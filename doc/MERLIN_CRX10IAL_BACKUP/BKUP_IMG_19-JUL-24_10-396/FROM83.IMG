  <h1 class='headert' id='headert_3'></h1>

    <div class='ladder_main_window' id='ladder_main_window'>
      <!-- search range -->
      <div class="search_string_area message-box message-box-inbox" >
        <span class="text_static_ladder_search message-box-contents-left" id="id_search_range"></span>
        <span class="select message-box-contents-right" id="iSelect1">
          <div class="select_list_width">
            <label class="select-label select-fixed-width" id="iSelect1.label"></label>
            <ul class="select-options hide" id="iSelect1.options" style="top:0px;">
            </ul>
            <button class="select-button">
              <ins class="select-arrow"></ins>
            </button>
          </div>
        </span>
      </div>

      <!-- search kind -->
      <div class="search_kind_area message-box message-box-inbox" >
        <span class="text_static_ladder_search message-box-contents-left" id="id_search_kind"></span>
        <span class="select message-box-contents-right" id="iSelect2">
          <div class="select_list_width">
            <label class="select-label select-fixed-width" id="iSelect2.label"></label>
            <ul class="select-options hide" id="iSelect2.options" style="top:0px;">
              <li class="select-option" data-value="0"><a href="#"><span id="id_search_kind_list_1"></span></a></li>
              <li class="select-option" data-value="1"><a href="#"><span id="id_search_kind_list_2"></span></a></li>
              <li class="select-option" data-value="2"><a href="#"><span id="id_search_kind_list_3"></span></a></li>
              <li class="select-option" data-value="3"><a href="#"><span id="id_search_kind_list_4"></span></a></li>
              <li class="select-option" data-value="4"><a href="#"><span id="id_search_kind_list_5"></span></a></li>
            </ul>
            <button class="select-button">
              <ins class="select-arrow"></ins>
            </button>
          </div>
        </span>
      </div>

      <!-- search string -->
      <div class="search_string_area message-box message-box-inbox">
        <span class="text_static_ladder_search message-box-contents-left" id="id_search_string"></span>
        <span class="message-box-contents-right">
          <span class="textbox" id="intbox.inbox">
            <input class="numeric text_ladder_search" id="intbox.inbox.search" style="color: rgb(0,0,0);" type="text">
          </span>
        </span>
      </div>

      <!-- search result list checkbox -->
      <div class="search_string_area message-box message-box-inbox" style="width: 1019px">
        <span class="text_static_ladder_search message-box-contents-left" id="id_search_result_list"></span>
        <span class="message-box-contents-right">
          <label id="checkbox1" class="checkbox">
            <input id="checkbox1.input" type="checkbox">
            <span tabindex="0"></span>
          </label>
        </span>
      </div>
      <!-- search contact checkbox -->
      <div class="search_string_area message-box message-box-inbox" style="width: 1019px">
        <span class="text_static_ladder_search message-box-contents-left" id="id_search_category"></span>
        <span class="text_static_ladder_search message-box-contents-left" id="id_search_contact"></span>
        <span class="text_static_ladder_search message-box-contents-left" id="id_search_coil"></span>
        <span class="text_static_ladder_search message-box-contents-left" id="id_search_subroutine"></span>
        <span class="contact-box-contents-right">
          <label id="checkbox2" class="checkbox">
            <input id="checkbox2.input" type="checkbox">
            <span tabindex="0"></span>
          </label>
        </span>
        <span class="coil-box-contents-right">
          <label id="checkbox3" class="checkbox">
            <input id="checkbox3.input" type="checkbox">
            <span tabindex="0"></span>
          </label>
        </span>
        <span class="subroutine-box-contents-right">
          <label id="checkbox4" class="checkbox">
            <input id="checkbox4.input" type="checkbox">
            <span tabindex="0"></span>
          </label>
        </span>
      </div>
      <!-- match type select radio button -->
      <div class="search_string_area message-box message-box-inbox" style="width: 1019px; top:70px;">
        <span class="text_static_ladder_search message-box-contents-left" id="id_match_search_type"></span>
        <span class="text_static_ladder_search message-box-contents-left" id="id_partial_match"></span>
        <span class="text_static_ladder_search message-box-contents-left" id="id_perfect_match"></span>
        <span class="partial-match-box-contents-right">
          <input id="partial_checked_focus" class="partial_radio"  type="image" src="icon/radio_1.png" onclick='switch_radio_button("partial_checked_focus")' style="display: none">
          <input id="partial_checked" class="partial_radio"  type="image" src="icon/radio_2.png" onclick='switch_radio_button("partial_checked")' style="display: block">
          <input id="partial_none_check" class="partial_radio"  type="image" src="icon/radio_3.png" onclick='switch_radio_button("partial_none_check")' style="display: none">
          <input id="partial_none_check_focus" class="partial_radio"  type="image" src="icon/radio_4.png" onclick='switch_radio_button("partial_none_check_focus")' style="display: none">
          <input id="partial_checked_disabled" class="partial_radio"  type="image" src="icon/radio_5.png" onclick='switch_radio_button("partial_checked_disabled")' style="display: none">
          <input id="partial_none_check_disabled" class="partial_radio"  type="image" src="icon/radio_6.png" onclick='switch_radio_button("partial_none_check_disabled")' style="display: none">
          <span tabindex="0"></span>
        </span>
        <span class="perfect-match-box-contents-right">
          <input id="perfect_checked_focus" class="perfect_radio"  type="image" src="icon/radio_1.png" onclick='switch_radio_button("perfect_checked_focus")' style="display: none">
          <input id="perfect_checked" class="perfect_radio"  type="image" src="icon/radio_2.png" onclick='switch_radio_button("perfect_checked")' style="display: none">
          <input id="perfect_none_check" class="perfect_radio"  type="image" src="icon/radio_3.png" onclick='switch_radio_button("perfect_none_check")' style="display: block">
          <input id="perfect_none_check_focus" class="perfect_radio"  type="image" src="icon/radio_4.png" onclick='switch_radio_button("perfect_none_check_focus")' style="display: none">
          <input id="perfect_checked_disabled" class="perfect_radio"  type="image" src="icon/radio_5.png" onclick='switch_radio_button("perfect_checked_disabled")' style="display: none">
          <input id="perfect_none_check_disabled" class="perfect_radio"  type="image" src="icon/radio_6.png" onclick='switch_radio_button("perfect_none_check_disabled")' style="display: none">
          <span tabindex="0"></span>
        </span>
      </div>      
    </div>

    <!-- function button view area -->
    <div class="function_button" id="function_button_3">
      <a class="func_btn" id="func_btn_3_home"></a>
      <a class="func_btn" id="func_btn_3_1"></a>
      <a class="func_btn" id="func_btn_3_2" onclick='ladder_search_click_f2_button()'></a>
      <a class="func_btn" id="func_btn_3_3"></a>
      <a class="func_btn" id="func_btn_3_4"></a>
      <a class="func_btn" id="func_btn_3_5" onclick='ladder_search_click_f5_button()'></a>
      <a class="func_btn" id="func_btn_3_next"></a>
    </div>
  </div>
  <!-- popup -->
  <div id="popup_no_comfirm_3" class="popup">
    <textarea id="poptitle" disabled="disabled"></textarea>
    <textarea class="srch_pop_msg" id="popcomment_3_1" disabled="disabled"></textarea>
    <textarea class="srch_pop_msg" id="popcomment_3_2" disabled="disabled"></textarea>
    <textarea class="srch_pop_msg" id="popcomment_3_3" disabled="disabled"></textarea>
    <textarea class="srch_pop_msg" id="popcomment_3_4" disabled="disabled"></textarea>
    <textarea class="srch_pop_msg" id="popcomment_3_5" disabled="disabled"></textarea>
    <textarea class="srch_pop_category" id="search_category_3_1" disabled="disabled"></textarea>
    <textarea class="srch_pop_category" id="search_category_3_2" disabled="disabled"></textarea>
    <textarea class="srch_pop_category" id="search_category_3_3" disabled="disabled"></textarea>
    <textarea class="srch_pop_category" id="search_category_3_4" disabled="disabled"></textarea>
    <textarea class="srch_pop_category" id="search_category_3_5" disabled="disabled"></textarea>
    <textarea class="srch_pop_category" id="search_category_3_6" disabled="disabled"></textarea>
    <textarea class="srch_pop_category" id="search_category_3_7" disabled="disabled"></textarea>
    <textarea class="srch_pop_all_category" id="search_all_category_3_1" disabled="disabled"></textarea>
    <input type="image" id="popbutton_close_3" onclick="closeDialog()" src="icon/close_x.png"  >
    <button type="button" id="popbutton_run" class="popbutton_run" onclick="all_category_search()"><span id="popbutton_comment_3_1"></span></button>  
    </div>

  <!-- Ladder Search Result Screen -->
  <div class='screen_ladder_search_result' id='screen_ladder_search_result'>
    <!-- title view area -->
    <h1 class='headert' id='headert_4'></h1>
    <h1 class='headert_result_count_area' id='headert_4_1_result_count_area'></h1>
    <h1 class='headert_result_count_area' id='headert_4_2_result_count_area'></h1>
    <!-- canvas domain for indication -->
    <div class="draw_area"> </div>
    <!-- function button view area -->
    <div class="function_button" id="function_button_4">
      <a class="func_btn" id="func_btn_4_home"></a>
      <a class="func_btn" id="func_btn_4_1" onclick='ladder_search_result_click_f1_button()'></a>
      <a class="func_btn" id="func_btn_4_2" onclick='ladder_search_result_click_f2_button()'></a>
      <a class="func_btn" id="func_btn_4_3" onclick='ladder_search_result_click_f3_button()'></a>
      <a class="func_btn" id="func_btn_4_4" onclick='ladder_search_result_click_f4_button()'></a>
      <a class="func_btn" id="func_btn_4_5"></a>
      <a class="func_btn" id="func_btn_4_next"></a>
    </div>
  </div>
  <!-- popup -->
  <div id="popup_no_comfirm_4" class="popup">
    <textarea id="poptitle" disabled="disabled"></textarea>
    <textarea id="popcomment_4_1" disabled="disabled"></textarea>
    <textarea id="popcomment_4_2" disabled="disabled"></textarea>
    <textarea id="poptitle_info_4" readonly></textarea>
    <textarea id="poptitle_address_4" disabled="disabled" ></textarea>
    <textarea id="poptitle_symbol_4" disabled="disabled" ></textarea>
    <textarea id="poptitle_comment_4" disabled="disabled" ></textarea>
    <textarea id="pop_address_4" placeholder="" disabled="disabled"></textarea>
    <textarea id="pop_symbol_4" placeholder="" disabled="disabled"></textarea>
    <textarea id="pop_comment_4" placeholder="" disabled="disabled"></textarea>
    <textarea class="srch_pop_msg" id="popcomment_4_3" disabled="disabled"></textarea>
    <textarea class="srch_pop_category" id="search_category_4_1" disabled="disabled"></textarea>
    <textarea class="srch_pop_category" id="search_category_4_2" disabled="disabled"></textarea>
    <textarea class="srch_pop_error" id="search_category_4_3" disabled="disabled"></textarea>
    <textarea class="srch_result_list_pop_error_" id="search_category_4_4" disabled="disabled"></textarea>
    <textarea class="srch_pop_category" id="search_category_4_5" disabled="disabled"></textarea>
    <textarea class="srch_pop_category" id="search_category_4_6" disabled="disabled"></textarea>
    <textarea class="srch_pop_category" id="search_category_4_7" disabled="disabled"></textarea>
    <textarea class="srch_pop_category" id="search_category_4_8" disabled="disabled"></textarea>
    <textarea class="srch_pop_category" id="search_category_4_9" disabled="disabled"></textarea>
    <input type="image" id="popbutton_close_4" onclick="closeDialog()" src="icon/close_x.png"  >
    <button type="button" id="popbutton_contact_2" class="popbutton_contact" onclick="search_result_contact_search()"><span id="popbutton_comment_4_1"></span></button>  
    <button type="button" id="popbutton_coil_2" class="popbutton_coil" onclick="search_result_coil_search()"><span id="popbutton_comment_4_2"></span></button>
    <button type="button" id="popbutton_edit_2" class="popbutton_edit" onclick="ladder_disp_edit_move(SCREEN_LADDER_SEARCH_RESULT)"><span id="popbutton_comment_4_3"></span></button>  
  </div>

  <!-- Ladder Search Result List Screen -->
  <div class='screen_ladder_search_result_list' id='screen_ladder_search_result_list'>
    <!-- title view area -->
    <h1 class='headert' id='headert_10'></h1>
    <h1 class='headert_result_list_count_area' id='headert_10_result_list_count_area'></h1>
    <!-- canvas domain for indication -->
    <div class="draw_area"> </div>
    <!-- function button view area -->
    <div class="function_button" id="function_button_10">
      <a class="func_btn" id="func_btn_10_home"></a>
      <a class="func_btn" id="func_btn_10_1" onclick='ladder_search_result_list_click_f1_button()'></a>
      <a class="func_btn" id="func_btn_10_2" onclick='ladder_search_result_list_click_f2_button()'></a>
      <a class="func_btn" id="func_btn_10_3"></a>
      <a class="func_btn" id="func_btn_10_4"></a>
      <a class="func_btn" id="func_btn_10_5"></a>
      <a class="func_btn" id="func_btn_10_next"></a>
    </div>
  </div>

  <!-- Ladder Search Replace Screen -->
  <div class='screen_ladder_search_replace' id='screen_ladder_search_replace'>
    <!-- title view area -->
    <h1 class='headert' id='headert_11'></h1>
    <h1 class='headert_replace_count_area' id='headert_11_1_replace_count_area'></h1>
    <h1 class='headert_replace_count_area' id='headert_11_2_replace_count_area'></h1>
    <!-- canvas domain for indication -->
    <div class="draw_area"> </div>
    <!-- function button view area -->
    <div class="function_button" id="function_button_11">
      <a class="func_btn" id="func_btn_11_home"></a>
      <a class="func_btn" id="func_btn_11_1" onclick='ladder_search_replace_click_f1_button()'></a>
      <a class="func_btn" id="func_btn_11_2" onclick='ladder_search_replace_click_f2_button()'></a>
      <a class="func_btn" id="func_btn_11_3" onclick='ladder_search_replace_click_f3_button()'></a>
      <a class="func_btn" id="func_btn_11_4" onclick='ladder_search_replace_click_f4_button()'></a>
      <a class="func_btn" id="func_btn_11_5" onclick='ladder_search_replace_click_f5_button()'></a>
      <a class="func_btn" id="func_btn_11_next"></a>
    </div>
  </div>
  <!-- popup -->
  <div id="popup_no_comfirm_11" class="popup">
    <textarea id="poptitle" disabled="disabled"></textarea>
    <textarea class="srch_rep_pop_msg" id="popcomment_11_1" disabled="disabled"></textarea>
    <textarea class="srch_rep_pop_msg" id="popcomment_11_2" disabled="disabled"></textarea>
    <textarea class="srch_rep_pop_msg" id="popcomment_11_3" disabled="disabled"></textarea>
    <textarea id="cnt_popcomment_11_4" placeholder="" disabled="disabled"></textarea>
    <textarea id="msg_popcomment_11_4_1" disabled="disabled"></textarea>
    <textarea id="msg_popcomment_11_4_2" disabled="disabled"></textarea>
    <textarea id="popcomment_11_4" disabled="disabled"></textarea>
    <input type="image" id="popbutton_close_11" onclick="closeDialog_11()" src="icon/close_x.png"  >
    <input type="button" id="popbutton_11_1" onclick="notSave_closeDialog_11()" value="OK"  onfocus="ladder_SL_onfocus_notsave_ok_button();"  onblur="ladder_SL_outfocus_notsave_button();">
    <input type="button" id="popbutton_11_2" onclick="closeDialog_11()" value="Cancel"  onfocus="ladder_SL_onfocus_notsave_cancel_button();"  onblur="ladder_SL_outfocus_notsave_button();">
  </div>

  <!-- Ladder Editor Screen -->
  <div class='screen_ladder_editor' id='screen_ladder_editor'>
    <!-- title view area -->
    <h1 class='headert' id='headert_5'></h1>
    <h1 class='headert_net_view_area' id='headert_edit_net_view_area'></h1>
    <!-- canvas domain for indication -->
    <div class="draw_area"> </div>
    <!-- function button view area -->
    <div class="function_button" id="function_button_5">
      <a class="func_btn" id="func_btn_5_home"></a>
      <a class="func_btn" id="func_btn_5_1" onclick='ladder_editor_click_f1_button()'></a>
      <a class="func_btn" id="func_btn_5_2" onclick='ladder_editor_click_f2_button()'></a>
      <a class="func_btn" id="func_btn_5_3" onclick='ladder_editor_click_f3_button()'></a>
      <a class="func_btn" id="func_btn_5_4" onclick='ladder_editor_click_f4_button()'></a>
      <a class="func_btn" id="func_btn_5_5" onclick='ladder_editor_click_f5_button()'></a>
      <a class="func_btn" id="func_btn_5_next" onclick= 'ladder_editor_click_fnext_button()'></a>
      <!-- function popup menu html-->
      <div id="func_menu_5_3" >
        <ul class="PopUpMenu" id="actMenu_5">
          <li><span id="action_menu_comment0"></span></li>
          <li id="func5_1"><a href="javascript:void(0);" onClick='ladder_display_action_menu_button(1)' tabindex="-1"><span id="action_menu_comment1"></span></a></li>
          <li id="func5_2"><a href="javascript:void(0);" onClick='ladder_display_action_menu_button(2)' tabindex="-1"><span id="action_menu_comment2"></span></a></li>
          <li id="func5_3"><a href="javascript:void(0);" onClick='ladder_display_action_menu_button(3)' tabindex="-1"><span id="action_menu_comment3"></span></a></li>
        </ul>
      </div>
      <!-- function popup menu html-->
      <div id="func_menu_5_4" >
        <ul class="PopUpMenu" id="netMenu_5">
          <li><span id="net_menu_comment0"></span></li>
          <li id="net5_1"><a href="javascript:void(0);" onClick='ladder_action_menu_button(1)' tabindex="-1"><span id="net_menu_comment1"></span></a></li>
          <li id="net5_2"><a href="javascript:void(0);" onClick='ladder_action_menu_button(2)' tabindex="-1"><span id="net_menu_comment2"></span></a></li>
          <li id="net5_3"><a href="javascript:void(0);" onClick='ladder_action_menu_button(3)' tabindex="-1"><span id="net_menu_comment3"></span></a></li>
          <li id="net5_4"><a href="javascript:void(0);" onClick='ladder_action_menu_button(4)' tabindex="-1"><span id="net_menu_comment4"></span></a></li>
        </ul>
      </div>
    </div>
    <div class="function_button2" id="function_button_5_2">
      <a class="func_btn" id="func_btn_5_home_2" width="0"></a>
      <a class="func_btn" id="func_btn_5_6" width="0"></a>
      <a class="func_btn" id="func_btn_5_7" onclick='ladder_editor_click_f7_button()'></a>
      <a class="func_btn" id="func_btn_5_8"></a>
      <a class="func_btn" id="func_btn_5_9" onclick='ladder_editor_click_f9_button()'></a>
      <a class="func_btn" id="func_btn_5_10"></a>
      <a class="func_btn" id="func_btn_5_next_2" onclick= 'ladder_editor_click_fnext_button()'></a>
      <!-- function popup menu html-->
      <div id="func_menu_5_7" >
        <ul class="PopUpMenu" id="symbolMenu_5">
          <li><span id="symbol_menu5_comment0"></span></li>
          <li id="symbol5_1" ><a href="javascript:void(0);" onClick='ladder_editor_symbol_menu_button(1)' tabindex="-1"><span id="symbol_menu5_comment1"></span></a></li>
          <li id="symbol5_2" ><a href="javascript:void(0);" onClick='ladder_editor_symbol_menu_button(2)' tabindex="-1"><span id="symbol_menu5_comment2"></span></a></li>
          <li id="symbol5_3" ><a href="javascript:void(0);" onClick='ladder_editor_symbol_menu_button(3)' tabindex="-1"><span id="symbol_menu5_comment3"></span></a></li>
          <li id="symbol5_4" ><a href="javascript:void(0);" onClick='ladder_editor_symbol_menu_button(4)' tabindex="-1"><span id="symbol_menu5_comment4"></span></a></li>
          <li id="symbol5_5" ><a href="javascript:void(0);" onClick='ladder_editor_symbol_menu_button(5)' tabindex="-1"><span id="symbol_menu5_comment5"></span></a></li>
          <li id="symbol5_6" ><a href="javascript:void(0);" onClick='ladder_editor_symbol_menu_button(6)' tabindex="-1"><span id="symbol_menu5_comment6"></span></a></li>
        </ul>
      </div>
      <!-- function scalng menu -->
      <div id="func_menu_5_9" >
        <ul class="PopUpMenu" id="scaleMenu_5">
          <li><span id="scaring_menu5_comment0"></span></li>
          <li id="scaling5_1" ><a href="javascript:void(0);" onClick='ladder_editor_scaling_menu_button(1)' tabindex="-1"><span id="scaring_menu5_comment1"></span></a></li>
          <li id="scaling5_2" ><a href="javascript:void(0);" onClick='ladder_editor_scaling_menu_button(2)' tabindex="-1"><span id="scaring_menu5_comment2"></span></a></li>
          <li id="scaling5_3" ><a href="javascript:void(0);" onClick='ladder_editor_scaling_menu_button(3)' tabindex="-1"><span id="scaring_menu5_comment3"></span></a></li>
          <li id="scaling5_4" ><a href="javascript:void(0);" onClick='ladder_editor_scaling_menu_button(4)' tabindex="-1"><span id="scaring_menu5_comment4"></span></a></li>
          <li id="scaling5_5" ><a href="javascript:void(0);" onClick='ladder_editor_scaling_menu_button(5)' tabindex="-1"><span id="scaring_menu5_comment5"></span></a></li>
          <li id="scaling5_6" ><a href="javascript:void(0);" onClick='ladder_editor_scaling_menu_button(6)' tabindex="-1"><span id="scaring_menu5_comment6"></span></a></li>
        </ul>
      </div>
    </div>
  </div>
  <!-- popup -->
  <div id="popup_no_comfirm_5" class="popup">
    <textarea id="poptitle" disabled="disabled"></textarea>
    <textarea id="popcomment_5_1" disabled="disabled"></textarea>
    <textarea id="popcomment_5_2" disabled="disabled"></textarea>
    <textarea id="popcomment_5_3" disabled="disabled"></textarea>
    <textarea id="popcomment_5_4" disabled="disabled"></textarea>
    <textarea id="popcomment_5_5" disabled="disabled"></textarea>
    <input type="image" id="popbutton_close_5" onclick="closeDialog()" src="icon/close_x.png"  >
  </div>

  <!-- Ladder Net Edit Screen -->
  <div class='screen_ladder_netedit' id='screen_ladder_netedit'>
    <!-- title view area -->
    <h1 class='headert' id='headert_6'></h1>
    <!-- canvas domain for indication -->
    <div class="draw_area"> </div>
    <!-- function button view area -->
    <div class="function_button" id="function_button_6">
      <a class="func_btn" id="func_btn_6_home"></a>
      <a class="func_btn" id="func_btn_6_1" onclick='ladder_netedit_click_f1_button()'></a>
      <a class="func_btn" id="func_btn_6_2" onclick='ladder_netedit_click_f2_button()'></a>
      <a class="func_btn" id="func_btn_6_3"></a>
      <a class="func_btn" id="func_btn_6_4" onclick='ladder_netedit_click_f4_button()'></a>
      <a class="func_btn" id="func_btn_6_5" onclick='ladder_netedit_click_f5_button()'></a>
      <a class="func_btn" id="func_btn_6_next"></a>
      <!-- function popup menu html-->
      <div id="func_menu_6_4" >
        <ul class="PopUpMenu" id="eleMenu_6">
          <li><span id="ele_menu6_comment0"></span></li>
          <li id="net6_1" ><a href="javascript:void(0);" onClick='ladder_netedit_ele_menu_button(1)' tabindex="-1"><span id="ele_menu6_comment1"></span></a></li>
          <li id="net6_2" ><a href="javascript:void(0);" onClick='ladder_netedit_ele_menu_button(2)' tabindex="-1"><span id="ele_menu6_comment2"></span></a></li>
          <li id="net6_3" ><a href="javascript:void(0);" onClick='ladder_netedit_ele_menu_button(3)' tabindex="-1"><span id="ele_menu6_comment3"></span></a></li>
          <li id="net6_4" ><a href="javascript:void(0);" onClick='ladder_netedit_ele_menu_button(4)' tabindex="-1"><span id="ele_menu6_comment4"></span></a></li>
        </ul>
      </div>
      <!-- function popup menu html-->
      <div id="func_menu_6_4_subroutine" >
        <ul class="PopUpMenu" id="eleMenu_6_subroutine">
          <li><span id="elesub_menu6_comment0"></span></li>
          <li id="net6_1" ><a href="javascript:void(0);" onClick='ladder_netedit_ele_menu_button(1)' tabindex="-1"><span id="elesub_menu6_comment1"></span></a></li>
          <li id="net6_2" ><a href="javascript:void(0);" onClick='ladder_netedit_ele_menu_button(2)' tabindex="-1"><span id="elesub_menu6_comment2"></span></a></li>
        </ul>
      </div>
      <!-- net edit button -->
      <input class='net_edit_button' id='a_contact'       type="image" src="icon/net_edit_1.png" tabindex="-1" onclick="click_a_contact();"/>
      <input class='net_edit_button' id='b_contact'       type="image" src="icon/net_edit_2.png" tabindex="-1" onclick="click_b_contact();"/>
      <input class='net_edit_button' id='coil'            type="image" src="icon/net_edit_3.png" tabindex="-1" onclick="click_coil();"/>
      <input class='net_edit_button' id='not_coil'        type="image" src="icon/net_edit_4.png" tabindex="-1" onclick="click_not_coil();"/>
      <input class='net_edit_button' id='horizontal_line' type="image" src="icon/net_edit_5.png" tabindex="-1" onclick="click_horizontal_line();"/>
      <input class='net_edit_button' id='vertical_line'   type="image" src="icon/net_edit_6.png" tabindex="-1" onclick="click_vertical_line();"/>
      <input class='net_edit_button' id='set_coil'        type="image" src="icon/net_edit_7.png" tabindex="-1" onclick="click_set_coil();"/>
      <input class='net_edit_button' id='reset_coil'      type="image" src="icon/net_edit_8.png" tabindex="-1" onclick="click_reset_coil();"/>
      <input class='net_edit_button' id='reset_button'    type="image" src="icon/net_edit_9.png" tabindex="-1" onclick="click_reset_button();"/>
      <input class='net_edit_button' id='undo'            type="image" src="icon/net_edit_10.png" tabindex="-1" onclick="click_undo();"/>
      <input class='net_edit_button' id='redo'            type="image" src="icon/net_edit_11.png" tabindex="-1" onclick="click_redo();"/>
    </div>
    <div class="function_button2" id="function_button_6_2">
      <a class="func_btn" id="func_btn_6_home_2"></a>
      <a class="func_btn" id="func_btn_6_6"></a>
      <a class="func_btn" id="func_btn_6_7" onclick='ladder_netedit_click_f7_button()'></a>
      <a class="func_btn" id="func_btn_6_8" onclick='ladder_netedit_click_f8_button()'></a>
      <a class="func_btn" id="func_btn_6_9" onclick='ladder_netedit_click_f9_button()'></a>
      <a class="func_btn" id="func_btn_6_10" onclick='ladder_netedit_click_f10_button()'></a>
      <a class="func_btn" id="func_btn_6_next_2"></a>
    </div>
  </div>
  <!-- popup -->
  <div id="popup_no_comfirm_6" class="popup">
    <textarea id="poptitle" disabled="disabled"></textarea>
    <textarea id="popcomment_6_1" disabled="disabled"></textarea>
    <textarea id="popcomment_6_2" disabled="disabled"></textarea>
    <textarea id="popcomment_6_3" disabled="disabled"></textarea>
    <textarea id="popcomment_6_4" disabled="disabled"></textarea>
    <textarea id="err_popcomment_6_1" placeholder="" disabled="disabled"></textarea>
    <textarea id="err_popcomment_6_2" placeholder="" disabled="disabled"></textarea>
    <textarea id="err_popcomment_6_3" placeholder="" disabled="disabled"></textarea>
    <textarea id="err_popcomment_6_4" placeholder="" disabled="disabled"></textarea>
    <input type="image" id="popbutton_close_6" onclick="closeDialog()" src="icon/close_x.png"  >
    <input type="button" id="popbutton6_1" onclick="closeDialog()" value="OK"  onfocus="onfocus_net_edit_ok_button();"  onblur="outfocus_net_edit_ok_button();">
    <button type="button" id="popbutton6_2" onclick="net_edit_paste_popup_click(1)" onfocus="onfocus_overwrite_button()"  onblur="outfocus_overwrite_button()"><span id="popbutton_comment6_2"></span></button>
    <button type="button" id="popbutton6_3" onclick="net_edit_paste_popup_click(2)" onfocus="onfocus_insert_button()"  onblur="outfocus_overwrite_button()"><span id="popbutton_comment6_3"></span></button>
    <!-- subroutine parameter edit popup -->
    <div id="sub_param_area" style="display: none; height: 70%;">
      <textarea id="popcomment_6_5" disabled="disabled"></textarea>
      <div class="wrapp">
        <span id="sub_edit_info"></span>
        <div class="message-box message-box-inbox" id="param_text_area1">
          <span class="message-box-contents-left" id="id_net_editor_param1"></span>
          <span class="message-box-contents-right" style="width: 60%;">
            <span id="sub_param1"></span>
          </span>
        </div>
        <div class="message-box message-box-inbox" id="param_text_area2">
          <span class="message-box-contents-left" id="id_net_editor_param2"></span>
          <span class="message-box-contents-right" style="width: 60%;">
            <span class="textbox" id="intbox.inbox">
              <input class="numeric text_tmr_param2" id="intbox.inbox.param2" style="width: 40%;" type="text">
            </span>
          </span>
        </div>
        <span id="err_comment_param2"></span>
      </div>
      <input type="button" id="popbutton6_4" onclick="check_sub_edit_param()" value="OK"  onfocus="onfocus_net_edit_ok_button();"  onblur="outfocus_net_edit_ok_button();">
      <input type="button" id="popbutton6_5" onclick="closeDialog()" value="Cancel"  onfocus="onfocus_net_edit_ok_button();"  onblur="outfocus_net_edit_ok_button();">
    </div>
  </div>

  <!-- Ladder Replace Screen -->
  <div class='screen_ladder_replace' id='screen_ladder_replace'>
    <!-- title view area -->
    <h1 class='headert' id='headert_7'></h1>

    <div class='ladder_main_window' id='ladder_main_window'>
      <!-- replace range -->
      <div class="replace_before_area message-box message-box-inbox">
        <span class="text_static_ladder_replace message-box-contents-left" id="id_replace_range"></span>
        <span class="select message-box-contents-right" id="iSelect4">
          <div class="select_list_width">
            <label class="select-label select-fixed-width" id="iSelect4.label"></label>
            <ul class="select-options hide" id="iSelect4.options" style="top:0px;">
            </ul>
            <button class="select-button">
              <ins class="select-arrow"></ins>
            </button>
          </div>
        </span>
      </div>

      <!-- address : before replacement -->
      <div class="replace_before_area message-box message-box-inbox">
        <span class="text_static_ladder_replace message-box-contents-left" id="id_replace_before"></span>
        <span class="message-box-contents-right">
          <span class="textbox" id="intbox.inbox">
            <input class="numeric text_ladder_replace" id="intbox.inbox.replace.before" style="color: rgb(0,0,0);" type="text">
          </span>
        </span>
      </div>

       <!-- address : after replacement -->
      <div class="replace_after_area message-box message-box-inbox">
        <span class="text_static_ladder_replace message-box-contents-left" id="id_replace_after"></span>
        <span class="message-box-contents-right">
          <span class="textbox" id="intbox.inbox">
            <input class="numeric text_ladder_replace" id="intbox.inbox.replace.after" style="color: rgb(0,0,0);" type="text">
          </span>
        </span>
      </div>

    <!-- search warning message -->
    <textarea id="id_replace_comment" disabled="disabled"></textarea>
    </div>

    <!-- function button view area -->
    <div class="function_button" id="function_button_7">
      <a class="func_btn" id="func_btn_7_home"></a>
      <a class="func_btn" id="func_btn_7_1" onclick='ladder_replace_click_f1_button()'></a>
      <a class="func_btn" id="func_btn_7_2" onclick='ladder_replace_click_f2_button()'></a>
      <a class="func_btn" id="func_btn_7_3" onclick='ladder_replace_click_f3_button()'></a>
      <a class="func_btn" id="func_btn_7_4"></a>
      <a class="func_btn" id="func_btn_7_5"></a>
      <a class="func_btn" id="func_btn_7_next"></a>
    </div>
  </div>
  <!-- popup -->
  <div id="popup_no_comfirm_7" class="popup">
    <textarea id="poptitle" disabled="disabled"></textarea>
    <textarea id="cnt_popcomment_7_1" placeholder="" disabled="disabled"></textarea>
    <textarea id="msg_popcomment_7_1" disabled="disabled"></textarea>
    <textarea id="msg_popcomment_7_2" disabled="disabled"></textarea>
    <textarea id="popcomment_7_1" disabled="disabled"></textarea>
    <textarea id="popcomment_7_2" disabled="disabled"></textarea>
    <textarea id="popcomment_7_3" disabled="disabled"></textarea>
    <textarea id="popcomment_7_4" disabled="disabled"></textarea>
    <textarea id="popcomment_7_5" disabled="disabled"></textarea>
    <input type="image" id="popbutton_close_7" onclick="closeDialog()" src="icon/close_x.png"  >
  </div>

  <!-- Ladder Element Editor Screen -->
  <div class='screen_ladder_element_editor' id='screen_ladder_element_editor'>
    <!-- title view area -->
    <h1 class='headert' id='headert_8'></h1>

    <div class='ladder_main_window' id='ladder_main_window'>
      <!-- PMC address -->
      <div class="elem_edit_top_area message-box message-box-inbox">
        <span class="text_static_elem_edit message-box-contents-left" id="id_elem_edit_pmc_addr"></span>
        <span class="message-box-contents-right">
          <span class="textbox" id="intbox.inbox">
            <input class="numeric text_elem_edit" id="intbox.inbox.elem.addr" style="color: rgb(0,0,0); " type="text">
          </span>
        </span>
      </div>

       <!-- PMC symbols -->
      <div class="elem_edit_area message-box message-box-inbox" style="width: 1019px">
        <span class="text_static_elem_edit message-box-contents-left" id="id_elem_edit_pmc_symbol"></span>
        <span class="message-box-contents-right" style="width: 38%; position: fixed; left: 305px;">
          <span class="text_static_elem" id="elem_edit_pmc_symbol" ></span>
        </span>
      </div>

       <!-- comment -->
      <div class="elem_edit_area message-box message-box-inbox" style="width: 1019px">
        <span class="text_static_elem_edit message-box-contents-left" id="id_elem_edit_pmc_comment"></span>
        <span class="message-box-contents-right" id="message_box_pmc_comment">
          <span class="text_static_elem" id="elem_edit_pmc_comment"></span>
        </span>
      </div>
    </div>

    <!-- function button view area -->
    <div class="function_button" id="function_button_8">
      <a class="func_btn" id="func_btn_8_home"></a>
      <a class="func_btn" id="func_btn_8_1" onclick='ladder_element_editor_click_f1_button()'></a>
      <a class="func_btn" id="func_btn_8_2"></a>
      <a class="func_btn" id="func_btn_8_3"></a>
      <a class="func_btn" id="func_btn_8_4"></a>
      <a class="func_btn" id="func_btn_8_5" onclick='ladder_element_editor_click_f5_button()'></a>
      <a class="func_btn" id="func_btn_8_next"></a>
    </div>
  </div>
  <!-- popup -->
  <div id="popup_no_comfirm_8" class="popup">
    <textarea id="poptitle" disabled="disabled"></textarea>
    <textarea id="popcomment_8_1" disabled="disabled"></textarea>
    <textarea id="popcomment_8_2" disabled="disabled"></textarea>
    <textarea id="popcomment_8_3" disabled="disabled"></textarea>
    <input type="image" id="popbutton_close_8" onclick="closeDialog()" src="icon/close_x.png"  >
  </div>

  <!-- Ladder Tree Screen -->
  <div class='screen_ladder_tree' id='screen_ladder_tree'>
    <!-- title view area -->
    <h1 class='headert' id='headert_9'></h1>
    <!-- ladder tree view area -->
    <div class="tree-scroll-frame" id="treeMenu_scroll">
      <div id="treeMenu" class="tree-menu text" tabindex="0" height="0">
      </div>
    </div>
  <!--#if _remote_mode = FALSE -->
  <div id="divTabEnd" tabindex="0"></div>
  <!--#endif -->
<script type="text/javascript">
  var iHMIReqParams = {path: ""}
  var treeJson = [];

</script>
    <!-- function button view area -->
    <div class="function_button" id="function_button_9">
      <a class="func_btn" id="func_btn_9_home"></a>
      <a class="func_btn" id="func_btn_9_1" onclick='ladder_tree_click_f1_button()'></a>
      <a class="func_btn" id="func_btn_9_2" onclick='ladder_tree_click_f2_button()'></a>
      <a class="func_btn" id="func_btn_9_3" onclick='ladder_tree_click_f3_button()'></a>
      <a class="func_btn" id="func_btn_9_4" onclick='ladder_tree_click_f4_button()'></a>
      <a class="func_btn" id="func_btn_9_5"></a>
      <a class="func_btn" id="func_btn_9_next"></a>
      <!-- popup -->
      <div id="func_menu_9_2" >
        <ul class="PopUpMenu" id="pmcMenu_9">
          <li><span id="pmc_menu_comment3_0"></span></li>
          <li  id="pmc9_1" ><a href="javascript:void(0);" onClick='ladder_tree_pmc_menu_button(1)' tabindex="-1"><span id="pmc_menu_comment3_1"></span></a></li>
          <li  id="pmc9_2" ><a href="javascript:void(0);" onClick='ladder_tree_pmc_menu_button(2)' tabindex="-1"><span id="pmc_menu_comment3_2"></span></a></li>
          <li  id="pmc9_3" ><a href="javascript:void(0);" onClick='ladder_tree_pmc_menu_button(3)' tabindex="-1"><span id="pmc_menu_comment3_3"></span></a></li>
          <li  id="pmc9_4" ><a href="javascript:void(0);" onClick='ladder_tree_pmc_menu_button(4)' tabindex="-1"><span id="pmc_menu_comment3_4"></span></a></li>
          <li  id="pmc9_5" ><a href="javascript:void(0);" onClick='ladder_tree_pmc_menu_button(5)' tabindex="-1"><span id="pmc_menu_comment3_5"></span></a></li>
          <li  id="pmc9_6" ><a href="javascript:void(0);" onClick='ladder_tree_pmc_menu_button(6)' tabindex="-1"><span id="pmc_menu_comment3_6"></span></a></li>
        </ul>
      </div>
    </div>
  </div>
    
  <!-- popup -->
  <div id="popup_no_comfirm_9" class="popup">
    <textarea id="poptitle" disabled="disabled"></textarea>
    <textarea class="tree_pop_msg" id="popcomment_9_1" disabled="disabled"></textarea>
    <textarea class="tree_pop_msg" id="popcomment_9_2" disabled="disabled"></textarea>
    <textarea class="tree_pop_msg" id="popcomment_9_3" disabled="disabled"></textarea>
    <textarea id="popcomment_9_4" disabled="disabled"></textarea>
    <input type="image" id="popbutton_close_9" onclick="closeDialog()" src="icon/close_x.png"  >
  </div>

  <!-- Symbol comment editor Screen -->
  <div class='screen_symbol_comment_editor' id='screen_symbol_comment_editor'>
    <!-- title view area -->
    <h1 class='headert' id='headert_12'></h1>

    <div class='ladder_main_window' id='ladder_main_window'>
      <!-- address string -->
      <div class="address_string_area message-box message-box-inbox" id="address_string_area" style="width: 100%; position: absolute;">
        <span class="text_static_symbol_comment message-box-contents-left" id="id_address_string"></span>
        <span class="select message-box-contents-left" id="iSelect3">
          <div id="select_address"  style="width: 55px; left: 170px;">
            <label class="select-label select-fixed-width" id="iSelect3.label"></label>
            <ul class="select-options hide" id="iSelect3.options" style="top:0px;"></ul>
            <button class="select-button" id="sym_select">
              <ins class="select-arrow" id="sym_select_arw"></ins>
            </button>
          </div>
        </span>
        <span class="message-box-contents-right">
          <span class="textbox" id="intbox.inbox">
            <input class="numeric text_symbol_comment" id="intbox.inbox.address" style="left: 350px;width: 25%;max-width: 250px;" type="text">
          </span>
        </span>
      </div>
      <div class="symbol_comment" id="symbol_comment_table"></div>
      <ul class="sym_com_edit_button">
        <li id="further_prev_addr" tabindex="-1" onclick="click_further_prev_addr();"><img src="icon/sym_com_1.png"></li>
        <li id="prev_addr" tabindex="-1" onclick="click_prev_addr();"><img src="icon/sym_com_2.png"></li>
        <li id="blank" ></li>
        <li id="next_addr" tabindex="-1" onclick="click_next_addr();"><img src="icon/sym_com_3.png"></li>
        <li id="further_next_addr" tabindex="-1" onclick="click_further_next_addr();"><img src="icon/sym_com_4.png"></li>
      </ul>
    </div>

    <!-- function button view area -->
    <div class="function_button" id="function_button_12">
      <a class="func_btn" id="func_btn_12_home"></a>
      <a class="func_btn" id="func_btn_12_1" onclick='ladder_symbol_comment_editor_click_f1_button()'></a>
      <a class="func_btn" id="func_btn_12_2" onclick='ladder_symbol_comment_editor_click_f2_button(0, 0)'></a>
      <a class="func_btn" id="func_btn_12_3" onclick='ladder_symbol_comment_editor_click_f3_button()'></a>
      <a class="func_btn" id="func_btn_12_4"></a>
      <a class="func_btn" id="func_btn_12_5" onclick='ladder_symbol_comment_editor_click_f5_button()'></a>
      <a class="func_btn" id="func_btn_12_next"></a>
    </div>
    
  </div>
  <!-- popup -->
  <div id="popup_no_comfirm_12" class="popup">
    <textarea id="poptitle" disabled="disabled"></textarea>
    <textarea class="symbol_com_pop_msg" id="popcomment_12_1" disabled="disabled"></textarea>
    <textarea class="symbol_com_pop_msg" id="popcomment_12_2" disabled="disabled"></textarea>
    <textarea class="symbol_com_pop_msg" id="popcomment_12_3" disabled="disabled"></textarea>
    <textarea class="symbol_com_pop_msg" id="popcomment_12_4" disabled="disabled"></textarea>
    <textarea class="symbol_com_pop_msg" id="popcomment_12_5" disabled="disabled"></textarea>
    <textarea class="symbol_com_pop_msg" id="popcomment_12_6" disabled="disabled"></textarea>
    <textarea class="symbol_com_pop_msg" id="popcomment_12_7" disabled="disabled"></textarea>
    <textarea class="symbol_com_pop_msg" id="popcomment_12_8" disabled="disabled"></textarea>
    <textarea class="symbol_com_pop_msg" id="popcomment_12_9" disabled="disabled"></textarea>
    <textarea id="poptitle_row_12" disabled="disabled" ></textarea>
    <textarea id="poptitle_column_12" disabled="disabled" ></textarea>
    <textarea id="pop_row_12" placeholder="" disabled="disabled"></textarea>
    <textarea id="pop_column_12" placeholder="" disabled="disabled"></textarea>
    <input type="image" id="popbutton_close_12" onclick="closeDialog()" src="icon/close_x.png"  >
    <input type="button" id="popbutton12" onclick="ladder_symbol_comment_editor_click_f3_button_func()" value="OK">
    <input type="button" id="popbutton13" onclick="closeDialog()" value="Cancel">  
    <input type="button" id="popbutton14" onclick="ladder_symbol_comment_editor_comp_ok_button()" value="OK">
    <input type="button" id="popbutton15" onclick="closeDialog()" value="Cancel">  
  </div>

<a hidden id="fnccomment_close"></a>

  <!-- Debug Page(log) -->
  <div class='screen_ladder_debug_page_log' id='screen_ladder_debug_page_log'>
    <h1 class='headert' id='headert_debug'></h1>
    <p>Debug Log</p>
    <textarea class='ladder_debug_log_area' id='ladder_debug_log_area' readonly></textarea>
    <div class="function_button" id="function_button">
      <a class="func_btn" id="func_btn_debug_home"></a>
      <a class="func_btn" id="func_btn_debug_1" onclick='ladder_debug_page_log_click_f1_button()'></a>
      <a class="func_btn" id="func_btn_debug_2" onclick='ladder_debug_page_log_click_f2_button()'></a>
      <a class="func_btn" id="func_btn_debug_3" onclick='ladder_debug_page_log_click_f3_button()'></a>
      <a class="func_btn" id="func_btn_debug_4" onclick='ladder_debug_page_log_click_f4_button()'></a>
      <a class="func_btn" id="func_btn_debug_5" onclick='ladder_debug_page_log_click_f5_button()'></a>
      <a class="func_btn" id="func_btn_debug_next"></a>
    </div>
  </div>

  <!-- Debug Page(interface test) -->
  <div class='screen_ladder_debug_page_if_test' id='screen_ladder_debug_page_if_test'>
    <h1 class='headert' id='headert_debug_if_test'></h1>
    <p>Interface test page</p>
    <p>1.Check PMC status
      <input type='button' id='ladder_debug_if_test_pmc_status_get_button' onclick='ladder_debug_page_if_test_pmc_status_get()' value='GET STATUS'></input>
    </p>
    <p id='ladder_debug_if_test_pmc_status'>unacquired</p>

    <p id='ladder_debug_if_test_pmc_status'>2.Check PMC value
      <input type='button' id='ladder_debug_if_test_pmc_value_get_button' onclick='ladder_debug_page_if_test_pmc_value_get()' value='GET VALUE'></input>
    </p>
    <p>
      <input type='radio' name='pmc_symbol' value='A'>A
      <input type='radio' name='pmc_symbol' value='C'>C
      <input type='radio' name='pmc_symbol' value='D'>D
      <input type='radio' name='pmc_symbol' value='E'>E
      <input type='radio' name='pmc_symbol' value='F'>F
      <input type='radio' name='pmc_symbol' value='G'>G
      <input type='radio' name='pmc_symbol' value='K'>K
      <input type='radio' name='pmc_symbol' value='L'>L
      <input type='radio' name='pmc_symbol' value='M'>M
      <input type='radio' name='pmc_symbol' value='N'>N
      <input type='radio' name='pmc_symbol' value='P'>P
      <br>
      <input type='radio' name='pmc_symbol' value='R'>R
      <input type='radio' name='pmc_symbol' value='S'>S
      <input type='radio' name='pmc_symbol' value='T'>T
      <input type='radio' name='pmc_symbol' value='U'>U
      <input type='radio' name='pmc_symbol' value='V'>V
      <input type='radio' name='pmc_symbol' value='W'>W
      <input type='radio' name='pmc_symbol' value='X'>X
      <input type='radio' name='pmc_symbol' value='Y'>Y
      <input type='radio' name='pmc_symbol' value='Z'>Z
    </p>
    <p>from
      <input type="text" id="text_from_address"></input>
      to
      <input type="text" id="text_to_address"></input>
    </p>
    <p>Debug Information :</p>
    <textarea class='ladder_debug_pmc_data_textarea' id='ladder_debug_pmc_data_textarea' readonly></textarea>
    <div class="function_button" id="function_button">
      <a class="func_btn" id="func_btn_debug_if_test_home"></a>
      <a class="func_btn" id="func_btn_debug_if_test_1" onclick='ladder_debug_page_if_test_click_f1_button()'></a>
      <a class="func_btn" id="func_btn_debug_if_test_2" onclick='ladder_debug_page_if_test_click_f2_button()'></a>
      <a class="func_btn" id="func_btn_debug_if_test_3"></a>
      <a class="func_btn" id="func_btn_debug_if_test_4" onclick='ladder_debug_page_if_test_click_f4_button()'></a>
      <a class="func_btn" id="func_btn_debug_if_test_5" onclick='ladder_debug_page_if_test_click_f5_button()'></a>
      <a class="func_btn" id="func_btn_debug_if_test_next"></a>
    </div>
  </div>

  <!-- PMC Read Error Screen -->
  <div class='screen_ladder_error_pmc_read' id='screen_ladder_error_pmc_read'>
    <h1 class='headert' id='headert_error_pmc_read'></h1>
    <textarea class='ladder_error_pmc_read_area' id='ladder_error_pmc_read_area' disabled="disabled"></textarea>
       
    <div class="function_button" id="function_button_err">
      <a class="func_btn" id="func_btn_error_pmc_read_home"></a>
      <a class="func_btn" id="func_btn_error_pmc_read_1" onclick='ladder_error_pmc_read_click_f1_button()'></a>
      <a class="func_btn" id="func_btn_error_pmc_read_2" onclick='ladder_error_pmc_read_click_f2_button()'></a>
      <a class="func_btn" id="func_btn_error_pmc_read_3"></a>
      <a class="func_btn" id="func_btn_error_pmc_read_4"></a>
      <a class="func_btn" id="func_btn_error_pmc_read_5"></a>
      <a class="func_btn" id="func_btn_error_pmc_read_next"></a>
      <!-- function popup menu html-->
      <div id="func_menu_error_pmc_read" >
        <ul class="PopUpMenu" id="pmcMenu_error_pmc_read">
          <li><span id="pmc_menu_comment6_0"></span></li>
          <li id="pmcMenu_error_pmc_read1" ><a href="javascript:void(0);" onClick='ladder_error_pmc_menu_button(1)' tabindex="-1"><span id="pmc_menu_comment6_1"></span></a></li>
          <li id="pmcMenu_error_pmc_read2" ><a href="javascript:void(0);" onClick='ladder_error_pmc_menu_button(2)' tabindex="-1"><span id="pmc_menu_comment6_2"></span></a></li>
          <li id="pmcMenu_error_pmc_read3" ><a href="javascript:void(0);" onClick='ladder_error_pmc_menu_button(3)' tabindex="-1"><span id="pmc_menu_comment6_3"></span></a></li>
          <li id="pmcMenu_error_pmc_read4" ><a href="javascript:void(0);" onClick='ladder_error_pmc_menu_button(4)' tabindex="-1"><span id="pmc_menu_comment6_4"></span></a></li>
          <li id="pmcMenu_error_pmc_read5" ><a href="javascript:void(0);" onClick='ladder_error_pmc_menu_button(5)' tabindex="-1"><span id="pmc_menu_comment6_5"></span></a></li>
          <li id="pmcMenu_error_pmc_read6" ><a href="javascript:void(0);" onClick='ladder_error_pmc_menu_button(6)' tabindex="-1"><span id="pmc_menu_comment6_6"></span></a></li>
        </ul>
      </div>
    </div>
  </div>
  
  <input id="reload_flg" type="hidden" value="" />
  <input id="pmctype" type="hidden" value="" />
  <script>
    g_processing_flg = FLG_ON;
    var webpage = 'ihmi_pmc_ladder';
    var doc = document;
    var init = initComponents;

    init(doc, 'select', 'iSelect2', {'width':'300px'});
    init(doc, 'treeMenu', 'treeEditMenu', {'treetype':'select', 'movetype':'focus', 'scroll':'true', 'heigth':'570px'});
    init(doc, 'treeMenu', 'treeMenu', {'treetype':'select', 'movetype':'focus', 'scroll':'true', 'heigth':'570px'});

    window.onclick = function(event) {
      var elem = event.srcElement;
      if (g_popup_flg === FLG_OFF) {
        if (document.getElementById("screen_ladder_search").style.display !=="block") {
          return;
        }
        if (elem.className == "partial_radio" || elem.className == "perfect_radio") {
          return;
        }
        take_focus_radio_button();
      }
    }
    window.onload = function() {
      
      //Scroll bar for smt
      create_scrollbar();
      // pmc display from Launcher
      if (g_device === 'smt' && top.tpkeyssheet == undefined) { 
        var tree_scrollbar = document.styleSheets[0].cssRules;
        for (var i = 0; i < document.styleSheets[0].cssRules.length; i++) {
          if (document.styleSheets[0].cssRules[i].selectorText === ".add_scrollbar::-webkit-scrollbar") {
            var tree_scrollbar_style = document.styleSheets[0].cssRules[i];
            break;
          }
        }
        tree_scrollbar_style.style.width = "45px";
        var symbolcommnet_scrollbar = document.styleSheets[0].cssRules;
        for (var i = 0; i < document.styleSheets[2].cssRules.length; i++) {
          if (document.styleSheets[2].cssRules[i].selectorText === "#symbol_comment_table::-webkit-scrollbar") {
            var symbolcommnet_scrollbar_style = document.styleSheets[2].cssRules[i];
            break;
          }
        }
        symbolcommnet_scrollbar_style.style.width = "15px";
        symbolcommnet_scrollbar_style.style.height = "15px";
      }

      if (g_scroll_chg_flg == FLG_OFF) { // using iPendant or opboard screen
        document.getElementById('scroll').width = 45;
        document.getElementById('scroll_h').height = 45;
      } else {
        document.getElementById('scroll').width = 9;
        document.getElementById('scroll_h').height = 9;
      }
      document.getElementById('scroll').style.right = "0px";
      document.getElementById('scroll_h').style.bottom = "73px";

      document.getElementById("screen_running").style.display="none";
      document.getElementById("popup_no_comfirm_9").style.display="block";
      document.getElementById("popcomment_9_1").style.display="block";
      document.getElementById("popcomment_9_2").style.display="none";
      document.getElementById("popcomment_9_3").style.display="none";
      document.getElementById("popcomment_9_4").style.display="none";
      document.getElementById("popbutton_close_9").style.display="none";
      DEBUG_PAGE_SW = 0;  // now not read ladder_debug_page.js
      // pmc debug page interface file check - start
      var debug_req = new XMLHttpRequest();
      debug_req.open("GET", "/td:\\pmc_debug.txt", true);
      debug_req.onreadystatechange = function () {
        if (debug_req.readyState === 4 && debug_req.status === 200) {
          DEBUG_PAGE_SW = 1;
          ladder_debug_init();
        }
      };
      debug_req.send();
      get_pmc_data_from_server(PMC_DATA_LOAD_KIND.START_UP);
      
      var resource = [];
      resource = JSON.parse(JSON.stringify(pmc_lang_table));
      pmc_lang_keys.forEach( function(value) {
        var page = value;
        Object.keys(resource[page]).forEach(function(value) {
          var target = document.getElementById(value);
          target.innerHTML = this[value];
        }, resource[page]);
      });

      document.getElementById("iSelect2").setCallback(ladder_search_callback);
      document.getElementById("iSelect2").refresh([], 0, null, false, "header changed");
      search_kind = "0";
      document.getElementById("treeEditMenu").setSelectCallback(ladder_tree_edit_callback);
      document.getElementById("treeMenu").setSelectCallback(ladder_tree_callback);
      KeyEvent.attachHandlers(window);
      
      elem_fnccomment_close = document.getElementById("fnccomment_close").innerHTML;
      
      //all_size_position_change
      display_change_size_position();

      document.onselectstart = function() {
        return false;
      }
    }
    var timer = 0;
    window.onresize = function(){
      if(timer > 0){
        clearTimeout(timer);
      }
      timer = setTimeout(function(){
        //all_size_position_change
        display_change_size_position();
        //DropDownListPosition
        drop_down_list_position();
        //fnccomment_close_dispposition
        funccomment_change_position();
        //Can not click Popup
        click_disabled();
        //draw_ladder_disp
        ladder_diagram_redraw();
      }, 200);
    };
  </script>

</body>
</html>

<!--[comment]>
                                 world {  z-index: 1; position: absolute; top: 0; left: 0; }
div#glid { position: absolute; top: 570px; left: 0; }

/* title bar */
.headert, .headert_net_view_area, .headert_result_count_area, .headert_result_list_count_area, .headert_replace_count_area {
  background: #3a3a3b;                   /* background color */
  border-left: 1px solid black;
  border-top: 4px solid black;
  border-bottom: 1px solid black;
  color: #ffffff;                        /* text color */
  font-size: large;
  font-family: "Meiryo UI", sans-serif;
  height: 35px;                          /* height of the title bar : 33pix */
  margin: 2px;
  padding: 0px;
  width: 100%;                         /* width of the title bar : 1016pix */
  position: fixed;
  top: -2px;
  left: -2px;
}

.headert_net_view_area, .headert_result_count_area, .headert_result_list_count_area, .headert_replace_count_area{
  left: 70%;
  width: 40%;
  border-left: 0;
}

/* the runnning screen display */
#screen_running{
  position:absolute;
  left:250px;
  top:120px; 
  font-size:40px;
  width: 550px;
}

/* setting windows use such as the search screen and background setting */
.box1 {
  background: #FFFFFF;        /* background color(white) */
  text-indent: 1em;           /* indent of the text*/
}

/* the text box of the search screen and common style */
.input.textstile {
  position: absolute;
  width: 200px;
  left:  300px;
}
.select.textstile {
  position: absolute;
  width: 205px;
  left:  300px;
}
/* popup */
[id^="popup_no_comfirm"]{
  font-family: "Meiryo UI", sans-serif;
  display:none;
  position: absolute;
  top:100px;
  width:575px;
  height:400px;
  height:300px;
  background-color: #e1e7ec;  /* background color */
  border-left:  4px solid black;
  border-right: 4px solid black;
  border-top:   4px solid black;
  border-bottom:4px solid black;
  z-index: 50;
}
#popup_no_comfirm_0{
  display: block;
}
/* popup dialog */
textarea{
  readonly;
  resize: none;
  border:0px;
  padding: 10px;
  font-size: 16px;
  margin-bottom: 15px;
  background-color: #3a3a3b;  /* background color */
}
/* upper part bar of the popup */
#poptitle,[id^="poptitle_info"]{
  font-family: "Meiryo UI", sans-serif;
  readonly;
  background-color: #3a3a3b;  /* background color */
  color: #ffffff;             /* text color */
  text-align: center;
  vertical-align: middle;
  font-size: large;           /* character size */
  position: absolute;
  top:0px;
  left:0px;
  width:547px;
  height:55px;
  border-top:   4px solid #106d74;
  border-left:  4px solid #106d74;
  border-right: 4px solid #106d74;
}
[id^="poptitle_info"]:disabled{
  color: #ffffff;  /* text color */
  opacity: 1;
}
/* letter to display inside of the popup */
[id^="popcomment"]{
  font-family: "Meiryo UI", sans-serif;
  color: #000000;             /* text color */
  text-align: center;
  line-height: 150px;
  font-weight: bold;
  vertical-align: middle;
  readonly;
  background-color: #e1e7ec;  /* background color */
  position: absolute;
  top:53px;
  left:0px;
  width:527px;
  height:203px;
  border-left:  4px solid #106d74;
  border-right: 4px solid #106d74;
  border-bottom:4px solid #106d74;
  padding: 20px;
}
[id^="popcomment"]:disabled{
  color: #000000;  /* text color */
  opacity: 1;
}

#popcomment_4_4{
  top: 100px;
}

#popcomment_0_1{
  line-height: 45px;
}

#popcomment_9_3{
  line-height: 100px;
  font-size: 15px;
}

#popcomment_9_4{
  line-height: 200px;
  background-color: transparent;  /* background color */
  border-left: none;
  border-right: none;
  border-bottom: none;
  z-index: 100;
  top: 80px;
  left: 120px;
  padding: 0px;
  width: 340px;
}

/* element infomation domain setting of the popup*/
[id^="poptitle_address"]{
  font-family: "Meiryo UI", sans-serif;
  color: #000000;             /* text color */
  font-weight: bold;
  font-size: 18px;
  vertical-align: middle;
  readonly;
  background-color: #e1e7ec;  /* background color */
  position: absolute;
  top:53px;
  left:0px;
  width:527px;
  height:203px;
  border-left:  4px solid #106d74;
  border-right: 4px solid #106d74;
  border-bottom:4px solid #106d74;
  padding: 20px;
  line-height: 50px;
}
[id^="poptitle_symbol"],[id^="poptitle_comment"]{
  font-family: "Meiryo UI", sans-serif;
  color: #000000;             /* text color */
  background-color: #e1e7ec;  /* background color */
  font-weight: bold;
  font-size: 18px;
  position: absolute;
  top:145px;
  right:675px;
  width:150px;
  border-radius: 3px;
  padding: 0;
}
[id^="poptitle_symbol"]{
  top:145px;
  right: 400px;
}
[id^="poptitle_comment"]{
  top:200px;
  right: 400px;
}
[id^="pop_address"],[id^="pop_symbol"],[id^="pop_comment"]{
  font-family: "Meiryo UI", sans-serif;
  color: #191919;             /* text color */
  background-color: #e1e7ec;  /* background color */
  font-weight: bold;
  font-size: 18px;
  position: absolute;
  right:10px;
  width:390px;
  border-radius: 3px;
  padding: 0;
}
[id^="pop_address"]{
  top: 85px;
}
[id^="pop_symbol"]{
  top: 145px;
  right: 75px;
  width: 325px;
}
[id^="pop_comment"]{
  top: 200px;
  right: 65px;
  width: 325px;
  height: 50px;
  padding-right: 10px;
}

#cnt_popcomment_7_1, #cnt_popcomment_11_4, #msg_popcomment_7_1, #msg_popcomment_7_2, #msg_popcomment_11_4_1, #msg_popcomment_11_4_2{
  font-family: "Meiryo UI", sans-serif;
  color: #000000;             /* text color */
  background-color: #e1e7ec;  /* background color */
  font-weight: bold;
  font-size: 18px;
  position: absolute;
  right:340px;
  border-radius: 3px;
  padding: 0;
  top: 158px;
  z-index: 3
}
#msg_popcomment_7_1, #msg_popcomment_7_2, #msg_popcomment_11_4_1, #msg_popcomment_11_4_2{
  right:75px;
  width:250px;
}
[id^="err_popcomment"]{
  font-family: "Meiryo UI", sans-serif;
  color: #000000;             /* text color */
  background-color: #e1e7ec;  /* background color */
  font-weight: bold;
  font-size: 16px;
  position: absolute;
  right:20px;
  width:380px;
  border-radius: 3px;
  padding: 0;
  top: 130px;
}

#err_popcomment_6_1{
  left: 220px;
  width: 300px;
}
#err_popcomment_6_2{
  left: 183px;
  width: 300px;
}
#err_popcomment_6_3{
  left: 237px;
  width: 300px;
}
#err_popcomment_6_4{
  left: 210px;
  width: 300px;
}


/* close(X) button of the popup window */
[id^="popbutton_close"]{
  color: #ffffff;             /* text color */
  border:0px;
  background-color: #ea6000;  /* background color */
  position: absolute;
  top:15px;
  right:10px;
  width:25px;
  height:25px;
  border-radius: 3px;
  text-align: center;
  vertical-align: middle;
  font-size: 25px;           /* character size */
  font-weight: 700;          /* thickness of the letter */
  padding: 0;
  overflow: visible;         /* protrude and display */
  z-index: 1;
}
#fnccomment_close,#fnccomment_close_UpdateMsg{
  font-family: "Meiryo UI", sans-serif;
  color: #FFFFFF;             /* text color */
  font-size: 14px;
  text-align: start;
  line-height: 20px;
  vertical-align: middle;
  readonly;
  background-color: #106d74;  /* background color */
  position: absolute;
  top:40px;
  left:0px;
  width:100px;
  height:30px;
  resize: none;
  overflow:hidden;
  text-decoration: none;
  padding: 0px;
}


/* button of the popup for Ladder Tree Edit Screen */
/*** after ladder update, OK button ***/
#popbutton1,#popbutton_13 {
  color: #000000;             /* text color */
  background-color: #ffffff;  /* background color */
  position: absolute;
  top:200px;
  right:220px;
  width:125px;
  height:45px;
  border-radius: 3px;
  text-align: center;
  vertical-align: middle;
  font-size: 18px;           /* character size */
  padding: 0;
  overflow: visible;         /* protrude and display */
  display:none;
}

/*** editing destruction, OK button ***/
#popbutton2, #popbutton6_2, #popbutton6_4,#popbutton_11_1,#popbutton_0_1,#popbutton12,#popbutton14{
  color: #000000;             /* text color */
  background-color: #ffffff;  /* background color */
  position: absolute;
  top:220px;
  right:300px;
  width:125px;
  height:45px;
  border-radius: 3px;
  text-align: center;
  vertical-align: middle;
  font-size: 18px;           /* character size */
  padding: 0;
  overflow: visible;         /* protrude and display */
  display:none;
}

/*** editing destruction, Cancel button ***/
#popbutton3, #popbutton6_3, #popbutton6_5,#popbutton_11_2,#popbutton_0_2,#popbutton13,#popbutton15{
  color: #000000;             /* text color */
  background-color: #ffffff;  /* background color */
  position: absolute;
  top:220px;
  right:120px;
  width:125px;
  height:45px;
  border-radius: 3px;
  text-align: center;
  vertical-align: middle;
  font-size: 18px;           /* character size */
  padding: 0;
  overflow: visible;         /* protrude and display */
  display:none;
}

#popbutton_0_1,#popbutton_0_2, #popbutton_13{
  display:block;
}

/*** error of the ladder net edit, OK button ***/
#popbutton6_1{
  color: #000000;             /* text color */
  background-color: #ffffff;  /* background color */
  position: absolute;
  top:200px;
  right:220px;
  width:125px;
  height:45px;
  border-radius: 3px;
  text-align: center;
  vertical-align: middle;
  font-size: 18px;           /* character size */
  padding: 0;
  overflow: visible;         /* protrude and display */
  display:none;
}
#popbutton6_4, #popbutton6_5 {
  display: block;
  top: 70%;
}
/*** editing destruction, contact search button ***/
.popbutton_contact, .popbutton_coil, .popbutton_edit{
  color: #000000;             /* text color */
  background-color: #ffffff;  /* background color */
  position: absolute;
  top:75px;
  right:160px;
  width:125px;
  height:45px;
  border-radius: 3px;
  text-align: center;
  vertical-align: middle;
  font-size: 18px;           /* character size */
  padding: 0;
  overflow: visible;         /* protrude and display */
  display:none;
}

.popbutton_contact:focus, .popbutton_coil:focus, .popbutton_edit:focus{
  outline: none;
}

/*** editing destruction, coil search button ***/
.popbutton_coil{
  right:15px;
}

/*** editing destruction, edit button ***/
.popbutton_edit{
  top:240px;
  left:20px;
}

/*** editing destruction, contact search button ***/
.popbutton_run{
  color: #000000;             /* text color */
  background-color: #ffffff;  /* background color */
  position: absolute;
  top:193px;
  right:100px;
  width:125px;
  height:45px;
  border-radius: 3px;
  text-align: center;
  vertical-align: middle;
  font-size: 18px;           /* character size */
  padding: 0;
  overflow: visible;         /* protrude and display */
  display:none;
}

.srch_pop_all_category, .srch_pop_category, .srch_pop_error, .srch_result_list_pop_error_{
  font-family: "Meiryo UI", sans-serif;
  color: #000000;             /* text color */
  background-color: transparent;
  text-align: center;
  line-height: 0px;
  font-weight: bold;
  vertical-align: middle;
  position: absolute;
  top:205px;
  left: 45px;
  width: 290px;
  display:none;
}

.srch_pop_error{
  left: 135px;
  line-height: 163px;
  font-weight: bold;
  vertical-align: middle;
  background-color: #e1e7ec;  /* background color */
  top:53px;
  left:0px;
  width:527px;
  height:203px;
  border-left:  4px solid #106d74;
  border-right: 4px solid #106d74;
  border-bottom:4px solid #106d74;
  padding: 20px;
  z-index: 0;
}

.srch_result_list_pop_error_{
  position: absolute;
  top:200px;
  left:70px;
  width: 420px;
  z-index: 1;
}

.srch_pop_category{
  top:90px;
  left: 75px;
  width: 440px;
  z-index: 1;
}

.textarea:focus{
    outline: none;
}
/* style for function button */
/* 20180828 revise button size for a resolution change */
.func_btn {
  display: inline-block;
  position: relative;
  text-decoration: none;
  left:7px;                   /* the button top right corner coordinate(pexis) */
  top:7px;
  color: #ffffff;             /* text color */
  text-align: center;
  vertical-align: middle;
  font-size: 14px;
  height: 60px;               /* height size of the function button */
  line-height: 60px;          /* letter position in the button */
  overflow: hidden;
  background-color: #393839;  /* background color */
  letter-spacing: normal;
  white-space: normal;
}

#func_btn_0_home,#func_btn_0_1,
#func_btn_0_2,#func_btn_0_3,
#func_btn_0_4,#func_btn_0_5,
#func_btn_0_6,#func_btn_0_next{
  background-color: rgb(16, 109, 116);  /* background color */
  z-index: 50;
}

#func_btn_5_next,#func_btn_5_next_2{
  font-size: 30px;
}

#func_btn_5_4,#func_btn_6_4{
  font-size: 13px;
}

/* PMC read error */
[id^="ladder_error_pmc_read_area"]{
  vertical-align: middle;
  text-align: center;
  font-size: 25px;   /* character size */
  font-weight: 700;  /* thickness of the letter */
}

/* function button */
.function_button{
  background-color: #000000;
  width: 100%;   /* width of the title bar : 1016pix */
  height: 73px;  /* height of the title bar : 73pix */
  position: fixed;
  bottom: 0px;
  z-index: 50;
  white-space: nowrap;
}
/* function button */
.function_button2{
  background-color: #000000;
  width: 100%;   /* width of the title bar : 1016pix */
  height: 73px;  /* height of the title bar : 73pix */
  position: fixed;
  bottom: 0px;
  z-index: 50;
  white-space: nowrap;
}
.draw_area, #worldDiv{
  width: 100%;
  height: 100%;
  margin: 0px;
  padding: 0px;
  border: 0px;
}
#worldDiv{
  top: 40px;
  position: fixed;
  overflow: hidden;
  z-index: 2;
  display: none;
}

[id^="scroll"]{
  display: inline-block;
  position: fixed; right: 0px;
  z-index: 2;
}

[id^="scroll_h"]{
  position: fixed;
  bottom: 73px; 
  left: 0px;
}
#canvas_area {
position: fixed;
}

/* canvas for button */
.net_edit_button {
  visibility: hidden;
  background-color: #97a1ab;
  display: inline-block;
  position: absolute; 
  bottom: 135px;
  height: 80px;
  width: 80px;
  max-height: 80px;
  max-width: 80px;
}
[id^="a_contact"]{
  left: -13px;
}

[id^="b_contact"]{
  left: -9px;
}

[id^="coil"]{
  left: -5px;
}

[id^="not_coil"]{
  left: -1px;
}

[id^="horizontal_line"]{
  left: 3px;
}

[id^="vertical_line"]{
  left: 7px;
}

[id^="set_coil"]{
  left: 11px;
}

[id^="reset_coil"]{
  left: 15px;
}

[id^="undo"]{
  left: -40px;
}

[id^="redo"]{
  left: -35px;
}

[id^="reset_button"]{
  left: 81px;
}


/****************************************/
/* setting of the style for each screen */
/****************************************/

.screen_update_pmc_data {
  position: absolute;
  display:none;
  width: 100%;
  height: 100%;
  background-color: transparent;
  z-index: 100;
}
/* Ladder Tree Edit Screen */
.screen_ladder_tree_edit {
  position: absolute;
  display:none;
  width: 100%;
}

/* Ladder Display Screen */
.screen_ladder_display {
  position: absolute;
  display:none;
  overflow: hidden;
  width: 100%;
}

/* Ladder Search Screen */
.screen_ladder_search {
  position: absolute;
  display:none;
  width: 100%;
}

/* Ladder Search Result Screen */
.screen_ladder_search_result {
  position: absolute;
  display:none;
  overflow: hidden;
  width: 100%;
}

/* Ladder Search Result List Screen */
.screen_ladder_search_result_list {
  position: absolute;
  display:none;
  overflow: hidden;
  width: 100%;
}

/* Ladder Editor Screen */
.screen_ladder_editor {
  position: absolute;
  display:none;
  overflow: hidden;
  width: 100%;
}

/* Ladder Net Edit Screen */
.screen_ladder_netedit {
  position: absolute;
  display:none;
  overflow: hidden;
  width: 100%;
}

/* Ladder Replace Screen */
.screen_ladder_replace {
  position: absolute;
  display:none;
  width: 100%;
}

/* Ladder Element Editor Screen */
.screen_ladder_element_editor {
  position: fixed;
  display:none;
  width: 100%;
}

/* Ladder Tree Screen */
.screen_ladder_tree {
  position: absolute;
  display:none;
  width: 100%;
}

/* Ladder Search Replace Screen */
.screen_ladder_search_replace {
  position: absolute;
  display:none;
  overflow: hidden;
  width: 100%;
}

/* Symbol Comment Editor Screen */
.screen_symbol_comment_editor {
  position: absolute;
  display:none;
  width: 100%;
}

/* DebugPage */
.screen_ladder_debug_page_log,
.screen_ladder_debug_page_if_test {
  width: 100%;
  height: 100%;
  position: fixed;
  top: 30px;
  background: #FFFFFF;        /* background color(white) */
  display:none;
}

/* PMC Read Error Screen */
.screen_ladder_error_pmc_read {
  position: absolute;
  display:none;
  width: 100%;
}

/* popup menu of the function button */
[id^="func_menu"] {
  display:none;
  width:220px;
  height:0px;
}

#func_menu_6_4, #func_menu_6_4_subroutine {
  width:220px;
}

/* list of popup menus of the function button */
.PopUpMenu {
  width: 220px;
  bottom: 75px;
  readonly;
  background-color: #e1e7ec;  /* background color */
  color: #000000;             /* text color */
  font-size: large;           /* character size */
  position: absolute;
  padding: 0;
  border-top:   2px solid #222222;
  border-left:  2px solid #222222;
  border-right: 2px solid #222222;
  margin: 0px;
  border-bottom:1px solid #222222;
  list-style-type: none!important;
  cursor: pointer;
  text-decoration: none;
  background-color: #0e90b8;
  z-index:3;
}
.PopUpMenu>li>a {
  display: block;
  white-space: nowrap;
  text-decoration: none;
  text-align: left;
  padding: 0 2px;
  color: #000000;
}
.PopUpMenu>li {
  margin: 0px;
  padding: 0.5em 0;
  border-bottom:1px solid #222222;
  list-style-type: none!important;
}
.PopUpMenu>li:first-of-type {
  background-color: #000000;  /* background color */
  color: #ffffff;             /* text color */
  text-align: center;
}
#eleMenu_6{
  z-index: 50;
}
#eleMenu_6_subroutine{
  z-index: 50;
}

/************************/
/* Ladder Search Screen */
/************************/
#ladder_main_window {
  width: 100%;
  height: 100%;
  background-color: #e1e7ec;
  padding-top: 1px;
  top: 33px;
  position: fixed;
}

#search_category_2_1{
  width: 280px;
  position: relative;
  left: 140px;
}
#search_category_2_2{
  width: 280px;
  position: relative;
  left: 140px;
}
  
#search_category_3_1{
  width: 280px;
  position: relative;
  left: 140px;
}
  
#search_category_3_2{
  width: 280px;
  position: relative;
  left: 140px;
}
  
#search_category_3_3{
  width: 280px;
  position: relative;
  left: 138px;
}
  
#search_category_3_4{
  width: 336px;
  position: relative;
  left: 110px;
}

#search_category_3_5{
  width: 290px;
  position: relative;
  left: 133px;
}
  
#search_category_3_6{
  width: 435px;
  position: relative;
  left: 59px;
}
  
#search_category_3_7{
  width: 435px;
  position: relative;
  left: 60px;
}

#search_category_4_6{
  width: 340px;
  position: relative;
  left: 100px;
}

#search_category_4_1{
  width: 280px;
  position: relative;
  left: 140px;
}
#search_category_4_2{
  width: 280px;
  position: relative;
  left: 140px;
}
#search_category_4_5{
  width: 290px;
  position: relative;
  left: 133px;
}
  

#checkbox2{
  position: relative;
  top: -5px;
}

#checkbox3{
  position: relative;
  top: -5px;
}

#checkbox3{
  position: relative;
  top: -5px;
}

#id_search_category{
  width: 180px;
}

#id_search_contact{
  position: relative;
  left: 70px;
  width: 77px;
}

#id_search_coil{
  position: relative;
  left: 165px;
  width: 60px;
}

#id_search_subroutine{
  position: relative;
  left: 45px;
  top: 70px;
}

#id_match_search_type{
  width: 180px;
  position: relative;
}

#id_partial_match{
  position: relative;
  left: 70px;
  width: 140px;
}

#id_perfect_match{
  position: relative;
  left: -100px;
  top: 50px;
  width: 140px;
}

.search_kind_area,
.replace_before_area,
.elem_edit_top_area {
  margin-top: 15px;
}

.search_string_area,
.replace_after_area,
.elem_edit_area,
.address_string_area {
  margin-top: 15px;
}

.text_static_ladder_search,
.text_static_ladder_replace,
.text_static_elem_edit,
.text_static_symbol_comment {
  font-weight: bold;
  padding-left: 0px;
}

.text_static_elem {
  font-weight: bold;
}

.text_ladder_search,
.text_ladder_replace,
.text_elem_edit,
.text_symbol_comment {
  font-family: "Meiryo UI", sans-serif;
  font-size: 19px;
}
.text_ladder_search,
.text_ladder_replace,
.text_elem_edit {
  width: calc(100% - 350px) !important;
}

.partial_radio{
  position: relative;
  right: 518px;
  top: 15px;
  width: 37px;
  height: 33px;
  outline: none;
}

.perfect_radio{
  position: relative;
  right: 535px;
  top: 5px;
  width: 37px;
  height: 33px;
  outline: none;
}

/* Google Chrome, Safari, Opera 15+, Android, iOS */
::-webkit-input-placeholder {
  color: #696969; 
}

/*************************/
/* PMC read error screen */
/*************************/
#ladder_error_pmc_read_area{
  background-color: #e1e7ec;
  width: 100%;
  height: 100%;
  margin: 0px;
  padding: 0px;
  border: 0px;
  position: fixed;
  margin-top: 40px;
}

.ladder_debug_log_area {
  background-color: #ffffff;
  width: 99%;
  height: 100%;
}

.ladder_debug_pmc_data_textarea {
  background-color: #ffffff;
  width: 100%;
  height: 185px;
}

#id_replace_comment{
  background-color: #e1e7ec;
  width: 90%;
  height: 300px;
  padding-left: 35px;
  padding-top: 30px;
}
#id_search_level, #id_replace_level{
  font-weight: bold;
  font-size: 18px;
  background-color: #e1e7ec;
  width: 200px;
  height: 40px;
  margin-top: 10px;
  position: absolute;
  left: 300px;
}

#id_net_editor_comment1{
  display: none;
  position: absolute;
  background-color: transparent;
  width: 460px;
  height: 50px;
  left: 45px;
  bottom: 210px;
  line-height: 20px;
}

/********************************/
/* Symbol Comment editor Screen */
/********************************/
#symbol_comment_table{
  font-family: "Meiryo UI", sans-serif;
  color: #000000;             /* text color */
  text-align: center;
  font-size: 16px;
  font-weight: bold;
  vertical-align: middle;
  background-color: #e1e7ec;  /* background color */
  position: absolute;
}
#symbol_comment_table::-webkit-scrollbar{
  height: 5px;
  width: 5px;
}
 #symbol_comment_table::-webkit-scrollbar-thumb {
  background: #999;
 }
 table, td, th { 
  table-layout: auto;
  border: 1px #808080 solid; 
}

table, th { 
  position: sticky;
  z-index: 1;
}
table tr td:nth-of-type(1){
  padding-left: 5px;
  padding-right: 5px;
}
#table_text{
  font-family: "Meiryo UI", sans-serif;
  color: #000000;             /* text color */
  background-color: #FFFFFF;
  text-align: left;
  font-size: 16px;
  font-weight: bold;
  border:0px;
  padding: 5px;
  height:25px;
  margin-top: 2px;
  margin-bottom: -2px;
  overflow: hidden;
}

#poptitle_row_12, #poptitle_column_12, #pop_row_12, #pop_column_12{
  font-family: "Meiryo UI", sans-serif;
  color: #000000;             /* text color */
  background-color: #e1e7ec;  /* background color */
  font-weight: bold;
  font-size: 18px;
  position: absolute;
  top: 60%;
  left: 25%;
  width:180px;
  height:30px;
  border-radius: 3px;
  padding: 0;
}

#poptitle_row_12, #poptitle_column_12{
  width:95px;
  text-align: right;
}

#poptitle_column_12, #pop_column_12{
  top: 70%;
}

#pop_row_12, #pop_column_12{
  left: 50%;
}

.sym_com_edit_button {
  visibility: hidden;
  background-color: #97a1ab;
/*  display: flex;*/
/*  flex-wrap:wrap;*/
  position: absolute;
  z-index: 50;
  top: 490px;
  left: 55%;
  height: 50px;
  width: 25%;
  min-width: 300px;
  list-style: none;
  margin: 0px;
}
.sym_com_edit_button li {
  width: calc(100%/5);
  padding:0 10px;
  box-sizing:border-box;
}
.sym_com_edit_button li img {
  max-width: 50px;
  height: auto;
  outline: none;
}
#prev_addr {
  position: absolute;
  top: 0px;
  left: 110px;
}
#next_addr {
  position: absolute;
  top: 0px;
  left: 200px;
}
#further_next_addr {
  position: absolute;
  top: 0px;
  left: 270px;
}

#stopwatch_1,#stopwatch_2, #stopwatch_3, #stopwatch_4, #stopwatch_5, #stopwatch_6 {
  font-weight: bold;
  font-size: 18px;
  text-align: center;
  position: fixed;
  z-index: 2;
  display: none;
}

[id^="param_text_area"] {
  background-color: transparent;
  width: 100%;
  left: 5%;
  height: 80px !important;
  line-height: 50px !important;
}
#param_text_area1 {
  top: 40px;
}
#param_text_area2 {
  top: 20px;
}
#sub_edit_info {
  width: 100%;
  text-align: center;
  font-family: "Meiryo UI", sans-serif;
  color: #FFFFFF;
  background-color: transparent;
  font-weight: bold;
  font-size: 14pt;
  position: relative;
  padding-bottom: 20px;
  padding-top: 15px;
  left: 220px;
  top: 15px;
}
[id^="intbox.inbox.param"] {
  color: rgb(0,0,0);
  width: 50%;
  left: 35% !important;
  height: 40px !important;
  font-family: "Meiryo UI", sans-serif;
  font-size: 14pt;
}
[id^="err_comment_param"] {
  width: 50%;
  height: 20px;
  left: 40%;
  font-family: "Meiryo UI", sans-serif;
  color: red;
  background-color: transparent;
  font-weight: bold;
  font-size: 12pt;
  position: relative;
  padding-bottom: 10px;
  top: -7%;
}
.wrapp {
/*  display: flex;*/
  flex-direction: column;
  justify-content: center;
  align-items: flex-start;
  width: 100%;
  height: 100%;
}
.select_list_width {
  width: calc(100% - 406px) !important;
}                                                                                                                                                                                                             html, body {
  *height: 100%;
  width: 100%;
}

body {
  font-family: "Meiryo UI", sans-serif;
  font-size: 14pt;
  margin: 0;
  background-color: #e1e7ec;
  background-color: #FFFFFF;  /* a body part is a white background */
}

.hide {
  display: none !important;
}

/* select & selectOptions */
.select {
  display: inline-block;
  height: 54px;
}

.hide .select {
  display: none;
}

/* > cannot be used because it does not work on old IE version which is used in result page */
.select div {
  position: absolute;
  left: 304px;
/*  width: 30%;*/
  width: 54%;
  display: inline-block;
  float: left;
  background-color: white;
  color: black;
  border: 1px solid #97a1ae;
  padding: 0px 63px 0px 2px;
  height: 54px;
  line-height: 54px;
  min-width: 10px;
  margin: 0px 0px 0 0;
  cursor: default;
  z-index: 0;
  white-space: nowrap;
}

.select-disabled div {
  border-color: #97a1ae;
  color: #67727e;
}

.select.focus div {
  border: 1px solid #6fc7d5;
}

.select.select-with-icon div {
  padding-left: 0px;
}

.select-label {
  display: inline-block;
  width: 100%;
  text-overflow: ellipsis;
}

.select.disabled .select-label {
  color: #67727e;
}

.select-fixed-width,
.select.select-visdata div .select-label {
  *overflow: hidden;
}

.select.select-visdata div {
  width: 256px;
}

.select-button {
  position: absolute;
  top: 0;
  right: 0;
  background-color: #67727e;
  border-style: none;
  cursor: pointer;
  height: 50px;
  margin: 2px;
  width: 50px;
}

.select-button:focus {
  outline: none;
}

.select-btn:focus {
  outline: none;
}

.select-button > .select-arrow {
  border-top: 22px solid #ffffff;
  border-right: 12px solid transparent;
  border-bottom: 12px solid transparent;
  border-left: 12px solid transparent;
  display: inline-block;
  height: 0;
  margin-top: 10px;
  margin-left: 2px;
  vertical-align: middle;
  width: 0;
}

.select-button.disabled {
  /* filter: alpha(opacity=30); */
  /* -moz-opacity: 0.3; */
  /* opacity: 0.3; */
  background-color: #c7ced7;
}

.select-button.disabled > .select-arrow {
  border-top: 22px solid #67727e;
}

.select.opened .select-button {
  background-color: #0e6eb8;
}

.select-options {
  position: absolute;
  width: 100%;
  left: -1px;
  right: -1px;
  margin: 0;
  border: 2px solid #a0a0a0;
  border-bottom-width: 1px;
  z-index: 50;
  background-color: #ffffff;
  list-style-type: none;
  padding-left: 0;
  min-width: 98%;
}

.select-options.scrolling {
  overflow-y: auto;
  overflow-x: hidden;
}

.select-options-pullup {
  top: auto;
  bottom: 58px;
}

.select-option {
  border-bottom: 1px solid #a0a0a0;
  cursor: pointer;
}

.select-option-highlight {
  background-color: #0e6eb8;
}

.select-option a {
  display: block;
  height: 58px;
  line-height: 58px;
  min-width: 100%;
  white-space: nowrap;
  text-decoration: none;
  text-align: left;
  padding: 0 2px;
  color: #000000;
}

.select-option-highlight a {
  color: white;
}

.select.select-with-icon .select-option a {
  height: 58px;
  line-height: 58px;
}

.select-icon,
.select-option-icon {
  border-style: none;
  background-color: #67727e;
  margin-right: 5px;
}

.select-icon {
  display: none;
}

.select.select-with-icon .select-icon {
  display: inline;
  margin-left: 2px;
}

.invalid,
.invalid a {
  color: #b31e23 !important;
  /* cannot use inherit on IE */
}

.select .select-option.invalid {
  display: none;
}

.select .select-option.invalid.select-option-selected {
  display: block;
}

.selectable-invalid,
.selectable-invalid a {
  color: #b31e23;
}

.select-grid {
  display: flex;
  align-items: center;
}

/* Message Box */
#message_box_pmc_comment {
  line-height: 30px;
  margin-top: 15px;
  position: fixed;
  left: 305px;
  width: 50%;
}

#elem_edit_pmc_comment {
  display: inline-block;
  word-wrap: break-word;
  overflow: auto;
  height: 350px;
  width: 100%;

}

#elem_edit_pmc_symbol {
  display: inline-block;
  word-wrap: break-word;
  overflow: auto;
  height: 70px;
  width: 50%;
  line-height: 30px;
  position: fixed;
  top: 140px;
}

.message-box {
  background-color: #e1e7ec;
  color: #000000;
  height: 54px;
  line-height: 54px;
}

.message-box.message-box-inbox {
  position: relative;
  height: 60px;
  line-height: 60px;
}

.message-box.message-box-inbox .checkbox {
  position: relative;
  top: 3px;
  *top: 0px;
  *left: 3px;
  width: 100%
}

.message-box > span {
  vertical-align: middle;
}

.message-box-contents-left {
  float: left;
  margin-left: 30px;
}

.message-box-contents-right {
  float: right;
  clear: right;
  margin-right: 30px;
}

.contact-box-contents-right {
  float: right;
  clear: right;
  margin-right: 30px;
  position: relative;
  left: 100px;
}

.coil-box-contents-right {
  float: right;
  margin-right: 30px;
  position: relative;
  left: 380px;
}

.subroutine-box-contents-right {
  float: right;
  margin-right: 30px;
  position: relative;
  left: 464px;
  top: 64px;
}

.partial-match-box-contents-right {
  float: right;
  margin-right: 30px;
  position: relative;
  left: 268px;
}

.perfect-match-box-contents-right {
  float: right;
  margin-right: 30px;
  position: relative;
  left: 352px;
  top: 60px;
}

.message-box-contents-right > span.textbox {
  display: inline;
}

/* Text Box */
input.textbox {
  height: 50px;
  line-height: 50px;
  border: solid 1px #97a1ae;
}

input.textbox:hover {
  border-color: #97a1ae;
}

span.textbox {
  font-size: 0;
}

span.textbox {
  display: flex;
  align-items: center;
}

span.textbox > input {
  height: 50px;
  line-height: 50px;
  border: solid 1px #97a1ae;
  *vertical-align: middle;
  position: absolute;
  top: 0px;
  left: 305px;
/*  width: 38%;*/
  width: 60%;
}

span.textbox > label {
  *vertical-align: middle;
  margin-left: 4px;
}

span.textbox > span {
  *vertical-align: middle;
  margin-left: 14px;
}

.textbox > input:hover {
  border-color: #97a1ae;
}

input.textbox.focus {
  border-color: #6fc7d5;
}

input.textbox:focus {
  outline: none;
  border-color: #6fc7d5;
}

.textbox > input.focus {
  border-color: #6fc7d5;
}

.textbox > input:focus {
  outline: none;
  border-color: #6fc7d5;
}

.textbox-no-text {
  background-color: #ffd5ec;
}

legend {
  color: #000000;
}
/* checkbox */
.checkbox {
  display: inline-block;
  width: 54px;
  height: 54px;
  left: -628px;
}

.checkbox > input[type="checkbox"] {
  display: none;
  *display: inline;
  *position: relative;
  *left: -4px;
}

.checkbox > span {
  display: inline-block;
  position: relative;
  *display: none;
  width: 54px;
  height: 54px;
}

.checkbox > span::before {
  display: block;
  position: absolute;
  top: 0px;
  left: 0px;
  width: 52px;
  height: 52px;
  border: solid 1px #97a1ae;
  content: "";
  background-color: #ffffff;
}

.checkbox > span:focus {
  outline: none;
}

.checkbox > span:focus::before {
  border: solid 1px #6fc7d5;
}

.checkbox > input[type="checkbox"]:checked + span::after {
  display: block;
  position: absolute;
  top: 11px;
  left: 8px;
  width: 38px;
  height: 22px;
  border-left: solid 8px #000000;
  border-bottom: solid 8px #000000;
  content: "";
  box-sizing: border-box;
  -webkit-box-sizing: border-box;
  transform: rotate(-45deg);
  -webkit-transform: rotate(-45deg);
  -ms-transform: rotate(-45deg);
}

.checkbox input[type="checkbox"]:disabled + span::before {
  background-color: #c7ced7;
}

.checkbox input[type="checkbox"]:disabled:checked + span::after {
  border-color: #67727e;
}

.checkbox.complex-range-cell,
.checkbox.complex-dofzone-cell {
  margin-top: 4px;
}

.checkbox.complex-vp-measurement-cell {
  float: left;
  margin-right: 15px;
}

.add_scrollbar::-webkit-scrollbar{
  height: 5px;
  width: 5px;
}
.add_scrollbar::-webkit-scrollbar-thumb {
  background: #999;
 }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              /* 2018/07/12 v00001 */
/* treeMenu */
.tree-menu {
  /* overflow: auto; */
  margin: 30px;
  width: auto;
}
/* #treeMenu_scroll::-webkit-scrollbar{
  height: 5px;
  width: 5px;
}
#treeMenu_scroll::-webkit-scrollbar-thumb {
  background: #999;
 }

 #treeEditMenu_scroll::-webkit-scrollbar{
  height: 5px;
  width: 5px;
}
#treeEditMenu_scroll::-webkit-scrollbar-thumb {
  background: #999;
 } */

.tree-menu .tree-menu-open > ul {
  display: block;
}
.tree-menu .tree-menu-closed > ul {
  display: none;
}
.tree-menu ul,
.tree-menu li {
  padding: 0;
  list-style-type: none;
  margin: 0;
  display: block;
}
.tree-menu li {
  line-height: 34px;
  min-height: 34px;
  display: block;
  white-space: nowrap;
  margin-left: 54px;
  margin-bottom: 4px;
}
.tree-menu li:first-child {
  margin-top: 3px;
}
.tree-menu > ul:first-child >  li:first-child {
  margin-top: 0;
}
.tree-menu li.tree-menu-last {
  margin-bottom: 0;
}
.tree-menu > ul > li {
  margin-left: 0;
}
.tree-menu > ul.tree-menu-ancestor-open {
  margin-bottom: 10px;
}
.tree-menu .tree-menu-icon {
  display: inline-block;
  text-decoration: none;
  width: 30px;
  height: 30px;
  vertical-align: middle;
  margin-left: 5px;
  cursor: pointer;
}

.tree-menu .tree-menu-text {
  margin-left: 5px;
}

.tree-menu .tree-menu-node {
/* // margin: 0; */
  margin: 20px 100px 10px 50px;
  margin-right: 3px;
  line-height: 52px;
/* //  height: 52px; */
  height: 45px;
  vertical-align: middle;
  min-width: 160px;
  display: block;
  white-space: nowrap;
  color: white;
  text-decoration: none;
  outline-style: none; /* this style does not work on IE7 */
}
.tree-menu .tree-menu-open > .tree-menu-node,
.tree-menu .tree-menu-closed > .tree-menu-node {
  background-color: #97a1ae;
  border: solid 1px #97a1ae;
}
.tree-menu .tree-menu-leaf > .tree-menu-node {
  background-color: #67727e;
  border: solid 1px #67727e;
}

.tree-menu .tree-menu-leaf > .tree-menu-node.tree-menu-selected {
  background-color: #0e6eb8;
  border-color: #0e6eb8;
  color: white;
}

.tree-menu .tree-menu-leaf > .tree-menu-node.tree-menu-disabled {
  background-color: #e1e7ec;
  color: #808080;
}
.tree-menu .tree-menu-leaf > .tree-menu-node > .tree-menu-arrow {
  display: none;
}
.tree-menu .tree-menu-open > .tree-menu-node > .tree-menu-arrow,
.tree-menu .tree-menu-closed > .tree-menu-node > .tree-menu-arrow {
  display: inline-block;
  vertical-align: middle;
  margin-right: 10px;
  margin-left: 10px;
  width: 0;
  height: 0;
}

.tree-menu .tree-menu-open > .tree-menu-node > .tree-view-btn >.tree-menu-arrow,
.tree-menu .tree-menu-closed > .tree-menu-node > .tree-view-btn >.tree-menu-arrow {
  display: inline-block;
  vertical-align: middle;
  margin-top: -4px;
  *margin-top: 13px;
  margin-left: 13px;
  width: 0;
  height: 0;
}

.tree-menu .tree-menu-closed > .tree-menu-node > .tree-menu-arrow {
  border-top: 9px solid transparent;
  border-right: 0px solid transparent;
  border-bottom: 9px solid transparent;
  border-left: 17px solid white;
}

.tree-menu .tree-menu-closed > .tree-menu-node > .tree-view-btn >.tree-menu-arrow {
  border-top: 13px solid transparent;
  border-right: 0px solid transparent;
  border-bottom: 13px solid transparent;
  border-left: 25px solid white;
}

.tree-menu .tree-menu-open > .tree-menu-node > .tree-menu-arrow {
  border-top: 17px solid white;
  border-right: 9px solid transparent;
  border-bottom: 0px solid transparent;
  border-left: 9px solid transparent;
}

.tree-menu .tree-menu-open > .tree-menu-node > .tree-view-btn >.tree-menu-arrow {
  border-top: 25px solid white;
  border-right: 13px solid transparent;
  border-bottom: 0px solid transparent;
  border-left: 13px solid transparent;
}

li.tree-menu-open > ul {
  display: block;
}
li.tree-menu-closed > ul {
  display: none;
}
.tree-menu-focus {
  border-color: #6fc7d5 !important;
}

.tree-view-btn {
  display: inline-block;
  width: 53px;
  height: 52px;
  z-index: 1;
  border-top: solid 1px #97a1ae;
  border-bottom: solid 1px #97a1ae;
  border-left: solid 1px #97a1ae;
  background-color: #97a1ae;
  float: left;
  cursor: pointer;
  margin-top: -1px;
  margin-left: -1px;
}

.tree-menu-focus > .tree-view-btn {
  border-color: #6fc7d5;
}

.tree-scroll-frame {
  background-color: #e1e7ec;
  overflow: auto;
  width: 100%;
  height:100%;
  position: fixed;
  margin-top: 40px;
}

                                                                                                                                                                                                                                                                             PNG

   IHDR   s   *      gAMA  a   sRGB    PLTEmt899JHHela gonz9::pwda`566344] _ f05` mu
jq_[[e"` !lk;:9ms_nf	a Y lsipEEEa Irpw^_ bW8e`QZZZ{)UjO=?>vg>b;k]Te&)poyiggpo  LIDATXV@'Q3	!{Qoc7#gkvRb9Ox"(aJ	  ` F9Yd;K,S=pipM q+X[ rmr,m%a(VYR`T_lu lFvn)~7M2M[OeI~\	%(ud"Q"y[[OfAezL/CiN]M;XKBfV_+op{FT-J\7    IENDB`                                                                                                                                                                                                                                                                                                                                                                  PNG

   IHDR         7uQ   gAMA  a   sRGB    PLTE` V d \We\ Z ` KR Z \ _ N ] [Vm ulX ^R)5?sbh5h,-G,wlulway{tGlVqw g p:Fc!&Dx   IDAT(0C[8p{e\,}9&yaI"Z.dg#`>)_iu*io	Nvic4u+hH; j-	iND*D]>H%D8Rv?NlBvh Na;t{NIy~U b,< q"b    IENDB`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         PNG

   IHDR   P   P   `   gAMA  a   sRGB    PLTEgr~I   *IDAT(cL8A Hf^_2GV -j    IENDB`                                                                                                                                                                                                                                                                                                                                                                              PNG

   IHDR   P   P      gAMA  a   sRGB    fPLTEcn{_kwep|\gsfq}gr~]htamyWcpit]ivR^kLXg|upz7[  IDATX0T-g8%D>j3 B}g&a;Tc 5(7 M`4M"r
@SB_2t/+0xQLHZ]"+}=
qz#dq<eeJ+ P&To~FX*,`0ZEr0@y*P~|*:?@hh;
$&J^>`sk &`FE7.=e #2QA[
2i]H>A\E.,Y'%,$oR#Pz(@: 8(l\},p	})E(lRt-R|KpQlWF%8->|b%I](<_w!RNavwP4rqDq U (MN{dMrHZ;=@zj	rs,mxIw)ls<i~|gFd$'|_=\3yA$QT}7k\!8+N5^&{uD UC1l9=F
5^'c>+vmEz{AsVR)Q5CFU5J:}auu}m1zk<lM4 B[ IztB nV    IENDB`                         PNG

   IHDR   P   P      gAMA  a   sRGB    PLTEgr~amy_kwep|\gsfq}]htcn{]ivhsVboR^kYerNZiupz~{HUdlv  GIDATXz0 `YN$"B^};=m	m.?m`:1L]k[X6CZcXVC(w^$cJ&o@-qQ:8r~eGwDk  o$Au[xP	|R-HH8&
Zd=?c;P&f	n$-@RY-##*xk@@2x(JS4t@gyxf$""lO[@o<I7Q)ZkERo
81b"%"kh++$$IKru !zT?u9	Sp#k7E	3sZgrfVC%vsWSP`=Ft2jm
fI</[e'zk\tOjGG>R`t f~;H;+<3\$`7N  %`0>KZ8~3z(:mea7alc	LYO8:D@dYS/ NE)C 4%iAste~mSPxV]@ =+`^_2 S9 0["tx#~UN-`AIVkf"Dd3s ql1Q7@h['?s!cEQ*2&    IENDB`                                                                                                                                                                                                                                                                                                                                                                                                                                                                       PNG

   IHDR   P   P      gAMA  a   sRGB    lPLTEVbofq}gr~`kx_jwXdqT`mdo{\gubnz{NZit~mwEQa.x  IDATXn0Cs 'r.w2	.)1=Az'c'4m?dmg )N$RJVv/( C $5j$tv:J?N X sE@ Rc_ :&d; P YY>`V^  u#.AjDg@m
  D}m"`.?EE/)~H^7GSL$!7U ,r=_Vq[oa"  -%s(le{A2u
@yj. $K\6h@Q
<TpP.WFtJVL'@_[Q/.C{=" y 8    IENDB`                                                                                                                                                                                                                                                                                                                                                                                                           BG    8  N E T _ E  8D I T _ 3 .   P N NET_ED~5PNG   eXeX eX{  BG      N E T _ E  D I T _ 4 .   P N NET_ED~6PNG   eXeX eX{  BG    y  N E T _ E  yD I T _ 5 .   P N NET_ED~7PNG   eXeX eX{i  BG    Y  N E T _ E  YD I T _ 6 .   P N NET_ED~8PNG   eXeX eX{  BG      N E T _ E  D I T _ 7 .   P N NET_ED~9PNG   eXeX eX{  BG      PNG

   IHDR   P   P      xPLTEgr~aly`kxdp|_jwfq}bnzlw{oz[gtur|is3  EIDATX0E%q<8t0TMw[Oz<oeeeeeQ}oooEItrS&i=/RXO$z:	. 0%j^s8YQb] 7Kz8VNXk5"S  tfnfl]V+^\Q({ Y<VTT
+; /h($ 9!@h[+:7#Rpl%qIZ?$C;IJx&6e$k{`O(gU4^nG'h^|iS;O=a=Yn2G;NafJt/'dg<7&g~<).?Sn5${l|z; 7= )NKS @p]E YG/3 .BoybPB}yI>EzU]V[~vvnU^PZk=/q* Rx    IENDB`                                                                                                                                                                                                                                                              PNG

   IHDR   P   P      PLTEgr~bnzep|_jwdo{fq}`lx\hucn{T`muXdq{lwq{jt  IDATXW0%!	YZP@V&Q97Tn-X	&L?3$(B ,}( M:p4V3*yOTi+,sN6+'F22t1Vi.8Ff:v~VYHVW:#	7`<!+K ?% !c;1*!* `FxwD"9IKqCyTG{sBg~T.'lW^TI_ rtza#A86Q)d21E FNCIs",M#36J(~xl/2Z:JRI`NR
7N\V*u1 bmY'j\$}[5gN	0_G~Ca[#Op5"4u#Ax.`.SCsu+EP)@ehex;:KKvVCp?'E#0+P)a)>`*#>#WS
E9\6IC9^vPhcKR6`DPm_n(pc?tOaVg3l!|oPruz{W&L0a:"7h    IENDB`                                                                                                  PNG

   IHDR   P   P      TPLTEgr~cn{alyfq}_jw`kx[gtpzw~lv   IDATXK08H{{vTBE0CDDDD$yU{@is K:t|M5YiB[Q[JRb'18k;18oDuL(U?w;4R@iJg4R;5': }4;E)T#"""WO>A>z    IENDB`                                                                                                                                                       PNG

   IHDR   P   P      QPLTEgr~_jwamylvuep}cn{[gtq{yVbo?P  IDATXC@`[H?f2EY(dFU'\*3hr6"0/i0 fZCW$<Y_pKxZl3]#xP6+OG[I-wd63k`DLnIIYr>zd/ v;$GTPATPAPs	ds=d/M,^&V;>c.6V    IENDB`                                                                                           PNG

   IHDR   P   P      gAMA  a   sRGB    PLTEgr~`lxbmz_jwfq}cn{dp|ju3AOYerhs[fs]hunx{q|vUboisR_lN[iKWfERaV\  IDATX[w:sdsMw?<XUi=o<Vd|_$6DC$@V8[tCW$LPVs10^E?IK F b&Mk Qn \EY cmu1}7c (q]}j78 s[? 
|~?e<NAfRVw nF U:,YO$N@3@gpU\)s@|L|f#~~Bi//S e,):P6bJt-M&%./JTvusG7\J8zU7$ mF%a94. *{ ~6A0 xH:p GWT{L:/ LVW  K22PeIgZ, yBRQ^%Wnz|F-i<nGHAR5 j~J~i>_m	(.,j60*#e-Hf;Q|~t-brmo+vgqZwrS`3vM?eo7i &tG<
	p(o y `!_1hK3;gBq5+\4uNL)5e|UZNpd*rZpi-{lw`!Kq6I&S@lNsJTvSG)'JzwlB:MR)EY:ztL_/]N*    IENDB`                                                                                                                                                                                                                                                                                                                                                                                        N E T _ E  D I T _ 8 .   P N NET_E~10PNG   eXeX eX{  BG    e  N E T _ E  eD I T _ 9 .   P N NET_E~11PNG   eXeX eX{e  BN G      S C R O L  L _ D O W N   . P SCROLL~1PNG   eXeX eX{  BN G      S C R O L  L _ L E F T   . P SCROLL~2PNG   eXeX eX{   BP N G      S C R O L  L _ R I G H   T . SCROLL~3PNG   eXeX eX{,   AS C R O L  GL _ U P . P   N G SCROLL~4PNG   eXeX eX{  PNG

   IHDR   P   P      PLTEgr~^jwXdq[gtep|alycn{fq}`kx{bmznys}jtxR^l]  IDATXz8F%$|$,l8!I]>BKUB<SO=Zmg"i&i7ofjwU<}]K3X(,'Zu7Kq$z;]~([XuQ
?Q:3n!]B7+^n+OmQ%M(y.^z `1Fm@:<
(68	pe P!>PNj	<5e{-E7#`\Aq3<y/V595JCd=5j*B|I&N'`K);J1SyYu]_B({3l`*Jp{/C7Hpmg**[@_ C{S:(^!dG)WzS'8Wa&pV? aync9F5XmJw>6}v9?'-6pa@_u\B?V^BwGMvn0B-L
as35;VFUB77IZ!{R!\GD%#`S^?5@oMdH{m>:zn*]I	a6Z]Om?
;k{_8j    IENDB`                                                                                      PNG

   IHDR   P   P      PLTEgr~fq}]huQ^kco{ep|alyju3AP_jwYerGTcUanhslw|s}q{v>L[R  IDAT7#!Cdv4*~`oadxyyy(NEI/m$Fr1Qxkf	dVS9(fjc"YC[,7Z^/wPW5#e#oy/"Hx[3"q1V!iN"^%,(f]T,1dcD1iNTs1-
A2[3qOV	YmXL-ogYII6eF1J^?WVI5;m1 +~1.SzK)5Z|!^IEv7H?ZblwZ4./5 #Tk}@/HVv.SWl -f$:9lM4h:Uogdd;1[
8Yg;[9wPd|]3[4pvOPI+dC25LIQ2AcSx-P{1JG%?T;VWXPW?_!uQN(!B r"Rgo=Yn=577DIY#    IENDB`                                                                                                                                                           PNG

   IHDR   -   -    p  zTXtRaw profile type exif  x[r=Y kY|`o/35V$n)X\so\{l<o
ZywpJPj/
7A_?vmZ36Qz(Xo&	)LhsF*p>_4 =y[cKZ9o~3&Ml\qc<y	WU|a;eknu*F0z? A/
70n=WXx:aN`'^w+QC=C~Q:~yS<l_"zr7l)qtxyX;xfv,!	hc13>k#RAp!"H,`bJ)'I%r1dM~MDIEHVB%\Sji@rL5W6$7nZ=S]z|Fi!QG~Iy,J+UV]mvi-k\nzkkxJoxTEtgxGE= 7:H-:g:w<o&Q>M6s<aF|"~?goNAkv.+ 
sL8U"djU\WD!qio 7GJq I,_or"&{$wIe#RrcO37Zy3wg#8/gq3HZy)_3G8kVRwN.'t33]R7qP(>fFJbNF7c'e$O[fZk;F+K[`yf K(n-7s_5u{7A7jMY;O~2Tp-n0DC(]o3,
t8JdR+])S|sa4B>f\_ 1aMa!qpw/>Vsz>Ln+LB0*-EX6^DZ0:MtRNv1wLW(cD_KMZMVx0Fe%tg^0I*cT^sJ7=V=>FFK[7]=Z{ezKrx70n\Ccm)*cg419:b)SW!jN 'm5ivy=~2v8Ephj4k)IT*mg6	8em0ag5T;4<vHI]sJ+('d|,=.#%cUrEg"Jh3I&Xquv2D[dV{II6THbC6s6D_x2\Scw6yQL^6IsP[I]Z-JC[#jdvLOiq%BoaeixrS,HH#v+&::1 gGY`b*l$wBw \6)mtZT;poaj \u]O!l-;jn)z#1xv%2IPCSxn}57 !-
%)D$iC4nCNwZj7m2z}Xi{)j=i.Pfut6&HyNCQeE+ W+A	65_ B9 \VE"5i	T\WQi%VIB+/LP}7[	e-MdYrlI+ FN~-pSj?rP!fHBYB/A7y=Xs,dtBFBzHRsOUQZ	f'JKRu:`TI	GD}A]Hq+9$aR.@^/xwB0kB%s=c7$[5E<EG6
^)jLVC(,(,G!h#\&+v!, )%+*kLNxdOt88my7?qx?$w5m ~uX*X%.g=JG}/Zp_"V1'dZvRb%z9Gw?+sV+c.TJPU6PW'w;|Pt]>A9J?`%dnnm#'d>?ydi%s[	zbX5xnQ1RSaBlYb"1GNvqgv"Jqaod[CG.^;0*)kou-]7QV:lxjKaQY^Y<^Q?GqEOX~Y<Zy{P^?y'<`bw01;gqL8&K;<>(ze2r  iCCPICC profile  x}=H@JE*v:YqV,Vh?h8
.:
]Rhqw*SI@,#x! K,<=||,s`2'37g7->q%x.3CF6'.x89[j7iHA:*BViyG\2*`X@*${k`}1 }l\i	}h#`php<!9P,gLy@>N,j88Kq{4rZ  9iTXtXML:com.adobe.xmp     <?xpacket begin="" id="W5M0MpCehiHzreSzNTczkc9d"?>
<x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="XMP Core 4.4.0-Exiv2">
 <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
  <rdf:Description rdf:about=""
    xmlns:iptcExt="http://iptc.org/std/Iptc4xmpExt/2008-02-29/"
    xmlns:xmpMM="http://ns.adobe.com/xap/1.0/mm/"
    xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#"
    xmlns:plus="http://ns.useplus.org/ldf/xmp/1.0/"
    xmlns:GIMP="http://www.gimp.org/xmp/"
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:tiff="http://ns.adobe.com/tiff/1.0/"
    xmlns:xmp="http://ns.adobe.com/xap/1.0/"
   xmpMM:DocumentID="gimp:docid:gimp:a6e2b0ac-b39d-419d-8e3e-9d684fdd5822"
   xmpMM:InstanceID="xmp.iid:14e3c928-2bfd-49a9-9f60-c23dabfc6062"
   xmpMM:OriginalDocumentID="xmp.did:571cca70-896f-45e2-af53-1ddcfef215d5"
   GIMP:API="2.0"
   GIMP:Platform="Windows"
   GIMP:TimeStamp="1613607685401760"
   GIMP:Version="2.10.22"
   dc:Format="image/png"
   tiff:Orientation="1"
   xmp:CreatorTool="GIMP 2.10">
   <iptcExt:LocationCreated>
    <rdf:Bag/>
   </iptcExt:LocationCreated>
   <iptcExt:LocationShown>
    <rdf:Bag/>
   </iptcExt:LocationShown>
   <iptcExt:ArtworkOrObject>
    <rdf:Bag/>
   </iptcExt:ArtworkOrObject>
   <iptcExt:RegistryId>
    <rdf:Bag/>
   </iptcExt:RegistryId>
   <xmpMM:History>
    <rdf:Seq>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:4dcfed68-ad00-47a4-b771-29acfdb40e61"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-01-08T16:44:11"/>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:97ab173e-028e-4ebe-8b63-defd7b3786d4"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-02-17T16:42:21"/>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:4f489a6d-dbe9-409c-93a1-5565675c60a9"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-02-18T09:10:18"/>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:3bd81e6a-6d9f-48b6-8cf7-089e3057f0bb"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-02-18T09:21:25"/>
    </rdf:Seq>
   </xmpMM:History>
   <plus:ImageSupplier>
    <rdf:Seq/>
   </plus:ImageSupplier>
   <plus:ImageCreator>
    <rdf:Seq/>
   </plus:ImageCreator>
   <plus:CopyrightOwner>
    <rdf:Seq/>
   </plus:CopyrightOwner>
   <plus:Licensor>
    <rdf:Seq/>
   </plus:Licensor>
  </rdf:Description>
 </rdf:RDF>
</x:xmpmeta>
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                           
<?xpacket end="w"?>Gh   PLTEgr~I   	pHYs  t  tfx   tIME YS1   ^IDAT D! J4(R(pE558 bfL&D,:b@j\S$LSwg_&$9=Bw    IENDB`                                                      PNG

   IHDR   -   -    p  fzTXtRaw profile type exif  xYv0D^Ip\szl?;vHD
m	zb.d	5T)ix?~s._Mc/x]$:"e ^n$<.7hl%Os{y\j]!IDy_sF8]JeqWqw2oQwEyp1}y7G,1\iL:c;!cW/WU@>py`.nC~zH|0+xpOq3T0woR9[nb\^I09}* qxz
#	6[.Rpad{rB#q69.9>/w p1(}ICl>q<fD$hH)
%c9XcKB)TZr)\rH	%Tr)8jmu{^{gGy3hOL32l-+mewy]w	+j@J/7h[8" bfN13L`XnC7pWBq{j3!MCoK=sGF+[b}q+61/^ek=6[@(V2%i$DVWdk/|v52\#oC><qV`ufxMLP`I	ksHC3;Mr:9k'\'{[7`Zvr"|m.Lj,<>xD8F1=+H9Z#:34R}-$6D9hV%eSY.mi4$.pk*CHs0>e!F*JCRv.!>F.EVBF(Y5J>|}m$VQiwH~,>^R,P>	uSy	p&!b=zrf,#ulkL7H;xKMTg;wT	pfR-R,2Vh!Y'UZUh$\^Nt[u)!CS}W9In=XMV"j9lGL
R?5]pe51.t7&IJHn~o4&,)NviPs'!@gy	dBve	~Rs%ou@H7GArft}eP&Ux	7Xo| o|+ 7ZT>:Q+'LojetbmR	CF4Fv&$/d5i
RUEK ux5y;yc/]rD\kyGz/zo+E4u0q
A(cu37gmvcEq;g|iN{Vj\;2FC3xm9lo:n,H(-'.ZSF6v,i6r|X( hfx\08T9)Wkg|VWk{`tWP4`?R\_j 
X+97NjT !&,aKy8>KR ^Dc0l5ysExA<g$nKe33^n}##1]p41+EVMfG"^tJ?%iiX4HD*Z[
Huo7{4`LJ`X1D3jLx]bLeA_1GJ!Kam~LVK_[0/|me<tLf_k)-. uadA9Lj$,k{
myKJ5*[cBuV&}fwBN!AxuH{
T-T*eL}` T(_0*$/@LC\Nm|l1ZzN1D[4\NBO',Ae/yk<HW
zry>1$4]ijKi&!cqm7748hm-IefCH9.Ggp(GLN4UWWqMAo>hR,6S1jkc}gUiJ%b+t&cBk#o=5ZXR6'JCBUOhPO]9a`#
ckZ2NKR7Y-Y swp/G-hm=}\gQpiB[NRwMW n.-m6.!e]F8@^Aa|$Y8]h?frV\S|;)oxxY3}g!|e7BrJyB%>DQqzl6;jmIx
Pir}V}V;[55ZB  iCCPICC profile  x}=H@JE*v:YqV,Vh?h8
.:
]Rhqw*SI@,#x! K,<=||,s`2'37g7->q%x.3CF6'.x89[j7iHA:*BViyG\2*`X@*${k`}1 }l\i	}h#`php<!9P,gLy@>N,j88Kq{4rZ  9iTXtXML:com.adobe.xmp     <?xpacket begin="" id="W5M0MpCehiHzreSzNTczkc9d"?>
<x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="XMP Core 4.4.0-Exiv2">
 <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
  <rdf:Description rdf:about=""
    xmlns:iptcExt="http://iptc.org/std/Iptc4xmpExt/2008-02-29/"
    xmlns:xmpMM="http://ns.adobe.com/xap/1.0/mm/"
    xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#"
    xmlns:plus="http://ns.useplus.org/ldf/xmp/1.0/"
    xmlns:GIMP="http://www.gimp.org/xmp/"
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:tiff="http://ns.adobe.com/tiff/1.0/"
    xmlns:xmp="http://ns.adobe.com/xap/1.0/"
   xmpMM:DocumentID="gimp:docid:gimp:a6e2b0ac-b39d-419d-8e3e-9d684fdd5822"
   xmpMM:InstanceID="xmp.iid:a97fb0bb-0dfe-4203-8d6d-0639039aa20a"
   xmpMM:OriginalDocumentID="xmp.did:571cca70-896f-45e2-af53-1ddcfef215d5"
   GIMP:API="2.0"
   GIMP:Platform="Windows"
   GIMP:TimeStamp="1613607702721846"
   GIMP:Version="2.10.22"
   dc:Format="image/png"
   tiff:Orientation="1"
   xmp:CreatorTool="GIMP 2.10">
   <iptcExt:LocationCreated>
    <rdf:Bag/>
   </iptcExt:LocationCreated>
   <iptcExt:LocationShown>
    <rdf:Bag/>
   </iptcExt:LocationShown>
   <iptcExt:ArtworkOrObject>
    <rdf:Bag/>
   </iptcExt:ArtworkOrObject>
   <iptcExt:RegistryId>
    <rdf:Bag/>
   </iptcExt:RegistryId>
   <xmpMM:History>
    <rdf:Seq>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:4dcfed68-ad00-47a4-b771-29acfdb40e61"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-01-08T16:44:11"/>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:97ab173e-028e-4ebe-8b63-defd7b3786d4"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-02-17T16:42:21"/>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:4f489a6d-dbe9-409c-93a1-5565675c60a9"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-02-18T09:10:18"/>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:e0ea9b94-5a6f-40eb-acfb-2ca22747ac6d"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-02-18T09:21:42"/>
    </rdf:Seq>
   </xmpMM:History>
   <plus:ImageSupplier>
    <rdf:Seq/>
   </plus:ImageSupplier>
   <plus:ImageCreator>
    <rdf:Seq/>
   </plus:ImageCreator>
   <plus:CopyrightOwner>
    <rdf:Seq/>
   </plus:CopyrightOwner>
   <plus:Licensor>
    <rdf:Seq/>
   </plus:Licensor>
  </rdf:Description>
 </rdf:RDF>
</x:xmpmeta>
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                           
<?xpacket end="w"?>P   PLTEgr~I   	pHYs  t  tfx   tIME *'   UIDAT1 !DQ8^k16/FIP0a-
&8ECmJ.!J,'KJdH]q75    IENDB`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                PNG

   IHDR   -   -    p  zTXtRaw profile type exif  xir:sbGk`?_,
|$Ug	b.IR:	UNqa?n\~qst]	C,>LTu!<Mt-uGk#F;okz>Gh<d_dk7O2us[ywn5oJ@^xyF~f?OuL6!~X'oxZt5$B=>c`#~-FbGX,;l}N\\u\u-,<,#e2`|8Z+4	" v( >?\xzs[G~9\y\"lz8&{dOe|plnKOcXd,>4P
C5b)X|
)rW!r%KPbI%b*N<1J,EDjeoW\-R4i>=S.7N4(CFvJ38LujJ+d;j>jH|G|j9`A<+$SbCpFSq":va17fB+9BrlC+LgSq-_ix=	EB,ToQ9J
"6duyifOBvy`e(w?n\Gs;yl-OKPLlh\c!+'N@op<X)49Np#]{X13?F_zijzdNDvG!:Nn+wU|ptfCjQm.'PIoBVh!fw-SlK<waY
uk%9'	|9ym!Q<-L#=&~LeAYQ'Y(Ass1}:{Ef!griDBC]izBar3K!iHqy4#%] LRW)hG{sd2<_9[.V8
=^-^/B"F#:8!iUE50Huu#Ponn@I{G|]a}	\)6qQ`TOfn=he  s$<=1I1ZksGbCsN"/\ J^6[
FC47:+\X	1fg<%mFw=V>S_W<1&i=!XVb{p	3CjVmTkDgo;ZD5C35VIO7F;73 #olV|m| lZ:4*tz63)0&+!zs%MR&>%JHYZaA	if	+5Au}Xo:'25DWZx_0_mhuQ1dC4_#;:q@n76d
:N?t({F(rvv?Zj4Czi?c+7P\ee a@KWxJARO'L$)QlMq/9nXY;nnB3(5N=5Z{cR
v'7rDD$Jqyv3*X.&B7qD6,):@uj"22Z&Kx(Tlzvw}+ ?xo"#: _w+G,<8V}C;w~p+>luCJkh-uz4VTTzLv5
gvgm<3`n_zl<Ug~w^|7+W/^|Om+iRSX(h9e5,%uj%%;dkIp8@tZ\D_A2jgh~%f|n~wQ&5(.)H?\4\E\@)j`E)Nu82r.3BU2fY3'?EI:L3YNk~_Y|
\O<||Z.|uL4t-vY[!L}[x9SXjCh,S(~{s.wMn{]6Si6Zcf)1SoK>xv;uiXx86xJO,0tj-'GX3Mjom N N=Cs<'j7y_wd7e3o|J`BK!}6{C#u6U1iAJMC~)6:(Do'zD3O}cyBiRGJW%c:b|w2hC	?L`  iCCPICC profile  x}=H@JE*v:YqV,Vh?h8
.:
]Rhqw*SI@,#x! K,<=||,s`2'37g7->q%x.3CF6'.x89[j7iHA:*BViyG\2*`X@*${k`}1 }l\i	}h#`php<!9P,gLy@>N,j88Kq{4rZ  9iTXtXML:com.adobe.xmp     <?xpacket begin="" id="W5M0MpCehiHzreSzNTczkc9d"?>
<x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="XMP Core 4.4.0-Exiv2">
 <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
  <rdf:Description rdf:about=""
    xmlns:iptcExt="http://iptc.org/std/Iptc4xmpExt/2008-02-29/"
    xmlns:xmpMM="http://ns.adobe.com/xap/1.0/mm/"
    xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#"
    xmlns:plus="http://ns.useplus.org/ldf/xmp/1.0/"
    xmlns:GIMP="http://www.gimp.org/xmp/"
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:tiff="http://ns.adobe.com/tiff/1.0/"
    xmlns:xmp="http://ns.adobe.com/xap/1.0/"
   xmpMM:DocumentID="gimp:docid:gimp:a6e2b0ac-b39d-419d-8e3e-9d684fdd5822"
   xmpMM:InstanceID="xmp.iid:24011712-c031-418b-9103-84227f32a2f7"
   xmpMM:OriginalDocumentID="xmp.did:571cca70-896f-45e2-af53-1ddcfef215d5"
   GIMP:API="2.0"
   GIMP:Platform="Windows"
   GIMP:TimeStamp="1613607666487705"
   GIMP:Version="2.10.22"
   dc:Format="image/png"
   tiff:Orientation="1"
   xmp:CreatorTool="GIMP 2.10">
   <iptcExt:LocationCreated>
    <rdf:Bag/>
   </iptcExt:LocationCreated>
   <iptcExt:LocationShown>
    <rdf:Bag/>
   </iptcExt:LocationShown>
   <iptcExt:ArtworkOrObject>
    <rdf:Bag/>
   </iptcExt:ArtworkOrObject>
   <iptcExt:RegistryId>
    <rdf:Bag/>
   </iptcExt:RegistryId>
   <xmpMM:History>
    <rdf:Seq>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:4dcfed68-ad00-47a4-b771-29acfdb40e61"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-01-08T16:44:11"/>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:97ab173e-028e-4ebe-8b63-defd7b3786d4"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-02-17T16:42:21"/>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:4f489a6d-dbe9-409c-93a1-5565675c60a9"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-02-18T09:10:18"/>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:ef88c163-5b0d-4e51-958b-0fbfa86b3d95"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-02-18T09:21:06"/>
    </rdf:Seq>
   </xmpMM:History>
   <plus:ImageSupplier>
    <rdf:Seq/>
   </plus:ImageSupplier>
   <plus:ImageCreator>
    <rdf:Seq/>
   </plus:ImageCreator>
   <plus:CopyrightOwner>
    <rdf:Seq/>
   </plus:CopyrightOwner>
   <plus:Licensor>
    <rdf:Seq/>
   </plus:Licensor>
  </rdf:Description>
 </rdf:RDF>
</x:xmpmeta>
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                           
<?xpacket end="w"?>   PLTEgr~I   	pHYs  t  tfx   tIME [   WIDAT	0EQ*=HvL k5<3|rs!CHIR%	&]6:\<    IENDB`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    PNG

   IHDR   -   -    p  
zTXtRaw profile type exif  xYE
/3p|PtM>T2_|b,$%-XcbO;Gg9=~<oxpY=1S*T}Q-|t/T#m\B_c~Fu[Gz3N~,G@3D*z6 _|bSB/]a<W~7oY]{SO:e/q-[z.vw<n.np_^8{?p [Qn{c3|6po`?uqgztaN`_
[!-O[WzN!n?pkf%'wcKq+[ &b2.]H.;+sCDKC8amwa8GB
_EH,`bJ)'I%r1d%&A$"RJ+J.R)kSUjZ{K/6#<d3h02l-J+/Ye6Pav=O^S:Q^QtgxGE= 7:H-:g:w;sF]3_xl3l0CjT/w!M+8yukD.UnmC-lzA&9l["&fL.Qz<5V=	Q-Lg[}2^Y(5b8[/uG1hQX'[WoS|i	y)!~*Ny'`b^w01;WqL'B,.RTs|9]XlWZY)!k]uO9ssf-<v9+g;_cO]jJSZ
-L|S2
[:`2G+U{+zg7j6:5Oyu)s/44f5z+HOR*s74.NW7aO/cm8f+HhN|Fib7^'^tnEh)m'B"\u*F jc?[nHvSEIuNTcF14+ad `:W%j4f>pj7cZZ_1sJS;AW]FM6\}g-OMqS(<A,mEvA}Eqs3	*aLf@!V#:+ss.ve$6GG#G&cv^V;Kb
&N;5PIY76nw:oIDo a'X$$]E{[%YRw(};VX:/$iBtUd)@{0}P*-xuilhK#t5fE{24nHO>m)<[W&UX>h@TD'hD|)I0%BGZzEb.~b2b>@\FLL,io12(z[YdhY#ivvR7<A@]i&5k+6WAl9vOmRZImIsO9[l*0><b//oAc$5'q)Fwh1i=;I[-hF_F	u!|z_i3?3*+JRen 8c#^\zMh0l6):Zjfh%eMdzD\PB$z\+HV1A$eH?"Iqsw!7}#AIdt@+ nnD:9" 	MZ0g%lX$$?N'hEE!/)WJ7eLC!BR@!QPOqBzvHBhF?
t(o<<,\,o5^"R"mC-stsT#Q,ea292(`P4OV!8=!JTnHxXu
T8HY!gCyi+

A{"=At_";<zm+5SjubrP3y;J-!l^qVU!NVRM5j24jC z&6r]IqC-Hrv"]~DiOsu{1Zu+dqp$ l4.<_v^yfyG;8rj7#g'gV)Cf'1q!1Y_ )CT
6~Kh&Qt Zhx~.QAiS+  iCCPICC profile  x}=H@JE*v:YqV,Vh?h8
.:
]Rhqw*SI@,#x! K,<=||,s`2'37g7->q%x.3CF6'.x89[j7iHA:*BViyG\2*`X@*${k`}1 }l\i	}h#`php<!9P,gLy@>N,j88Kq{4rZ  9iTXtXML:com.adobe.xmp     <?xpacket begin="" id="W5M0MpCehiHzreSzNTczkc9d"?>
<x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="XMP Core 4.4.0-Exiv2">
 <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
  <rdf:Description rdf:about=""
    xmlns:iptcExt="http://iptc.org/std/Iptc4xmpExt/2008-02-29/"
    xmlns:xmpMM="http://ns.adobe.com/xap/1.0/mm/"
    xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#"
    xmlns:plus="http://ns.useplus.org/ldf/xmp/1.0/"
    xmlns:GIMP="http://www.gimp.org/xmp/"
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:tiff="http://ns.adobe.com/tiff/1.0/"
    xmlns:xmp="http://ns.adobe.com/xap/1.0/"
   xmpMM:DocumentID="gimp:docid:gimp:a6e2b0ac-b39d-419d-8e3e-9d684fdd5822"
   xmpMM:InstanceID="xmp.iid:8b9c5ec5-62a2-4494-88b1-ad7dd4b51102"
   xmpMM:OriginalDocumentID="xmp.did:571cca70-896f-45e2-af53-1ddcfef215d5"
   GIMP:API="2.0"
   GIMP:Platform="Windows"
   GIMP:TimeStamp="1613607640818073"
   GIMP:Version="2.10.22"
   dc:Format="image/png"
   tiff:Orientation="1"
   xmp:CreatorTool="GIMP 2.10">
   <iptcExt:LocationCreated>
    <rdf:Bag/>
   </iptcExt:LocationCreated>
   <iptcExt:LocationShown>
    <rdf:Bag/>
   </iptcExt:LocationShown>
   <iptcExt:ArtworkOrObject>
    <rdf:Bag/>
   </iptcExt:ArtworkOrObject>
   <iptcExt:RegistryId>
    <rdf:Bag/>
   </iptcExt:RegistryId>
   <xmpMM:History>
    <rdf:Seq>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:4dcfed68-ad00-47a4-b771-29acfdb40e61"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-01-08T16:44:11"/>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:97ab173e-028e-4ebe-8b63-defd7b3786d4"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-02-17T16:42:21"/>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:4f489a6d-dbe9-409c-93a1-5565675c60a9"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-02-18T09:10:18"/>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:50ae1b59-6fce-4e33-a3df-97d0f479781b"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-02-18T09:20:40"/>
    </rdf:Seq>
   </xmpMM:History>
   <plus:ImageSupplier>
    <rdf:Seq/>
   </plus:ImageSupplier>
   <plus:ImageCreator>
    <rdf:Seq/>
   </plus:ImageCreator>
   <plus:CopyrightOwner>
    <rdf:Seq/>
   </plus:CopyrightOwner>
   <plus:Licensor>
    <rdf:Seq/>
   </plus:Licensor>
  </rdf:Description>
 </rdf:RDF>
</x:xmpmeta>
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                           
<?xpacket end="w"?>M_   PLTEgr~I   bKGD H   	pHYs  t  tfx   tIME (J   `IDAT DC(1
#P $gSEH5.qwxc#Qe+Na2B:I@$E`'/G[R    IENDB`                                                                                                                                AS Y M _ C  O M _ 1 . P   N G SYM_CO~1PNG   eXeX eX	|'  AS Y M _ C  $O M _ 2 . P   N G SYM_CO~2PNG   eXeX eX|6  AS Y M _ C  DO M _ 3 . P   N G SYM_CO~3PNG   eXeX eX-|b  AS Y M _ C  O M _ 4 . P   N G SYM_CO~4PNG   eXeX eX=|(  B_ D O W N  . P N G     A D D _ S  C R O L L B   A R ADD_SC~1PNG   eXeX eXR|#  B_ L E F T  <. P N G     A D D _ S  <C R O L L B   A R ADD_SC~2PNG   eXeX eXd|$  B_ R I G H  T . P N G     A D D _ S  C R O L L B   A R PNG

   IHDR   U   U   8Z  zTXtRaw profile type exif  xYr$9Dq9vUdn0&;knN&w.tO5\^O?|~?R~~Ecx=|0xV~:P[_E_o:(d(/gYf?/a?eG>Q]8O<?cH.E=</[ W'U_wYT?;^e1t}nYEX{'Jc/W9hOV!rra{\aq9h<h^kb+yGzE{}-83?<|}B'!Qy?k/l	G5:gP"]!P-@-'-UR9L3{K/Y40LFkz*ClrCK)XiQSZ%VYn[iYk6z	r,v>'yqgull5;]'t);3.P[nvw|w-O[~t-N5>jAtR3:s rNS|LE\eQsvP`>!{o.oGZSstmKmOuHc;bqsRB_'2J.m}	+C-+i#3FUg(0J'Z[%*7EcsPq?3'Hk_qMf1 ?G>XMu!80Vn24[)9z_[yfuhW7E M38A=](#jnIR-:x.=#<q^2;8\X \m$,\<"X_j4_<I=!d!]w;X^g6	VV@<[-2pir<=Or9Sok>=Oj	{,Xa|Oplpi;O=]]5-Wm1A=Q(g@#)53lqY|n+2DXzq5,P^ctm%:}f6|@, OzG?XI1{t%b)CNgI4fF*mhjrK&SNm1cCsAOP!*C hh`,9k3x2]`!k+p\k/}Vn`iqa 9b4Qkfd3=D&^f&C.Uab}~"G"^6]IZwS9?7p?]:~pBa=Y.3q`M S$H-^/%p$|[Iz8;Z.:PP|hu>5S*f)Q&T_u'o|Or[T'FRRM5 `d>j&f@!FzlRpbE5/%/T9Q:N&OvcVT+Hap0&"K*P74`N@=H\{ gTuA}*H,~B9]XRM!O\_vX8B>fh#s'vz1Y{"T6BHP'NmRDJdik9 j3B-.Tc$T{D0DhmR7'F9#h ;A8tt6!@E2"F $_h=f<IP= 3%jfEj/[_V1{\o?r$?1H`^7F)hon}m8.9@C7T O.y$sBDTB^}['lu~Y;@X"T)4a!4z4!t}smh852 N,DaqEgZS/zP{ z\IN]qHBy <^
\ d1p+qx&)lGGiE|j<j	@ !s@:2bBsP21 3AsX,tk'[
f=C(fFg-(4*8%IQI-($dB
:ZQr/fp]B JWE0aX(YC'3m9`rP]H[?t2PHy6$L @ENCbw`"f.Vs-44WsRdnAg!`gY0mX3L4gdud`R.OYI?+5KeQs=8I>Bt+>uV(UE[8)wchHpYqd#3<}kbG\E(HqlYJW ufs5ygO#%ae'ezx}z\l<f+g(95Qr[;<4Am:+`q1]b1vhN%<@gGI\d&ODmB'w{wbySc3&T	`M(JS $[GL1Z\3C=,oD h/4b2(6e$mH md Eab%5fKHdp)vFcI@bHQ5h#1.&G;D(.i#j!~C9Keh<?y?&EI@~!$\`(P-e
|VsDBlD gI\c}"oh;>Q`W!jycrXn64Ka1j*sn\4rYBG!
 wIY%8F
.Vz	Z4>gB>Q^01.s3`>"sLf"]MI9buZe6c/ZD
+dt%aU!*(p,$#2MVQ	n"PV}xn'O3emLS.x.eAV, 8Vc{~m2gjlgj%BP`:@n;O$yxf]CwAQYD;XOzT6KUm	aeR1r"D; uDX 9^%c@,crRT(z@y
$#<-H%Z,s,bH8=(#x't7,QE
#l{jBn=3MT	H9"'1w)/-NqC;.-q?>f3I%C&QsjokCwVx<`+<qpBhi"
-hBuv$Ptg8it' D.<6TDYI"f@Ni#^3iKQgo,\cwl10a#Tu_XP*A4R(`vlNn:#=a-)2."k+g0*=77?wv 1sYj>@]G`ORI?=:t*D$4/a1U,un0[rso>+%2CMB1kjF
aU{f. #[+4+u.Y>\(+fE%&`]j^)p4}jN7C6c*%uknaYF[~8C~#d%G&gq&`"%JtKLXBy'"x|;)-WID";D#~V@C1+\w}HP2I0 OMQ>{40+c$]1x> _TG
p{F	Dvf2J[ppF>P(s8^Z&mn\y &U:j{rugem!t  [Jm^$(sl,)?`]8O`Qoj
u*^;PVgveRmw:AmCb's00-xC38qgnLF
7jz8:sOtkW8kmWNF0UzGN0@Wn^;nX  iCCPICC profile  x}=HPOSE*qP,Jq*Bi+`?h8
.:
x_Rh8{BTgP5H'b.*^C0$1SOf{,?_)sL7,s'OtAG.q.9,MR]J<CQT
-j/i"%$uTP()&t8drUTH~,NOI8bc@`h5l[':Z$"G6pq=r~%Cr$?-X-} KZe{;={tr  iTXtXML:com.adobe.xmp     <?xpacket begin="" id="W5M0MpCehiHzreSzNTczkc9d"?>
<x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="XMP Core 4.4.0-Exiv2">
 <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
  <rdf:Description rdf:about=""
    xmlns:iptcExt="http://iptc.org/std/Iptc4xmpExt/2008-02-29/"
    xmlns:xmpMM="http://ns.adobe.com/xap/1.0/mm/"
    xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#"
    xmlns:plus="http://ns.useplus.org/ldf/xmp/1.0/"
    xmlns:GIMP="http://www.gimp.org/xmp/"
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:tiff="http://ns.adobe.com/tiff/1.0/"
    xmlns:xmp="http://ns.adobe.com/xap/1.0/"
   xmpMM:DocumentID="gimp:docid:gimp:67414af2-901a-4fbc-b59d-f95bd801dfc0"
   xmpMM:InstanceID="xmp.iid:4bb129c0-9398-44c7-bec3-49c86ca9bc44"
   xmpMM:OriginalDocumentID="xmp.did:3a185613-e580-4f09-aebd-be254e3bf20e"
   GIMP:API="2.0"
   GIMP:Platform="Windows"
   GIMP:TimeStamp="1610092664430863"
   GIMP:Version="2.10.22"
   dc:Format="image/png"
   tiff:Orientation="1"
   xmp:CreatorTool="GIMP 2.10">
   <iptcExt:LocationCreated>
    <rdf:Bag/>
   </iptcExt:LocationCreated>
   <iptcExt:LocationShown>
    <rdf:Bag/>
   </iptcExt:LocationShown>
   <iptcExt:ArtworkOrObject>
    <rdf:Bag/>
   </iptcExt:ArtworkOrObject>
   <iptcExt:RegistryId>
    <rdf:Bag/>
   </iptcExt:RegistryId>
   <xmpMM:History>
    <rdf:Seq>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:5716827b-edd7-4267-83cc-65fe31dfc385"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-01-08T16:57:44"/>
    </rdf:Seq>
   </xmpMM:History>
   <plus:ImageSupplier>
    <rdf:Seq/>
   </plus:ImageSupplier>
   <plus:ImageCreator>
    <rdf:Seq/>
   </plus:ImageCreator>
   <plus:CopyrightOwner>
    <rdf:Seq/>
   </plus:CopyrightOwner>
   <plus:Licensor>
    <rdf:Seq/>
   </plus:Licensor>
  </rdf:Description>
 </rdf:RDF>
</x:xmpmeta>
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                           
<?xpacket end="w"?>   bKGD      	pHYs  t  tfx   tIME9,K  IDATxK[QO5C5 
R{'B]DpI%dAP
-Jy`(<fch~w^~wr_0V
(R)TJTR)RJTJe(R)TJTR)o[Ug_ahKSR3d0?L:=v~?
-7ZJ;qq*;^KK]QioVWkhSrkV;$|R6)RqDR:D}YAdQ*iYj&B~eQ|Ro@H}j3V72r2'C<6_D9}td	(8Ei"R/2.z*m~I{TKM|;*4zHmT h62FLvF$"RiG/"jk4?|+,rE 5L\jYdR4oPCN	+U7>oYPUI9SKk<ok$RH|/R*2JP*R*CJR*2JPj<jI    IENDB`                                       PNG

   IHDR   U   U   8Z  zTXtRaw profile type exif  x)rH <W*V#Q$h(*c:dk>)yK_?do dOQev{=|-+%OSc|mDo)9J;@O
e}O2#3! SbV[T>JO'_:FowpynV%^R=N\<)Go{ox[)M54MZ2XmP~G8UXp4%=,ung`w8bNB7gH<'o_kAyY5<@N\Km D[L* 5IbD;L ,s-E\sn:fLhH&i)E42djM]f+6iZmK]{GAeh1'WONsUV]tXUSk;'t~r~_G-}1Dr9rM S98tY,zR>r_jKC;#nAm{X5}(m?e 2/,)NwU4Nlk/lu$kXK=;wsWIUt~m)}4*>hy]VL,kbNz	kb9'k%=2n4d0k#tY?hWSaOZ#Ce`q[3n*dsz=\]SC+[fUEMe&js(d=]-r2b-"c6<8?g|X5m|I@irnMXgp7#;7;{[fD_7c7KCSYKH~y$cP8b)Nx`(#*oOS!M< vU0o{2#`d|Naej~HS6EU{<qrVSg++"ieZ	%Jm|D>k(	:1Amm6iEu7Om!LSink9H/ilSkGH6r{6^nz8eY`f:[nir_ONcY	,'USj~5@ HpS!9Q7B'1n64eA
6iEqMg]]cx`C|T \bvZsBBrOMab\;zn0frT3U
;ntZv\Yo[ocL H-Y3p{KP&[=a?@kGT`Is7i/n&k3*k6PU
d<z!MU0#NEoJ5JCyB*:wpm@eRGh	;*[.zP&D
iXh] 3JM*WToVa*_Fg5Nu#Dlx6\H~YXlRDGAofB@BI5Zp*0>/R`"#']#,::EuOL>n`^8L6{\&Suu+ Mi_xc#N!"4nK&?mo'CACQ#6<7N&
8Qsx_lfKm\WM@^w$i:vHhF	yM*=+eb<ihJ)S%61g07T\Pipq%aHn!w>2	,!J	s'&$3"eh	vtRJ&LF*LjFmp(;CA[/Fz@yXe^z	z'a]\Ckv&B8ij@JnG ;va-<7|:Z+5ZFaA?_=[(w j%\&vAzrPrn.	-"J:at 2VY`W{$;EX*0R'S6-`,Wr]I7%,8?j|zaYzv`QH*(=Sq(6~&+@^uLXaY7
0boRZMC(\0h`&?SPKa1%c<f.~`mEn,HJI*Jt`[18"CNLgY$"%21n+R4:gPP (0&df  iCCPICC profile  x}=HPOSE*qP,Jq*Bi+`?h8
.:
x_Rh8{BTgP5H'b.*^C0$1SOf{,?_)sL7,s'OtAG.q.9,MR]J<CQT
-j/i"%$uTP()&t8drUTH~,NOI8bc@`h5l[':Z$"G6pq=r~%Cr$?-X-} KZe{;={tr  iTXtXML:com.adobe.xmp     <?xpacket begin="" id="W5M0MpCehiHzreSzNTczkc9d"?>
<x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="XMP Core 4.4.0-Exiv2">
 <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
  <rdf:Description rdf:about=""
    xmlns:iptcExt="http://iptc.org/std/Iptc4xmpExt/2008-02-29/"
    xmlns:xmpMM="http://ns.adobe.com/xap/1.0/mm/"
    xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#"
    xmlns:plus="http://ns.useplus.org/ldf/xmp/1.0/"
    xmlns:GIMP="http://www.gimp.org/xmp/"
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:tiff="http://ns.adobe.com/tiff/1.0/"
    xmlns:xmp="http://ns.adobe.com/xap/1.0/"
   xmpMM:DocumentID="gimp:docid:gimp:becb8f70-1dbe-4d31-9301-2af8b56dab6e"
   xmpMM:InstanceID="xmp.iid:13b42b80-3d20-4b93-b16c-9933a91d0b9d"
   xmpMM:OriginalDocumentID="xmp.did:6de76ce9-76ce-4819-b0ae-e4c82c5f44ae"
   GIMP:API="2.0"
   GIMP:Platform="Windows"
   GIMP:TimeStamp="1610092747017898"
   GIMP:Version="2.10.22"
   dc:Format="image/png"
   tiff:Orientation="1"
   xmp:CreatorTool="GIMP 2.10">
   <iptcExt:LocationCreated>
    <rdf:Bag/>
   </iptcExt:LocationCreated>
   <iptcExt:LocationShown>
    <rdf:Bag/>
   </iptcExt:LocationShown>
   <iptcExt:ArtworkOrObject>
    <rdf:Bag/>
   </iptcExt:ArtworkOrObject>
   <iptcExt:RegistryId>
    <rdf:Bag/>
   </iptcExt:RegistryId>
   <xmpMM:History>
    <rdf:Seq>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:aa64fa2a-7017-4d6a-aee9-a3ba72dad77d"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-01-08T16:59:07"/>
    </rdf:Seq>
   </xmpMM:History>
   <plus:ImageSupplier>
    <rdf:Seq/>
   </plus:ImageSupplier>
   <plus:ImageCreator>
    <rdf:Seq/>
   </plus:ImageCreator>
   <plus:CopyrightOwner>
    <rdf:Seq/>
   </plus:CopyrightOwner>
   <plus:Licensor>
    <rdf:Seq/>
   </plus:Licensor>
  </rdf:Description>
 </rdf:RDF>
</x:xmpmeta>
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                           
<?xpacket end="w"?>3lw   bKGD      	pHYs  t  tfx   tIME;M  fIDATxKBac*RIADETMmB-5 5465DPEHE\$Hr5BJz*zq\i QJTD%*CT!*QDeJT2u	w797;H81ij$B,:'xNV4Q5rvaeDR2Y#/pwN5N;LG")N;%-uv)iEpU yC5aB5e@v:_Y4jR;C\_)LLMMM$SKk_4NLkov+QuS#u"QGtwR=m-'7ujtprv[(* |8>@Czk_^:Zik52PV)UJZKjH}bj yF:TjdjP/`g;.on?FSLthcS'/ L!Le>*;%gkH>T!*QDeJT2D%*QQJTD,^    IENDB`                                                                                                                                                                                                          PNG

   IHDR   U   U   8Z  =zTXtRaw profile type exif  xk$>'uI Lv;?cP2"X7\5RZ2@o>[>>|M7~_X_=~=Q%=xmhy7fsk^K'zV't6Z@<9g5gJGq*|EH~r(N|y?~xBy:{Mv4B/*7.Br@nlJ)WYbI'u)ms{iGn`eYsol\<g-&S!W|~:[b]e8r. G	A>aV^pbUyQ~XjM D]YdMr&Ed MRk2VJp.i8 *b?(94kjZG-jk7's/{>E6AFhc'OOnsWYu&}vu=d	kMm<rHSN=gyIoq'j^Q?Q?X* cUJIsHTEM:8&#^?}[(/>@.8t?A 5s1!/Cj3L#Go{0j;l5RiW,ZRWli&DtI!Gn,pfu(kE@EuYkcQ6{/TX@EP}*+9{Jy4R^2.*>|=g$V;._^P`vsjkf`=Up[3]j~8&Z1>
XYt8G*HD(}QAigW(Nf_m/g]1sTs68	YvmO5K-1Ej6(A}Ae{jh[kpUS,'5	bHvRH}3R5l+q!/N#F4z@Vi;J(
;%h2:UK*:Dao aEsJfM"O 	!r)>e!6k@G4^!"z^:HU|AMM:mU'*hSQqI]YI+J;qRoTm44!hK!`:m/5<{+u_&iDx))riK/Lm$0AQ'Zz$3Hg%
yiH,FXtZ?cqYdm.lv|v)L4YKBzYQ'xwa74:8H'kUoaKZ./v]JsD<w,,$O?
L{l`DG1zn,$'8Nm^BO{8kioi!RLk(Zb$!+ 21p46sE$Ti_#r7jNYsKzG=n7H"szZOB#JLe,8`q"rax;BJ(niw5;TVaMA S$f4/7+C*/JJ K_PvjVq/gFWGhZ[pSIB)Zv3RlAj~I?OA|aM`qEb#/ Tuj6ml	Es3+K^4BKYFen9W&,x.a &BOo%!>cP{!61<k"	((Vf\cDhQF9Raw<l+iC#8N6r|U<B%\,(*jjO-uguDX:@t=NGKu|#%QAuKu5QraV q6Z2L<jO-[VWPA~=YBACrks<aJRtA+P9E9.-oFk UaAi&n0%Vs+PGN'ARL==#({&Q-	m0LXH_Tu5jb]RrOR_=ZFaIatbd[QJ$*G	"/"P9$"6iB2|jAw*v&ed'DHIu r5$\
q@&=y&c7frw@%j>b9	=~O+^P =Q6I/x Z!7`ov /LK8lTDEiW\bgFVUdH0Fg	?tL  iCCPICC profile  x}=HPOSE*qP,Jq*Bi+`?h8
.:
x_Rh8{BTgP5H'b.*^C0$1SOf{,?_)sL7,s'OtAG.q.9,MR]J<CQT
-j/i"%$uTP()&t8drUTH~,NOI8bc@`h5l[':Z$"G6pq=r~%Cr$?-X-} KZe{;={tr  iTXtXML:com.adobe.xmp     <?xpacket begin="" id="W5M0MpCehiHzreSzNTczkc9d"?>
<x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="XMP Core 4.4.0-Exiv2">
 <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
  <rdf:Description rdf:about=""
    xmlns:iptcExt="http://iptc.org/std/Iptc4xmpExt/2008-02-29/"
    xmlns:xmpMM="http://ns.adobe.com/xap/1.0/mm/"
    xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#"
    xmlns:plus="http://ns.useplus.org/ldf/xmp/1.0/"
    xmlns:GIMP="http://www.gimp.org/xmp/"
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:tiff="http://ns.adobe.com/tiff/1.0/"
    xmlns:xmp="http://ns.adobe.com/xap/1.0/"
   xmpMM:DocumentID="gimp:docid:gimp:6bf3d20e-ec5c-4b86-a4eb-e2957095b087"
   xmpMM:InstanceID="xmp.iid:10d9b359-8852-48ec-ad39-f1eb812e3568"
   xmpMM:OriginalDocumentID="xmp.did:01544942-87eb-40d2-b1ae-d11ef152858b"
   GIMP:API="2.0"
   GIMP:Platform="Windows"
   GIMP:TimeStamp="1610092795179951"
   GIMP:Version="2.10.22"
   dc:Format="image/png"
   tiff:Orientation="1"
   xmp:CreatorTool="GIMP 2.10">
   <iptcExt:LocationCreated>
    <rdf:Bag/>
   </iptcExt:LocationCreated>
   <iptcExt:LocationShown>
    <rdf:Bag/>
   </iptcExt:LocationShown>
   <iptcExt:ArtworkOrObject>
    <rdf:Bag/>
   </iptcExt:ArtworkOrObject>
   <iptcExt:RegistryId>
    <rdf:Bag/>
   </iptcExt:RegistryId>
   <xmpMM:History>
    <rdf:Seq>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:1045c6a1-9406-4b7a-89a3-1f06b0944863"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-01-08T16:59:55"/>
    </rdf:Seq>
   </xmpMM:History>
   <plus:ImageSupplier>
    <rdf:Seq/>
   </plus:ImageSupplier>
   <plus:ImageCreator>
    <rdf:Seq/>
   </plus:ImageCreator>
   <plus:CopyrightOwner>
    <rdf:Seq/>
   </plus:CopyrightOwner>
   <plus:Licensor>
    <rdf:Seq/>
   </plus:Licensor>
  </rdf:Description>
 </rdf:RDF>
</x:xmpmeta>
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                           
<?xpacket end="w"?>jO   bKGD      	pHYs  t  tfx   tIME;7}|  mIDATx=kSa;z!	m	P4PphJ@3:v7PEB0t:"*@?%5  TP	J@T*PA
*TPA=Us$W*yi>}$B8fQyZTZfPDPlunYt?|I<;nHifZ|&{FzN^~grb'V+xlm{ugV|iyJ~,V^ _H?2jTAvJA&G45ADkFdI\G0z3i;shx+ewH!5\~jY;v:-VS;Y+kgz%+JkI(K=vCv )TAd 2ekoT*QsR)XjP]oP}hTH-j3L??*PA
*TPA%
*TP3? whI    IENDB`                                                                                                                                                              PNG

   IHDR   U   U   8Z  zTXtRaw profile type exif  xY#Dq
r  :'Y^[1}Mt*fy?Sb.'<I?|~?Jy,|Acz>/z<+_\~B%(d/4J|m[X~u6>jwnTob<)$kIK'US{NUo,ou_~>P~\|;'W{><J*_|uzoo~eaoan8c9xh^-yG-WLF{w7cbAPpW|B
!Y+B;ECQy
574:D!Po1c?r\ 79Js{Zx~7_p(S5#Mz!6rCK)(k*-JF=Ks 2h1+O=9W\iUV]m54cUk;]w}=O8@SN=3@okw-|t->/>.D'E=c1: 3Cu(U5gubwW}s99S~miUT?3WC&gp/0[EsS 6[0!~Z;LWPByxJ6Z6JjB>emDvSKrJ~lfX}VcmgM]ofaj'YIz<uK/f{T{eni3Y,zN_-,0<6n_p+Ylsc>GkO6N#|h!:`A;7nr_+p{b+lcc )Qv\k/{;OBRequU(6O*/y;~O-6WkV12K}@}_1nkU*{=D*6z`WCF.REVUIR5.$;|YfV=#F3+D_=_@68;mR7n<Xa-Q	HMD7m yS5n@%12m$tB@\kF-70JWX!%2](cTOknBJacKQ7m7CCd[9y&.JPsXtq\lwZ1^Ul)9,zp:I5GV<M81y@MFvx:nHQH|JR5q)E&;4_3~? I!3@h_`w{u&>8cX)l<w:aL~vQH#O	nuy`mc\T M&I"-~ QBPyQ8l,[vR]&%Z-q"	t 5;S+F;B89L \)-7K_m88yke&1xZ2ei/8J.hE{L=<.g>9yQ'"_" %X9l,@)	>b`8[0Tt^KC\RyA
wbQ
g>.XYP)6&RJx}|j*5:fFX=a5BqpaLKoLhxw&eOj0O@k><P~ GX j"PGG1]@@ NpbZy|fauX1P~4TdA $fqtD cUA$r".T8Q#ghdc$t~V0@4.
n	`wMs'T!VhY	oP ~p8WN[@-T`^`W*o)p<K8>B`'ayp94'15kNpVXU?i`;1=u [d	)PA,}0[5X6F$2xeA	0/	4 &a\|1$OGlDzG`ljR[P;SPDAKxB%7q9UAqPFtx"~xlT-0mDJ%'*Kpl9)y'HD .ua+QpNxZ L1[41g*.8jhdHX#yqzKWB~9V8O$bq<#S6Esbf
4/$gsNrT!3M!*
q.v`6VC*O:%Mx2@<lPs"B_DL@*6>5uaAn)6^9NN8{L=j"L!$,*yST=4pkA1HxpK Z/QMa2R69aF5RVhY6+'.)581[9`cm02+D"K	)AXNw3xX`QU >VM lc @?p*_23^TZC6QZpb2zf@{H$8X S+0$G*I^GuuQ&I0`hcD2
u,#r+6bl	g9%}E8Fw$i@.JE@vE_PORN$"PFkX#sV'"l\LKmR6_x$.u<3n`p"d|j{6#CyX/!B#)vbQl:FLy[CUJ|[@#<~zVW37I-[0-CyaP*cA^@;S0OFwwB-RB|&.Q]b^5Yw r(0/#gy?>Ui*#vm g`caGu<8h`lV.VH p\uzk/0j2oq:w#~{ax;&5CnA%)dd6lpTH[l;AqR|sXm%
*(-il;9N~UlIp+uDPTzO2Blg!:u5'1X+/kCGqwW!3aAo'Fd6^y.iA+Zl~S0.IGeG)V`<,simg4Q9I
>IG<H10a5P, \nlX7Nv83	X3k)Z)cASnO6a$=3k<2(? xl3jxGJ?_wy&2[GX/B-.RZ FV76:@QBicH>3qGgFr*T V\X|:mygC[+t*Q/r4&qL8DlXc.'L`JLN31e)rQ%A3cm <p3)W5WdGAU]"6>u4z#j2^A_#*CR&
5V_X7}V	x?v@D
[	H adb!G)lbLG=0i:z	0PyM'!-)vR 2o*w4m|wAr&'jq	jv?=OpkhNGj.4 w0N	xE{nQ, &}z MY'>yTgb)=!MF>_TBZ'H,)!;-ShvXM~Z@Awy8NXTrunNQMn%guss^aX R9(D=Ctm+|dm @&[cwG?^	H im@|]D\N-k^@IEDj'?AnfOtFm1'C&Cp$rszbgG>Yh },kl2glxhhXs$
$k}BI20i8@/{	  iCCPICC profile  x}=HPOSE*qP,Jq*Bi+`?h8
.:
x_Rh8{BTgP5H'b.*^C0$1SOf{,?_)sL7,s'OtAG.q.9,MR]J<CQT
-j/i"%$uTP()&t8drUTH~,NOI8bc@`h5l[':Z$"G6pq=r~%Cr$?-X-} KZe{;={tr  iTXtXML:com.adobe.xmp     <?xpacket begin="" id="W5M0MpCehiHzreSzNTczkc9d"?>
<x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="XMP Core 4.4.0-Exiv2">
 <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
  <rdf:Description rdf:about=""
    xmlns:iptcExt="http://iptc.org/std/Iptc4xmpExt/2008-02-29/"
    xmlns:xmpMM="http://ns.adobe.com/xap/1.0/mm/"
    xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#"
    xmlns:plus="http://ns.useplus.org/ldf/xmp/1.0/"
    xmlns:GIMP="http://www.gimp.org/xmp/"
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:tiff="http://ns.adobe.com/tiff/1.0/"
    xmlns:xmp="http://ns.adobe.com/xap/1.0/"
   xmpMM:DocumentID="gimp:docid:gimp:bb8c8b48-9a19-4610-bbe9-cc823b17e348"
   xmpMM:InstanceID="xmp.iid:54335f5c-d0d3-489b-a276-3a84cf3a311b"
   xmpMM:OriginalDocumentID="xmp.did:ec6a7969-bd3c-4c2e-a973-39e223c04dae"
   GIMP:API="2.0"
   GIMP:Platform="Windows"
   GIMP:TimeStamp="1610092708459286"
   GIMP:Version="2.10.22"
   dc:Format="image/png"
   tiff:Orientation="1"
   xmp:CreatorTool="GIMP 2.10">
   <iptcExt:LocationCreated>
    <rdf:Bag/>
   </iptcExt:LocationCreated>
   <iptcExt:LocationShown>
    <rdf:Bag/>
   </iptcExt:LocationShown>
   <iptcExt:ArtworkOrObject>
    <rdf:Bag/>
   </iptcExt:ArtworkOrObject>
   <iptcExt:RegistryId>
    <rdf:Bag/>
   </iptcExt:RegistryId>
   <xmpMM:History>
    <rdf:Seq>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:e6d38516-edeb-49d1-ad91-0f24de05b5b6"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-01-08T16:58:28"/>
    </rdf:Seq>
   </xmpMM:History>
   <plus:ImageSupplier>
    <rdf:Seq/>
   </plus:ImageSupplier>
   <plus:ImageCreator>
    <rdf:Seq/>
   </plus:ImageCreator>
   <plus:CopyrightOwner>
    <rdf:Seq/>
   </plus:CopyrightOwner>
   <plus:Licensor>
    <rdf:Seq/>
   </plus:Licensor>
  </rdf:Description>
 </rdf:RDF>
</x:xmpmeta>
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                           
<?xpacket end="w"?>i.m   bKGD      	pHYs  t  tfx   tIME:Fn}  IDATxKQ1$uHJH)B
tc	B,Uq]WJA$(,U:5spq3o2>" TB%TP	P)B%TBP	"TB%TP	P)Bujy~jTRe"PK,o_!Z_hSIhSSbjR{41]02?`c~kTd"Pv88B8'z1|E)nlc\vt-Z_* \v:Kj,IJ@ $SU\jcg4[mDHR,@{#F&58HqF;o%m$R}'JRo;s_j/O&ASOS6,.V8{Ng/}p	TLIX}Ww=+"tm|1\-}WJ]2}WJ=JO|tF5*4"+Po*ij_0<?RVj"P6dutNPJ:@l.GhOj^<KJ*RJJ**EJ*Rj[<ls	    IENDB`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    PNG

   IHDR   -   .   @w  0zTXtRaw profile type exif  x[v$D
/\x^/X%nIURD ~Rk\R<?:'?OC1>y:9ox=omF]{?Kv	0{N}b;J+.vNJ'9QYQ9cT^~ %?\w7o~$sscu=BZzY=AZUj~$ $K8e2vC eid/9
fx#ox	Wa0Tpw~99"^qo3C
@Q~ycF7!FgnYtQkRs B3HRqT!0@rY4N{m19Xb+#6&%z9KYsJ.bkZjZ[5iUiBcnig;>#<CG}>3<Sl'VYujoN;v?'|GO;5qQE.Z_lXH aUR
3|TE28K1L[B>_^s3~}2j>0*mW/@0T17WNkgL<TIDg+Ta^kY/]}9T?x69x\TVzEf~b!NQ!4!<N{CyIqo~o~o>s_B/C`~}h_}%k2mu+dUcLhg.$5aZaqf>;3jF%VcQT8''xLhc9'-y&Tm.b@HCSH9Ze/.J!HK+Nq%P),<g26j3Ch\[MN[c
Mk{9|je>w=9LULru
7	4l[kgi=k)A31)# sg2:K\	Icl}5
!+wi@w>L1"JhT9Ym	r 1okMUb-_Bl}n	n2'ih.L~Bui|,Md\fE >3;/D)NLn4K2dNA@1!(6i.^q>d0Q
2"4DaKgQ^2
j+K{w%7p\9I=Ax{qMc 1w]=3?fk-GX~hR,e1wC5g4f,6e'KO_e=@UM1FkB4c32:I^ 59*	Op_U$2D@@gxBvu,%VEROC 36d!X'_Wa7 = $^R&<@-h-	c=	+|R5%i;JS3\R&iI%@l(e`@%N9 6'c|L7/2uZh7+Qy>~!A7jZakGtV4lZp2b=vSuOx1A'h-&kv)7|5ipM|y6//q;UQ
C;fh?>NI:m j;Zx`7rCk![wzm<Ek#G1'q3ktSh$B^F[I$+go/,DU%v>H-1cQk|?=	wQiql	K1y*UQZ"q`7y)qeT|i."18A9_*XF4"_nhmOAG`TLrl/]d('"C
'7Q[mJA)fh+b(@zhF"n"8n%Aes[9_1T(]F
'!>>w	q!4CVM>NPJ3Aw:
l8:N
_5 ?.W~V'[W3)AF;D6yX"'PN|h-\_oEI)	56b2~v&kSZBsb48FDL R(H"!JZ!x-G)B=[-ilHEDY-'N~|)}Sht K	*\OEvfe[#kk=d{7ZRalI3l(f4@v,O9]H=~u%,+>iS2~JEd=e6#wzqvc~r[m{$cue**Wr%+%(A:=JP:UTYQYUeuy`ieR_V 	4i/Y0Kh6a*7xm!1&o+8C/GJB`x@dScKq&vQf_PNDl.~elSm9F/Q&j9R2gaug{Mb^K%UlTc!0:qB{E<x	n.$8l8V7g^17&1G(@ZSh;\E&	3#;DSHyh3@WcA'*ca/4V' AV"d;#e
ncNBY@F$F)\9`+-i1()zxGwYO%Z2N_J	KGF5Rv3Afwp,Y}uCW"*[{GTtvM58^V4'tWs*L9$@j:,.yyq'mNUg{+0iy8iMgwRH4<arnS"M?)_:n7hY)W:\}r,;2y<wS]i	0Cdf}Gqq5M\]&<05<|}mr46f%d7Nj|H&Ia6}<6Ausa1&"&a0_%q
q9C~19}Q6=Bw<JP  iCCPICC profile  x}=H@_JU*
v:Yq*Bi+`r!Iqq\~,V\uup77'E)IExwqq@,#|E@Az2w1}LDY:s'tAG.q.9,MRJ<EUT
-jZ/iF"HA6P)&;drmcU?,NNI8b#@phm'j$G@6pq=rz%Cr$?MX-nC`Dk3~ ,r  9iTXtXML:com.adobe.xmp     <?xpacket begin="" id="W5M0MpCehiHzreSzNTczkc9d"?>
<x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="XMP Core 4.4.0-Exiv2">
 <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
  <rdf:Description rdf:about=""
    xmlns:iptcExt="http://iptc.org/std/Iptc4xmpExt/2008-02-29/"
    xmlns:xmpMM="http://ns.adobe.com/xap/1.0/mm/"
    xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#"
    xmlns:plus="http://ns.useplus.org/ldf/xmp/1.0/"
    xmlns:GIMP="http://www.gimp.org/xmp/"
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:tiff="http://ns.adobe.com/tiff/1.0/"
    xmlns:xmp="http://ns.adobe.com/xap/1.0/"
   xmpMM:DocumentID="gimp:docid:gimp:a6e2b0ac-b39d-419d-8e3e-9d684fdd5822"
   xmpMM:InstanceID="xmp.iid:9c3797df-6ad6-434a-96bd-918d1005f90a"
   xmpMM:OriginalDocumentID="xmp.did:571cca70-896f-45e2-af53-1ddcfef215d5"
   GIMP:API="2.0"
   GIMP:Platform="Windows"
   GIMP:TimeStamp="1631766559080811"
   GIMP:Version="2.10.22"
   dc:Format="image/png"
   tiff:Orientation="1"
   xmp:CreatorTool="GIMP 2.10">
   <iptcExt:LocationCreated>
    <rdf:Bag/>
   </iptcExt:LocationCreated>
   <iptcExt:LocationShown>
    <rdf:Bag/>
   </iptcExt:LocationShown>
   <iptcExt:ArtworkOrObject>
    <rdf:Bag/>
   </iptcExt:ArtworkOrObject>
   <iptcExt:RegistryId>
    <rdf:Bag/>
   </iptcExt:RegistryId>
   <xmpMM:History>
    <rdf:Seq>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:4dcfed68-ad00-47a4-b771-29acfdb40e61"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-01-08T16:44:11"/>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:97ab173e-028e-4ebe-8b63-defd7b3786d4"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-02-17T16:42:21"/>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:db5140bf-a4a5-4170-a167-e7fd9f67f9a9"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-02-17T17:31:57"/>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:2137cb85-d275-4edd-bc35-19231cba1a2b"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-09-16T13:29:19"/>
    </rdf:Seq>
   </xmpMM:History>
   <plus:ImageSupplier>
    <rdf:Seq/>
   </plus:ImageSupplier>
   <plus:ImageCreator>
    <rdf:Seq/>
   </plus:ImageCreator>
   <plus:CopyrightOwner>
    <rdf:Seq/>
   </plus:CopyrightOwner>
   <plus:Licensor>
    <rdf:Seq/>
   </plus:Licensor>
  </rdf:Description>
 </rdf:RDF>
</x:xmpmeta>
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                           
<?xpacket end="w"?>"   PLTEgr~I   	pHYs  t  tfx   tIME	a   `IDAT0D%hR-Wm3+bt` PDUhpn NgKZ:v_?'<    IENDB`                           PNG

   IHDR   -   -    p  zTXtRaw profile type exif  xYr#9E^fwAJ'D&; 6+y)&&)l5VxSog}^?7?x>
%?>w\/w_P}@^}!
y}]9e:j>;
Wp]@gB;o67V)Wu|M	k1]x]x;g1{Z47;%gx/]|a;U9vMv7%ABzm/
7^;tN<[zB[!-Zq]^Aeh7[8J_@)s!zr7G4:a5'> %q]vVc?'Wcfqg[1E#RSA^EH,`bJ)'I%r1d%&A$"RJ+J.R)kSUjIGn{ko8CF16y,J+UV]mvi-k\mGn(N$iv @{-.Fou3[=S<W9i`\{KLUsF[}}kSf`Nt60~c7_Lwp_o78XQ8=din*I>u.-n[jFt}9hip59MMWUa\T5e9a={okto8yp9+t[2g~IR?O/$c!:yHQ)&,w.3$"r#0UmH*nX4IVmP_?W=X-cR$Qh-k9JXV|M6	T>A{(8=8suT2#fk\ -rYy:=GT
2z3ps:in[N-QBRsEvcOBE\A%k+j9
@G*2/x19
-sGTfKhLz3K%$B %r,#X1vKvlXC0Uhuu9	{ cr:ut}l=uz/2{Db%&	Zp;m7OS\O:ynE-;cjf-`D[CNUbMzikQ"x.4sigOn/,N
PceL:`Gh_ eSz	]er8]1=J,6mH0ZJ\^,-Xr,aGd@r{*XVr{6x5MMX-6sc% A}W&3Je1gC^j->ufTd+kho!x&DC`*S8N"T>%L{K&6NmJN'5u&?3SIqDb[UDfE$`,%7D}Ka1@T/yW;83aX9aP ,rzpHT|fzUhY#~uZ*kdCZBa4].a9"I(O _I4,zBttAa(k,
mbW(.5*Ndh{oe.H7T :w60	2L+b&FVynvk50`qkyF<Q x-	7x
	fStI /SeYU}
17B"a8X#{Mu#6OdylY}g@oxURUgtfl{K'Yi
[BB.U?jNqFs[2ub`\ dXW$N.
JCL(^6se IBcrEz U#lSHI?CCchjRLb#o$oktx{d1+_#
)&>jdAu	gs'oq#_hnh3oGamIT{d;;{)U^-$i
_u.KWe1X.V_FkK0-uA#}bqPO` aR4XYI)b'V."wsY;xjHTR\D%Xi	>f%I/3p IL lCiN!kUs81Es XB2{'%kR9I;X$%aE;#8<8jrQn"aXYDExld|L>{+.dg/BzfDOs&pQh2TH
@ma?!5<~p""nt9Yvlg00(/8}	vv6Cc_qXXA.x\';YUw.6^W>[k=b9@#t$]qhm[$	6fS`2j\/lX:-P btAqzZH`goPE^d&Y8$l%G2lObz8^qqrtGX|[f
>%GdqWd9Eu!7Bri1S	9[ uYAsp%$6}qTNA`GN(1Am0<Y@d}8}Y,cfi"7)Ob5"6:SR?JgtIHITBg+^t`fFcMjtJ01Fr\bsw_1Z%k$?a6u6;Wn*Fe%%\\*6cRgN;4pt]'u$vPZIeh*C-Z*-r`Q)O,;+(@yOIRW)s+ lwmb	<[!~.V{`bz' e
fh<(]<}'m(M.I9YB]hVuV?ai%fXj>(~[r@>^j$h_SfvZJ8T0T0QyHTS(t&hB[)WuVR 9 ;>cWtSWQj;Ov%{@*A9_?BzC=FiFixdau#(m~T'|
.-?Q3f8OIy Jbnr 5,?j7?-2F#~!;-@B#5xXF4]T|zv/.`l8p?690p>j;\-YA^kH6yllo_q1|tj^*.7)t?|ec>c( YjWoQu=E-[d8L, aC-  iCCPICC profile  x}=H@_S";8dNVDEK`Zu04$).k "%/)=BTkP5Hcb6*^!` L (1SO3_.9 HeaonZ:}+I
9A$~<qX,vd3aE(_pVjuO`^[IsXBIQCXb"E1OK&WBwfazM
@n<W'>&;.#i
~Fo5>Nu|cE^xwOgoi^rp&  ZiTXtXML:com.adobe.xmp     <?xpacket begin="" id="W5M0MpCehiHzreSzNTczkc9d"?>
<x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="XMP Core 4.4.0-Exiv2">
 <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
  <rdf:Description rdf:about=""
    xmlns:iptcExt="http://iptc.org/std/Iptc4xmpExt/2008-02-29/"
    xmlns:xmpMM="http://ns.adobe.com/xap/1.0/mm/"
    xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#"
    xmlns:plus="http://ns.useplus.org/ldf/xmp/1.0/"
    xmlns:GIMP="http://www.gimp.org/xmp/"
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:tiff="http://ns.adobe.com/tiff/1.0/"
    xmlns:xmp="http://ns.adobe.com/xap/1.0/"
   xmpMM:DocumentID="gimp:docid:gimp:a6e2b0ac-b39d-419d-8e3e-9d684fdd5822"
   xmpMM:InstanceID="xmp.iid:6c5cff7d-f7a2-4869-b1f2-0daebfaeede5"
   xmpMM:OriginalDocumentID="xmp.did:571cca70-896f-45e2-af53-1ddcfef215d5"
   GIMP:API="2.0"
   GIMP:Platform="Windows"
   GIMP:TimeStamp="1613550737218838"
   GIMP:Version="2.10.22"
   dc:Format="image/png"
   tiff:Orientation="1"
   xmp:CreatorTool="GIMP 2.10">
   <iptcExt:LocationCreated>
    <rdf:Bag/>
   </iptcExt:LocationCreated>
   <iptcExt:LocationShown>
    <rdf:Bag/>
   </iptcExt:LocationShown>
   <iptcExt:ArtworkOrObject>
    <rdf:Bag/>
   </iptcExt:ArtworkOrObject>
   <iptcExt:RegistryId>
    <rdf:Bag/>
   </iptcExt:RegistryId>
   <xmpMM:History>
    <rdf:Seq>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:4dcfed68-ad00-47a4-b771-29acfdb40e61"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-01-08T16:44:11"/>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:97ab173e-028e-4ebe-8b63-defd7b3786d4"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-02-17T16:42:21"/>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:a47192d0-2271-46d8-b5ca-660cab418643"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-02-17T17:32:17"/>
    </rdf:Seq>
   </xmpMM:History>
   <plus:ImageSupplier>
    <rdf:Seq/>
   </plus:ImageSupplier>
   <plus:ImageCreator>
    <rdf:Seq/>
   </plus:ImageCreator>
   <plus:CopyrightOwner>
    <rdf:Seq/>
   </plus:CopyrightOwner>
   <plus:Licensor>
    <rdf:Seq/>
   </plus:Licensor>
  </rdf:Description>
 </rdf:RDF>
</x:xmpmeta>
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                           
<?xpacket end="w"?>tRf   PLTEgr~I   	pHYs  t  tfx   tIME    vIDATA!=???`oDW\FHbZ-N.b'88bQ$Xb ECzX(2";U\='Df    IENDB`                                                                                                                                                                                                                                                                                                                                                                  ADD_SC~3PNG   eXeX eXx|q  B_ U P . P  }N G     A D D _ S  }C R O L L B   A R ADD_SC~4PNG   eXeX eX|k$  RADIO_1 PNG   eXeX eX|N$  RADIO_2 PNG   eXeX eX|"  RADIO_3 PNG   eXeX eX|   RADIO_4 PNG   eXeX eX|  RADIO_5 PNG   eXeX eX|  RADIO_6 PNG   eXeX eX|                                                                                                                                                                                                  PNG

   IHDR   Z   -   .|{  
]zTXtRaw profile type exif  xi><J{;y*ZRkHd"('\9'X}@VxsM>w~><pu^wa BeEf9x&3Pyhrq	}BNszI}fXL'x@?qqPJMs&yfB@~aV+*oG_Py;'>3</o9ry=	i~Z9Ny,-%Vx yR-Q4~`/_{? i(.N}0yo=x
wza01*8_(/b;V	!g[/p NC$G 1sM| D;1	 pe	I\"B|w d>xn)r,H!4$XEpbJ)4r1s&~K*A&ZTVm8kZkm6Fn<{{ko8u6ydAWZy;.[w5q75yRvcyCGKy!&'01! avAg]3dL1@0.iv}p/AO _Mqw4^ymK$J`r05OsBrL^5Wv^'Hy]!H~4F35 (_PS^{vg4GQ3KKeI}H ~e Nbj}u, enLV1sR	%pBZL;9Rz\7_5Xy[+qUH/a	aq!,y	'vxR9hKRK$+$:IVA+{Keb`<0DyGf6
D%#@8.V<"rPx3HWM$6J=)QFsh;4Fm!d5,H^r# g6?-lk^p40M51?t{to$ de'i<A|T]%Uv3%LM26:Kx$.*fI
{qK9JwbZ2,@V9hpg@m5f#"8z^,9TjZoLs+b#MHR,mjp[JMSm,}Wu,4HLTX`Q(wPB:'*)}GA![q+yH&\kB7"Rq	DL9>vqL2	$R`~aG7p/>b6>wk57+	EizSxq(>CY4,iPI2XEp4nh ]}&s3G>XXTd.o[0Gu8.,wZv{V$Xf5e[x'x+{E:KjU'
"BZZU~vMrujP)vc`d Ly7e&WFY{P!-!z0c79|3JJr Y+rI*z90S5TbW@d%I0qt@ZsbK2bpP'Dhb5	47Hqr9!}	"W1P1w(}5(1?-*b	+SV	UJ>O#VkUZ8O-_][?lIQ\"JRRP!|m?HUrCHR^*zuu?iB
_JD04y1f[,H'^knL#Lj],:?b<"LZ`>$1^(_a`slg`)df.n[Qz(rO,UT"M.Dos4H5rV6Bb]TQr$e+dXx[SX LCi;9adK081(pTZfh3n t:$,DF=R(JiG`MGm!15s919%V0'fipvA)
4Diy7UA:r,AjDl.xb:9JyA}ch0ih/DeY\dmFIF<oDjWgZNN/?*U+%tImUZ;A$L 1kb{e  iCCPICC profile  x};HP*
vqP;Y(U,Vh/h8
Ug]\A"%Zxr?{{Ff$jlnUyECaz"g}S']gyYJdO$caoG7->q$x?r]vsagLj8H,;X`V2Tj/d]V8oqV+5'a Nkq,!$D
,DhH1'%FTBr{fazM
zvfmy+6Om-tnmM.w']2$G
)kZ8} 24){s5mrxY  9iTXtXML:com.adobe.xmp     <?xpacket begin="" id="W5M0MpCehiHzreSzNTczkc9d"?>
<x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="XMP Core 4.4.0-Exiv2">
 <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
  <rdf:Description rdf:about=""
    xmlns:iptcExt="http://iptc.org/std/Iptc4xmpExt/2008-02-29/"
    xmlns:xmpMM="http://ns.adobe.com/xap/1.0/mm/"
    xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#"
    xmlns:plus="http://ns.useplus.org/ldf/xmp/1.0/"
    xmlns:GIMP="http://www.gimp.org/xmp/"
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:tiff="http://ns.adobe.com/tiff/1.0/"
    xmlns:xmp="http://ns.adobe.com/xap/1.0/"
   xmpMM:DocumentID="gimp:docid:gimp:a6e2b0ac-b39d-419d-8e3e-9d684fdd5822"
   xmpMM:InstanceID="xmp.iid:9fe2a14f-a63a-4bc5-bfae-07177a8ab463"
   xmpMM:OriginalDocumentID="xmp.did:571cca70-896f-45e2-af53-1ddcfef215d5"
   GIMP:API="2.0"
   GIMP:Platform="Windows"
   GIMP:TimeStamp="1631757583141735"
   GIMP:Version="2.10.22"
   dc:Format="image/png"
   tiff:Orientation="1"
   xmp:CreatorTool="GIMP 2.10">
   <iptcExt:LocationCreated>
    <rdf:Bag/>
   </iptcExt:LocationCreated>
   <iptcExt:LocationShown>
    <rdf:Bag/>
   </iptcExt:LocationShown>
   <iptcExt:ArtworkOrObject>
    <rdf:Bag/>
   </iptcExt:ArtworkOrObject>
   <iptcExt:RegistryId>
    <rdf:Bag/>
   </iptcExt:RegistryId>
   <xmpMM:History>
    <rdf:Seq>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:4dcfed68-ad00-47a4-b771-29acfdb40e61"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-01-08T16:44:11"/>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:97ab173e-028e-4ebe-8b63-defd7b3786d4"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-02-17T16:42:21"/>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:e84cb049-b06a-44bf-838b-4acdb5320b22"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-02-17T17:31:39"/>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:467cee8c-f31c-4d9f-9a48-a60485ece8ef"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-09-16T10:59:43"/>
    </rdf:Seq>
   </xmpMM:History>
   <plus:ImageSupplier>
    <rdf:Seq/>
   </plus:ImageSupplier>
   <plus:ImageCreator>
    <rdf:Seq/>
   </plus:ImageCreator>
   <plus:CopyrightOwner>
    <rdf:Seq/>
   </plus:CopyrightOwner>
   <plus:Licensor>
    <rdf:Seq/>
   </plus:Licensor>
  </rdf:Description>
 </rdf:RDF>
</x:xmpmeta>
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                           
<?xpacket end="w"?>ij   bKGD      	pHYs  t  tfx   tIME	;+Fi0   IDATh1DQCH@@NGd;_f;8Z@OW]h;|a!pw=vXX`vXaGCh!4v;Br 9@C!h4 r 9@C!h4 *Z4prx    IENDB`                                                                                                                                               PNG

   IHDR   -   -    p  zTXtRaw profile type exif  xir:s(k`?_-	j{&"l5V8{l<;sQ?%?>wC,HEEi{yNnCL
kY6W)u|,_ouK5<]IsdYe>Gy^|)(!_><~K_;9>/Oy=qiX9-*&yU^bA:E7]ssn`b PG%0Ax-[t	O1T0O^sV.I9}*#qG`:nlyN&W2ps'qBr}q?
i$>D	KO1LpS'}f2$?%
9RH1SIjj9SdVB%\JRK Qd)"Fk STw7.hz^ }FiQQG~	N<Yg[nJ+*KV]mj;lugQ'RzayF[KyNx^cfNcf*N#Fr>m[>Gq"jSf`N6P~c7/M30I+Y!3s9X3Z'5<0Lq6[__fn#l#6:?=^'Wg	c5V;Qg_Rqu7 e.;wQ\o+hr!;{N 5NYhFCK[6aa^8w?[CQC3Hd	%ZXM#&XGLmO4J48YpL; -)\:(9b!l#4ShagpO=Xc#XJf3jOI`~sA#$sGP	1c?XTub<[{k$H$ hwqi,*b&j^y~|`,%3kO NvumL*=]uP>
4"t';J>Xv.sv9u8Ru1g'ql`9:c;$hk6c+en Lamh vR~0>^(yI b$IC#tG6dW(7F"#-C4Rv-}bJ  Y+K{HfWDJm;@0s44#RSizN7!E7eEBr!mEI k'Xfv~NFP@O+kt?Wtl 6	kF 
Y9
F,Y0l,uz!) bWRa	(A*]#7TYMQThrj3Ng\ u4L:KzrfQ$r:;\=p
SM#(vky\0*&{
BMW3o &CL$&QYQjYhkgWU ME"v?"]ez&)(MqZs05(% \q~ +xL1{;<jb8xZ+yG.;'.BxrKjy<K
r>DTsdM=Y;q|'N-Nic!{i`#;Q+DTH_NMR"u,Z"{SMi)A0;NH70)jm+.Os)fC]U5IBhk(w((hh^B:<=8dg-1LE.uD]Su=[GzP2,	j6|gGk\R
5%icuh/7 =}Bz+.Md
oPT t?42K<q	zq%/|[ N8xS&\/}F	S31\fgTI%io[73{_@ b1>RZD:@R0H7+(/HsG&![-j!(iMX4LWNE-aV5I%G<@ka6s@,D&F 8Uo+51bZX-h_7Aue0HNJA@"nHJ6Pf$l>i_x$s5U6Ofl~/l~?I6Ofy2Mr>>@f;@Q$t#5rKUafvn09} c/J',Z3A{$z5wBEDO{H	rShRz-)VyjAj&E]r	KA`px!l6F Wj-T{h7>14-id-={Y9xZa"LZ;^[>n"ZN:9{TqY<,dQVUl]FZE3=`\Ps3 1?4tFZ.D=:}7
q6_~yJ+A(yVj
\g>D?Z/jXYG}%5i=dYa,+*KR={sz^fonql@IEaf)Y!QG]dw/:hm)>$SZtAIbKn0UR*]oP<@bGhfp3q:wt{~mq Szd
lRf{g.A* o<9nXFn*ApqWvZ!A)tZ]dwhe>
 IFyZY+7
Y0aOy`\6dG:D!p.5U0BjkMM>7J(M=BN
;YNU!3B4xu52{~OI7Tx;'"#YAFizW)ZQ}Y|5.bNtKEw,dFmeFT7}j"b *zRt[EPlHcCKGM7]dy>i~bW8T/	OPlip)W$bKM@w0TDP-Dl7tG\tu}K""0!2-jc(aunBZpHw!;$>dy586jg#-	,rjiI:,hthHjPd[/[ F_E7wW$A;`*edTX/@"k9U`klVKC|3JC60uOxC\  Vt[m#7!E#L}QLVs"2HeQLzx3en:a~2?3?wO6gxmo03&A.9%|%Lr@t9)ZBgQ%lrZrW'wZkfKq>0  iCCPICC profile  x}=H@_S";8dNVDEK`Zu04$).k "%/)=BTkP5Hcb6*^!` L (1SO3_.9 HeaonZ:}+I
9A$~<qX,vd3aE(_pVjuO`^[IsXBIQCXb"E1OK&WBwfazM
@n<W'>&;.#i
~Fo5>Nu|cE^xwOgoi^rp&  ZiTXtXML:com.adobe.xmp     <?xpacket begin="" id="W5M0MpCehiHzreSzNTczkc9d"?>
<x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="XMP Core 4.4.0-Exiv2">
 <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
  <rdf:Description rdf:about=""
    xmlns:iptcExt="http://iptc.org/std/Iptc4xmpExt/2008-02-29/"
    xmlns:xmpMM="http://ns.adobe.com/xap/1.0/mm/"
    xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#"
    xmlns:plus="http://ns.useplus.org/ldf/xmp/1.0/"
    xmlns:GIMP="http://www.gimp.org/xmp/"
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:tiff="http://ns.adobe.com/tiff/1.0/"
    xmlns:xmp="http://ns.adobe.com/xap/1.0/"
   xmpMM:DocumentID="gimp:docid:gimp:a6e2b0ac-b39d-419d-8e3e-9d684fdd5822"
   xmpMM:InstanceID="xmp.iid:2c796187-0460-4c62-9a2a-05c9dddffbc7"
   xmpMM:OriginalDocumentID="xmp.did:571cca70-896f-45e2-af53-1ddcfef215d5"
   GIMP:API="2.0"
   GIMP:Platform="Windows"
   GIMP:TimeStamp="1613550655623228"
   GIMP:Version="2.10.22"
   dc:Format="image/png"
   tiff:Orientation="1"
   xmp:CreatorTool="GIMP 2.10">
   <iptcExt:LocationCreated>
    <rdf:Bag/>
   </iptcExt:LocationCreated>
   <iptcExt:LocationShown>
    <rdf:Bag/>
   </iptcExt:LocationShown>
   <iptcExt:ArtworkOrObject>
    <rdf:Bag/>
   </iptcExt:ArtworkOrObject>
   <iptcExt:RegistryId>
    <rdf:Bag/>
   </iptcExt:RegistryId>
   <xmpMM:History>
    <rdf:Seq>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:4dcfed68-ad00-47a4-b771-29acfdb40e61"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-01-08T16:44:11"/>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:97ab173e-028e-4ebe-8b63-defd7b3786d4"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-02-17T16:42:21"/>
     <rdf:li
      stEvt:action="saved"
      stEvt:changed="/"
      stEvt:instanceID="xmp.iid:4c96e235-a1bb-4f1d-9b6f-850f2c578d2a"
      stEvt:softwareAgent="Gimp 2.10 (Windows)"
      stEvt:when="2021-02-17T17:30:55"/>
    </rdf:Seq>
   </xmpMM:History>
   <plus:ImageSupplier>
    <rdf:Seq/>
   </plus:ImageSupplier>
   <plus:ImageCreator>
    <rdf:Seq/>
   </plus:ImageCreator>
   <plus:CopyrightOwner>
    <rdf:Seq/>
   </plus:CopyrightOwner>
   <plus:Licensor>
    <rdf:Seq/>
   </plus:Licensor>
  </rdf:Description>
 </rdf:RDF>
</x:xmpmeta>
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                           
<?xpacket end="w"?>X_   PLTEgr~I   	pHYs  t  tfx   tIME7zc   ZIDAT DRP20(@@l6N:d}C65nJe!XV4HJ
\P5/~PxG    IENDB`                                                                                                                                                                                                                                                                                                                                                                                                                     PNG

   IHDR  d  (   o7   sRGB    gAMA  a   	pHYs    od  #IDATx^pyo[Wld1888@K!C2J'fIh3MBJi:t	f()SpB^1l
`%mw[5cK9gf+9ItSG  D  !C   `2 !  @   `2 !  @   `2 !  @   `2 !  @   `2 !  @   `2 !  @   `2 !  @   `2 !  @   `2 !  @   `2 !5riv}?wNsYqH;Z.M+ L@Exaxu?YE45xpXOBX!0f6%hs;v9D\<Z"ZP9%? h@`mRh(xt@ 8lw;`]<?dC qca<+g<K&xtqV%Hb n(`G?%P B [hOC7%CDGPpiz" _6c]bxu&@p /?K1aM	D
WG c:63Z*5]/yX@{>3O2YYM6g;r<v5"0VPrJCp.n* #w	l_]ZYaErG6"m=*H`9":u	Uyt4\/#$@|8W4	HiyjCx,^xxd^<zip/FvdU+?`hsxGg4G3S	ZC_OiZ<^jON:f~,A wO] >,I&#'.mlN7Fj51avvV[C?-x\n*-}^AP_KE\id=dKJC1%x~Z'Clw'W|\B0qIpp6m"E0?.f3[e5r'x&B0w1w{sm2
N|4UHA RqCOqbZ^a}{{w&'Z#B@SZ'I3RcA*<o;lszz.%?~<sRs^C4 5*'^8F}c(@ kyq?H<sF>]4	As;z;<ZSRiddux$N({;VJyvFyl,bikwo(o0sp({W7)cAJ  rsGf}]?~d
q}e kw%ic0W5
p."UiGb O4w7Ma\QrkGoXtJC7JhD8{\^5
@,IsGbpU[^O3OxK$qqYHE8F&S~o=kk@$h="[~Z]aF<z[Y8[K.qKnot/4~}tM",Hjc{9:'4<}{z+;?mzvpMsm~YrzB]"snzvSxH;s`e'LPT#~eq}t]Cm@tE8j&|4vIdD?WetfU*hC6g0j0O	<
5%{$=(}j[.9m\:iS;k* JCWPL%O Mc5|A;2Yi:19KlMNus0>="7LL&W-P-U]^V,/A?nT?f:d>19vC\S1P<B<+1MCHw#mD0,g<[VtNI(@%o4t7i&Da%1[-[[@=9#RtG_y=+x&wN}{juVU!2TA ]M]XV7lv9eD|3
~ix1bChnr{uD|ywoA].m]F~sRE:!SS|Oa8n&T{F1IOWsOuiE%v]@>=]EbvI^]RO80:<x9FanS/654M/@|'q~5QdL@1L;rq*5	r/z;:zC5U23vTxgA!	
|c^+ Tu+_F3Xy:)To?Y&fg%Sn\y2y2M\G9m:g"|:_89c\{wUsFt yQrhzee
>x0GB|aQ)H_;0vAT+Eg838<ahB(75I0KxA9T^c3p(-kNQ=4!r@\Z>5Q.qY1NQ\:bF
f`;2yL86yZC |Z>Mxcs\_5*d%zOUV!@_QOk
F@^ {. a06h>/M&,\HL'%^S0:dw)r.SqhO~LMmj[<\s$/l4D	[)^[=CrfR(cGb{[Wq${m@K?$>vAQM^15+{kskga A~/: vyma=kY/L>;
sx	K	-g_%MEnx~!SWx	st!yZ2/9&/'Px=/5?AL*0LZ!%
/5]29;d	P`Y.
1F.>W$riWcTa0f;QZ5#c] K%w	Gktv/%^(*Cwl05rMsm"sUzr?*w;.d69^{0<?e^Uw ?P]5.yd
d,vSS
l"9X[$^8AJ
oE9rm.j\k/
]	+[m+}y5.s5!":p[&7$d6x	w@,Yv^qdO w/$?.Io;0yte@-yvJ
`aqLzX
J^p(|,vW ZWqMa35nwCw#uk0#DM>uv/_2k E89+Y0k]u8"*0f`6	[ ev2bYiyEs~0If\qdE I,[0]2k^Z#+]b	DZ4%gmi^|-u!C"K:2YYrJ2{e<:!T/ND{,C$	~9K.rBtCA,!@f!gI%!kcE K+{+ ;yk1dWlE e$+F:,/46 xu*":Y>!C
5ndG3u/<6,,Y
^|DB<4 .#!	,^!u)d/d!y7$,^@}lAfcd14;:d[md0Y64+"yE-M:Kj+ 1:,2bY -vhue@CT'k :d3e+=dvy-YL'sdZ8_s ;5|zkFB"3Q;$^X+t]7vs*W6yxu	\oZE+{Yo$'},Av^qdM z4Q<dzWd^{ah2-^HCfatH`0vW0MgVbyvZ1I8u)jk\k/
O[>[D}\d+K=Xw }[QwyNbm*OjV-
^ze69^{0<L{MzC%8imY},y>%!YvMc~<r/@mz]rFw|5-5^s022-9-xqq<T/)>IT?AK~On-#@`[k:<c{[V0LXDdw;Ep>+/Cvwk=Gw|P\^c66$>%7"?p=p."b~"vymX|r?|Ch
^0v5N(`'GcE4Q\2^[:{tNcwO(d.Wg^r)jV&^S {V2=j_x9\s~U0F5+fg} B.O">qnx-awY|Vp%s?i8 ^dx&d^s6	K~^SP6O&;yQT% K>
0B(p"5k	FX1E'#}R=B06\DMrmb82#[f{<PIa5Q]Pk<)@~]23cSnN{EIVL
,,k?.Pu/0m\1QZv`YQnMo9ZP|#1f sV%
6u5&gwo"\{u
a.),5(]-O0&>ZFg\i[!:[|65+>EaQfDaZsqa,$VT9ji}dFAv2]i#
5B>IL/S6W,{Ag&vy83`6
6x\!c$|z>`[z{"M0_oSt%=:;+T@ ] B'b00q5MucvyV78twPx^`mfW*CGr8M^n~iZUP<BKNjFS
zfa19Pf_jb84}e7G=OB%mj#rE90!Bg9n`es#l[+q'RtNQ
;%6|CfDg["5g{ls}7DrK*uA gIftjE(NQ].s*Q{C[<2gaT9K:tcP9xwkpr{iN8!1v#t.yjJ7K%Lgq34V=xV3ci.]SQ.Q.APsJ4?/FCyxDXLX,3yGc=4]F6om5ccpzAT's8/aZ(yu==M].C' {zZP\wOGgz)M[\kkC 'J<CS7qZV5p5@ KlK_tm_4C<^{3D_z'I;idC5^)FgujY/|jB :]n]4x&@ +p=T_(W&nyl'0z:e.06f
/
|SMy_zYA4{T:kkY>:~$ml;JW5[>b<R]V@o?02Y.o0E]=:',1)
XA +.kwfuw99-`o ne3)DY|O-no>]ovF02YC+wv|$H;sAGkj]*Mbu;]VK+b|3Nf).}cMgc~/mE|U5/H}/gTa<uU{?#I0?Q|Kpzz.%mnr\kX%9`aO{,6qUDkj 55,BmfuTbcBz~x}{DWbCM$!q=lfWz\b\wpclt[kTt<^/a^uQ@6NCVxZT?=!I"~a>~8MgM#3_@!!AwGeA]U`nXnAh].BW'd:3Z13$&r*x.jON"Ox/v]~v >\I?:JG?hyuqp0x;.o x;~qG
>xHcDgvZ^=UU@=wrM/9^i9;:|G=q21A17&Nt]5^Y$m@{E(OP/HKv&\&ziu&4:f\<
*[=ZCA@0[^0(ean!qG|i9".]Zt CA [G7%CDU(DWWG#@:a~u$A-f"r]<\p<d26pp\fD"Er:0Vd3+~0w9]pDdA $klnMw~=".J]O YQ6V	"|9Ky4lS6>qRG9|.q 4C tmDu"T{jCUM+&ua,~SL@:9:Qrg<:[sq"~?<u V@~td  C` !  @   `2 !  @   `2 !  @   `2 !  @   `2 !  @   `2 !  @   `2 !  @   `2 !  @   `2 !  @   `2 !  @   `2 =|D    IENDB`                                                                                                                                                                                                                                                                                                                                                                                                                                                  PNG

   IHDR  c  (   ]N   sRGB    gAMA  a   	pHYs    od  "bIDATx^Ip\}}'V\DJT>J9d'lWRSlrSoqR.$. !R+ ;2cQ2Wju7=;cplzGU,b9aLD 1DD`9aLD 1DD`9aLD 1DD`9aLD 1DD`9aLD 1DD`9aLD 1DD`9aLD 1DD`9aLD 1DD`9aLD 1DD`9aLD 12w{"j|Eq)D589Y/^GFfL8%aL!<^eVn^%B9/q5xp'aLi[\biX_9$qQR&1|_!33SeaLBL}0rNsYEUD*1GvvvA!*kDEU(DbKSA H^|P~U,Q3'F,Evv(`.ga!L1bcCNN590=0?'&qyL5EI)F<C6V!80%m<1
, VP(j)r8bP0d=ix1q4k2</F#D\at*[8&`Q
/,^&k3qF1-Q2^<}bjbL('8OA-DPhcy$VIn^h;u_D8>Fe+0;v(**
^

m1^_=4nz$eFivfqlQ0{DQqqqM0	;cqqQR0vjCOd+Eee
X,&Mx\LMMmA-aKwb11*vTG_eW/N[cE!c#CAQ444Qe&0b;g~
d(nSdalM1n.`,z8MD 3crn>.N<i|CXav'ODooo0y3alDr FGd3g:EUm<Cc[{e Rapp0Iyqjrmjjj
Fca<czj;![*![[m\NQ[=Le[**7{lnn]w<cVaaaI ?'aQqpIdg9=uc67w&B[8faV{u "+!?.s}d05IqbD<?;#QZZ*._s!|o9#
&K\`sfSAS {zzd
EW05xxY(E vsNP0,:_-aw-Liii	GD(y``@[9=l-c3S@sZ4aBzU5L"!3
qE	1sE-2a[2	LyG!eLycA|Y3=9>{<^iX_^4A~goj"462EPQ{[E7,b0~`n-865~Gy[8ZDss#_|^YEUP0>"lDu*))	eeg'?]]>:WRq>i=76'O0>aH@_v-kK xy9uj[op!_F")Z-= a8>:2vV6X(y-QRV.[8E)/]z5xxhx/`OCUo~{7n^"qweta a:]0#ca:UP%9ZcG1Bh=~z8;_z#Q+vBGC=
>,P2jd6a|HomR,J@|cD|DPfd Q<dmWdTc@zoG>@TVV;(G>/CUe#igzM'Dc_Ja0>KR+Na8/P[vV|ulww"k>z1F.wV?v.:	qd,1u?Od|5qfGvtUZXjKn:!_1;}HA:tkaA|"gBmA)ktt(]wDC_CA{1_cey9X0^\n<ZF)FuA_+sOa#CzO<l j[24pce	/PW0:O1_0/&dK<utsn93#}OSVt=+F;p1`xSX0gW)c5,ij>	Al@%mV0wQ+w #b>,>aKnnF}<2r0@]G_q a,777[=Z%sm'7UuvJ?^3A=.7qZa'viq/w|}ooo	OgY`1>|>(Y>Qi\K(u1Uwtrat/[GUp-qt|43NL5*|.\U#|ucl4:wnnl5S`_3pmQjqicT#|uOmSgee9~gU"T_[>6![j55b5GRkx8qx)}}X%HaoRc'F,ODr>kL(2U16}5;0s=[C]XR70U}Eaz
?	[wI?Au_KT92wsR1z<%(aZ2xXe+}=<c,<ryM\k`FK|mUcpyu?~\/6.O\*wvvkjj;3pb1Be5kUZrqkykW';_C6*bULOeDFWEU^q||>?qT?wrt*oxc}=8T1Y[)L/P9P}E7ad#yLUq`
*--999 }L'MY^ ,Q*oRn?,
<Y(U*##092v3]7/xcc]VLoq~&}tPqZ"U~#gddXe:*0^y'LOsTU^QEoomw39*f0T7092f^tPU^QEom ~|^gpPU^QG+66]3*k1jXH0^tPY)bmo*L')Rrp6/i}ey22V7jGS21G{^HkD.PU^Qq"0R8O|2U^QqL[;Ggewcl+4aZSd2M_tG{dd0XL#^xa'X&)Rd2/pdLqx|g1xO,Sh}MAczdL7)R(01}/Aegbo^q4~1i7}BeWy-Fa\PfrdQU^QE
uc7kmuyUT^QE<J1G*:A\z^1Ffl@_0xqAZdx##092;+;/`~~xI>>77'[xoqN?
wE>\Tq`x9|gK~QPU_QM1l }yE%]c?D@6	}}\^Ty%eGY|G>QPU_{QUULu7_C6Pqy\]0}~z|`Vqy5>{L(c?w*7!-)e0cOwv[|_Q])XL744$lq1*^]]>\k|pcP}3AH0~Q|GQdVoaR (jk=}SVq3=PSSyjW$dF. 6]wpcu27zx3/9*=.Q0=[O3??rEa4}1:<oj~s?zHlmm9/dJ>?[	Y]T_[>:Us)]NlgwU8u^bQ\R&[jcnEGpmQjcSgm+|QPe<* /cU&~D:	>zk(0FS1F\d\ ;`GWUzpt|?~X,//yIqT|tR-_7@&p-0Fwwc !.l>r$ORYEUP?b{9b R/Okx:X{e\-2%Y#ve#YEIt\;aR\Z&+eK`GpSu,@c+9}Q0_#")>_"t'b5(*.2=.Ta2W]>Pa-ZO<>b7T=ua]s{:V5
DK1;;+[gEe	Wn%kAQa]c<~cccC/YRn% }}M#I_1S6}5ZIj.\pRY"	}LI6p:cz6#ba~N.Y}b`Vk%>|([j7-Ra|EQ+WDkkl7FP%d8N\[nzzk0>>1T_ }s(#xz+GMOO>Lk:&[xoA!}K,-b1qUQVSL?|pq0+E1iqaN<lWPP ]&JJJPd^"4!Qwu"w1S0+FzA wotY9|=r!'0]Hq}}S<_^-^}|:A cka&K"qwetahanVtF#d
`=L)aQ` NH#bupG06:,{n81(eKY-#6 PGRQH'=}X<Vun{OFs2+qDPC2
d"\8^}fMyS{543E1]173%[zdgg\_g"
Q_h_[(uSM3oXLEy|>;,qrrsEsKg>`460NSqIQG7-Pgei25cEz]<***jjj`D<33#UmX:Xl{/_vz7::MlNneXGi3,vkii	B95HX__B^U9awlC.]$99?FFF **EKE615m1?gt`L6=}BqcMvvBg2C WWW32C]"x##\0v~Dgggd"E_S]"3Af[2rB-1"a06`ss#1Bm`)N2ja&u\$sr	MFgY*Zw My|fM~Uc?Fd&|\oog= Nwal~z!O<)RappP<y$co#1-*Ph9++KTlmm`7ot:y\03,zv<c@ #,// 6AcTG'ekk+sSWW<^^1yCqNaD OMua'a'rCCsZFv[.1"60vNeF:07.@aKA /:Vxnareee#f~1tA\xHb;jxO=5nA:1+ |gggC6&[vc^#,Kqqqp`f5y80,~qq18 km?`lVXYPG<`	x}Hh7Joh'OE	8$S_#*OrEIMd<NMshcP<"9;/m">`^):JEcskJ`G|wc:X,(GTg'(yd?R|ZpCKk0&1#f}mM%`=rWvNN{]}gWx;{

Em}C"9C^b{`zr<79+!#xz"1ZgZQeC<1:"&GGI=<]][/j8Oai1=5!f&&99FTTV[aL/aD0t0,_Qu#(c,>;=+1:haL)f /E%nE%%SH91 0'E%/QcSQ3.%rrsoQq"K_0icRa'++J0k1,?qD{0&PXM#l8xVpng{;x6^g82kp.3hc&2aLD &"r c""00&"r c""00&"r c""00&"r c""00&"r c""00&"r c""00&"r c""00&"r c""00&"r c""00&"r c""00&"N:l	w    IENDB`                                                                                                                                                                                                                                                                                                                   PNG

   IHDR  d  (   o7   sRGB    gAMA  a   	pHYs    od  IDATx^Ysw"!6cEJ*E$Tl1K; t37]26pd  Wj? F @ d    2 @@  A @ d    2 @@  A @ d    2 @@  A @ d    2 @@  A @ d    2 @@ #lomks+{L.{OLYyURZjmTMi]]5BG 9{;K;;JWeUsUqX.k)>w5UhHsx}u~CPZZjjsm}}@ D
pn#5	m5,-Y07?%%%4@ KI:^i*C.[]b-/.Es#={Q^^aZLK.[]i2{{wu'K #lfL{ihm0W{L}p29s3fY]^wPMjiiwj3|k"5MGWw.{X>W>A+]=7y 3dblLsYQrww+9f#F>(^u\w!F<=hY\xwE #B kjbrt]K2X}r>#/m{1dof#m?\bjkk%n#>?onn|fi>smm!kUgf3*.	=&O]kkk(.5n*v\*MMM&Wuu0mmmZXX0KKZ`2 vc=7*F!
XSLS>C.7Je._wPLO'a|f9m?11a&'');{m@? .QEi|SSSnXn/m@.m3c=Iggg*++]n%}CPdS_<}bvBKS_	Qjfxx8YrKl@gOxhh
aq}|BY%uCN{@. <6:l[q__`w
o`(y@NGQS:6jB?=N/{L4'O$)+{
:D `<}Y_[wu$8FGG`~0g;1q.],gi.Ct#21LX;!<N<2~%Z|WQ.s#E{'<+zCb9)!!=\'[N7o1BfWKHd>.Pk	/w%i;-O[JK7'C_;X_~m[($<2P-DNB!y=L3inn6_}2nvv<z%~?xPsSfl/%K_~=te[H:Ok+o[8"Yg}Ti=;{f5M8gFj#}qST>"/H./]V__o?%gZOW/B _DrBOpMc#Cz=^;L%dF_<-?6g6T#Ty@>'|;jc$j'.C { :#_|F`^4T8d!6~okd!KR-&^x=w)7jC bc}WLKKmQ-|Q_P)^{||s)/>Dh;M_t~| >V!?ckk3=m[1_7G$PTs>\+676M}Pijj-/G{Q*F'LPR M9S%D d}uN;z9z5!?251f{cqsT{Na.=k+^
CX0@~K.qZTMKldKG,/.;-T>e>,cUjR/1!s15M!%\c7+WljS5:~+O}0F]V>>u} u=pP_b|q-gtbZu>Y'>Q^YYi[@TS*r1QZF5zy~\
u=pbm 7m188huo1J>hk1wUj2{eii;5>2]-8]e]z
}eq >u kY] o0[[?k
m^rkN59MtzN
d8yu]qhWi[0mqvQr{{dVS
dv&KU.k[}QDddfl
U-lQm]q,@|kcdQenrtuhyohY],'-`***l&xccm7NM r#*G>|@,\>1eq,NE #de/d*0BF4TyW8YcN['"1:Fl\EQ?Fw(@>8pW5/fQ2o!6.ke_",@Fl\<S'cd)1eqN.gd-a!$@Fl2#P9d\E@Fl!'@.sPboo~],"(/f#sb0BNO\Vf@FlE@Fl\N1B>Y$#d(#d$q<c\g1eqN2btL )s\e3eq2,imm~8Y\peYE \l2b],"kdDCwe_(TVUV%#.k]}P}E tr+[!#..`V1B F#t1BCm+OO ;<33c],&+*+Y&5eU4,.!#\8gU o[__g2Kwe~sQ2um{YU 746Rw	ddVS
0xrYs{8]T,.S7oi70]qVW^o@6~~s_Y] mKqe[@q6ccc?5;Y\?`p= 
_|<;(i\2'9-8;?>(y0mba.@Nk[@qQpbm u\u{dd~URD7gmA5uuE7|Sv]bt|1Q:SWh[nKFPDOodit\{ 0JFPB\DzrKNQ:5Bu=xP_buE*.rQ2Uzfcc6U1:S[o@X|.@z7w!T#4I[lbC [.JtM}G}!{~sG~jQ5#=uMN
ibb"E[^#R!?R[Weou4=k+p@~/_S|`-.6omlKA}
'JD dg ~Tk_>@?xAF-1CKo-]rI#Rm|PP{){ujJ>;:m,,,jN@>d}/?mR-> 3 T;!'x@>#sflT3/}70d._-jF9p2jkT}G 5O`~y|N:fm#?AQR8F _@gWyA=_jVVVPm~:C _}d:_355e vo{nB aRum5O{R|tVm#}r**+/mr6_WA5F<76x?id~gjQ26gya9;ddh|m9!#8?k[~{Y4E:9B!{fiaO9LM8ZZ/-1|ah1
4_jln1w}c[(4~xhV;vd N{icCc+%$'GGfe)PnhhHBANaMV!!=74wM3MK<y;xw?0qhdj\RR.CA';	H;VA._2K
KKZUG0)/w9%OS]}$;::aff&	C~L)n~q12OI*^344?nxx;qc[\ cm3/_Lt \ 3f<Xmmm58d4 LD=uvt;(riOCc(W\wq$i;qK]6O,Ztvv&bbiw5Cw4UU9/r<?V>swws^B8#Z;s#tLr@'`g5/ >;JF zkMa|L%UgVXBC54&a|JbF j>hjj = xiiKq6hzmY@ LF{%Vlhi^N^UR48\[[KbTq`v B W1*~etZr)}~|-->?k'7K^3n@.:j3m &UqK.hezxgqEhkkL	v2kCbA %316|";LO@07&
cO\djL*Q1F g]y~WyEEy|gWw394Jy3af&fapU\6]0a>@ G`an&96tq!>@^ggF:I373nw[Gif1@Y5KsfpGyyink7-myX.mi\.@dm0lMh$p[\ q"-[^7)k_R[W\[_o[Y/d2`>o%yS0FVPQYkr!.B ^JLlm&jw!d-?.UwuFTic;>{G):P&~&Jsm]|i
]]L9 @ d    2 @@  A @ d    2 @@  A @ d    2 @@  A @ d    2 @@  A @ d    2 @@  A @/^p)    IENDB`PNG

   IHDR  d  &   UG   sRGB    gAMA  a   	pHYs    od  IDATx^]U}>&1"RBXP:#`v,:j,`:> X*BFE"b%o}]}1PrsZ3<8z;+7 @ *#2 x@ O 	 <A 'd   2 x@ O 	 <A 'd   2 x@ O 	 <A 'd   2 x@ O 	 <A 'd   2 x@ O 	 <A 'd DsoR~8_dKCQz H~}_>H#QB<<FiILxn1a{qH?"KL0w6av+aO8fO->g"36ODVl? #Q]:XgBw]'UP>YmG<^#yL!:]gX5#IC@}Q=d9\C9ql!qx8:]8x0g~SG &|>0obJ	euYC c9D.-rX6b9 O ~9w:bDVj#B+Z@XL ]H(]bnl9iXa='^vy&amA ;
f[!wgdzQ,,9pH0biu6&"kO{"e;;Fw]0qTFp;l_;bY(85d(8 Cb31'XU@znd!Zp#k]	z3/k)(o0"i-N7<ybDJf&X6h2L'W~+c?x@m.QZ<Kw<l}7dy^V4|V7V1(gN(Fo<ol%y@mM-e0@vl~Y1Co7A<U&i@ywj7rg,'7@M#=rB>d~\lIS9M9&kw~Pjr#=Mo+p^\jXs-4c&M0o]~er-#lq1 ily|j~h_Wp}_^V7PS*86a}F{t[R[;es,mI7}pzlJ7k7%RkP}]]o~%p|,-{g@=V=.,/m4uW9r>b!x|5]>w+;PoZ@ gy@a&OYzd|a3Y,"39L^(OU'Oh.A^M4VOoM%dJ"Wnu}72Q>cP!A+[E<yLZ782quT|u0Nk]#ww$cy,M\_;#z<~00>(kNmd]g{syIj#C ;+W/2Y`
drls|||dc!0^TL07~YZ?-ydvE~g3&r'qz3b$_Kq2~gY]Tl_Tg@g,WWg|YFuda{"lg4w<zOw2:\6j+WovaeqH\?,|js!iT|G#_e'&W~9h=\gnk]$;Yx)ZpIk~)\WAs|7'ooqbZp5lv^,MgRiMhmh5O{"-nl')hmhh5lqZLjIaLDkDkEk%5_/]w6g5\k^kW'{Eq?m|$%.}EO_re~c64/!%W\ p;E8FZCZKhh/(?o$oE%)W'|_tONOkJk=:mGApt)oH}R)m9[X"oQ<rVM|m;i4fii*5d*9s;59+@~4r5m;	dxW _z;PZ{nw1!_n"MvPy'rrh=.X@uB;8va\f&O/5IXK@.[<L_zct4PM&m{SF X;zb1KMMjmjKHd^9X,UO.jS{H{	SG kd)a6m.z)$'p,repQUk/iOaj\@Z. 5ztj/iOaj[aWtxvO$@~?'-_X|f=j{yM{J{:kh4f:F_tZ6PzY{n~Fk2\\/,X'Cm][%W.@'CX;F-*_`IvC"g0yAO,[s5l^;Xd2Z<-#	.a{Erziy"}Shiard6	/-^egEkZk=wAr~7GV l.@ojj%W6k[{)yr
dkY2vm<9A3/	 +[G O45ne`Lwgm^5-Y,VG6=AL,@~an10!#lpyzh-6{0	MOijzP	(@SaEKZj7qM
gb nZyD=b	Y8 ^sB
uyD0`w:
uS^ dX?Fhl^ oWpcmb.}`fyD W35O O%
gbbLj#5<1B2b	
%23&
sdf3!OzbYrXCFhXCLl7aW6{1dW!^5k'\ =a<@7<2Bcmb1!W@FhzXC\!	kW!&dfSobaL4"k:0#2bXgbbaLy@FXl<M,@>^-	%Phkb(@^hJj=S25o^ yf{D lN8 YffBF(l3]0|bk xc=WLS!62!]@r,qrOkmyN [v=/xv<
&;m6[ef31`Y-k*?	ygs{yT b[Lmkb,@~tE]{/
DYL #Xs{8&W6k[{N{GT +Du7|7SZ0O^xly-#g@>i'/@>)+{!
k865m&'@V`:.(jVL W@=%@OSZ6	2E=%[,0yAii Ik=`9=&=z%~1hjy6~I6fvm[:OmI6saQ3Vo25k*t +\}cpEi'_A|'SsZ%Yj]dNl<]{5CI~5,'/E/@6hyk3/.jS{H{	SG ]=7rJ5sIM\Phw9w%wP-	L'MMv$!0WX75i_b|U?~a.P]mL#_n
_IGsKc{8598k0OPAkaHt@~.m[Fnii]XeC6\$C | =Y^CkLkU1G Db{76bXPpZcZk.hoh.y:%|W<sT9v-1'\|tWxB6)-W\DxsK"-r#OOvh-iM=7Iva_$ql\^;$}xwwnBS5N5.{ I:M:^q+Zp@rJ	X.yO(crVfv\{rnpyip`\<~@%ntCmL5lS|dF4l@ZZNs/_St:y@#usF\4B]rSZ(|n^Zmm_y3B#i-c2W|:7dS`z?4I?kTZZ|~-3&iX.[7 J0\?,h~iM:d.36w9?GA^gYgaW7fS?_GWn#FhgC7Fg19Nb'^}<?W,7$"[GY5{/73N<\ .5iWT-	c_7MM@:Y6gwcQU	;~<~0SL]W~>{lX:?W>~+]~!t:dq?|aZW'2.S4h}uF3& !gV;Obx@1WB:-x&N%j"YI;:`>oGAsD,H@_,/Ww]rv9;n2"ft\q\,_<)j\_QZmY8~ooMGU_gcC]r|oo$n.J_B59j*KI=.%ylUO=yU[]t(pdlqo5xYVv!l'L(uj`j>DMvu	PSdO|bSAs*p^\:tNkw;]Iw$w&Y/eGUvTN&/1f]^kXXa}3x0 i(?w0k=N(oU5~ad_I7&w?ft9)[a|rs4Sl/jk34ZzaqO_(k2	1-`~YZeqYYSWX6dMf3/Ix|(zm<.jh:dyKygbX"}%Iz;~m0)o)}y|[-\#~N;F#oACNE5d(Qz5>_0F_{r<m-=xD6 kO{tbICx[eowL]f^ %CE &l+hMK^5\&3xre/mA ~9wbnl8ia <mevUZ@=fj>eX.7209@q<W{D.-r1ir~x Er_u"Jk&m8D	Gk&hB1"hl6G5%rNyB cBz.k)w~9U8l]3d6uf+Mj ?cd	^E1!g9Sp[,gzDF"2(eHKG{%tN<o*?z
3/E5</1/q!}<.-H>>/&4J|G '8b <A 'd   2 x@ O 	 <A 'd   2 x@ O 	 <A 'd   2 x@ O 	 <A 'd   2 x@ O 	 <A 'd   2 x@ /}1X    IENDB`                                                                                                                            PNG

   IHDR  c  '   |"   sRGB    gAMA  a   	pHYs    od  'IDATx^s7qlIn	m;OGM|muu_2-=H>  0   @@c H a 	  1 $0   @@c H a 	  1 $0   @@c H a 	  1 $0   @@c H a 	  1 $0   @@c H a 	  G=zc_mmme{M[fKG\c?6#G{~k1G^Ggg*;2)<W^5]_[UXmCk;aC[5ssfqAX_RmmDo3'Go MQ@8?o_G?CKvvzm|ssE`.ycf^f9r:y2C'sc535YrB`#37;=e5
n7778V30|5pa!-1{txj66`Z[[b>qFfgO	B>5bN3},L0}13f}a\SZ6O<7+HAgW9;1-ft&6gvm0'kwG\it<z;5ry^)K]lN 'qiBNa&E}%/AW	?ypLxnA:m.^fr&
Q-XG;EFWwY_[ 'mE#{V}LKC#!ACk#W0Nn_Y^ZTw=QE]KW>!Y5hs,6JZ__/mtz ji1m[o'T:Rw1:t>cAU	y>utt=:n]H9{*"qo)wS`}bP5qdkkn#5YrFkkk4hRJ#;;
8"=mfm5=%42OB^2,klOFuLN<7woHkBXGeuT HaiRGGk*pgg}.jS#}q`~YlW!0?
c9&=GREi~cQ?~C8[ZZ:R2SsX}!07,.wdBXaQBY~15>wMs1At(YXZaq/!-GZz!(X!4itPh94EWOa7 nf;ahZoo/s:|p}9\	On>u0A\!Vfv!m"7b"';];]e%QU0vo?]5CCC6]C]7">7~)UnwUm5uk.;3=X7\c!#3Lq2 ia~_{f5Zm6CX_7wofl;%Mm#,n81;wN8j	=)Cw: w!tc3kzQG|?8\pC Q2
P8a0Psz>C3FO;
Wuo2t~SV0W=g|"4?;cn=AS)C\t
mz|!w6m V	<::Zzxvvk w1O{_&uz~/	kD\ I \)G###z}=s
ANxG*!/$Gf+UPY"7T 4iY5Am3F{IV9?2PV <Rfo=wp%=/k,~-8/TWNJq|=C?~SN-5V.q};_jS>P9cdbk[AMj
b2I..3x++Xn2P#=yFjcVox>z 5J}&S#9"wX6VHe	JRnI@Vyn;_Ia,XPO:sfs{KasN?~m2+R|l<fx}:C:q$DSY"k0@xY/OxO;i` RHD|_j>d3S/!Q+===,Fa
kYrB[z:_ N9v^mGB} 0|0	*.-b=B.}0n

=N	FbqzR6p0qlaWjjK>wz=&EL>.07FkNA=@V_bt|0+7YW-uEmHT.c=Cu)X:jZupcT#K-ZpY}+YF18pp
bcPu=:vrm{ssce9_5bK@fUEsc}kL37b5"<Q/1_ueb=5'I;TmL]:2]CcT'Kcbp}RWyg~[zn&U'&b\e}WKfueF'(O!FD/0FK]cJqdscTK]Db
7o8XA8/VV>ev]f[[}&XAcm[}ekWGS_C6u*x*_WWY+b(cmelxc}8\	YG)Mazew(0^v2L!uw&0vxPkku'*x{&]BN	%
HvS7a| !XRU@C B1blTS[an%t{p,ac.a,*vE/f8FiSew&0~e_^0&\y}nc#aL;rWIa|;	.\y}nc7wew2E#*icdQ1;	=tdLbW)rdj
#cddn9M1#cq(S iwEoVtixwI)FadA
6/Mar_W@\y}n7)]02#0>v:<-fU4ade]lw]92>~}e
jc1j#c(S41b.	]QhR1)J)S2EB@c'G.<eeG.	j2S{&\y}nnB544d_q\y}n. d 3\}N6n/d32v}}}U."vEoaL%*1e]~c	e[wcJ*F02>w12NmF{'+WVcTtQmul8\	B"o1]q	cqYZ__12Bbmze='zyAbrHWWYqo}FR+%
q(04G_]`"/?5xm[}N}{*9b5#cXeVS
cquY$jy];i{(QGvavb_C86henG1	1*V[vky?LX^^+QZeu(U&I5~$2K/XY"w/ze--I:.zQac>urC9DhzuUzr=q'Xe'G81:WR8ucqv^ZZ
|)vG*Oo 0vz^gai6yYDo=sC#cd^%Q8]wTOo9Y<\?bQvBTUU5}*f|]n)1G;8/cT*>xN>kqn&bF\nr\?Yxrz 6\mG9Q=}^_\\&YSIGTR_;ZHF2Sxlv0BWJA60fE_Y
!FdU18wrCosg'=Gz
dCAkl6A!1z7F1xW)H*_h s-%J\!^~s8_ j{>ZxgWWlI%&)\:jsHx==dnnlll3_eC*L|Pbg]:G
RYg-
bGrD\=sK}IJGwhT(~hI}C}y|*!ZngnieCOO=K?Xq_ZZOk~so\!ciq=:;;YzP%2S	4ag_= {{Afs(+xUHgx]laO0o}P(|QpI+'fff5~w{}Z5=scE Wj
'"K#\M)}8f$B7f{^Y4I`hY
OhV 23@7m^-4^_@.)5RV0ZR>c~uhD?s}^?=oias
5R*r9jNUQ .i$/I8_<sQ@N2FK:uB?63D?~7<g~(84*P +tv
NG]]~9sU{COfvzq".@&zOg)wicQ-jjXmZmaf|=K9=ya|H'z"4#&gy:T3Az5.W6
x?PAQ:OV8Sav}!z3304l$|1kckkk{6c>?8d!jj0_A{$-KNf?RU[EcO}I&*DJ,:rMQ;<R/?x{^=EhcLv>xA{Y6cO?o)9ns>V};0`ss1BcGcFG`qvzl4--x@6NOwCOVpZVM|O_SEvf=%DSj4rNF]gHa0V(+W!=NCH&'oj/]C'y
`7}]+W0H+,aV-+YOap
_i>vWa{(kIEG_Z?[uhr.%ZC|'a0NF OxnR\#EN7Fav <lmS0W!Kzp "ji;j^PAkDyD_{;*8QO3g@Ojm{s/0N&e;%s:IfMa	At?\L>
xpwl=>W*wl?/QC
ysGuBWwY_9jk0?8ca\!00ed%xtvi
1O/>zK_0jq8E9rBFeTj.a05xZl~9WGFfe9cn3rvc[q^Nzb/.Mi$<tr0n~-O S#Tca!S~txZqB%9kNe00|af&_M0ZZZSfpdh|1`v~hp}#p1r63/jAnH#"OQ8{I8?_<zqaK^zNO[5,Is1Ee8?mOo#?1M0757xvvmmD#a 46rNkqwt?_c--!PX)Vuq'Imk:jmhNM2RG@   @@c H a 	  1 $0   @@c H a 	  1 $0   @@c H a 	  1 $0   @@c H a 	  1 $0   @@c H a 	  1 Dg=8    IENDB`                                                                                                              PNG

   IHDR  d  (   o7   sRGB    gAMA  a   	pHYs    od  SIDATx^iW8qS;$@6NeN,R;oG&(Jr;of]*Y/ _ @  A @ d    2 @@  A @ d    2 @@  A @ d    2 @@  A @ d    2 @@  A @ d    2 ani~;??7G84ggg"vqqnu$otM^&or446f{k1kRrtWBWCO6SJ-9B@ f;-mvwt|him5=gz-Ux\bhll47@ Z
8H=J@F \^^UbWWsQ304.ds}-aY2y^@Po8	30<bpW##g+fuy>q3:>Nn@Hy{|7k+
0<:fFO>zrWSWPfWjIoxyqAO$<9|@.>1>4}o|29vr1S/y3X{.G}{!sL+a]z9yo_%{E4<zL>bsD&+P32@	3sr|d &mfgQpr}i>,hZ]	^=<ye'mV'O@^u~3+t5G]]3^. 9P+~=-uVKNNN#o-=x<-8&?N;]%|+N:BLo:iQ-*=}:BP7!@z{c
oC8kw3?3\gGf6	c=I[[f4Q	c{5z7r[[<!H8z9>
c
~;::LgggB umCK6@%3A4bMESuHV
e!L}3<v^AuWpTWa!xd:}@ g V+Y'm5t!drFn_/
{{{u1455+S-=SWQoYkf~innW33*;cCk3?i_.sV3}-L%+k*O@2	gadCSz{{y`W.OL{rH<50q^eIEXd/]kX+;,TU@vtjkN tu/|QGEdt,Xp@t/uOuoz]5EyX[g~i1uTaY|UY=r8J5ZF5)o?cx=A\tZVM>3YU\&<;Y/$TY;f[~gTAjBj_3d@th|ZGv*6W/0fa |j#PVJe
-Pf";rulj`(,U!6'%(!.~6Y	|KR_@}k#)P+jC `owRj	A '.om}W6(WAOV7?+QzP6o9M% //~m$VWy[[jW({Q*FW,myx|m8XKvfmeX`&9!8?g?1ECX;;[^vEG}mm#1voPc_]bC [fkc wZ1t{Kc<dVB.}=	
0TPM!%1M[\0jS5xx+j[>jTmIm
w} uyF]>5V>OnhU/,nS1:#O|UnNe*nzNymXzWQ%n[6~vvj%U\h`4c+PfEL}{oon37#\_Ee cm$f|Ru[+(Qk1Egyem=stxhjPvKc~zhT._pb
K=dEpY.lmmbqYjso'@v=EEGywl?N]OB]"*1\sY.^E''
(:5U4|@Fqm	do=
O5Zw7nM abG|2bA g!; sr|ljG #.k]mPmE D #kaEw]""/w(@>;;jG #6.ke[,(]]b]"#~+b]"bJ5!;DqCfZYT2bt"!jCqCfu!W@Fl2=kEgL{C=EJz"ityyi?qpY.bEM8ym!W2bC9;qrST;qbCC|HzY wL _'z;sP=di@CU8CfZYT\@Np8io";:;w(@.u-Bp]bD--@F,\"-@2b,@jG #.ke,*zw@ #ENOOycWBfoc	(&5Q4(:5U4,.NNN'\8U wO\WdQro(*UT?hOfEp+z(*6EZ4	ej<>+n+@v=uxxh?]*-YoJv*^uBQ]o^t,0O@eU'@f:tCv<	<C]quB/yp{QP1pyanc16G;r]j[jcN,cnXUm"@v}6zwu wu~{z%#/T{jSj[^,#~dj06YO].)>zjKY4zo|NL.]?5z!}^M!%lO>d{^Ah|6N!{j5!@bc_ U h;1"7C#<<::g@}}l08<@C?%Ec_2uG@|LT[af;WO>Ef] k9_>2vf{mNOOjM5HG;JD dQa<|l#"T0gni#IMK+6F|L<Ek#ooO'jj>Dh{Yyrrb|-?-L>J'L5ZEm@mo~PC Q\gG-iF|&fT;>7DP@'EO}j^*=9bw/rM3?	|Smd1Z@{%+|I5Ex:C ~FnccjA5;UOg
\nK%{8-/Tmd@AKk~=K}i6G /DdIF}hV:_D@X:ga_3vdG>vB)myPYQZG ;?!3/*`\.+{\ =jWjG ;_L=OkfT\#[Edf~gU^eF~fvjTp.EOx#WgY3WmFu?D?S~ZGG2MMM
BYY7?Mc#3;fCA\nOf{!!3pvvevwJKV(QoXa\U0-
BC gofkc^^kkkmmm
p||q=5J@{VR)-+X,}	3t!dr,5sofY(
h V0E[/nudf#{}TVm>Ng :W0GI[FPd-+Crnv!2W:zW5gz`11
@$VYX*#!~+!#Dq6&9 K?Yb
<p790{i(65Q9ZZZr??#t=}iwvu+39P^o_|P(_ j1xW<2@}a|t:
/fIh_az]ttu%g<og_s,4|5uZ!Ps?<~jP4rNl^cvQk[Yf[>QOPcz+f>x9txx`v2STbX9V4so(3Iq!`uC:qTeQR)o 6rM:'iq#,-Ot??%]<..H^y`b+ut$'9X_]N_}!zC#c
99"z{%5,+Mz<uB+	mmjZ47Q384nT@'Z/c#	gZ7HI'LV2VG\_My}uPNCxJt@d\K6nSt^?8t5xA *H)w9^tW=$>1P2+GGt^g^2uW@}<`x,]$mtyq~N[>]M5&:sm:r@ @ d    2 @@  A @ d    2 @@  A @ d    2 @@  A @ d    2 @@  A @ d    2 @@  A @:)Tf    IENDB`                                                                  /*
 * @fileoverview : PMC Ladder iHMI debug page script
 * @char-code    : SJIS
 * @NewLineCode  : LF
 */

/**
  Constant definition
**/
var SCREEN_ID_LADDER_DEBUG_LOG_PAGE = "screen_ladder_debug_page_log";
var TEXT_AREA_ID_LADDER_DEBUG_LOG_AREA = "ladder_debug_log_area";
var DEBUG_LOG_MAX_SIZE = 2000;
var DEBUG_TIME_LOG_MAX_SIZE = 500;

var DEBUG_PAGE_SW = 0;        // debug page display switch  0:invalidity/1:valid

/**
  Global(Only this file)
**/
var g_prev_screen_id = "";    // screen ID before the debugging screen shift
var g_debug_log_buffer = [];  // log storage buffer
var g_debug_log_pos = 0;      // log set down pointer
var g_debug_start_time_buffer = [];  // time measurement start value buffer
var g_debug_end_time_buffer = [];    // time measurement end value buffer

/*
 =========================================================================
 @function name : ladder_debug_init
 @description   : ladder debug page initial processing
 @return        : none
 =========================================================================
*/
function ladder_debug_init() {
  var func_btn_home = [];
  // the screen name list except the debug page
  var screen_name = ["screen_ladder_tree_edit",
                     "screen_ladder_display",
                     "screen_ladder_search",
                     "screen_ladder_search_result",
                     "screen_ladder_editor",
                     "screen_ladder_netedit",
                     "screen_ladder_replace",
                     "screen_ladder_element_editor",
                     "screen_ladder_tree",
                     "screen_ladder_search_result_list",
                     "screen_ladder_search_replace",
                     "screen_symbol_comment_editor",
                     "screen_ladder_error_pmc_read"];
 
  for (i = 0; i < screen_name.length; i++) {
    if (i < screen_name.length - 1) {
      func_btn_home[i] = document.getElementById("func_btn_" + (i + 1) + "_home");
    } else {
      func_btn_home[i] = document.getElementById("func_btn_error_pmc_read_home");
    }
    func_btn_home[i].innerHTML = "DEBUG";
    // click event addition of each screen
    func_btn_home[i].onclick = new Function("move_to_debug_page('" + screen_name[i] + "');");
  }
}

/*
 =========================================================================
 @function name : move_to_debug_page
 @argument [id] : the element id of the origin of transition
 @description   : debug screen transition API
 @return        : none
 =========================================================================
*/
function move_to_debug_page(id) {

  // debug page display switch is not ON
  if (DEBUG_PAGE_SW != 1) { 
    return;
  }

  if (id != SCREEN_ID_LADDER_DEBUG_IF_TEST_PAGE) {
    g_prev_screen_id = id;
  }
  document.onkeydown = ladder_debug_page_log_keydown;
  document.getElementById(SCREEN_ID_LADDER_DEBUG_LOG_PAGE).style.display = 'block';
  document.getElementById('worldDiv').style.display = 'none';
  document.getElementById(id).style.display = 'none';
}

/*
 =========================================================================
 @function name : ladder_debug_page_log_keydown
 @description   : processing at the time of the hard key pressing
 @return        : none
 =========================================================================
*/
function ladder_debug_page_log_keydown(event) {
  var key_code = event.keyCode;
  var key_ctrl = event.ctrlKey;
  // notify a browser to invalidity of the key
  invalidate_notification_key(event);

  switch (key_code) {
  case 49:  // function1 key(TP environment)
    if (key_ctrl == true) {
      ladder_debug_page_log_click_f1_button();
    }
    break;
  case 50:  // function2 key(TP environment)
    if (key_ctrl == true) {
      ladder_debug_page_log_click_f2_button();
    }
    break;
  case 51:  // function3 key(TP environment)
    if (key_ctrl == true) {
      ladder_debug_page_log_click_f3_button();
    }
    break;
  case 52:  // function4 key(TP environment)
    if (key_ctrl == true) {
      ladder_debug_page_log_click_f4_button();
    }
    break;
  case 53:  // function5 key(TP environment)
    if (key_ctrl == true) {
      ladder_debug_page_log_click_f5_button();
    }
    break;
  case 112:  // function1 key(PC environment)
    ladder_debug_page_log_click_f1_button();
    break;
  case 113:  // function2 key(PC environment)
    ladder_debug_page_log_click_f2_button();
    break;
  case 114:  // function3 key(PC environment)
    ladder_debug_page_log_click_f3_button();
    break;
  case 115:  // function4 key(PC environment)
    ladder_debug_page_log_click_f4_button();
    break;
  case 27:  // prev button(TP environment)
  case 116:  // function5 key
    ladder_debug_page_log_click_f5_button();
    break;
  default:
    break;
  }
}

/*
 =========================================================================
 @function name : ladder_debug_page_log_click_f1_button
 @description   : F1 key click processing
 @return        : none
 =========================================================================
*/
function ladder_debug_page_log_click_f1_button() {
  ladder_debug_log_disp();
}

/*
 =========================================================================
 @function name : ladder_debug_page_log_click_f2_button
 @description   : F2 key click processing
 @return        : none
 =========================================================================
*/
function ladder_debug_page_log_click_f2_button() {
  ladder_debug_log_clear();
}

/*
 =========================================================================
 @function name : ladder_debug_page_log_click_f3_button
 @description   : F3 key click processing
 @return        : none
 =========================================================================
*/
function ladder_debug_page_log_click_f3_button() {
  ladder_debug_log_remove();
}

/*
 =========================================================================
 @function name : ladder_debug_page_log_click_f4_button
 @description   : F4 key click processing
 @return        : none
 =========================================================================
*/
function ladder_debug_page_log_click_f4_button() {
  move_to_debug_page_if_test(SCREEN_ID_LADDER_DEBUG_LOG_PAGE);
}

/*
 =========================================================================
 @function name : ladder_debug_page_log_click_f5_button
 @description   : F5 key click processing
 @return        : none
 =========================================================================
*/
function ladder_debug_page_log_click_f5_button() {
  if ( g_prev_screen_id === "screen_ladder_tree_edit" ) {
    move_to_ladder_tree_edit(SCREEN_ID_LADDER_DEBUG_LOG_PAGE);
  }
  else if ( g_prev_screen_id === "screen_ladder_display" ) {
    move_to_ladder_display(SCREEN_ID_LADDER_DEBUG_LOG_PAGE);
  }
  else if ( g_prev_screen_id === "screen_ladder_search" ) {
    move_to_ladder_search(SCREEN_ID_LADDER_DEBUG_LOG_PAGE);
  }
  else if ( g_prev_screen_id === "screen_ladder_search_result" ) {
    move_to_ladder_search_result(SCREEN_ID_LADDER_DEBUG_LOG_PAGE);
  }
  else if ( g_prev_screen_id === "screen_ladder_search_result_list" ) {
    move_to_ladder_search_result_list(SCREEN_ID_LADDER_DEBUG_LOG_PAGE);
  }
  else if ( g_prev_screen_id === "screen_ladder_editor" ) {
    move_to_ladder_editor(SCREEN_ID_LADDER_DEBUG_LOG_PAGE);
  }
  else if ( g_prev_screen_id === "screen_ladder_netedit" ) {
    move_to_ladder_net_edit(SCREEN_ID_LADDER_DEBUG_LOG_PAGE);
  }
  else if ( g_prev_screen_id === "screen_ladder_replace" ) {
    move_to_ladder_replace(SCREEN_ID_LADDER_DEBUG_LOG_PAGE);
  }
  else if ( g_prev_screen_id === "screen_ladder_search_replace" ) {
    move_to_ladder_search_replace(SCREEN_ID_LADDER_DEBUG_LOG_PAGE);
  }
  else if ( g_prev_screen_id === "screen_ladder_element_editor" ) {
    move_to_ladder_element_editor(SCREEN_ID_LADDER_DEBUG_LOG_PAGE);
  }
  else if ( g_prev_screen_id === "screen_ladder_tree" ) {
    move_to_ladder_tree(SCREEN_ID_LADDER_DEBUG_LOG_PAGE);
  }
  else if ( g_prev_screen_id === "screen_symbol_comment_editor" ) {
    move_to_symbol_comment_editor(SCREEN_ID_LADDER_DEBUG_LOG_PAGE);
  }
  else if ( g_prev_screen_id === "screen_ladder_error_pmc_read" ) {
    var err_type = get_err_type();
    move_to_error_pmc_read(err_type);
  }
  else {
    return;
  }
}

/*
 =========================================================================
 @function name       : ladder_debug_log
 @argument [log_text] : character string to store log
 @description         : it stores character string in an internal log buffer
 @return              : none
 =========================================================================
*/
function ladder_debug_log(log_text) {

  // debug page display switch is not ON
  if (DEBUG_PAGE_SW != 1) { 
    return;
  }

  g_debug_log_buffer[g_debug_log_pos] = log_text;
  g_debug_log_pos += 1;

  if (g_debug_log_pos >= DEBUG_LOG_MAX_SIZE) {
    g_debug_log_pos = 0;
  }
}

/*
 =========================================================================
 @function name     : ladder_debug_log_disp
 @description       : display the contents of the log buffer to a screen
 @return            : none
 =========================================================================
*/
function ladder_debug_log_disp() {
  var disp_start_pos = 0;
  if (g_debug_log_buffer.length >= DEBUG_LOG_MAX_SIZE) {
    disp_start_pos = g_debug_log_pos + 1;
  }

  ladder_debug_log_clear();

  var count = 0;
  var log_area_elem = document.getElementById(TEXT_AREA_ID_LADDER_DEBUG_LOG_AREA);
  for( count = 0; count < g_debug_log_buffer.length; count++ ) {
    var line_no = count + 1;
    log_area_elem.value += line_no + "\t: " + g_debug_log_buffer[disp_start_pos] + "\n";
    disp_start_pos += 1;
    if (disp_start_pos >= DEBUG_LOG_MAX_SIZE) {
      disp_start_pos = 0;
    }
  }
}

/*
 =========================================================================
 @function name : ladder_debug_log_clear
 @description   : clear the log display on the screen
 @return        : none
 =========================================================================
*/
function ladder_debug_log_clear() {
  var log_area_elem = document.getElementById(TEXT_AREA_ID_LADDER_DEBUG_LOG_AREA);
  log_area_elem.value = "";
}

/*
 =========================================================================
 @function name : ladder_debug_log_remove
 @description   : delete the contents of the log buffer
 @return        : none
 =========================================================================
*/
function ladder_debug_log_remove() {
  g_debug_log_buffer.length = 0;
  g_debug_log_buffer = [];
  g_debug_log_pos = 0;

  g_debug_start_time_buffer.length = 0;
  g_debug_start_time_buffer = [];
  g_debug_end_time_buffer.length = 0;
  g_debug_end_time_buffer = [];

  ladder_debug_log_disp();
}

/*
 =========================================================================
 @function name      : ladder_debug_start_time
 @argument [time_id] : time id (0 - DEBUG_TIME_LOG_MAX_SIZE-1)
 @description        : it stores measurement start time in an internal log buffer
 @return             : none
 =========================================================================
*/
function ladder_debug_start_time(time_id) {

  // debug page display switch is not ON
  if (DEBUG_PAGE_SW != 1) {
    return;
  }

  if (time_id >= DEBUG_TIME_LOG_MAX_SIZE) {
    ladder_debug_log("[ladder_debug_page.js(ladder_debug_start_time)][ERROR] : Invalid time id. -> " + time_id);
    return;
  }

  // stores start time in an internal log buffer
  var start_time = Date.now();
  g_debug_start_time_buffer[time_id] = start_time;

}

/*
 =========================================================================
 @function name      : ladder_debug_end_time
 @argument [time_id] : time id (0 - DEBUG_TIME_LOG_MAX_SIZE-1)
 @description        : it stores measurement end time in an internal log buffer
 @return             : none
 =========================================================================
*/
function ladder_debug_end_time(time_id) {

  // debug page display switch is not ON
  if (DEBUG_PAGE_SW != 1) {
    return;
  }

  if (time_id >= DEBUG_TIME_LOG_MAX_SIZE) {
    ladder_debug_log("[ladder_debug_page.js(ladder_debug_end_time)][ERROR] : Invalid time id. -> " + time_id);
    return;
  }

  // stores end time in an internal log buffer
  var end_time = Date.now();
  g_debug_end_time_buffer[time_id] = end_time;

}

/*
 =========================================================================
 @function name      : ladder_debug_get_time
 @argument [time_id] : time id (0 - DEBUG_TIME_LOG_MAX_SIZE-1)
 @description        : get measurement time
 @return             : the measurement result specified in time id [unit : ms]
                       repay a negative value at the time of the error
 =========================================================================
*/
function ladder_debug_get_time(time_id) {

  // debug page display switch is not ON
  if (DEBUG_PAGE_SW != 1) {
    return;
  }

  if (time_id >= DEBUG_TIME_LOG_MAX_SIZE) {
    ladder_debug_log("[ladder_debug_page.js(ladder_debug_get_time)][ERROR] : Invalid time id. -> " + time_id);
    return -1;
  }

  // calculate measurement time from start time and end time and return it
  if (typeof g_debug_start_time_buffer[time_id] === "undefined") {
    ladder_debug_log("[ladder_debug_page.js(ladder_debug_get_time)][ERROR] : start time id not found. -> " + time_id);
    return -1;
  }
  if (typeof g_debug_end_time_buffer[time_id] === "undefined") {
    ladder_debug_log("[ladder_debug_page.js(ladder_debug_get_time)][ERROR] : end time id not found. -> " + time_id);
    return -1;
  }
  var start_time = g_debug_start_time_buffer[time_id];
  var end_time = g_debug_end_time_buffer[time_id];

  return (end_time - start_time);

}

/*
 =====================================================================================
                       Interface test debug page script
 =====================================================================================
*/
/**
  Constant definition
**/
var SCREEN_ID_LADDER_DEBUG_IF_TEST_PAGE = "screen_ladder_debug_page_if_test";
var DEBUG_PMC_STATUS_GET_RESULT = "ladder_debug_if_test_pmc_status";
var DEBUG_PMC_VALUE_TEXTAREA = "ladder_debug_pmc_data_textarea";

/**
  Global(Only this file)
**/
var g_debug_pmc_bin_data = [];

/*
 =========================================================================
 @function name : move_to_debug_page_if_test
 @argument [id] : the element id of the origin of transition
 @description   : interface test debug screen transition API
 @return        : none
 =========================================================================
*/
function move_to_debug_page_if_test(id) {
  document.onkeydown = ladder_debug_page_if_test_keydown;
  document.getElementById(SCREEN_ID_LADDER_DEBUG_IF_TEST_PAGE).style.display = 'block';
  document.getElementById(id).style.display = 'none';
}

/*
 =========================================================================
 @function name : ladder_debug_page_if_test_keydown
 @description   : processing at the time of the hard key pressing
 @return        : none
 =========================================================================
*/
function ladder_debug_page_if_test_keydown(event) {
  var key_code = event.keyCode;
  var key_ctrl = event.ctrlKey;
  // notify a browser to invalidity of the key
  invalidate_notification_key(event);

  switch (key_code) {
  case 52:  // function4 key(TP environment)
    if (key_ctrl == true) {
      ladder_debug_page_if_test_click_f4_button();
    }
    break;
  case 53:  // function5 key(TP environment)
    if (key_ctrl == true) {
      ladder_debug_page_if_test_click_f5_button();
    }
    break;
  case 115:  // function4 key(PC environment)
    ladder_debug_page_if_test_click_f4_button();
    break;
  case 27:  // prev button(TP environment)
  case 116:  // function5 key
    ladder_debug_page_if_test_click_f5_button();
    break;
  default:
    break;
  }
}
/*
 =========================================================================
 @function name : ladder_debug_page_if_test_click_f1_button
 @description   : F1 key click processing
 @return        : none
 =========================================================================
*/
function ladder_debug_page_if_test_click_f1_button() {
  var value_textarea_elem = document.getElementById(DEBUG_PMC_VALUE_TEXTAREA);
  value_textarea_elem.value = "";

    // request for pmc update from server
  requestPmcUpdate(PMC_MEMORY_TYPE_1, function (status) {
    if (status == IO_SUCCESS) {
      // load pmc data from server
      loadPmcFile(PMC_MEMORY_TYPE_1, ladder_debug_load_file_callback);
      value_textarea_elem.value = "requestPmcUpdate() : Http status is OK.[" + status + "]" + "\n";
    }
    else {
      // server communicate error
      value_textarea_elem.value = "requestPmcUpdate() : Http status is error.[" + status + "]" + "\n";
    }
  });
  
  return;
}

/*
 =========================================================================
 @function name            : ladder_debug_load_file_callback
 @argument [status]        : correspondence status with the server
 @argument [pmc_file_name] : PMC file name
 @argument [bin_data]      : binary date
 @description              : call back function for loadPmcFile()
 @return                   : none
 =========================================================================
*/
function ladder_debug_load_file_callback(status, pmc_file_no, bin_data) {
  var value_textarea_elem = document.getElementById(DEBUG_PMC_VALUE_TEXTAREA);
  if (status == IO_SUCCESS) {
    // update pmc data for debug buffer
    g_debug_pmc_bin_data = bin_data;
    var pmc_bin_data = new Uint8Array(g_debug_pmc_bin_data);
    value_textarea_elem.value += "ladder_debug_load_file_callback() : Http status is OK.[" + status + "]" + "\n";
    value_textarea_elem.value += "ladder_debug_load_file_callback() : get pmc fileno --> " + pmc_file_no + "\n";
    value_textarea_elem.value += "ladder_debug_load_file_callback() : get pmc binary data(Display 32 bytes from the beginning)" + "\n";
    for (var i = 0; i <= 31; i++) {
      if (i % 16 == 0) {
        value_textarea_elem.value += "\n";
        value_textarea_elem.value += ("00000000" + (i.toString(16))).substr(-8) + " ";
      } else {
        // nothing to do
      }
      value_textarea_elem.value += ("0" + pmc_bin_data[i].toString(16)).substr(-2) + " ";
    }
  } else {
    // server communicate error
    value_textarea_elem.value += "ladder_debug_load_file_callback() : Http status is error.[" + status + "]" + "\n";
  }
}

/*
 =========================================================================
 @function name : ladder_debug_page_if_test_click_f2_button
 @description   : F2 key click processing
 @return        : none
 =========================================================================
*/
function ladder_debug_page_if_test_click_f2_button() {
  var value_textarea_elem = document.getElementById(DEBUG_PMC_VALUE_TEXTAREA);
  value_textarea_elem.value = "";
  if (g_debug_pmc_bin_data.length <= 0) {
    value_textarea_elem.value = "storePmcFile() : pmc data is nothing.";
    return;
  }

  // store pmc data to server
  storePmcFile(PMC_MEMORY_TYPE_1, g_debug_pmc_bin_data, function(status) {
    if (status == IO_SUCCESS) {
      // request pmc data update to server
      finishPmcUpdate(PMC_MEMORY_TYPE_1, ladder_debug_pmc_update_callback);
      value_textarea_elem.value = "storePmcFile() : Http status is OK.[" + status + "]" + "\n";
    }
    else {
      // server communicate error
      value_textarea_elem.value = "storePmcFile() : Http status is error.[" + status + "]" + "\n";
    }
  });

  return;
}

/*
 =========================================================================
 @function name     : ladder_debug_pmc_update_callback
 @argument [status] : correspondence status with the server
 @description       : call back function for finishPmcUpdate()
 @return            : none
 =========================================================================
*/
function ladder_debug_pmc_update_callback(status) {
  var value_textarea_elem = document.getElementById(DEBUG_PMC_VALUE_TEXTAREA);
  if (status == IO_SUCCESS) {
    // finishPmcUpdate(PMC_MEMORY_TYPE_1, ladder_debug_pmc_update_callback)
    value_textarea_elem.value += "ladder_debug_pmc_update_callback() : Http status is OK.[" + status + "]" + "\n";
  }
  else {
    // server communicate error
    value_textarea_elem.value += "ladder_debug_pmc_update_callback() : Http status is error.[" + status + "]" + "\n";
  }
}

/*
 =========================================================================
 @function name : ladder_debug_page_if_test_click_f4_button
 @description   : F4 key click processing
 @return        : none
 =========================================================================
*/
function ladder_debug_page_if_test_click_f4_button() {
  move_to_debug_page(SCREEN_ID_LADDER_DEBUG_IF_TEST_PAGE);
}

/*
 =========================================================================
 @function name : ladder_debug_page_if_test_click_f5_button
 @description   : F5 key click processing
 @return        : none
 =========================================================================
*/
function ladder_debug_page_if_test_click_f5_button() {
  if ( g_prev_screen_id === "screen_ladder_tree_edit" ) {
    move_to_ladder_tree_edit(SCREEN_ID_LADDER_DEBUG_IF_TEST_PAGE);
  }
  else if ( g_prev_screen_id === "screen_ladder_display" ) {
    move_to_ladder_display(SCREEN_ID_LADDER_DEBUG_IF_TEST_PAGE);
  }
  else if ( g_prev_screen_id === "screen_ladder_search" ) {
    move_to_ladder_search(SCREEN_ID_LADDER_DEBUG_IF_TEST_PAGE);
  }
  else if ( g_prev_screen_id === "screen_ladder_search_result" ) {
    move_to_ladder_search_result(SCREEN_ID_LADDER_DEBUG_IF_TEST_PAGE);
  }
  else if ( g_prev_screen_id === "screen_ladder_search_result_list" ) {
    move_to_ladder_search_result_list(SCREEN_ID_LADDER_DEBUG_IF_TEST_PAGE);
  }
  else if ( g_prev_screen_id === "screen_ladder_editor" ) {
    move_to_ladder_editor(SCREEN_ID_LADDER_DEBUG_IF_TEST_PAGE);
  }
  else if ( g_prev_screen_id === "screen_ladder_netedit" ) {
    move_to_ladder_net_edit(SCREEN_ID_LADDER_DEBUG_IF_TEST_PAGE);
  }
  else if ( g_prev_screen_id === "screen_ladder_replace" ) {
    move_to_ladder_replace(SCREEN_ID_LADDER_DEBUG_IF_TEST_PAGE);
  }
  else if ( g_prev_screen_id === "screen_ladder_search_replace" ) {
    move_to_ladder_search_replace(SCREEN_ID_LADDER_DEBUG_IF_TEST_PAGE);
  }
  else if ( g_prev_screen_id === "screen_ladder_element_editor" ) {
    move_to_ladder_element_editor(SCREEN_ID_LADDER_DEBUG_IF_TEST_PAGE);
  }
  else if ( g_prev_screen_id === "screen_ladder_tree" ) {
    move_to_ladder_tree(SCREEN_ID_LADDER_DEBUG_IF_TEST_PAGE);
  }
  else if ( g_prev_screen_id === "screen_symbol_comment_editor" ) {
    move_to_symbol_comment_editor(SCREEN_ID_LADDER_DEBUG_IF_TEST_PAGE);
  }
  else if ( g_prev_screen_id === "screen_ladder_error_pmc_read" ) {
    var err_type = get_err_type();
    move_to_error_pmc_read(err_type);
  }
  else {
    return;
  }
}

/*
 =========================================================================
 @function name : ladder_debug_page_if_test_pmc_status_get
 @description   : PMC status acquisition button pressing processing
 @return        : none
 =========================================================================
*/
function ladder_debug_page_if_test_pmc_status_get() {
  var result_text_elem = document.getElementById(DEBUG_PMC_STATUS_GET_RESULT);
  getPmcRunStatus(1, function (pmc_num, status) {
    document.getElementById(DEBUG_PMC_STATUS_GET_RESULT).innerHTML = (status == PMC_RUNNING) ? "RUNNING" : "STOPPED";
  });
}

/*
 =========================================================================
 @function name : ladder_debug_page_if_test_pmc_value_get
 @description   : PMC address acquisition button pressing processing
 @return        : none
 =========================================================================
*/
function ladder_debug_page_if_test_pmc_value_get() {
  var symbol_elem = document.getElementsByName("pmc_symbol");
  var address_start = parseInt(document.getElementById("text_from_address").value, 10);
  var address_end = parseInt(document.getElementById("text_to_address").value, 10);
  var symbol = "";
  var performance = [];
  var pmc_adr = "";
  for (var i = 0; i < symbol_elem.length; i++){
    if (symbol_elem[i].checked) {
      symbol = symbol_elem[i].value;
      break;
    }
  }

  if (symbol != "") {
    var value_textarea_elem = document.getElementById(DEBUG_PMC_VALUE_TEXTAREA);
    value_textarea_elem.value = "";

    if (isNaN(address_end)) {
      address_end = address_start;
      document.getElementById("text_to_address").value = ("0000" + address_end).substr(-4);
    }
    for (var address = address_start; address <= address_end; address++) {
      pmc_adr = symbol + ("0000" + address).substr(-4);
      performance[pmc_adr] = Date.now();
      getPmcByteVal(1, pmc_adr, function (status, pmc_num, addr, value) {
        if (status == IO_SUCCESS) {
          if (value != null) {
            performance[addr] = Date.now() - performance[addr];
            value_textarea_elem.value += addr + "=" + value + "(" + performance[addr] + "ms)\n";
          } else {
            value_textarea_elem.value += "[!ERROR!]" + addr + "= no value\n";
          }
        } else {
          value_textarea_elem.value += "[!ERROR!]" + addr + "= status: " + status + "\n";
        }
      });
    }
  }
}

// end of file
                                                                                                                                                                                                                                                                                                                                                                                                                                 /*
 * @fileoverview : PMC Ladder iHMI ladder program display script
 * @char-code    : SJIS
 * @NewLineCode  : LF
 */

/**
  Constant definition
**/
var HEADER_ID_LADDER_DISPLAY = "headert_2";

/**
  Global(Only this file)
**/
var g_symbol_flg = FLG_OFF;  // symbol button choice indication flag
var g_tmp_symbol_no = 3;
var select_symbol_button = SYMBOL_KIND_ADDRESS_SYMBOL;  // symbol menu choice movement
var g_row_limit = 0;        // number of the letters restrictions
var g_disp_net_index = 0;   // start position of the list to display
var g_disp_grid_index = 0;
var g_disp_width_index = 0;
var g_max_row_num = 0;      // the height maximum of the net
var g_max_col_num = 0;      // the width maximum of the net
var change_amount_mem = 0;
var ly_net_p = 0;
var lx_net_p = 0;
var g_search_hit_square_disp_flag = FLG_OFF;
var g_search_hit_net_num = 0;
var g_search_hit_element_x = 0;
var g_search_hit_elemeny_y = 0;
var g_scaling_flg = FLG_OFF;
var g_scale_factor = SCALING_100PERCENT;
var g_tmp_scaling_no = SCALING_8_8;
var select_scaling_button = SCALING_8_8;
var g_stopwatch_pos = [-1, -1, -1, -1, -1, -1];
var g_click_net_index = 0;
var g_all_click_net_index = 0;
var g_pop_search_flg = FLG_OFF;
var g_screen_move_x = 0;
var g_screen_move_y = 0;
var g_base_position = 0;
var g_switch_scale_flg = FLG_OFF;
var g_slide_scroll_flg = FLG_OFF;
var g_stop_get_val_flg = FLG_OFF;
var g_h_scroll_flg = FLG_OFF;
var g_scroll_flg = FLG_OFF;
var g_flick_timer;
var g_flick_start_pos_tbl = { pos_x: 0, pos_y: 0 };
var g_flick_tmr_tbl       = { start: 0, end: 0 };
var g_diff_flick_tbl      = { pos_x: 0, route_x: 0, pos_y: 0, route_y: 0 };
var g_flick_flg_tbl       = { vertical: FLG_OFF, horizontal: FLG_OFF, scrolling: FLG_OFF };
var g_first_scroll_flg    = FLG_ON;
var g_scroll_route_tbl = { up: FLG_OFF, right: FLG_OFF };
var g_draw_subroutine_flg_tbl = { draw: FLG_OFF, draw_marker: FLG_OFF, draw_index_x: 0, draw_index_y: 0, height:0 };
var g_net_end_count = 0;
var g_selected_net_edit_index = 0;
/*
 =========================================================================
 @function name : ladder_display_click_f1_button
 @argument      : none
 @description   : processing in the case of pushed down(clicked) F1 key
 @return        : none
 =========================================================================
*/
function ladder_display_click_f1_button() {
  g_processing_flg = FLG_ON;
  if (g_pmc_no !== PMC_MEMORY_TYPE_DCS) {
    if (g_get_system_var_flg === FLG_ON) {
      g_processing_flg = FLG_OFF;
      return;
    } else {
      g_get_system_var_flg = FLG_ON;
      // get var
      getPmcVarStatus('*SYSTEM*', "$PMC_CFG.$EDIT_ENB", ladder_pmc_val_callback, "ladder_display_click_f1_button");
    }
  } else {
    ladder_display_click_f1_button_func();
  }
}

/*
 =========================================================================
 @function name            : ladder_display_click_f1_button_func
 @argument [value]         : get value with the server
 @argument [from_func]     : press button after func name
 @description              : processing in the case of pushed down(clicked) F1 key
 @return                   : none
 =========================================================================
*/
function ladder_display_click_f1_button_func(value, from_func) {
  if (g_symbol_flg == FLG_ON) {
    // in the case of opened the menu of symbol, close the menu
    ladder_display_click_f2_button();
  } else if (g_scaling_flg == FLG_ON) {
    ladder_display_click_f4_button();
  } else {
    // if (g_flick_flg_tbl.scrolling == FLG_ON) {
    //   stop_flick_scroll();
    //   return;
    // }  
    if (value === "TRUE") {
      document.getElementById('func_btn_9_4').innerHTML = pmc_lang_table['LadderTree'].func_btn_9_4;
      document.getElementById('func_btn_9_4').onclick = new Function("ladder_tree_click_f4_button();");
    } else if (value === "FALSE") {
      if (document.getElementById('func_btn_9_4').textContent !== "") {
        document.getElementById('func_btn_9_4').onclick = new Function("ladder_tree_click_f4_button();");
      } else if (document.getElementById('func_btn_9_4').textContent === "") {
        document.getElementById('func_btn_9_4').onclick = "";
      }
    }
    move_to_ladder_tree("screen_ladder_display", from_func);
    // return an indication start position of the scroll box to "0"
    scrollBoxPos.start_y = 0;
    scrollBoxPos.start_x = 0;
    // initialize list structure for display
    iterateArray = null;
    init_ladder_display_var();
  }
  setTimeout(function () {
    g_processing_flg = FLG_OFF;
  }, 10);
}

/*
 =========================================================================
 @function name : ladder_display_click_f2_button
 @argument      : none
 @description   : processing in the case of pushed down(clicked) F2 key
 @return        : none
 =========================================================================
*/
function ladder_display_click_f2_button() {
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }
  if(document.getElementById('func_menu_2_4').style.display == 'block'){
    ladder_display_scaling_menu_button(select_scaling_button);
    g_scaling_flg = FLG_OFF;
  }
  // display popup of the menu
  if(document.getElementById('func_menu_2_2').style.display == 'block'){
    ladder_display_symbol_menu_button(select_symbol_button);
    g_symbol_flg = FLG_OFF;
  } else {
    // display popup of the menu
    document.getElementById('func_menu_2_2').style.display = 'block';
    func_btn_2inner = document.getElementById('func_btn_2_2').innerHTML;
    var rep2_2_1 = func_btn_2inner.replace("[","|");
    var rep2_2_2 = rep2_2_1.replace("]","|");
    document.getElementById('func_btn_2_2').innerHTML = rep2_2_2;
    document.onkeydown = ladder_symbol_keydown;
    g_symbol_flg = FLG_ON;
    document.getElementById('worldDiv').style.zIndex = 0;
  }
}

/*
 =========================================================================
 @function name : move_to_ladder_display
 @argument [id] : the element id of the origin of transition
 @description   : API whitch changes in ladder display screen
 @return        : none
 =========================================================================
*/
function move_to_ladder_display(id, net_edit_move_flg) {
  // add words of "RUNNING" or "STOP" to header character string
  var headert_elem = document.getElementById(HEADER_ID_LADDER_DISPLAY);
  var tree_level = get_ladder_tree_level();
  g_net_cnt_before_tree = 0;
  read_address_conversion_flg = FLG_OFF;
  g_end_order_hit_flg = FLG_OFF;
  if (tree_level <= 3) {
    if (tree_level == 1) {
      g_net_cnt_before_tree = 0;
    } else if (tree_level == 2) {
      g_net_cnt_before_tree = g_lv_cnt_tbl[0].net_cnt;
      read_address_conversion_flg = FLG_ON;
    } else if (tree_level == 3) {
      g_net_cnt_before_tree = g_lv_cnt_tbl[0].net_cnt + g_lv_cnt_tbl[1].net_cnt;
    }
  } else if (tree_level >= 4) {
    read_address_conversion_flg = FLG_ON;
    for (var k = 0; k < g_lv_cnt_tbl.length; k++) {
      g_net_cnt_before_tree = g_net_cnt_before_tree + g_lv_cnt_tbl[k].net_cnt;
    }
    for (var l = 0; l < tree_level - 4; l++) {
      g_net_cnt_before_tree = g_net_cnt_before_tree + g_sub_pg_tbl[l].net_cnt;
    }
  }

  getPmcRunStatus(g_pmc_no, function (pmc_num, status) {
    if (g_pmc_no == PMC_MEMORY_TYPE_DCS) {
      headert_elem.innerHTML = (status == PMC_RUNNING) ? headert + safety + pmc_lang_table['LadderDisplay'].headert_2 + pmc_status_run : headert + safety + pmc_lang_table['LadderDisplay'].headert_2 + pmc_status_stop;
    } else {
      headert_elem.innerHTML = (status == PMC_RUNNING) ? headert + g_pmc_no + pmc_lang_table['LadderDisplay'].headert_2 + pmc_status_run : headert + g_pmc_no + pmc_lang_table['LadderDisplay'].headert_2 + pmc_status_stop;
    }
  });

  structure_ladder_disp(id);

  ladder_display_symbol_menu_bkcolor(g_tmp_symbol_no);
  document.onkeydown = ladder_display_keydown;
  var draw_area = CANVAS_AREA_LADDER_DISPLAY;
  // inherit display magnification
  if (g_pmc_num_chg_flg === FLG_ON) {
    g_pmc_num_chg_flg = FLG_OFF;
    ladder_display_scalingSet(g_tmp_scaling_no);
  }
  if (id === "screen_ladder_tree") {
    g_click_pos_disp_tbl = [
      { pos_ly: -1, pos_lx: -1, net_index: -1, search_result: -1 }
    ];
  } else if (id === "screen_ladder_search_result") {
    var search_level = get_ladder_search_range();
    var tree_level;
    tree_level = get_ladder_tree_level();
    if (search_level !== tree_level) {
      g_click_pos_disp_tbl = [
        { pos_ly: -1, pos_lx: -1, net_index: -1, search_result: -1 }
      ];
    }
  }
  if (net_edit_move_flg === undefined) {
    draw_figure(draw_area);
  }
  document.getElementById('screen_ladder_display').style.display = 'block';
  document.getElementById('worldDiv').style.display = 'block';
  if (net_edit_move_flg === undefined) {
    get_pmc_data_from_server(PMC_DATA_LOAD_KIND.PMC_DATA_COMPARE);
  }
}

/*
 =========================================================================
 @function name : structure_ladder_disp
 @argument [id] : none
 @description   : Create a ladder display screen structure
 @return        : none
 =========================================================================
*/
function structure_ladder_disp(id) {
  var grid_list_info_data = [];
  var grid_list_info_level = 0;
  var grid_list_info_subnum = 0;
  var bk_VIEW_MAX_COL;
  // genetare list stracture health for display
  if (id === 'screen_ladder_tree') {
    var tree_level = get_ladder_tree_level();

    grid_List = new List();
    g_net_num_tbl = [];
    g_result_list_net_num_tbl = [];
    g_make_grid_list_pos.temp_grid_cnt = 0;
    en_route_array.length = 0;
    bk_VIEW_MAX_COL = VIEW_MAX_COL;
    VIEW_MAX_COL = g_width_num;
    if (tree_level == 0) {
      make_sub_pg_flg = FLG_OFF;
      setg_array_grid_info(g_lv_cnt_tbl[0].mnemo_pos, CREATE_LIST_LIMIT, mnemonic_array, null);
    } else if (tree_level <= 3 && tree_level > 0) {
      make_sub_pg_flg = FLG_ON;
      setg_array_grid_info(g_lv_cnt_tbl[tree_level - 1].mnemo_pos, CREATE_LIST_LIMIT, mnemonic_array, null);
    } else if (tree_level >= 4) {
      make_sub_pg_flg = FLG_ON;
      setg_array_grid_info(g_sub_pg_tbl[tree_level - 4].mnemo_pos, CREATE_LIST_LIMIT, mnemonic_array, null);
    }
    VIEW_MAX_COL = bk_VIEW_MAX_COL;

    // it supports speedup of the ladder drawing
    // after initialization, copy it from target list in array
    iterateArray = [];
    iterateArray = grid_List.pushIterateArray();

    // initialization of the draw start position
    g_disp_net_index = 0;
    g_disp_grid_index = 0;
    g_disp_width_index = 0;

    if (document.getElementById("popup_no_comfirm_9").style.display === "block") {
      // close the popup during reading
      document.getElementById("popup_no_comfirm_9").style.display = "none";
      document.getElementById("popcomment_9_2").style.display = "none";
      Popdownbutton();
    }
  }

  screen_id = SCREEN_LADDER_DISPLAY;
  document.getElementById(id).style.display = 'none';
}

/*
 =========================================================================
 @function name : ladder_display_keydown
 @argument      : none
 @description   : processing in the case of pressed(clicked) hard key
                  (at the time of the menu non-display)
 @return        : none
 =========================================================================
*/
function ladder_display_keydown(event) {
  if (g_processing_flg === FLG_ON) {
    return;
  }
  var key_code = event.keyCode;
  var key_shift = event.shiftKey;
  var key_ctrl = event.ctrlKey;
  // invalidity of the key to notify a browser of
  invalidate_notification_key(event);

  // it is effective for only the F4 key during popup indication
  if (g_popup_flg === FLG_ON) {
    switch (key_code) {
      case 52:  // function4 key(TP environment)
      case 115:  // function4 key
        closeDialog();
        break;
      default:
        return;
    }
  } else {
    // if ((key_code == 9 || key_code == 33 || key_code == 34 || key_code == 38 || key_code == 40 || key_code == 37 || key_code == 39) && g_flick_flg_tbl.scrolling == FLG_ON) {
    //   stop_flick_scroll();
    //   return;
    // }
    switch (key_code) {
      case 9:  // keyboard up or keyboard down
        if (key_shift == false) {
          // keyboard down(TP environment)
          click_scroll_grid_move(CANVAS_AREA_LADDER_DISPLAY, ly = 0, KEYBOARD_DOWN);
        } else {
          // keyboard up(TP environment)
          click_scroll_grid_move(CANVAS_AREA_LADDER_DISPLAY, ly = 0, KEYBOARD_UP);
        }
        break;
      case 33:  // shift + keyboard up (PC PageUp)
        click_scroll_grid_move(CANVAS_AREA_LADDER_DISPLAY, ly = 0, KEYBOARD_SHIFT_UP);
        break;
      case 34:  // shift + keyboard down (PC PageDown)
        click_scroll_grid_move(CANVAS_AREA_LADDER_DISPLAY, ly = 0, KEYBOARD_SHIFT_DOWN);
        break;
      case 38:  // keyboard up
        click_scroll_grid_move(CANVAS_AREA_LADDER_DISPLAY, ly = 0, KEYBOARD_UP);
        break;
      case 40:  // keyboard down
        click_scroll_grid_move(CANVAS_AREA_LADDER_DISPLAY, ly = 0, KEYBOARD_DOWN);
        break;
      case 37:  // keyboard left
        if (key_shift == false) {
          click_scroll_grid_move_h(CANVAS_AREA_LADDER_DISPLAY, lx = 0, KEYBOARD_LEFT);
        } else {
          click_scroll_grid_move_h(CANVAS_AREA_LADDER_DISPLAY, lx = 0, KEYBOARD_SHIFT_LEFT);
        }
        break;
      case 39:  // keyboard right
        if (key_shift == false) {
          click_scroll_grid_move_h(CANVAS_AREA_LADDER_DISPLAY, lx = 0, KEYBOARD_RIGHT);
        } else {
          click_scroll_grid_move_h(CANVAS_AREA_LADDER_DISPLAY, lx = 0, KEYBOARD_SHIFT_RIGHT);
        }
        break;
      case 49:  // function1 key(TP environment)
        if (key_ctrl == true) {
          ladder_display_click_f1_button();
        }
        break;
      case 27:  // prev button(TP environment)
      case 112:  // function1 key
        ladder_display_click_f1_button();
        break;
      case 50:  // function2 key(TP environment)
        if (key_ctrl == true) {
          ladder_display_click_f2_button();
        }
        break;
      case 113:  // function2 key
        ladder_display_click_f2_button();
        break;
      case 51:  // function3 key(TP environment)
        if (key_ctrl == true) {
          ladder_display_click_f3_button();
        }
        break;
      case 114:  // function3 key
        ladder_display_click_f3_button();
        break;
      case 52: // function4 key(TP environment)
        if (key_ctrl == true) {
          ladder_display_click_f4_button();
        }
        break;
      case 115:  // function4 key
        ladder_display_click_f4_button();
        break;
      default:
        return;
    }
  }
}
/*
 =========================================================================
 @function name : ladder_scaling_keydown
 @argument      : none
 @description   : processing in the case of pressed(clicked) hard key
                  (at the time of the scaling menu indication)
 @return        : none
 =========================================================================
*/
function ladder_scaling_keydown(event) {
  var key_code = event.keyCode;
  var key_shift = event.shiftKey;
  var key_ctrl = event.ctrlKey;
  // invalidity of the key to notify a browser of
  invalidate_notification_key(event);

  switch (key_code) {
  case 9:  // keyboard up or keyboard down
    if (key_shift == false) {
      // keyboard down(TP environment)
      g_tmp_scaling_no += 1;
      if (SCALING_16_16 < g_tmp_scaling_no) {
        g_tmp_scaling_no= SCALING_HORIZON_FIT;
      }
      ladder_display_scaling_menu_bkcolor(g_tmp_scaling_no);
    } else {
      // keyboard up(TP environment)
      g_tmp_scaling_no -= 1;
      if (SCALING_HORIZON_FIT > g_tmp_scaling_no) {
        g_tmp_scaling_no = SCALING_16_16;
      }
      ladder_display_scaling_menu_bkcolor(g_tmp_scaling_no);
    }
      break;
  case 49:  // 1 key
  case 97:  // 1 key
    if (key_ctrl == false) {
      g_tmp_scaling_no = 1;
      ladder_display_scaling_menu_bkcolor(g_tmp_scaling_no);
    } else if (key_code == 49 && key_ctrl == true) {
      ladder_display_click_f1_button();
    }
    break;
  case 50:  // 2 key
  case 98:  // 2 key
    if (key_ctrl == false) {
      g_tmp_scaling_no = 2;
      ladder_display_scaling_menu_bkcolor(g_tmp_scaling_no);
    } else if (key_code == 50 && key_ctrl == true) {
      ladder_display_click_f2_button();
    }
    break;
  case 51:  // 3 key
  case 99:  // 3 key
    if (key_ctrl == false) {
      g_tmp_scaling_no = 3;
      ladder_display_scaling_menu_bkcolor(g_tmp_scaling_no);
    } else if (key_code == 51 && key_ctrl == true) {
      ladder_display_click_f3_button();
    }
    break;
  case 52:  // 4 key
  case 100:  // 4 key
    if (key_ctrl == false) {
      g_tmp_scaling_no = 4;
      ladder_display_scaling_menu_bkcolor(g_tmp_scaling_no);
    } else if (key_code == 52 && key_ctrl == true) {
      ladder_display_click_f4_button();
    }
    break;
  case 53:  // 5 key
  case 101:  // 5 key
    if (key_ctrl == false) {
      g_tmp_scaling_no = 5;
      ladder_display_scaling_menu_bkcolor(g_tmp_scaling_no);
    }
    break;
  case 54:  // 6 key
  case 102:  // 6 key
    if (key_ctrl == false) {
      g_tmp_scaling_no = 6;
      ladder_display_scaling_menu_bkcolor(g_tmp_scaling_no);
    }
    break;  
  case 13:  // enter
    ladder_display_scaling_menu_button(g_tmp_scaling_no);
    break;
  case 27:  // prev button(TP environment)
    ladder_display_click_f4_button();
    break;
  case 38:  // keyboard up
    g_tmp_scaling_no -= 1;
    if (SCALING_HORIZON_FIT > g_tmp_scaling_no) {
      g_tmp_scaling_no = SCALING_16_16;
    }
    ladder_display_scaling_menu_bkcolor(g_tmp_scaling_no);
    break;
  case 40:  // keyboard down
    g_tmp_scaling_no += 1;
    if (SCALING_16_16 < g_tmp_scaling_no) {
      g_tmp_scaling_no= SCALING_HORIZON_FIT;
    }
    ladder_display_scaling_menu_bkcolor(g_tmp_scaling_no);
    break;
  case 112:  // function1 key
    ladder_display_click_f1_button();
    break;
  case 113:  // function2 key
    ladder_display_click_f2_button();
    break;
  case 114:  // function3 key
    ladder_display_click_f3_button();
    break;
  case 115:  // function4 key
    ladder_display_click_f4_button();
    break; 
  default:
    break;
  }
  
}

/*
 =========================================================================
 @function name : ladder_symbol_keydown
 @argument      : none
 @description   : processing in the case of pushed down(clicked) hard key
                  (at the time of symbol menu indication)
 @return        : none
 =========================================================================
*/
function ladder_symbol_keydown(event) {
  var key_code = event.keyCode;
  var key_shift = event.shiftKey;
  var key_ctrl = event.ctrlKey;
  // invalidity of the key to notify a browser of
  invalidate_notification_key(event);

  switch (key_code) {
  case 9:  // keyboard up or keyboard down
      if (key_shift == false) {
        // keyboard down(TP environment)
        g_tmp_symbol_no += 1;
        if (g_tmp_symbol_no > SYMBOL_KIND_SYMBOL_COMMENT) {
          g_tmp_symbol_no = SYMBOL_KIND_ADDRESS;
        }
        ladder_display_symbol_menu_bkcolor(g_tmp_symbol_no);
      } else {
        // keyboard up(TP environment)
        g_tmp_symbol_no -= 1;
        if (g_tmp_symbol_no < SYMBOL_KIND_ADDRESS) {
          g_tmp_symbol_no = SYMBOL_KIND_SYMBOL_COMMENT;
        }
        ladder_display_symbol_menu_bkcolor(g_tmp_symbol_no);
      }
      break;
    case 49:  // 1 key
    case 97:  // 1 key
      if (key_ctrl == false) {
        g_tmp_symbol_no = 1;
        ladder_display_symbol_menu_bkcolor(g_tmp_symbol_no);
      } else if (key_code == 49 && key_ctrl == true) {
        ladder_display_click_f1_button();
      }
      break;
    case 50:  // 2 key
    case 98:  // 2 key
      if (key_ctrl == false) {
        g_tmp_symbol_no = 2;
        ladder_display_symbol_menu_bkcolor(g_tmp_symbol_no);
      } else if (key_code == 50 && key_ctrl == true) {
        ladder_display_click_f2_button();
      }
      break;
    case 51:  // 3 key
    case 99:  // 3 key
      if (key_ctrl == false) {
        g_tmp_symbol_no = 3;
        ladder_display_symbol_menu_bkcolor(g_tmp_symbol_no);
      } else if(key_code == 51 && key_ctrl == true){
        ladder_display_click_f3_button();
      }
      break;
    case 52:  // 4 key
    case 100:  // 4 key
      if (key_ctrl == false) {
        g_tmp_symbol_no = 4;
        ladder_display_symbol_menu_bkcolor(g_tmp_symbol_no);
      } else if (key_code == 52 && key_ctrl == true) {
        ladder_display_click_f4_button();
      }
      break;
    case 53:  // 5 key
    case 101:  // 5 key
      if (key_ctrl == false) {
        g_tmp_symbol_no = 5;
        ladder_display_symbol_menu_bkcolor(g_tmp_symbol_no);
      }
      break;
    case 54:  // 6 key
    case 102:  // 6 key
      if (key_ctrl == false) {
        g_tmp_symbol_no = 6;
        ladder_display_symbol_menu_bkcolor(g_tmp_symbol_no);
      }
    break;
  case 13:  // enter
    ladder_display_symbol_menu_button(g_tmp_symbol_no);
    break;
  case 27:  // prev button(TP environment)
    ladder_display_click_f2_button();
    break;
  case 38:  // keyboard up
    g_tmp_symbol_no -= 1;
    if (g_tmp_symbol_no < SYMBOL_KIND_ADDRESS) {
      g_tmp_symbol_no = SYMBOL_KIND_SYMBOL_COMMENT;
    }
    ladder_display_symbol_menu_bkcolor(g_tmp_symbol_no);
    break;
  case 40:  // keyboard down
    g_tmp_symbol_no += 1;
    if (g_tmp_symbol_no > SYMBOL_KIND_SYMBOL_COMMENT) {
      g_tmp_symbol_no = SYMBOL_KIND_ADDRESS;
    }
    ladder_display_symbol_menu_bkcolor(g_tmp_symbol_no);
      break;
  case 112:  // function1 key
     ladder_display_click_f1_button();
    break;
  case 113:  // function2 key
  ladder_display_click_f2_button();
    break;
  case 114:  // function3 key
    ladder_display_click_f3_button();
    break;
  case 115:  // function4 key
    ladder_display_click_f4_button();
    break;
  default:
    break;
  }
}

/*
 =========================================================================
 @function name        : ladder_display_scaling_menu_button
 @argument [symbol_no] : selected the magnification
 @description          : change of magnification choice background color during magnification choice
 @return               : none
 =========================================================================
*/
function ladder_display_scaling_menu_button(scaling_no) {
  document.getElementById('func_menu_2_4').style.display = 'none';
  document.getElementById('func_btn_2_4').innerHTML = func4inner;
  document.getElementById('worldDiv').style.zIndex = 2;

  // update of the inside information
  select_scaling_button = scaling_no;
  g_tmp_scaling_no = scaling_no;
  ladder_display_scaling_menu_bkcolor(scaling_no);

  g_edit_menu = document.getElementById('scaleMenu_5').children;
  g_tmp_scaling_no_editor = scaling_no;
  ladder_editor_menu_bkcolor(scaling_no);
  ladder_display_scalingSet(scaling_no);

  // symbol information was updated,redraw
  draw_ladder_diagram(SCROLLBAR_ACTION_NO_ACTION, CANVAS_AREA_LADDER_DISPLAY);

  // return key handler to ladder display screen
  document.onkeydown = ladder_display_keydown;
  g_scaling_flg = FLG_OFF;
}

/*
 =========================================================================
 @function name              : ladder_display_symbol_menu_tmp
 @argument [g_tmp_symbol_no] : selected the symbol
 @description                : change of symbol choice background color during symbol choice
 @return                     : none
 =========================================================================
*/
function ladder_display_symbol_menu_tmp(g_tmp_symbol_no) {
  // choice information of the symbol is stored temporarily
  switch (g_tmp_symbol_no) {
    case SYMBOL_KIND_ADDRESS:
      // address
      ladder_display_symbol_menu_bkcolor(g_tmp_symbol_no);
      break;
    case SYMBOL_KIND_SYMBOL:
      // symbols
      ladder_display_symbol_menu_bkcolor(g_tmp_symbol_no);
      break;
    case SYMBOL_KIND_ADDRESS_SYMBOL:
      // address & symbols
      ladder_display_symbol_menu_bkcolor(g_tmp_symbol_no);
      break;
    case SYMBOL_KIND_COMMENT:
      // comment
      ladder_display_symbol_menu_bkcolor(g_tmp_symbol_no);
      break;
    case SYMBOL_KIND_ADDRESS_COMMENT:
      // address & comment
      ladder_display_symbol_menu_bkcolor(g_tmp_symbol_no);
      break;
    case SYMBOL_KIND_SYMBOL_COMMENT:
      // symbols & comment
      ladder_display_symbol_menu_bkcolor(g_tmp_symbol_no);
      break;
    default:
      break;
  }
}

/*
 =========================================================================
 @function name        : ladder_display_symbol_menu_button
 @argument [symbol_no] : the symbol which was chosen
 @description          : redraw with the information of the selected symbol
 @return               : none
 =========================================================================
*/
function ladder_display_symbol_menu_button(symbol_no) {
  document.getElementById('func_menu_2_2').style.display = 'none';
  document.getElementById('func_btn_2_2').innerHTML = func_btn_2inner;
  document.getElementById('worldDiv').style.zIndex = 2;
  g_symbol_flg = FLG_OFF;
  // check of the dirty value
  switch(symbol_no){
    case SYMBOL_KIND_ADDRESS:
    case SYMBOL_KIND_SYMBOL:
    case SYMBOL_KIND_ADDRESS_SYMBOL:
    case SYMBOL_KIND_COMMENT:
    case SYMBOL_KIND_ADDRESS_COMMENT:
    case SYMBOL_KIND_SYMBOL_COMMENT:
      break;
    default:
      return;
  }

  // update of the inside information
  select_symbol_button = symbol_no;
  g_tmp_symbol_no = symbol_no;
  g_tmp_symbol_no_editor = symbol_no;
  ladder_display_symbol_menu_bkcolor(symbol_no);
  g_edit_menu = document.getElementById('symbolMenu_5').children;
  ladder_editor_menu_bkcolor(symbol_no);


  // symbol information was updated,redraw
  draw_ladder_diagram(SCROLLBAR_ACTION_UP_BUTTON, CANVAS_AREA_LADDER_DISPLAY);

  // return key handler to ladder display screen
  document.onkeydown = ladder_display_keydown;
}

/*
 =========================================================================
 @function name        : ladder_display_scaling_menu_bkcolor
 @argument [symbol_no] : selected the magnification
 @description          : selected background color
 @return               : none
 =========================================================================
*/
function ladder_display_scaling_menu_bkcolor(scaling_no) {
  document.getElementById('scaling1_1').style.backgroundColor = COLOR_LIGHT_GRAY;
  document.getElementById('scaling1_2').style.backgroundColor = COLOR_LIGHT_GRAY;
  document.getElementById('scaling1_3').style.backgroundColor = COLOR_LIGHT_GRAY;
  document.getElementById('scaling1_4').style.backgroundColor = COLOR_LIGHT_GRAY;
  document.getElementById('scaling1_5').style.backgroundColor = COLOR_LIGHT_GRAY;
  document.getElementById('scaling1_6').style.backgroundColor = COLOR_LIGHT_GRAY;

  switch(scaling_no){
  case SCALING_HORIZON_FIT:
    document.getElementById('scaling1_1').style.backgroundColor = '#0e90b8';
    break;
  case SCALING_4_4:
    document.getElementById('scaling1_2').style.backgroundColor = '#0e90b8';
    break;
  case SCALING_6_6:
    document.getElementById('scaling1_3').style.backgroundColor = '#0e90b8';
    break;
  case SCALING_8_8:
    document.getElementById('scaling1_4').style.backgroundColor = '#0e90b8';
    break;
  case SCALING_12_12:
    document.getElementById('scaling1_5').style.backgroundColor = '#0e90b8';
    break;
  case SCALING_16_16:
    document.getElementById('scaling1_6').style.backgroundColor = '#0e90b8';
    break;
  default:
    break;
  }
}

/*
 =========================================================================
 @function name        : ladder_display_scalingSet
 @argument [symbol_no] : selected the magnification
 @description          : width and height fir each magnification
 @return               : none
 =========================================================================
*/
function ladder_display_scalingSet(scaling_no) {
  switch(scaling_no){
  case SCALING_HORIZON_FIT:
    if(g_scaling_sizefit_col < 8){
      VIEW_GRID_COL=8; // grid size(click position)
      VIEW_GRID_ROW=8;
      VIEW_MAX_ROW=8;
      VIEW_MAX_COL=8;
    } else if(g_scaling_sizefit_col > 16){
      VIEW_GRID_COL=16; // grid size(click position)
      VIEW_GRID_ROW=16;
      VIEW_MAX_ROW=16;
      VIEW_MAX_COL=16;
    } else {
      VIEW_GRID_COL=g_scaling_sizefit_col; // grid size(click position)
      VIEW_GRID_ROW=g_scaling_sizefit_col;
      VIEW_MAX_ROW=g_scaling_sizefit_col;
      VIEW_MAX_COL=g_scaling_sizefit_col;
    }
    g_scale_factor=g_scaling_sizefit_per; // fit to horizon
    break;
  case SCALING_4_4:
    VIEW_GRID_COL=4;
    VIEW_GRID_ROW=4;
    VIEW_MAX_ROW=4;
    VIEW_MAX_COL=4;
    g_scale_factor=SCALING_200PERCENT;
    break;
  case SCALING_6_6:
    VIEW_GRID_COL=6;
    VIEW_GRID_ROW=6;
    VIEW_MAX_ROW=6;
    VIEW_MAX_COL=6;
    g_scale_factor=SCALING_133PERCENT;
    break;
  case SCALING_8_8:
    VIEW_GRID_COL=8;
    VIEW_GRID_ROW=8;
    VIEW_MAX_ROW=8;
    VIEW_MAX_COL=8;
    g_scale_factor=SCALING_100PERCENT;
    break;
  case SCALING_12_12:
    VIEW_GRID_COL=12;
    VIEW_GRID_ROW=12;
    VIEW_MAX_ROW=12;
    VIEW_MAX_COL=12;
    g_scale_factor=SCALING_066PERCENT;
    break;
  case SCALING_16_16:
    VIEW_GRID_COL=16;
    VIEW_GRID_ROW=16;
    VIEW_MAX_ROW=16;
    VIEW_MAX_COL=16;
    g_scale_factor=SCALING_050PERCENT;
    break;
  default:
    break;
  }
}

/*
 =========================================================================
 @function name        : ladder_display_symbol_menu_bkcolor
 @argument [symbol_no] : the symbol which was chosen
 @description          : redraw with the information of the selected symbol
 @return               : none
 =========================================================================
*/
function ladder_display_symbol_menu_bkcolor(symbol_no) {
  switch(symbol_no){
  case SYMBOL_KIND_ADDRESS:
      // Address
      document.getElementById('symbol2_1').style.backgroundColor = '#0e90b8';
      document.getElementById('symbol2_2').style.backgroundColor = '#e1e7ec';
      document.getElementById('symbol2_3').style.backgroundColor = '#e1e7ec';
      document.getElementById('symbol2_4').style.backgroundColor = '#e1e7ec';
      document.getElementById('symbol2_5').style.backgroundColor = '#e1e7ec';
      document.getElementById('symbol2_6').style.backgroundColor = '#e1e7ec';
    break;
  case SYMBOL_KIND_SYMBOL:
      // Symbols
      document.getElementById('symbol2_1').style.backgroundColor = '#e1e7ec';
      document.getElementById('symbol2_2').style.backgroundColor = '#0e90b8';
      document.getElementById('symbol2_3').style.backgroundColor = '#e1e7ec';
      document.getElementById('symbol2_4').style.backgroundColor = '#e1e7ec';
      document.getElementById('symbol2_5').style.backgroundColor = '#e1e7ec';
      document.getElementById('symbol2_6').style.backgroundColor = '#e1e7ec';
    break;
  case SYMBOL_KIND_ADDRESS_SYMBOL:
      // Address & Symbols
      document.getElementById('symbol2_1').style.backgroundColor = '#e1e7ec';
      document.getElementById('symbol2_2').style.backgroundColor = '#e1e7ec';
      document.getElementById('symbol2_3').style.backgroundColor = '#0e90b8';
      document.getElementById('symbol2_4').style.backgroundColor = '#e1e7ec';
      document.getElementById('symbol2_5').style.backgroundColor = '#e1e7ec';
      document.getElementById('symbol2_6').style.backgroundColor = '#e1e7ec';
    break;
  case SYMBOL_KIND_COMMENT:
      // Comment
      document.getElementById('symbol2_1').style.backgroundColor = '#e1e7ec';
      document.getElementById('symbol2_2').style.backgroundColor = '#e1e7ec';
      document.getElementById('symbol2_3').style.backgroundColor = '#e1e7ec';
      document.getElementById('symbol2_4').style.backgroundColor = '#0e90b8';
      document.getElementById('symbol2_5').style.backgroundColor = '#e1e7ec';
      document.getElementById('symbol2_6').style.backgroundColor = '#e1e7ec';
    break;
  case SYMBOL_KIND_ADDRESS_COMMENT:
      // Address & Comment
      document.getElementById('symbol2_1').style.backgroundColor = '#e1e7ec';
      document.getElementById('symbol2_2').style.backgroundColor = '#e1e7ec';
      document.getElementById('symbol2_3').style.backgroundColor = '#e1e7ec';
      document.getElementById('symbol2_4').style.backgroundColor = '#e1e7ec';
      document.getElementById('symbol2_5').style.backgroundColor = '#0e90b8';
      document.getElementById('symbol2_6').style.backgroundColor = '#e1e7ec';
    break;
  case SYMBOL_KIND_SYMBOL_COMMENT:
      // Symbols & Comment
      document.getElementById('symbol2_1').style.backgroundColor = '#e1e7ec';
      document.getElementById('symbol2_2').style.backgroundColor = '#e1e7ec';
      document.getElementById('symbol2_3').style.backgroundColor = '#e1e7ec';
      document.getElementById('symbol2_4').style.backgroundColor = '#e1e7ec';
      document.getElementById('symbol2_5').style.backgroundColor = '#e1e7ec';
      document.getElementById('symbol2_6').style.backgroundColor = '#0e90b8';
    break;
  default:
    break;
  }
}

/*
 =========================================================================
 @function name : ladder_display_click_f3_button
 @argument      : none
 @description   : processing in the case of pushed down(clicked) F3 key
 @return        : none
 =========================================================================
*/
function ladder_display_click_f3_button() {
  if (g_processing_flg === FLG_ON) {
    return;
  }
  if (g_symbol_flg == FLG_ON) {
    // in the case of opened the menu of symbol button, close the menu
    ladder_display_click_f2_button();
  } else if (g_scaling_flg == FLG_ON){
    ladder_display_click_f4_button();
  } else {
    // if (g_flick_flg_tbl.scrolling == FLG_ON) {
    //   stop_flick_scroll();
    //   return;
    // }  
    old_screen_id = SCREEN_LADDER_DISPLAY;
    move_to_ladder_search('screen_ladder_display');
    init_ladder_display_var();
  }
}

/*
 =========================================================================
 @function name : ladder_display_click_f4_button
 @argument      : none
 @description   : processing in the case of pushed down(clicked) F4 key
 @return        : none
 =========================================================================
*/
function ladder_display_click_f4_button() {
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }
  if(document.getElementById('func_menu_2_2').style.display == 'block'){
    ladder_display_symbol_menu_button(select_symbol_button);
    g_symbol_flg = FLG_OFF;
  }
  // display popup of the menu
  if (document.getElementById('func_menu_2_4').style.display == 'block') {
    ladder_display_scaling_menu_button(select_scaling_button);
    document.getElementById('worldDiv').style.zIndex = 2;
    g_scaling_flg = FLG_OFF;
  } else {
    // display popup of the menu
    document.getElementById('func_menu_2_4').style.display = 'block';
    func4inner = document.getElementById('func_btn_2_4').innerHTML;
    var rep2_4_1 = func4inner.replace("[","|");
    var rep2_4_2 = rep2_4_1.replace("]","|");
    document.getElementById('func_btn_2_4').innerHTML = rep2_4_2;
    document.onkeydown = ladder_scaling_keydown;
    ladder_display_scaling_menu_bkcolor(select_scaling_button);
    
    g_scaling_flg = FLG_ON;
    document.getElementById('worldDiv').style.zIndex = 0;
  }
}

/*
 =========================================================================
 @function name : init_ladder_display_var
 @argument      : none
 @description   : [update ladder color]init variable
 @return        : none
 =========================================================================
*/
function init_ladder_display_var() {
  init_grid_update();
  clearTimeout(g_interval_timer);

}

/*
 =========================================================================
 @function name        : draw_figure
 @argument [draw_area] : the canvas area to draw
 @description          : main function to draw ladder diagram
 @return [false]       : unjust end
 =========================================================================
*/
function draw_figure(draw_area) {
  // acquire to draw context
  // canvas setting for scroll
  switch(draw_area){
    case CANVAS_AREA_LADDER_DISPLAY:
    case CANVAS_AREA_LADDER_EDITOR:
    case CANVAS_AREA_LADDER_SEARCH_RESULT:
    case CANVAS_AREA_LADDER_SEARCH_RESULT_LIST:
    case CANVAS_AREA_LADDER_SEARCH_REPLACE:
      canvas = document.getElementById('canvas_area');
      scrollcanvas = document.getElementById('scroll');
      scrollcanvas_h = document.getElementById('scroll_h');
      break;
    default:
      console.error("INVARID_DRAW_AREA : " + draw_area);
      return false;
  }

  if(!canvas || !canvas.getContext || !scrollcanvas || !scrollcanvas_h || !scrollcanvas.getContext) {
    return false;
  }
  // enable draw function(acquire 2D context to use a function of the draw)
  ctx = canvas.getContext('2d');

  // enable draw function(acquire 2D context to use a function of the draw)
  sctx = scrollcanvas.getContext('2d');

  shctx = scrollcanvas_h.getContext('2d');

  // set the initial value of the variable
  init_ladder_display_var();

  // draw to ladder diagram
  scrollbar_tbl.ly = 0;
  scrollbar_tbl.lx = 0;
  var click_info = SCROLLBAR_ACTION_NO_ACTION;
  draw_ladder_diagram(click_info,draw_area);

  click_remove_event();
  // set click event for canvas element
  if(draw_area == CANVAS_AREA_LADDER_DISPLAY || draw_area == CANVAS_AREA_LADDER_NETEDIT){
    // scroll by the grid unit
    scrollcanvas.addEventListener('click', click_scroll_grid, false);
    scrollcanvas_h.addEventListener('click', click_scroll_grid, false);
  } else if (draw_area == CANVAS_AREA_LADDER_EDITOR || draw_area == CANVAS_AREA_LADDER_SEARCH_RESULT_LIST || draw_area == CANVAS_AREA_LADDER_SEARCH_REPLACE) {
    // scroll by the net unit
    scrollcanvas.addEventListener('click', click_scroll_net, false);
    scrollcanvas_h.addEventListener('click', click_scroll_grid, false);
    canvas.addEventListener('click', click_net, false);
  } else { }

  if ((draw_area == CANVAS_AREA_LADDER_SEARCH_RESULT) && (old_screen_id == SCREEN_LADDER_DISPLAY)) {
    // scroll by the grid unit
    scrollcanvas.addEventListener('click', click_scroll_grid, false);
    scrollcanvas_h.addEventListener('click', click_scroll_grid, false);
  } else if ((draw_area == CANVAS_AREA_LADDER_SEARCH_RESULT) && (old_screen_id == SCREEN_LADDER_EDITOR)) {
    // scroll by the net unit
    scrollcanvas.addEventListener('click', click_scroll_net, false);
    scrollcanvas_h.addEventListener('click', click_scroll_grid, false);
    canvas.addEventListener('click', click_net, false);
  } else { }

  if (draw_area == CANVAS_AREA_LADDER_DISPLAY || (draw_area == CANVAS_AREA_LADDER_SEARCH_RESULT && old_screen_id === SCREEN_LADDER_DISPLAY)) {
    if (document.getElementById('popup_no_comfirm_4').style.display !== "block") {
      canvas.addEventListener('click', onClick, false);
    }
  }
  canvas.addEventListener('wheel', wheel_scroll, false);
  // if (g_device === 'smt' && top.tpkeyssheet !== undefined) { // using tabletTP
  //   canvas.addEventListener('touchstart', touchstart_scroll, false);
  //   canvas.addEventListener('touchend', touchend_scroll, false);
  //   scrollcanvas.addEventListener('touchstart', touchstart_scroll, false);
  //   scrollcanvas.addEventListener('touchend', touchend_scroll, false);
  //   scrollcanvas_h.addEventListener('touchstart', touchstart_scroll, false);
  //   scrollcanvas_h.addEventListener('touchend', touchend_scroll, false);
  // }
}

/*
 =========================================================================
 @function name         : draw_ladder_diagram
 @argument [click_info] : click information
 @argument [draw_area]  : the canvas area to draw
 @description           : draw to the ladder diagram
 @return [1/-1]         : PMC RUNNING / PMC STOP
 =========================================================================
*/
function draw_ladder_diagram(click_info, draw_area, search_prev_next_flg, scroll_low_btn_click_flg) {

  var lx_i = 0;
  var ly_i = 0;

  var lx_p = 0;
  var ly_p = 0;
  var search_hit_redraw_flg = FLG_OFF;

  var net_index_flg = FLG_OFF;
  var grid_pos_y = 0;
  var grid_pos_x = 0;
  var click_grid_pos_flg = FLG_OFF;
  var select_tree_level = get_ladder_tree_level();
  var search_level = get_ladder_search_range();
  var net_end_count = 0;

  // [update ladder color]calc net index
  var call_draw_fig = 'FigureImageDraw_';
  // the acquisition of the canvas drawing domain
  var drawing_area_info = document.getElementById('canvas_area');

  switch (draw_area) {
    case CANVAS_AREA_LADDER_SEARCH_RESULT:
      var search_level = get_ladder_search_range();
      var tree_level;
      if (old_screen_id == SCREEN_LADDER_DISPLAY) {
        tree_level = get_ladder_tree_level();
      } else if (old_screen_id == SCREEN_LADDER_EDITOR) {
        tree_level = get_ladder_tree_edit_level();
      }
      break;
    default:
      break;
  }

  iterateArray = [];
  iterateArray = grid_List.pushIterateArray();
  
  var drawing_area_width = drawing_area_info.attributes.width.nodeValue;
  var drawing_area_height = drawing_area_info.attributes.height.nodeValue;

  // offset to ajust the draw position(line of both ends of the ladder diagram)
  var canvas_x_offset = 10;
  if (g_scroll_chg_flg == FLG_OFF) { // using iPendant or opboard screen
    var canvas_x_offset_2 = 54;
    var canvas_y_offset = 16;
  } else {
    var canvas_x_offset_2 = 10;
    var canvas_y_offset = 20;
  }

  // calculate size for 1 grid
  // in the scaling processing, the grid size is not changed(fix it with the eight)
  var grid_x_size = (drawing_area_width - canvas_x_offset - canvas_x_offset_2) / VIEW_GRID_COL;
  var grid_y_size = (drawing_area_height - canvas_y_offset) / VIEW_GRID_COL;
  // [update ladder color]set one grid size
  if (draw_area === CANVAS_AREA_LADDER_DISPLAY) {
    init_ladder_display_var();
    g_array_grid_update.x_size = grid_x_size;
    g_array_grid_update.y_size = grid_y_size;
    g_array_grid_update.identifier = g_disp_net_index + "_" + g_disp_width_index + "_" + g_array_grid_update.update;
  }

  // start draw processing
  ctx.beginPath();  // declaration of the drawing start
  ctx.strokeStyle = COLOR_BLACK;  // filled style
  ctx.fillStyle = COLOR_BLACK;  // style of the contour line

  // filled rectangle(light gray)
  ctx.fillStyle = COLOR_LIGHT_GRAY;
  ctx.fillRect(0, 0, drawing_area_width, drawing_area_height);

  if (click_info === SCROLLBAR_ACTION_NO_ACTION) {
    g_max_col_num = grid_List.getDataNum(0, iterateArray)[0].length;


    if (screen_id !== SCREEN_LADDER_SEARCH_RESULT) {
      if (select_tree_level == 0) {
        lengthcount = g_all_grid_cnt + 3; // +3 is for "END" Order
      } else if (select_tree_level <= 3) {
        lengthcount = g_lv_cnt_tbl[Number(select_tree_level) - 1].grid_cnt;
      } else if (select_tree_level >= 4) {
        lengthcount = g_sub_pg_tbl[Number(select_tree_level) - 4].grid_cnt;
      }
    } else {
      if (search_level == 0) {
        lengthcount = g_all_grid_cnt + 3; // +3 is for "END" Order
      } else if (search_level <= 3) {
        lengthcount = g_lv_cnt_tbl[Number(search_level) - 1].grid_cnt;
      } else if (search_level >= 4) {
        lengthcount = g_sub_pg_tbl[Number(search_level) - 4].grid_cnt;
      }
    }
    make_grid_pos();
    for (var ly_p = 0; ly_p < g_all_grid_cnt; ly_p++) {
      for (var lx_p = 0; lx_p < g_max_col_num; lx_p++) {
        // stores grid position(coordinate)
        g_array_grid_pos[ly_p][lx_p].pos_x = canvas_x_offset + lx_p * grid_x_size;
        g_array_grid_pos[ly_p][lx_p].pos_y = 5 + ly_p * grid_y_size;
      }
    }
  }

  ly_p = 0;
  lx_p = 0;
  g_row_limit = 0;

  var select_tree_edit_level = get_ladder_tree_edit_level();
  var net_index = g_disp_net_index;
  var grid_index = g_disp_grid_index;
  var width_index = g_disp_width_index;

  document.getElementById('stopwatch_1').style.display = 'none';
  document.getElementById('stopwatch_2').style.display = 'none';
  document.getElementById('stopwatch_3').style.display = 'none';
  document.getElementById('stopwatch_4').style.display = 'none';
  document.getElementById('stopwatch_5').style.display = 'none';
  document.getElementById('stopwatch_6').style.display = 'none';

  g_stopwatch_pos = [-1, -1, -1, -1, -1, -1];

  g_stopwatch_1_flg = FLG_OFF;
  g_stopwatch_2_flg = FLG_OFF;
  g_stopwatch_3_flg = FLG_OFF;
  g_stopwatch_4_flg = FLG_OFF;
  g_stopwatch_5_flg = FLG_OFF;
  g_stopwatch_6_flg = FLG_OFF;
 
  if (screen_id === SCREEN_LADDER_SEARCH_RESULT_LIST) {
    net_index = g_result_list_net_num_tbl.indexOf(g_disp_net_index + 1);
  } else {
    net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
  }
  //list update  check
  grid_List.forEach_net_cnt(net_index, iterateArray, click_info, scroll_low_btn_click_flg, function (data, next_update_flg) {
    var bk_VIEW_MAX_COL;
    bk_VIEW_MAX_COL = VIEW_MAX_COL;
    g_net_num_tbl = [];
    g_result_list_net_num_tbl = [];
    VIEW_MAX_COL = g_width_num;
    if (data == null && next_update_flg === FLG_ON) {
      //update next
      net_index = update_list_down();
    } else if (data == null && next_update_flg === FLG_OFF) {
      //update prev or scrollbar touch
      net_index = update_list_jump();
    }
    VIEW_MAX_COL = bk_VIEW_MAX_COL;
    if (screen_id === SCREEN_LADDER_SEARCH_RESULT ||screen_id === SCREEN_LADDER_SEARCH_RESULT_LIST ||screen_id === SCREEN_LADDER_SEARCH_REPLACE) {
      var bk_g_disp_width_index = g_disp_width_index;
      var bk_scrollbar_tbl_ly = scrollbar_tbl.ly;
      g_search_result_index = 0;
      g_array_search_result_index = [];
      upd_list_result_info(FLG_OFF);
      if (search_prev_next_flg === FLG_ON || screen_id === SCREEN_LADDER_SEARCH_RESULT || screen_id === SCREEN_LADDER_SEARCH_REPLACE) {
        var result_net_cnt = 0;
        for (var i = 0; i < g_array_search_result_netnum.length; i++){
          if (g_result_index - i < 0) {
            break;
          }
          if (g_array_search_result_netnum[g_result_index - i].net_num == g_array_search_result_netnum[g_result_index].net_num) {
            result_net_cnt += 1; 
          } else {
            break;
          }
        }
        for (var j = 0; j < g_array_search_result_index.length; j++){
          if (g_array_search_result_index[j].net_index == g_net_cnt_before_tree + g_array_search_result_netnum[g_result_index].net_num) {
            for (var k = result_net_cnt - 1; k > 0; k--){
              g_search_result_index += 1;
            }
            break;
          } else {
            g_search_result_index += 1;
          }
        }
      }
      g_disp_grid_index = grid_index;
      var length_cnt = length_count_func(g_disp_net_index);
      scrollBoxPos.start_y = SBHV_POS_E + scrollBoxPos.box_height * (g_disp_grid_index + length_cnt);  
      g_disp_width_index = bk_g_disp_width_index;
      scrollbar_tbl.ly = bk_scrollbar_tbl_ly;
    }
  });

  grid_List.forEach_row(net_index, grid_index, iterateArray, function (data, i, fixed_grid_index, level, subnum) {
    net_end_count = i;
    g_net_end_count = i;
    g_draw_subroutine_flg_tbl = { draw: FLG_OFF, draw_marker: FLG_OFF, draw_index_x: 0, draw_index_y: 0, height: 0 };
    
    if (screen_id == SCREEN_LADDER_SEARCH_RESULT_LIST) {
      if (g_net_cnt_before_tree + g_all_click_net_index + 1 === g_result_list_net_num_tbl[i]) {
        net_index_flg = FLG_ON;
      }
    } else {
      if (g_net_cnt_before_tree + g_all_click_net_index + 1 === g_net_num_tbl[i]) {
        net_index_flg = FLG_ON;
      }
    }

    // [update ladder color]entry net data(for display)
    if (draw_area === CANVAS_AREA_LADDER_DISPLAY) {
      entry_target_net_data(data, i, fixed_grid_index, ly_p);
    }
    for (ly_i = 0; ly_i < data.length; ly_i++) {
      if (fixed_grid_index > 0) {
        fixed_grid_index = fixed_grid_index - 1;
        continue;
      }
      for (lx_i = width_index; lx_i < data[ly_i].length; lx_i++) {
          if ((ly_i === g_click_pos_disp_tbl.pos_ly && lx_i === g_click_pos_disp_tbl.pos_lx && g_click_pos_disp_tbl.net_index === i) && net_index_flg === FLG_ON && click_grid_pos_flg === FLG_OFF) {
            grid_pos_y = g_array_grid_pos[ly_p][lx_p].pos_y;
            grid_pos_x = g_array_grid_pos[ly_p][lx_p].pos_x;
            click_grid_pos_flg = FLG_ON;
          }
        // drawing of the figure(image)
        (ArrFig[call_draw_fig + data[ly_i][lx_i].FigNo])(ctx, 3 * g_scale_factor, ctx.strokeStyle, g_array_grid_pos[ly_p][lx_p].pos_x, g_array_grid_pos[ly_p][lx_p].pos_y, grid_x_size, grid_y_size, data, ly_i, lx_i);

        // drawing of the upper lower part line
        if ((data[ly_i][lx_i].NetwriteUp == 1) || (data[ly_i][lx_i].NetwriteDown == 1)) {
          vertical_line(i, lx_i, ly_i, lx_p, ly_p, grid_x_size, grid_y_size);
        }

        // drawing of the subroutine
        if (data[ly_i][lx_i].SubNo != 0) {
          g_draw_subroutine_flg_tbl.draw = FLG_ON;
          g_draw_subroutine_flg_tbl.draw_index_x = lx_i;
          g_draw_subroutine_flg_tbl.draw_index_y = ly_i;
          for (var subno_cnt = 0; subno_cnt < subroutine_tbl.length; subno_cnt++){
            if (subroutine_tbl[subno_cnt].sub_num == data[ly_i][lx_i].SubNo) {
              g_draw_subroutine_flg_tbl.height = subroutine_tbl[subno_cnt].sub_height;
            }
          }
          diagram_subroutine(i, lx_i, ly_i, lx_p, ly_p, grid_x_size, grid_y_size);
        }

        // drawing of the address ,the symbol and the comment
        if ((IMAGENO1_A_CONTACT <= data[ly_i][lx_i].FigNo && data[ly_i][lx_i].FigNo <= IMAGENO8_RDNT) || ((IMAGENO1_A_CONTACT + IMAGE_MARKER_TOP) <= data[ly_i][lx_i].FigNo && data[ly_i][lx_i].FigNo <= (IMAGENO8_RDNT + IMAGE_MARKER_TOP))) {
          diagram_details(i, lx_i, ly_i, lx_p, ly_p, grid_x_size, grid_y_size, level);
        }

        // [update ladder color]set display data
        if (data[ly_i][lx_i].Address !== '' && draw_area === CANVAS_AREA_LADDER_DISPLAY) {
          insert_update_ladder_net_data(i, lx_i, ly_i, lx_p, ly_p);
        }

        // in the case of search hit the square
        if ((draw_area == CANVAS_AREA_LADDER_SEARCH_RESULT) || (draw_area == CANVAS_AREA_LADDER_SEARCH_REPLACE)) {
          if (data[ly_i][lx_i].SearchMarker != '') {
            if (g_search_hit_square_disp_flag == FLG_ON) {
              if ((i == g_net_num_tbl.indexOf(g_search_hit_net_num + 1)) && (lx_i == g_search_hit_element_x) && (ly_i == g_search_hit_element_y)) {
                g_search_hit_pos = [lx_p, ly_p];
                search_hit_square(ctx, grid_x_size, grid_y_size, lx_p, ly_p, null);
                g_search_hit_square_disp_flag = FLG_OFF;
                search_hit_redraw_flg = FLG_ON;
              } else { }
            }
          }
        }

        if (lx_i == 0) {
          // bar of both sides of the ladder diagram(black)
          ctx.fillStyle = COLOR_BLACK;
          ctx.lineWidth = 3 * g_scale_factor;  // line weight
          ctx.strokeStyle = COLOR_BLACK;
          // the left line
          ctx.moveTo(canvas_x_offset, 0);
          ctx.lineTo(canvas_x_offset, drawing_area_height - canvas_y_offset);
        }
        if (lx_i == (g_max_col_num - 1)) {
          // bar of both sides of the ladder diagram(black)
          ctx.fillStyle = COLOR_BLACK;
          ctx.lineWidth = 3 * g_scale_factor;  // line weight
          ctx.strokeStyle = COLOR_BLACK;
          // the right line
          ctx.moveTo(canvas_x_offset + (grid_x_size * (lx_p + 1)), 0);
          ctx.lineTo(canvas_x_offset + (grid_x_size * (lx_p + 1)), drawing_area_height - canvas_y_offset);
        }

        lx_p += 1;
        // finished if display column to display to a screen
        if (lx_p == VIEW_GRID_COL) {
          break;
        }
      }
      // finished if display row to display to a screen
      g_row_limit += 1;
      if (VIEW_GRID_ROW == g_row_limit) {
        break;
      }
      lx_p = 0;
      ly_p += 1;
    }
  });
  if (screen_id == SCREEN_LADDER_DISPLAY) {
    header_net_counts(net_end_count);
  } else if (screen_id == SCREEN_LADDER_EDITOR) {
    header_net_counts(net_end_count);
  } else if (screen_id == SCREEN_LADDER_SEARCH_RESULT_LIST) {
    header_net_counts_result_list();
  }
  // drawing of the scroll bar
  draw_scrollbar();

  // drawing of the scroll bar
  draw_scrollbar_horizontal();

  // drawing of the possible figure
  ctx.stroke();

  // drawing of the net
  if ((draw_area == CANVAS_AREA_LADDER_EDITOR) || (draw_area == CANVAS_AREA_LADDER_SEARCH_RESULT_LIST)) {
    draw_net_selected(lx_net_p, ly_net_p, grid_x_size, grid_y_size, net_index);
  }
  
  // [update ladder color]pmc run status = RUNNING -> get pmc address value
  if (screen_id === SCREEN_LADDER_DISPLAY) {
    for (var i = 0; i < g_array_grid_update.net_indexs.length; i++) {
      if (g_array_grid_update.net_indexs[i] != null) {
        g_array_grid_update.net_indexs[i].sort(function (a, b) {
          if (a.grid_iy < b.grid_iy) return -1;
          if (a.grid_iy > b.grid_iy) return 1;
          if (a.grid_ix < b.grid_ix) return -1;
          if (a.grid_ix > b.grid_ix) return 1;
        });
      }
    }
    init_grobal_variable_in_timer();
    g_array_grid_update.flg_start = true;
    g_interval_timer = setTimeout(get_address_value, 10);
  }
  ctx.closePath();
  // draw a red quadrangle
  if ((screen_id === SCREEN_LADDER_SEARCH_RESULT || screen_id === SCREEN_LADDER_DISPLAY) && net_index_flg === FLG_ON) {
    draw_disp_result_red_square(grid_x_size, grid_y_size, grid_pos_y, grid_pos_x);
    net_index_flg = FLG_OFF;
    if (screen_id === SCREEN_LADDER_SEARCH_RESULT && search_hit_redraw_flg === FLG_OFF && (g_click_pos_disp_tbl.search_result > 0)) {
      search_hit_square(ctx, grid_x_size, grid_y_size, g_search_hit_pos[0], g_search_hit_pos[1], net_index_flg);
      g_search_hit_square_disp_flag = FLG_ON;
    }
  }
}

/*
 =========================================================================
 @function name          : diagram_details
 @argument [i]           : net number
 @argument [lx_i]        : element of the grid_List(row)
 @argument [ly_i]        : element of the grid_List(column)
 @argument [lx_p]        : element of the g_array_grid_pos(row)
 @argument [ly_p]        : element of the g_array_grid_pos(column)
 @argument [grid_x_size] : width of the grid
 @argument [level]       : level
 @description            : drawing of the address ,the symbol and the comment
 @return                 : none
 =========================================================================
*/
function diagram_details(i, lx_i, ly_i, lx_p, ly_p, grid_x_size, grid_y_size, level) {
  // in the case of there is not address in g_array_grid_detail, do return
  if (!(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address])) {
    return;
  }
  if (g_window_size.width < g_window_size.height) {
    switch (g_scale_factor) {
      case SCALING_050PERCENT:
        var font_size = 10;
        break;
      case SCALING_066PERCENT:
        var font_size = 13;
        break;
      case SCALING_133PERCENT:
        var font_size = 26;
        break;
      default:
        var font_size = 20 * g_scale_factor;
        if (font_size < 7.5) {
          font_size = 7.5;
        }
        break;
    }
  } else if (g_window_size.width > g_window_size.height) {
    switch (g_scale_factor) {
      case SCALING_050PERCENT:
        var font_size = 9;
        break;
      case SCALING_066PERCENT:
        var font_size = 11;
        break;
      case SCALING_133PERCENT:
        var font_size = 28;
        break;
      default:
        var font_size = 20 * g_scale_factor;
        if (font_size < 7.5) {
          font_size = 7.5;
        }
        break;
    }
  }
  ctx.font    = font_size + "px 'meiryo'";
  ctx.textAlign = "left";
  if (g_device == 'pc') {
    var offset_width = search_marker_width(i, ly_i, lx_i, grid_x_size);
    if(g_scale_factor ===SCALING_066PERCENT){
    var offset_height = Math.floor(grid_y_size / 3.9);
    }else{
    var offset_height = Math.floor(grid_y_size / 3.3);
    }
    var offset_x = Math.floor(grid_x_size / 12.5) * 1.3;
    var offset_y = Math.floor(grid_y_size / 4.2) * 0.2;
    var offset_y_under = Math.floor(offset_y * 15);
    var offset_10 = 10 * g_scale_factor;
    var offset_18 = 19 * g_scale_factor;
    var offset_23 = Math.floor(grid_y_size / 5) * 1.7;
    var offset_38 =  Math.floor(grid_y_size / 5) * 3;
  } else if (g_window_size.width < g_window_size.height) {
    var offset_width = search_marker_width(i, ly_i, lx_i, grid_x_size);
    var offset_height = Math.floor(grid_y_size / 5.5);
    var offset_x = Math.floor(grid_x_size / 12) / 1.5;
    var offset_y = Math.floor(grid_y_size / 7);
    var offset_y_under = Math.floor(offset_y * 5.28);
    if (g_device == 'smt' && (700 <= g_window_size.width && g_window_size.width <= 720) && (892 <= g_window_size.height && g_window_size.height <= 912)) {//S5e
      var offset_y_under = Math.floor(offset_y * 4.7);
    }
    var offset_10 = 10 * g_scale_factor;
    var offset_18 = 20 * g_scale_factor;
    var offset_23 = Math.floor(grid_y_size / 5) * 2.3;
    var offset_38 =  Math.floor(grid_y_size / 5) * 3;
  } else if (g_window_size.width > g_window_size.height) {
    var offset_width = search_marker_width(i, ly_i, lx_i, grid_x_size);
    var offset_height = Math.floor(grid_y_size / 3.3);
    var offset_x = Math.floor(grid_x_size / 12) * 1.5;
    var offset_y = Math.floor(grid_y_size / 5.0) * 0.2;
    var offset_y_under = Math.floor(offset_y * 18.5);
    var offset_10 = 10 * g_scale_factor;
    var offset_18 = 18 * g_scale_factor;
    var offset_23 = Math.floor(grid_y_size / 5) * 1.6;
    var offset_38 =  Math.floor(grid_y_size / 5) * 3;
  }
  switch (select_symbol_button) {
  case 1:  // address
    if(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].SearchMarker === MARKFLG_ELCO){
      ctx.fillStyle = COLOR_BLUE;
      character_limit(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
      if(((IMAGENO3_COILE + IMAGE_MARKER_TOP) <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= (IMAGENO6_RESET + IMAGE_MARKER_TOP))){
        // filled rectangle(yellow)
        ctx.fillStyle = COLOR_YELLOW;
        ctx.fillRect(offset_10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, offset_23 + g_array_grid_pos[ly_p][lx_p].pos_y, offset_width, offset_18);
        ctx.fillStyle = COLOR_PINK;
        ctx.fillText(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, offset_10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, offset_38 + g_array_grid_pos[ly_p][lx_p].pos_y);
      }
    } else if(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].SearchMarker === MARKFLG_ELAD){
      // filled rectangle(yellow)
      ctx.fillStyle = COLOR_YELLOW;
      ctx.fillRect(offset_x + g_array_grid_pos[ly_p][lx_p].pos_x, offset_y + g_array_grid_pos[ly_p][lx_p].pos_y, offset_width, offset_height);
      ctx.fillStyle = COLOR_BLUE;
      character_limit(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
      if(((IMAGENO3_COILE + IMAGE_MARKER_TOP) <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= (IMAGENO6_RESET + IMAGE_MARKER_TOP))){
        ctx.fillStyle = COLOR_PINK;
        ctx.fillText(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, offset_10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, offset_38 + g_array_grid_pos[ly_p][lx_p].pos_y);
      }
    } else {
      ctx.fillStyle = COLOR_BLUE;
      character_limit(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
      if(((IMAGENO3_COILE <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= IMAGENO6_RESET)) ||
         ((IMAGENO3_COILE + IMAGE_MARKER_TOP) <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= (IMAGENO6_RESET + IMAGE_MARKER_TOP))){
        ctx.fillStyle = COLOR_PINK;
        ctx.fillText(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, offset_10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, offset_38 + g_array_grid_pos[ly_p][lx_p].pos_y);
      }
    }
    break;
  case 2:  // symbols
    if(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].SearchMarker === MARKFLG_ELCO){
      ctx.fillStyle = COLOR_GREEN;
      character_limit(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Symbol, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
      if(((IMAGENO3_COILE + IMAGE_MARKER_TOP) <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= (IMAGENO6_RESET + IMAGE_MARKER_TOP))){
        // filled rectangle(yellow)
        ctx.fillStyle = COLOR_YELLOW;
        ctx.fillRect(offset_10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, offset_23 + g_array_grid_pos[ly_p][lx_p].pos_y, offset_width, offset_18);
        ctx.fillStyle = COLOR_PINK;
        ctx.fillText(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, offset_10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, offset_38 + g_array_grid_pos[ly_p][lx_p].pos_y);
      }
    } else if(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].SearchMarker === MARKFLG_ELSY){
        // filled rectangle(yellow)
        ctx.fillStyle = COLOR_YELLOW;
        ctx.fillRect(offset_x + g_array_grid_pos[ly_p][lx_p].pos_x, offset_y + g_array_grid_pos[ly_p][lx_p].pos_y, offset_width, offset_height);
        ctx.fillStyle = COLOR_GREEN;
        character_limit(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Symbol, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
      if(((IMAGENO3_COILE + IMAGE_MARKER_TOP) <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= (IMAGENO6_RESET + IMAGE_MARKER_TOP))){
        ctx.fillStyle = COLOR_PINK;
        ctx.fillText(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, offset_10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, offset_38 + g_array_grid_pos[ly_p][lx_p].pos_y);
      }
    } else {
      ctx.fillStyle = COLOR_GREEN;
      character_limit(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Symbol, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
      if(((IMAGENO3_COILE <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= IMAGENO6_RESET)) ||
         ((IMAGENO3_COILE + IMAGE_MARKER_TOP) <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= (IMAGENO6_RESET + IMAGE_MARKER_TOP))){
        ctx.fillStyle = COLOR_PINK;
        ctx.fillText(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, offset_10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, offset_38 + g_array_grid_pos[ly_p][lx_p].pos_y);
      }
    }
    // in the case of there is not the symbol, display the address
    if (g_array_grid_detail[grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].Address].Symbol == "") {
      if (grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SearchMarker === MARKFLG_ELAD) {
        ctx.fillStyle = COLOR_YELLOW;
        ctx.fillRect(offset_x + g_array_grid_pos[ly_p][lx_p].pos_x, offset_y + g_array_grid_pos[ly_p][lx_p].pos_y, offset_width, offset_height);
      }
      ctx.fillStyle = COLOR_BLUE;
      character_limit(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].Address, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
    } else {}
    break;
  case 3:  // address & symbols
    if(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].SearchMarker === MARKFLG_ELCO){
      ctx.fillStyle = COLOR_BLUE;
      character_limit(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
      ctx.fillStyle = COLOR_GREEN;
      character_limit(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Symbol, CHAR_LOWER, ly_p, lx_p, grid_x_size, grid_y_size);
      if(((IMAGENO3_COILE + IMAGE_MARKER_TOP) <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= (IMAGENO6_RESET + IMAGE_MARKER_TOP))){
        // filled rectangle(yellow)
        ctx.fillStyle = COLOR_YELLOW;
        ctx.fillRect(offset_10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, offset_23 + g_array_grid_pos[ly_p][lx_p].pos_y, offset_width, offset_18);
        ctx.fillStyle = COLOR_PINK;
        ctx.fillText(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, offset_10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, offset_38 + g_array_grid_pos[ly_p][lx_p].pos_y);
      }
    } else if(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].SearchMarker === MARKFLG_ELAD){
      // filled rectangle(yellow)
      ctx.fillStyle = COLOR_YELLOW;
      ctx.fillRect(offset_x + g_array_grid_pos[ly_p][lx_p].pos_x, offset_y + g_array_grid_pos[ly_p][lx_p].pos_y, offset_width, offset_height);
      ctx.fillStyle = COLOR_BLUE;
      character_limit(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
      ctx.fillStyle = COLOR_GREEN;
      character_limit(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Symbol, CHAR_LOWER, ly_p, lx_p, grid_x_size, grid_y_size);
      if(((IMAGENO3_COILE + IMAGE_MARKER_TOP) <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= (IMAGENO6_RESET + IMAGE_MARKER_TOP))){
        ctx.fillStyle = COLOR_PINK;
        ctx.fillText(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, offset_10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, offset_38 + g_array_grid_pos[ly_p][lx_p].pos_y);
      }
    } else if(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].SearchMarker === MARKFLG_ELSY){
      ctx.fillStyle = COLOR_BLUE;
      character_limit(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
      // filled rectangle(yellow)
      ctx.fillStyle = COLOR_YELLOW;
      ctx.fillRect(offset_x + g_array_grid_pos[ly_p][lx_p].pos_x, offset_y_under + g_array_grid_pos[ly_p][lx_p].pos_y, offset_width, offset_height);
      ctx.fillStyle = COLOR_GREEN;
      character_limit(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Symbol, CHAR_LOWER, ly_p, lx_p, grid_x_size, grid_y_size);
      if(((IMAGENO3_COILE + IMAGE_MARKER_TOP) <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= (IMAGENO6_RESET + IMAGE_MARKER_TOP))){
        ctx.fillStyle = COLOR_PINK;
        ctx.fillText(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, offset_10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, offset_38 + g_array_grid_pos[ly_p][lx_p].pos_y);
      }
    } else {
      ctx.fillStyle = COLOR_BLUE;
      character_limit(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
      ctx.fillStyle = COLOR_GREEN;
      character_limit(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Symbol, CHAR_LOWER, ly_p, lx_p, grid_x_size, grid_y_size);
      if((IMAGENO3_COILE <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= IMAGENO6_RESET)){
        ctx.fillStyle = COLOR_PINK;
        ctx.fillText(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, offset_10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, offset_38 + g_array_grid_pos[ly_p][lx_p].pos_y);
      }
    }
    break;
  case 4:  // comment
    if(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].SearchMarker === MARKFLG_ELCO){
      if(((IMAGENO3_COILE + IMAGE_MARKER_TOP) <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= (IMAGENO6_RESET + IMAGE_MARKER_TOP))){
        ctx.fillStyle = COLOR_BLUE;
        character_limit(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
        // filled rectangle(yellow)
        ctx.fillStyle = COLOR_YELLOW;
        ctx.fillRect(offset_10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, offset_23 + g_array_grid_pos[ly_p][lx_p].pos_y, offset_width, offset_18);
        ctx.fillStyle = COLOR_PINK;
        ctx.fillText(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, offset_10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, offset_38 + g_array_grid_pos[ly_p][lx_p].pos_y);
      } else {
        // filled rectangle(yellow)
        ctx.fillStyle = COLOR_YELLOW;
        ctx.fillRect(offset_x + g_array_grid_pos[ly_p][lx_p].pos_x, offset_y + g_array_grid_pos[ly_p][lx_p].pos_y, offset_width, offset_height);
        ctx.fillStyle = COLOR_PINK;
        character_limit(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
      }
    } else if(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].SearchMarker === MARKFLG_ELAD){
      if(((IMAGENO3_COILE + IMAGE_MARKER_TOP) <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= (IMAGENO6_RESET + IMAGE_MARKER_TOP))){
        // filled rectangle(yellow)
        ctx.fillStyle = COLOR_YELLOW;
        ctx.fillRect(offset_x + g_array_grid_pos[ly_p][lx_p].pos_x, offset_y_under + g_array_grid_pos[ly_p][lx_p].pos_y, offset_width, offset_height);
        ctx.fillStyle = COLOR_BLUE;
        character_limit(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
        ctx.fillStyle = COLOR_PINK;
        ctx.fillText(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, offset_10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, offset_38 + g_array_grid_pos[ly_p][lx_p].pos_y);
      } else {
        // filled rectangle(yellow)
        ctx.fillStyle = COLOR_PINK;
        character_limit(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
      }
    } else {
      if(((IMAGENO3_COILE <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= IMAGENO6_RESET)) ||
         ((IMAGENO3_COILE + IMAGE_MARKER_TOP) <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= (IMAGENO6_RESET + IMAGE_MARKER_TOP))){
        ctx.fillStyle = COLOR_PINK;
        ctx.fillText(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, offset_10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, offset_38 + g_array_grid_pos[ly_p][lx_p].pos_y);
        ctx.fillStyle = COLOR_BLUE;
        character_limit(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
      } else {
        ctx.fillStyle = COLOR_PINK;
        character_limit(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
      }
    }
    // in the case of there is not the comment, display the address
    if (g_array_grid_detail[grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].Address].Comment1 == "") {
      if (grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SearchMarker === MARKFLG_ELAD) {
        ctx.fillStyle = COLOR_YELLOW;
        ctx.fillRect(offset_x + g_array_grid_pos[ly_p][lx_p].pos_x, offset_y + g_array_grid_pos[ly_p][lx_p].pos_y, offset_width, offset_height);
      }
      ctx.fillStyle = COLOR_BLUE;
      character_limit(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].Address, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
    } else {}
    break;
  case 5:  // address & comment
    if(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].SearchMarker === MARKFLG_ELCO){
      ctx.fillStyle = COLOR_BLUE;
      character_limit(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
      if(((IMAGENO3_COILE + IMAGE_MARKER_TOP) <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= (IMAGENO6_RESET + IMAGE_MARKER_TOP))){
        // filled rectangle(yellow)
        ctx.fillStyle = COLOR_YELLOW;
        ctx.fillRect(offset_10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, offset_23 + g_array_grid_pos[ly_p][lx_p].pos_y, offset_width, offset_18);
        ctx.fillStyle = COLOR_PINK;
        ctx.fillText(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, offset_10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, offset_38 + g_array_grid_pos[ly_p][lx_p].pos_y);
      } else {
        // filled rectangle(yellow)
        ctx.fillStyle = COLOR_YELLOW;
        ctx.fillRect(offset_x + g_array_grid_pos[ly_p][lx_p].pos_x, offset_y_under + g_array_grid_pos[ly_p][lx_p].pos_y, offset_width, offset_height);
        ctx.fillStyle = COLOR_PINK;
        character_limit(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, CHAR_LOWER, ly_p, lx_p, grid_x_size, grid_y_size);
      }
    } else if(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].SearchMarker === MARKFLG_ELAD){
      // filled rectangle(yellow)
      ctx.fillStyle = COLOR_YELLOW;
      ctx.fillRect(offset_x + g_array_grid_pos[ly_p][lx_p].pos_x, offset_y + g_array_grid_pos[ly_p][lx_p].pos_y, offset_width, offset_height);
      ctx.fillStyle = COLOR_BLUE;
      character_limit(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
      if(((IMAGENO3_COILE + IMAGE_MARKER_TOP) <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= (IMAGENO6_RESET + IMAGE_MARKER_TOP))){
        ctx.fillStyle = COLOR_PINK;
        ctx.fillText(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, offset_10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, offset_38 + g_array_grid_pos[ly_p][lx_p].pos_y);
      } else {
        ctx.fillStyle = COLOR_PINK;
        character_limit(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, CHAR_LOWER, ly_p, lx_p, grid_x_size, grid_y_size);
      }
    } else {
      ctx.fillStyle = COLOR_BLUE;
      character_limit(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
      if(((IMAGENO3_COILE <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= IMAGENO6_RESET)) ||
         ((IMAGENO3_COILE + IMAGE_MARKER_TOP) <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= (IMAGENO6_RESET + IMAGE_MARKER_TOP))){
        ctx.fillStyle = COLOR_PINK;
        ctx.fillText(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, offset_10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, offset_38 + g_array_grid_pos[ly_p][lx_p].pos_y);
      } else {
        ctx.fillStyle = COLOR_PINK;
        character_limit(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, CHAR_LOWER, ly_p, lx_p, grid_x_size, grid_y_size);
      }
    }
    break;
  case 6:  // symbols & comment
    if(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].SearchMarker === MARKFLG_ELCO){
      ctx.fillStyle = COLOR_GREEN;
      character_limit(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Symbol, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
      if(((IMAGENO3_COILE + IMAGE_MARKER_TOP) <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= (IMAGENO6_RESET + IMAGE_MARKER_TOP))){
        // filled rectangle(yellow)
        ctx.fillStyle = COLOR_YELLOW;
        ctx.fillRect(offset_10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, offset_23 + g_array_grid_pos[ly_p][lx_p].pos_y, offset_width, offset_18);
        ctx.fillStyle = COLOR_PINK;
        ctx.fillText(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, offset_10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, offset_38 + g_array_grid_pos[ly_p][lx_p].pos_y);
      } else {
        // filled rectangle(yellow)
        ctx.fillStyle = COLOR_YELLOW;
        ctx.fillRect(offset_x + g_array_grid_pos[ly_p][lx_p].pos_x, offset_y_under + g_array_grid_pos[ly_p][lx_p].pos_y, offset_width, offset_height);
        ctx.fillStyle = COLOR_PINK;
        character_limit(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, CHAR_LOWER, ly_p, lx_p, grid_x_size, grid_y_size);
      }
    } else if(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].SearchMarker === MARKFLG_ELSY){
      // filled rectangle(yellow)
      ctx.fillStyle = COLOR_YELLOW;
      ctx.fillRect(offset_x + g_array_grid_pos[ly_p][lx_p].pos_x, offset_y + g_array_grid_pos[ly_p][lx_p].pos_y, offset_width, offset_height);
      ctx.fillStyle = COLOR_GREEN;
      character_limit(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Symbol, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
      if(((IMAGENO3_COILE + IMAGE_MARKER_TOP) <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= (IMAGENO6_RESET + IMAGE_MARKER_TOP))){
        ctx.fillStyle = COLOR_PINK;
        ctx.fillText(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, offset_10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, offset_38 + g_array_grid_pos[ly_p][lx_p].pos_y);
      } else {
        ctx.fillStyle = COLOR_PINK;
        character_limit(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, CHAR_LOWER, ly_p, lx_p, grid_x_size, grid_y_size);
      }
    } else {
      ctx.fillStyle = COLOR_GREEN;
      character_limit(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Symbol, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
      if(((IMAGENO3_COILE <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= IMAGENO6_RESET)) ||
         ((IMAGENO3_COILE + IMAGE_MARKER_TOP) <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= (IMAGENO6_RESET + IMAGE_MARKER_TOP))){
        ctx.fillStyle = COLOR_PINK;
        ctx.fillText(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, offset_10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, offset_38 + g_array_grid_pos[ly_p][lx_p].pos_y);
      } else {
        ctx.fillStyle = COLOR_PINK;
        character_limit(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, CHAR_LOWER, ly_p, lx_p, grid_x_size, grid_y_size);
      }
    }
    // in the case of there is not the symbol, display the address
      if (g_array_grid_detail[grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].Address].Symbol == "") {
        if (grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SearchMarker === MARKFLG_ELAD) {
          ctx.fillStyle = COLOR_YELLOW;
          ctx.fillRect(offset_x + g_array_grid_pos[ly_p][lx_p].pos_x, offset_y + g_array_grid_pos[ly_p][lx_p].pos_y, offset_width, offset_height);
        }
      ctx.fillStyle = COLOR_BLUE;
      character_limit(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].Address, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
      } else {}
    break;
  default:
    return;
  }
}

/*
 =========================================================================
 @function name          : search_marker_width
 @argument [grid_x_size] : width of the grid
 @argument [i]           : net number
 @argument [ly_i]        : element of the grid_List(column)
 @argument [lx_i]        : element of the grid_List(row)
 @description            : Search result fill size
 @return                 : offset_width
 =========================================================================
*/
function search_marker_width(i, ly_i, lx_i, grid_x_size) {

  var offset_width = 0;
  var char_width = ctx.measureText("1").width;
  
  if (grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SearchMarker === MARKFLG_ELAD) {
    offset_width = ctx.measureText(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].Address).width;
  } else if (grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SearchMarker === MARKFLG_ELSY) {
    var sym_char = g_array_grid_detail[grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].Address].Symbol;
    var sym_char_split = sym_char.substring(0, 8);
    if (sym_char.length <= CHAR_REST) {
      offset_width = ctx.measureText(g_array_grid_detail[grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].Address].Symbol).width;
    } else {
      offset_width = ctx.measureText(sym_char_split).width;
    }
  } else if (grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SearchMarker === MARKFLG_ELCO) {
    var com_char = g_array_grid_detail[grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].Address].Comment1;
    var com_char_split = com_char.substring(0, 8);
    if (com_char.length <= CHAR_REST) {
      offset_width = ctx.measureText(g_array_grid_detail[grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].Address].Comment1).width;
    } else {
      offset_width = ctx.measureText(com_char_split).width;
    }
  }
  if (((IMAGENO3_COILE + IMAGE_MARKER_TOP) <= grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].FigNo <= (IMAGENO6_RESET + IMAGE_MARKER_TOP)) &&
        grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SearchMarker === MARKFLG_ELCO) {
    // no action
  } else {
    if ((grid_x_size - offset_width) < char_width) {
      offset_width = grid_x_size - char_width;
    }
  }
  return offset_width;
}

/*
 =========================================================================
 @function name          : character_limit
 @argument [str]         : character string to judge
 @argument [drawing_pos] : drawing position of the letter(upper stage / lower stage)
 @argument [ly_p]        : element of the g_array_grid_pos(row)
 @argument [lx_p]        : element of the g_array_grid_pos(column)
 @argument [grid_x_size] : width of the grid
 @description            : processing of character limitation of the address, the symbol and the comment
 @return                 : none
 =========================================================================
*/
function character_limit(str, drawing_pos, ly_p, lx_p, grid_x_size, grid_y_size) {

  var first_row = str.substr(0, CHAR_REST) + "  ";
  if (g_device == 'pc') {
    var str_pos_offset_15 = Math.floor(grid_y_size / 3) * 0.9;
    var str_pos_offset_25 = Math.floor(grid_x_size / 12) * 1.3;
    var str_pos_offset_50 = Math.floor(grid_y_size / 3.7) * 3.5;
  } else if (g_window_size.width < g_window_size.height) {
    var str_pos_offset_15 = Math.floor(grid_y_size / 4) * 1.1;
    var str_pos_offset_25 = Math.floor(grid_x_size / 17);
    var str_pos_offset_50 = Math.floor(grid_y_size / 4) * 3.5;
  } else if (g_window_size.width > g_window_size.height) {
    var str_pos_offset_15 = Math.floor(grid_y_size / 3) * 0.9;
    var str_pos_offset_25 = Math.floor(grid_x_size / 10.5) * 1.3;
    var str_pos_offset_50 = Math.floor(grid_y_size / 3.7) * 3.6;
    switch (g_scale_factor) {
      case SCALING_050PERCENT:
        var str_pos_offset_25 = Math.floor(grid_x_size / 10.5) * 1.3;
        break;
      case SCALING_066PERCENT:
        var str_pos_offset_25 = Math.floor(grid_x_size / 10.5) * 1.3;
        break;
      default:
        break;
    }
  }
  if (drawing_pos == CHAR_UPPER) {
    // drawing of the upper stage
    ctx.fillText(first_row, str_pos_offset_25 + g_array_grid_pos[ly_p][lx_p].pos_x, str_pos_offset_15 + g_array_grid_pos[ly_p][lx_p].pos_y, grid_x_size);
  } else if (drawing_pos == CHAR_LOWER) {
    // drawing of the lower stage0
    ctx.fillText(first_row, str_pos_offset_25 + g_array_grid_pos[ly_p][lx_p].pos_x, str_pos_offset_50 + g_array_grid_pos[ly_p][lx_p].pos_y, grid_x_size);
  }
}

/*
 =========================================================================
 @function name          : diagram_subroutine
 @argument [i]           : net number
 @argument [lx_i]        : element of the grid_List(row)
 @argument [ly_i]        : element of the grid_List(column)
 @argument [lx_p]        : element of the g_array_grid_pos(row)
 @argument [ly_p]        : element of the g_array_grid_pos(column)
 @argument [grid_x_size] : width of the grid
 @argument [grid_y_size] : height of the grid
 @description            : drawing of the subroutine
 @return                 : none
 =========================================================================
*/
function diagram_subroutine(i, lx_i, ly_i, lx_p, ly_p, grid_x_size, grid_y_size) {

  var num = 0;
  var font_size = 18 * g_scale_factor;
  if (g_device == 'pc') {
    var offset_sub_no_y = 7;
    var offset_sub_name_y = 30;
    if(g_scale_factor ===SCALING_066PERCENT){
    var offset_height = Math.floor(grid_y_size / 3.9);
    }else{
    var offset_height = Math.floor(grid_y_size / 3.3);
    }
  } else if (g_window_size.width < g_window_size.height) {
    var offset_height = Math.floor(grid_y_size / 5.5);
    var offset_sub_no_y = 7;
    var offset_sub_name_y = 30;
  } else if (g_window_size.width > g_window_size.height) {
    var offset_height = Math.floor(grid_y_size / 3.3);
    var offset_sub_no_y = 10;
    var offset_sub_name_y = 33;
  }

  for (num = 0; num < subroutine_tbl.length; num++) {
    if (grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].SubNo == subroutine_tbl[num].sub_num) {

      ctx.stroke();
      ctx.beginPath();
      // draw a quadrangle
      if (grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SearchMarker == MARKFLG_ELFN && grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubNo !== 70) {
        // draw with a marker
        g_draw_subroutine_flg_tbl.draw_marker = FLG_ON;
        
        ctx.strokeStyle = COLOR_BLACK;    // line color
        var rectangle_x = grid_x_size * subroutine_tbl[num].sub_width;
        var rectangle_y = grid_y_size * subroutine_tbl[num].sub_height;
        // for outer frame
        ctx.lineWidth = MARKER_WIDTH_FLAME * g_scale_factor;
        ctx.rect(g_array_grid_pos[ly_p][lx_p].pos_x, g_array_grid_pos[ly_p][lx_p].pos_y, rectangle_x, rectangle_y);
        ctx.stroke();
        // draw a line
        var line_pos_x = grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x;
        var line_pos_start_y = g_array_grid_pos[ly_p][lx_p].pos_y;
        var line_pos_end_y = line_pos_start_y + (grid_y_size * subroutine_tbl[num].sub_height);
        ctx.moveTo(line_pos_x, line_pos_start_y);
        ctx.lineTo(line_pos_x, line_pos_end_y);
        ctx.stroke();
      
        // for marker
        ctx.beginPath();
        ctx.strokeStyle = COLOR_YELLOW;
        ctx.lineWidth = MARKER_WIDTH_FILL * g_scale_factor;
        ctx.rect(g_array_grid_pos[ly_p][lx_p].pos_x, g_array_grid_pos[ly_p][lx_p].pos_y, rectangle_x, rectangle_y);
        ctx.stroke();
        // draw a line
        var line_pos_x = grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x;
        var line_pos_start_y = g_array_grid_pos[ly_p][lx_p].pos_y;
        var line_pos_end_y = line_pos_start_y + (grid_y_size * subroutine_tbl[num].sub_height);
        ctx.moveTo(line_pos_x, line_pos_start_y + 1);
        ctx.lineTo(line_pos_x, line_pos_end_y - 1);
        ctx.stroke();
        ctx.lineWidth = g_scale_factor * 3;  // line width
      
        ctx.beginPath();      
      } else {
        // normal drawing
        ctx.lineWidth = 3 * g_scale_factor;  // line weight
        var rectangle_x = grid_x_size * subroutine_tbl[num].sub_width;
        var rectangle_y = grid_y_size * subroutine_tbl[num].sub_height;
        ctx.rect(g_array_grid_pos[ly_p][lx_p].pos_x, g_array_grid_pos[ly_p][lx_p].pos_y, rectangle_x, rectangle_y);
        ctx.stroke();
        // draw a line
        var line_pos_x = grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x;
        var line_pos_start_y = g_array_grid_pos[ly_p][lx_p].pos_y;
        var line_pos_end_y = line_pos_start_y + (grid_y_size * subroutine_tbl[num].sub_height);
        ctx.moveTo(line_pos_x, line_pos_start_y);
        ctx.lineTo(line_pos_x, line_pos_end_y);
        ctx.stroke();
      }
      ctx.beginPath();

      ctx.strokeStyle  = COLOR_BLACK;

      // draw characters
      ctx.fillStyle = COLOR_BLACK;
      ctx.font = font_size + "px 'meiryo'";
      var param_offset = grid_x_size + 10;
      // draw the parameter of the subroutine
      if (grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam1 != undefined) {
        // parameter of the subroutine1
        if ((screen_id == SCREEN_LADDER_SEARCH_RESULT || screen_id == SCREEN_LADDER_SEARCH_RESULT_LIST) && (g_search_category_list.indexOf(IMAGENO10_FUNCTION) !== -1 && g_search_category !== SEARCH_CATEGORY_NONE)) {
          if (g_perfect_match_flg == FLG_ON) {
            if (typeof grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam1 == "string" && String(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam1).toLowerCase() === g_search_str.toLowerCase()) {
              ctx.fillStyle = COLOR_YELLOW;
              ctx.fillRect((g_array_grid_pos[ly_p][lx_p].pos_x + param_offset), (g_array_grid_pos[ly_p][lx_p].pos_y + 5 * g_scale_factor), ctx.measureText(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam1).width, offset_height);
              ctx.fillStyle = COLOR_BLACK;
            }
          } else {
            if (typeof grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam1 == "string" && String(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam1).toLowerCase().indexOf(String(g_search_str).toLowerCase()) !== -1) {
              ctx.fillStyle = COLOR_YELLOW;
              ctx.fillRect((g_array_grid_pos[ly_p][lx_p].pos_x + param_offset), (g_array_grid_pos[ly_p][lx_p].pos_y + 5 * g_scale_factor), ctx.measureText(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam1).width, offset_height);
              ctx.fillStyle = COLOR_BLACK;
            }
          }
        }
        ctx.fillText(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam1, (g_array_grid_pos[ly_p][lx_p].pos_x + param_offset), (g_array_grid_pos[ly_p][lx_p].pos_y + 20 * g_scale_factor));
        if (grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam2 != undefined) {
          // parameter of the subroutine2
          if ((screen_id == SCREEN_LADDER_SEARCH_RESULT || screen_id == SCREEN_LADDER_SEARCH_RESULT_LIST) && (g_search_category_list.indexOf(IMAGENO10_FUNCTION) !== -1 && g_search_category !== SEARCH_CATEGORY_NONE)) {
            if (g_perfect_match_flg == FLG_ON) {
              if (typeof grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam2 == "string" && String(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam2).toLowerCase() === g_search_str.toLowerCase()) {
                ctx.fillStyle = COLOR_YELLOW;
                ctx.fillRect((g_array_grid_pos[ly_p][lx_p].pos_x + param_offset), (g_array_grid_pos[ly_p][lx_p].pos_y + 25 * g_scale_factor), ctx.measureText(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam2).width, offset_height);
                ctx.fillStyle = COLOR_BLACK;
              }
            } else {
              if (typeof grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam2 == "string" && String(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam2).toLowerCase().indexOf(String(g_search_str).toLowerCase()) !== -1) {
                ctx.fillStyle = COLOR_YELLOW;
                ctx.fillRect((g_array_grid_pos[ly_p][lx_p].pos_x + param_offset), (g_array_grid_pos[ly_p][lx_p].pos_y + 25 * g_scale_factor), ctx.measureText(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam2).width, offset_height);
                ctx.fillStyle = COLOR_BLACK;
              }
            }
          }
          ctx.fillText(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam2, (g_array_grid_pos[ly_p][lx_p].pos_x + param_offset), (g_array_grid_pos[ly_p][lx_p].pos_y + 40 * g_scale_factor));
          if (grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam3 != undefined) {
            // parameter of the subroutine3
            if ((screen_id == SCREEN_LADDER_SEARCH_RESULT || screen_id == SCREEN_LADDER_SEARCH_RESULT_LIST) && (g_search_category_list.indexOf(IMAGENO10_FUNCTION) !== -1 && g_search_category !== SEARCH_CATEGORY_NONE)) {
              if (g_perfect_match_flg == FLG_ON) {
                if (typeof grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam3 == "string" && String(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam3).toLowerCase() === g_search_str.toLowerCase()) {
                  ctx.fillStyle = COLOR_YELLOW;
                  ctx.fillRect((g_array_grid_pos[ly_p][lx_p].pos_x + param_offset), (g_array_grid_pos[ly_p][lx_p].pos_y + 65 * g_scale_factor), ctx.measureText(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam3).width, offset_height);
                  ctx.fillStyle = COLOR_BLACK;
                }
              } else {
                if (typeof grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam3 == "string" && String(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam3).toLowerCase().indexOf(String(g_search_str).toLowerCase()) !== -1) {
                  ctx.fillStyle = COLOR_YELLOW;
                  ctx.fillRect((g_array_grid_pos[ly_p][lx_p].pos_x + param_offset), (g_array_grid_pos[ly_p][lx_p].pos_y + 65 * g_scale_factor), ctx.measureText(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam3).width, offset_height);
                  ctx.fillStyle = COLOR_BLACK;
                }
              }
            }
            ctx.fillText(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam3, (g_array_grid_pos[ly_p][lx_p].pos_x + param_offset), (g_array_grid_pos[ly_p][lx_p].pos_y + 80 * g_scale_factor));
            if (grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam4 != undefined) {
              // parameter of the subroutine4
              if ((screen_id == SCREEN_LADDER_SEARCH_RESULT || screen_id == SCREEN_LADDER_SEARCH_RESULT_LIST) && (g_search_category_list.indexOf(IMAGENO10_FUNCTION) !== -1 && g_search_category !== SEARCH_CATEGORY_NONE)) {
                if (g_perfect_match_flg == FLG_ON) {
                  if (typeof grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam4 == "string" && String(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam4).toLowerCase() === g_search_str.toLowerCase()) {
                    ctx.fillStyle = COLOR_YELLOW;
                    ctx.fillRect((g_array_grid_pos[ly_p][lx_p].pos_x + param_offset), (g_array_grid_pos[ly_p][lx_p].pos_y + 85 * g_scale_factor), ctx.measureText(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam4).width, offset_height);
                    ctx.fillStyle = COLOR_BLACK;
                  }
                } else {
                  if (typeof grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam4 == "string" && String(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam4).toLowerCase().indexOf(String(g_search_str).toLowerCase()) !== -1) {
                    ctx.fillStyle = COLOR_YELLOW;
                    ctx.fillRect((g_array_grid_pos[ly_p][lx_p].pos_x + param_offset), (g_array_grid_pos[ly_p][lx_p].pos_y + 85 * g_scale_factor), ctx.measureText(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam4).width, offset_height);
                    ctx.fillStyle = COLOR_BLACK;
                  }
                }
              }
              ctx.fillText(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam4, (g_array_grid_pos[ly_p][lx_p].pos_x + param_offset), (g_array_grid_pos[ly_p][lx_p].pos_y + 100 * g_scale_factor));
              if (grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam5 != undefined) {
                // parameter of the subroutine5
                if ((screen_id == SCREEN_LADDER_SEARCH_RESULT || screen_id == SCREEN_LADDER_SEARCH_RESULT_LIST) && (g_search_category_list.indexOf(IMAGENO10_FUNCTION) !== -1 && g_search_category !== SEARCH_CATEGORY_NONE)) {
                  if (g_perfect_match_flg == FLG_ON) {
                    if (typeof grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam5 == "string" && String(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam5).toLowerCase() === g_search_str.toLowerCase()) {
                      ctx.fillStyle = COLOR_YELLOW;
                      ctx.fillRect((g_array_grid_pos[ly_p][lx_p].pos_x + param_offset), (g_array_grid_pos[ly_p][lx_p].pos_y + 105 * g_scale_factor), ctx.measureText(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam5).width, offset_height);
                      ctx.fillStyle = COLOR_BLACK;
                    }
                  } else {
                    if (typeof grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam5 == "string" && String(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam5).toLowerCase().indexOf(String(g_search_str).toLowerCase()) !== -1) {
                      ctx.fillStyle = COLOR_YELLOW;
                      ctx.fillRect((g_array_grid_pos[ly_p][lx_p].pos_x + param_offset), (g_array_grid_pos[ly_p][lx_p].pos_y + 105 * g_scale_factor), ctx.measureText(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam5).width, offset_height);
                      ctx.fillStyle = COLOR_BLACK;
                    }
                  }
                }
                ctx.fillText(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam5, (g_array_grid_pos[ly_p][lx_p].pos_x + param_offset), (g_array_grid_pos[ly_p][lx_p].pos_y + 120 * g_scale_factor));
                if (grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam6 != undefined) {
                  // parameter of the subroutine6
                  if ((screen_id == SCREEN_LADDER_SEARCH_RESULT || screen_id == SCREEN_LADDER_SEARCH_RESULT_LIST) && (g_search_category_list.indexOf(IMAGENO10_FUNCTION) !== -1 && g_search_category !== SEARCH_CATEGORY_NONE)) {
                    if (g_perfect_match_flg == FLG_ON) {
                      if (typeof grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam6 == "string" && String(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam6).toLowerCase() === g_search_str.toLowerCase()) {
                        ctx.fillStyle = COLOR_YELLOW;
                        ctx.fillRect((g_array_grid_pos[ly_p][lx_p].pos_x + param_offset), (g_array_grid_pos[ly_p][lx_p].pos_y + 125 * g_scale_factor), ctx.measureText(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam6).width, offset_height);
                        ctx.fillStyle = COLOR_BLACK;
                      }
                    } else {
                      if (typeof grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam6 == "string" && String(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam6).toLowerCase().indexOf(String(g_search_str).toLowerCase()) !== -1) {
                        ctx.fillStyle = COLOR_YELLOW;
                        ctx.fillRect((g_array_grid_pos[ly_p][lx_p].pos_x + param_offset), (g_array_grid_pos[ly_p][lx_p].pos_y + 125 * g_scale_factor), ctx.measureText(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam6).width, offset_height);
                        ctx.fillStyle = COLOR_BLACK;
                      }
                    }
                  }
                  ctx.fillText(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubParam6, (g_array_grid_pos[ly_p][lx_p].pos_x + param_offset), (g_array_grid_pos[ly_p][lx_p].pos_y + 140 * g_scale_factor));
                }
              }
            }
          }
        }
      }

      // subroutine number
      if (grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SearchMarker == MARKFLG_ELFN && g_search_num_flg == FLG_ON && g_search_category == SEARCH_CATEGORY_NONE) {
        ctx.fillStyle = COLOR_YELLOW;
        ctx.fillRect(g_array_grid_pos[ly_p][lx_p].pos_x + 5 * g_scale_factor, g_array_grid_pos[ly_p][lx_p].pos_y + offset_sub_no_y * g_scale_factor, ctx.measureText("SUB " + subroutine_tbl[num].sub_num).width, offset_height);
        ctx.fillStyle = COLOR_BLACK;
      }
      ctx.fillText("SUB " + subroutine_tbl[num].sub_num, g_array_grid_pos[ly_p][lx_p].pos_x + 5 * g_scale_factor, g_array_grid_pos[ly_p][lx_p].pos_y + 25 * g_scale_factor);
      // correction value for stopwatch display position
      // drawing of stopwatch display
      if (screen_id === SCREEN_LADDER_DISPLAY) {
            switch (subroutine_tbl[num].sub_num) {
            case DEF_SUBROUTINE_TMR.NUM:
            case DEF_SUBROUTINE_TMRB.NUM:
            case DEF_SUBROUTINE_TMRC.NUM:
            case DEF_SUBROUTINE_TMRBF.NUM:
            case DEF_SUBROUTINE_TMRST.NUM:
            case DEF_SUBROUTINE_TMRSS.NUM:
              if (g_stopwatch_1_flg == FLG_OFF) {
                g_stopwatch_1_flg = FLG_ON;

                stopwatch_clear_1(subroutine_tbl[num].sub_num);
                document.getElementById("stopwatch_1").style.display = 'block';
                document.getElementById("stopwatch_1").style.fontSize = font_size + "px";

                document.getElementById("stopwatch_1").style.left = (g_array_grid_pos[ly_p][lx_p].pos_x + param_offset) + "px";
                document.getElementById("stopwatch_1").style.top = (g_array_grid_pos[ly_p][lx_p].pos_y + 47 * g_scale_factor) + 35 + "px";
                g_stopwatch_pos[0] = i; 
              } else if (g_stopwatch_2_flg == FLG_OFF) {
                g_stopwatch_2_flg = FLG_ON;

                stopwatch_clear_2(subroutine_tbl[num].sub_num);
                document.getElementById("stopwatch_2").style.display = 'block';
                document.getElementById("stopwatch_2").style.fontSize = font_size + "px";

                document.getElementById("stopwatch_2").style.left = (g_array_grid_pos[ly_p][lx_p].pos_x + param_offset) + "px";
                document.getElementById("stopwatch_2").style.top = (g_array_grid_pos[ly_p][lx_p].pos_y + 47 * g_scale_factor) + 35 + "px";
                g_stopwatch_pos[1] = i; 
              } else if (g_stopwatch_3_flg == FLG_OFF) {
                g_stopwatch_3_flg = FLG_ON;

                stopwatch_clear_3(subroutine_tbl[num].sub_num);
                document.getElementById("stopwatch_3").style.display = 'block';
                document.getElementById("stopwatch_3").style.fontSize = font_size + "px";

                document.getElementById("stopwatch_3").style.left = (g_array_grid_pos[ly_p][lx_p].pos_x + param_offset) + "px";
                document.getElementById("stopwatch_3").style.top = (g_array_grid_pos[ly_p][lx_p].pos_y + 47 * g_scale_factor) + 35 + "px";
                g_stopwatch_pos[2] = i; 
              } else if (g_stopwatch_4_flg == FLG_OFF) {
                g_stopwatch_4_flg = FLG_ON;

                stopwatch_clear_4(subroutine_tbl[num].sub_num);
                document.getElementById("stopwatch_4").style.display = 'block';
                document.getElementById("stopwatch_4").style.fontSize = font_size + "px";

                document.getElementById("stopwatch_4").style.left = (g_array_grid_pos[ly_p][lx_p].pos_x + param_offset) + "px";
                document.getElementById("stopwatch_4").style.top = (g_array_grid_pos[ly_p][lx_p].pos_y + 47 * g_scale_factor) + 35 + "px";
                g_stopwatch_pos[3] = i; 
              } else if (g_stopwatch_5_flg == FLG_OFF) {
                g_stopwatch_5_flg = FLG_ON;

                stopwatch_clear_5(subroutine_tbl[num].sub_num);
                document.getElementById("stopwatch_5").style.display = 'block';
                document.getElementById("stopwatch_5").style.fontSize = font_size + "px";

                document.getElementById("stopwatch_5").style.left = (g_array_grid_pos[ly_p][lx_p].pos_x + param_offset) + "px";
                document.getElementById("stopwatch_5").style.top = (g_array_grid_pos[ly_p][lx_p].pos_y + 47 * g_scale_factor) + 35 + "px";
                g_stopwatch_pos[4] = i; 
              } else if (g_stopwatch_6_flg == FLG_OFF) {
                g_stopwatch_6_flg = FLG_ON;

                stopwatch_clear_6(subroutine_tbl[num].sub_num);
                document.getElementById("stopwatch_6").style.display = 'block';
                document.getElementById("stopwatch_6").style.fontSize = font_size + "px";

                document.getElementById("stopwatch_6").style.left = (g_array_grid_pos[ly_p][lx_p].pos_x + param_offset) + "px";
                document.getElementById("stopwatch_6").style.top = (g_array_grid_pos[ly_p][lx_p].pos_y + 47 * g_scale_factor) + 35 + "px";
                g_stopwatch_pos[5] = i; 
              } else { }
              break;
            default:
              break;
          }
        }
      
      // order name
      if (grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SearchMarker == MARKFLG_ELFN && g_search_num_flg == FLG_OFF && g_search_category == SEARCH_CATEGORY_NONE) {
        ctx.fillStyle = COLOR_YELLOW;
        ctx.fillRect(g_array_grid_pos[ly_p][lx_p].pos_x + 10 * g_scale_factor,g_array_grid_pos[ly_p][lx_p].pos_y + offset_sub_name_y * g_scale_factor,  ctx.measureText(subroutine_tbl[num].order).width, offset_height);
        ctx.fillStyle = COLOR_BLACK;
      }
      ctx.fillText(subroutine_tbl[num].order, (g_array_grid_pos[ly_p][lx_p].pos_x) + 10 * g_scale_factor, (g_array_grid_pos[ly_p][lx_p].pos_y) + 48 * g_scale_factor);

      var ctl_offset_x = Math.floor(grid_x_size / 4) * 3;
      var ctl_offset_y = Math.floor(grid_y_size / 3);
      if (subroutine_tbl[num].ctl_condition_1 != null) {
        // control requirement1
        ctx.fillText(subroutine_tbl[num].ctl_condition_1, (g_array_grid_pos[ly_p][lx_p].pos_x - ctl_offset_x), (g_array_grid_pos[ly_p][lx_p].pos_y + ctl_offset_y));
        if (subroutine_tbl[num].ctl_condition_2 != null) {
          // control requirement2
          ctx.fillText(subroutine_tbl[num].ctl_condition_2, (g_array_grid_pos[ly_p][lx_p].pos_x - ctl_offset_x), (g_array_grid_pos[ly_p + 1][lx_p].pos_y + ctl_offset_y));
          if (subroutine_tbl[num].ctl_condition_3 != null) {
            // control requirement3
            ctx.fillText(subroutine_tbl[num].ctl_condition_3, (g_array_grid_pos[ly_p][lx_p].pos_x - ctl_offset_x), (g_array_grid_pos[ly_p + 2][lx_p].pos_y + ctl_offset_y));
            if (subroutine_tbl[num].ctl_condition_4 != null) {
              // control requirement4
              ctx.fillText(subroutine_tbl[num].ctl_condition_4, (g_array_grid_pos[ly_p][lx_p].pos_x - ctl_offset_x), (g_array_grid_pos[ly_p + 3][lx_p].pos_y + ctl_offset_y));
              if (subroutine_tbl[num].ctl_condition_5 != null) {
                // control requirement5
                ctx.fillText(subroutine_tbl[num].ctl_condition_5, (g_array_grid_pos[ly_p][lx_p].pos_x - ctl_offset_x), (g_array_grid_pos[ly_p + 4][lx_p].pos_y + ctl_offset_y));
                if (subroutine_tbl[num].ctl_condition_6 != null) {
                  // control requirement6
                  ctx.fillText(subroutine_tbl[num].ctl_condition_6, (g_array_grid_pos[ly_p][lx_p].pos_x - ctl_offset_x), (g_array_grid_pos[ly_p + 5][lx_p].pos_y + ctl_offset_y));
                }
              }
            }
          }
        }
      }
      break;
    }
  }
}

/*
 =========================================================================
 @function name          : vertical_line
 @argument [i]           : net number
 @argument [lx_i]        : element of the grid_List(row)
 @argument [ly_i]        : element of the grid_List(column)
 @argument [lx_p]        : element of the g_array_grid_pos(row)
 @argument [ly_p]        : element of the g_array_grid_pos(column)
 @argument [grid_x_size] : width of the grid
 @argument [grid_y_size] : height of the grid
 @description            : drawing of the upper lower part line
 @return                 : none
 =========================================================================
*/
function vertical_line(i, lx_i, ly_i, lx_p, ly_p, grid_x_size, grid_y_size){

  var line_updown_pos_x = 0;
  var line_updown_pos_y = 0;

  // drawing of the upper lower part line
  line_updown_pos_x = g_array_grid_pos[ly_p][lx_p].pos_x + grid_x_size;
  line_updown_pos_y = grid_y_size / 2;

  if(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].NetwriteUp == 1){
    ctx.moveTo(line_updown_pos_x, g_array_grid_pos[ly_p][lx_p].pos_y);
    ctx.lineTo(line_updown_pos_x, g_array_grid_pos[ly_p][lx_p].pos_y + line_updown_pos_y);
  }else{}
  
  if(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].NetwriteDown == 1){
    ctx.moveTo(line_updown_pos_x, g_array_grid_pos[ly_p][lx_p].pos_y + line_updown_pos_y);
    ctx.lineTo(line_updown_pos_x, g_array_grid_pos[ly_p][lx_p].pos_y + line_updown_pos_y * 2);
  }else{}
}

/*
 =========================================================================
 @function name         : draw_scrollbar
 @argument [click_info] : pressing information of the scroll bar
 @description           : drawing of the scroll bar
 @return                : none
 =========================================================================
*/
function draw_scrollbar(click_info){
  // drawing of the top button and bottom button
  if (g_scroll_chg_flg == FLG_OFF) { // using iPendant or opboard screen
    sctx.drawImage(add_scrollbtn_u,0,0);
    sctx.drawImage(add_scrollbtn_d,0,SBV_POS_S + SBHV_POS_C);
    sctx.drawImage(scrollbtn_u,0,SBHV_POS_C);
    sctx.drawImage(scrollbtn_d,0,SBV_POS_S);  
  }

  // drawing of the scroll box
  switch (grid_List) {
    case grid_List:
      if (screen_id === SCREEN_LADDER_DISPLAY) {
        var tree_level = get_ladder_tree_level();
        if (tree_level == 0) {
          var scrollbar_box_y = Math.floor((SCROLEBAR_DEFHEIGHT / g_all_grid_cnt) * Math.pow(10, 5)) / Math.pow(10, 5);
        } else if (tree_level <= 3 && tree_level > 0) {
          var scrollbar_box_y = Math.floor((SCROLEBAR_DEFHEIGHT / g_lv_cnt_tbl[tree_level - 1].grid_cnt) * Math.pow(10, 5)) / Math.pow(10, 5);
        } else if (tree_level >= 4) {
          var scrollbar_box_y = Math.floor((SCROLEBAR_DEFHEIGHT / g_sub_pg_tbl[tree_level - 4].grid_cnt) * Math.pow(10, 5)) / Math.pow(10, 5);
        }
      } else if (screen_id === SCREEN_LADDER_EDITOR) {
        var select_level = get_ladder_tree_edit_level();
        if (select_level <= 3) {
          var scrollbar_box_y = Math.floor((SCROLEBAR_DEFHEIGHT / g_edit_lv_cnt_tbl[Number(select_level) - 1].net_cnt) * Math.pow(10, 5)) / Math.pow(10, 5);
        }
        if (select_level >= 4) {
          var scrollbar_box_y = Math.floor((SCROLEBAR_DEFHEIGHT / g_edit_sub_pg_tbl[Number(select_level) - 4].net_cnt) * Math.pow(10, 5)) / Math.pow(10, 5);
        }
        scrollBoxPos.start_y = SBHV_POS_E + scrollbar_box_y * g_disp_net_index;
      } else if (screen_id === SCREEN_LADDER_NETEDIT) {
        var scrollbar_box_y = Math.floor((SCROLEBAR_DEFHEIGHT / lengthcount_net_edit) * Math.pow(10, 5)) / Math.pow(10, 5);
      } else if (screen_id === SCREEN_LADDER_SEARCH_RESULT) {
        var search_level = get_ladder_search_range();
        if (old_screen_id === SCREEN_LADDER_EDITOR) {
          if (search_level <= 3 && search_level > 0) {
            var scrollbar_box_y = Math.floor((SCROLEBAR_DEFHEIGHT / g_edit_lv_cnt_tbl[search_level - 1].net_cnt) * Math.pow(10, 5)) / Math.pow(10, 5);
          } else if (search_level >= 4) {
            var scrollbar_box_y = Math.floor((SCROLEBAR_DEFHEIGHT / g_edit_sub_pg_tbl[search_level - 4].net_cnt) * Math.pow(10, 5)) / Math.pow(10, 5);
          }
          scrollBoxPos.start_y = SBHV_POS_E + scrollbar_box_y * g_disp_net_index;
        } else {
          if (search_level == 0) {
            var scrollbar_box_y = Math.floor((SCROLEBAR_DEFHEIGHT / g_all_grid_cnt) * Math.pow(10, 5)) / Math.pow(10, 5);
          } else if (search_level <= 3 && search_level > 0) {
            var scrollbar_box_y = Math.floor((SCROLEBAR_DEFHEIGHT / g_lv_cnt_tbl[search_level - 1].grid_cnt) * Math.pow(10, 5)) / Math.pow(10, 5);
          } else if (search_level >= 4) {
            var scrollbar_box_y = Math.floor((SCROLEBAR_DEFHEIGHT / g_sub_pg_tbl[search_level - 4].grid_cnt) * Math.pow(10, 5)) / Math.pow(10, 5);
          }
        }
      } else if (screen_id === SCREEN_LADDER_SEARCH_RESULT_LIST) {
        var scrollbar_box_y = Math.floor((SCROLEBAR_DEFHEIGHT / g_search_result_list_net_num.length) * Math.pow(10, 5)) / Math.pow(10, 5);
        scrollBoxPos.start_y = SBHV_POS_E + scrollbar_box_y * g_disp_net_index;
      } else if (screen_id === SCREEN_LADDER_SEARCH_REPLACE) {
        var replace_level = get_ladder_replace_range();
        if (replace_level <= 3 && replace_level > 0) {
          var scrollbar_box_y = Math.floor((SCROLEBAR_DEFHEIGHT / g_edit_lv_cnt_tbl[replace_level - 1].net_cnt) * Math.pow(10, 5)) / Math.pow(10, 5);
        } else if (replace_level >= 4) {
          var scrollbar_box_y = Math.floor((SCROLEBAR_DEFHEIGHT / g_edit_sub_pg_tbl[replace_level - 4].net_cnt) * Math.pow(10, 5)) / Math.pow(10, 5);
        }
        scrollBoxPos.start_y = SBHV_POS_E + scrollbar_box_y * g_disp_net_index;
      }
      break;
    default:
      var tree_level = get_ladder_tree_level();
      if (tree_level == 0) {
        var scrollbar_box_y = Math.floor((SCROLEBAR_DEFHEIGHT / g_all_grid_cnt) * Math.pow(10, 5)) / Math.pow(10, 5);
      } else if (tree_level <= 3 && tree_level > 0) {
        var scrollbar_box_y = Math.floor((SCROLEBAR_DEFHEIGHT / g_lv_cnt_tbl[tree_level - 1].grid_cnt) * Math.pow(10, 5)) / Math.pow(10, 5);
      } else if (tree_level >= 4) {
        var scrollbar_box_y = Math.floor((SCROLEBAR_DEFHEIGHT / g_sub_pg_tbl[tree_level - 4].grid_cnt) * Math.pow(10, 5)) / Math.pow(10, 5);
      }
      break;
  }

  draw_scrollbar_box(scrollBoxPos.start_y,scrollbar_box_y); 
}

/*
 =========================================================================
 @function name         : draw_scrollbar_horizontal
 @argument [click_info] : pressing information of the scroll bar
 @description           : drawing of the scroll bar(horizontal)
 @return                : none
 =========================================================================
*/
function draw_scrollbar_horizontal(click_info){
  // drawing of the left button and the right button
  if (g_scroll_chg_flg == FLG_OFF) { // using iPendant or opboard screen
    shctx.drawImage(add_scrollbtn_l,0,0);
    shctx.drawImage(add_scrollbtn_r,SBH_POS_S + SBHV_POS_C - SBHV_POS_C,0);
    shctx.drawImage(scrollbtn_l,SBHV_POS_C,0);
    shctx.drawImage(scrollbtn_r,SBH_POS_S - SBHV_POS_C,0);
  }
  // drawing of the scroll box
  if (screen_id == SCREEN_LADDER_NETEDIT) {
    var width_display = 8;
    var scrollbar_box_width = (g_max_col_num - width_display) + 1;
    var scrollbar_box_x = Math.floor((SCROLEBAR_DEFWIDTH / scrollbar_box_width) * Math.pow(10, 5)) / Math.pow(10, 5);
  } else {
    var scrollbar_box_x = Math.floor((SCROLEBAR_DEFWIDTH / g_max_col_num) * Math.pow(10, 5)) / Math.pow(10, 5);
  }
  // drawing start position of the scroll box
  scrollBoxPos.start_x = Math.floor((SBHV_POS_E + scrollbar_box_x * g_disp_width_index) * Math.pow(10, 5)) / Math.pow(10, 5);
  draw_scrollbar_box_horizontal(scrollBoxPos.start_x, scrollbar_box_x);
  
}

/*
 =========================================================================
 @function name     : draw_scrollbar_box
 @argument [y]      : drawing start position
 @argument [height] : quadrangular length to paint pictures
 @description       : quadrangular drawing indicating the present location in the scroll bar
 @return            : none
 =========================================================================
*/
function draw_scrollbar_box(y,height){
  var scroll_box_high_min = 10;
  if(y <= 0){
    y=SBHV_POS_E;
  }

  // fill the original drawing
  if (g_scroll_chg_flg == FLG_OFF) { // using iPendant or opboard screen
    sctx.fillStyle = COLOR_PALE_WHITE;
    sctx.fillRect(0, SBHV_POS_E, SBHV_POS_E, SCROLEBAR_DEFHEIGHT);  // the width is fixed value
  } else {
    sctx.fillStyle = TABLET_SCROLLBAR_COLOR;
    sctx.fillRect(0, 0, 5, SCROLEBAR_DEFHEIGHT);  // the width is fixed value  45 is scrollbtn height
    sctx.fillStyle = COLOR_LIGHT_GRAY;
    sctx.fillRect(5, 0, 4, SCROLEBAR_DEFHEIGHT);
  }
  
  scrollBoxPos.start_y = y;
  scrollBoxPos.box_height = height;

  // drawing of the scroll box
  if (g_scroll_chg_flg == FLG_OFF) { // using iPendant or opboard screen
    sctx.fillStyle = COLOR_SILVER;
  } else {
    if (height < scroll_box_high_min) {
      if ((y + scroll_box_high_min) > SBV_POS_S) {
        y = SBV_POS_S - scroll_box_high_min;
      }
    }
    sctx.fillStyle = TABLET_SCROLLBOX_COLOR;
    var radianStart = 180 * Math.PI / 180;
    var radianEnd = 0 * Math.PI / 180;
    sctx.beginPath();
    sctx.arc(SCROLLBOX_RADIUS, y + SCROLLBOX_RADIUS, SCROLLBOX_RADIUS, radianStart, radianEnd, false);
    sctx.fillStyle = TABLET_SCROLLBOX_COLOR;
    if (scroll_box_high_min < scrollBoxPos.box_height) {
      sctx.arc(SCROLLBOX_RADIUS, (y + scrollBoxPos.box_height *1) - SCROLLBOX_RADIUS, SCROLLBOX_RADIUS, radianEnd, radianStart, false);
    } else {
      sctx.arc(SCROLLBOX_RADIUS, (y + scroll_box_high_min *1) - SCROLLBOX_RADIUS, SCROLLBOX_RADIUS, radianEnd, radianStart, false);
    }
    sctx.fill();
  }
  // decide the minimun of the scroll box
  if (height < scroll_box_high_min) {
    if ((y + scroll_box_high_min) > SBV_POS_S) {
      y = SBV_POS_S - scroll_box_high_min;
    }
    if (g_scroll_chg_flg == FLG_OFF) { // using iPendant or opboard screen
      sctx.fillRect(0,y,SBHV_POS_C,scroll_box_high_min);  // the width is fixed value
    }
  } else {
    if (g_scroll_chg_flg == FLG_OFF) { // using iPendant or opboard screen
      sctx.fillRect(0, y, SBHV_POS_C,height);  // the width is fixed value
    }
  }
}

/*
 =========================================================================
 @function name     : draw_scrollbar_box_horizontal
 @argument [x]      : drawing start position
 @argument [width]  : quadrangular length to paint pictures
 @description       : quadrangular drawing indicating the present location in the scroll bar(horizontal)
 @return            : none
 =========================================================================
*/
function draw_scrollbar_box_horizontal(x,width){
  if(x <= 0){
    x=SBHV_POS_E;
  }

  // fill the original drawing
  if (g_scroll_chg_flg == FLG_OFF) { // using iPendant or opboard screen
    shctx.fillStyle = COLOR_PALE_WHITE;
    shctx.fillRect(SBHV_POS_E, 0, SCROLEBAR_DEFWIDTH, SBHV_POS_C);  // the width is fixed value
  } else {
    shctx.fillStyle = TABLET_SCROLLBAR_COLOR;
    shctx.fillRect(0, 0, SCROLEBAR_DEFWIDTH, 5);  // the width is fixed value
    shctx.fillStyle = COLOR_LIGHT_GRAY;
    shctx.fillRect(0, 5, SCROLEBAR_DEFWIDTH, 4);
  }
  
  scrollBoxPos.start_x = x;
  scrollBoxPos.box_width = width;

  // drawing of the scroll box(width)
  if (g_scroll_chg_flg == FLG_OFF) { // using iPendant or opboard screen
    shctx.fillStyle = COLOR_SILVER;
    shctx.fillRect(x, 0, width, SBHV_POS_C);  // the width is fixed value
  } else {
    shctx.fillStyle = TABLET_SCROLLBOX_COLOR;
    var radianStart_right = 90 * Math.PI / 180;;
    var radianEnd_right = 270 * Math.PI / 180;;
    shctx.beginPath();
    shctx.arc((x + SCROLLBOX_RADIUS), SCROLLBOX_RADIUS, SCROLLBOX_RADIUS, radianStart_right, radianEnd_right, false);
    shctx.fillStyle = TABLET_SCROLLBOX_COLOR;
    sctx.beginPath();
    shctx.arc((x + width) - SCROLLBOX_RADIUS, SCROLLBOX_RADIUS, SCROLLBOX_RADIUS, radianEnd_right, radianStart_right, false);
    shctx.fill();
  }
}

/*
 =========================================================================
 @function name : wheel_scroll
 @argument [e]  : event in the mouse wheel
 @description   : scroll of the grid and net unit
 @return        : none
 =========================================================================
*/
function wheel_scroll(e) {
  // the scroll movement is invalid during popup indication
  // invalid in the case of symbol option is displayed
  if ((g_popup_flg == FLG_ON) || (g_symbol_flg == FLG_ON) || (g_scaling_flg == FLG_ON)) {
    return;
  }
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }
  var scroll_type = null;
  var draw_area = null;
  var direction = 0;
  // deceide an area painting picture from scrollarea
  switch (screen_id) {
    case SCREEN_LADDER_DISPLAY:
      draw_area = CANVAS_AREA_LADDER_DISPLAY;
      scroll_type = "grid";
      break;
    case SCREEN_LADDER_SEARCH_RESULT:
      draw_area = CANVAS_AREA_LADDER_SEARCH_RESULT;
      if (old_screen_id === SCREEN_LADDER_DISPLAY) {
        scroll_type = "grid";
      } else {
        scroll_type = "net";
      }
      break;
    case SCREEN_LADDER_EDITOR:
      draw_area = CANVAS_AREA_LADDER_EDITOR;
      scroll_type = "net";
      break;
    case SCREEN_LADDER_NETEDIT:
      draw_area = CANVAS_AREA_LADDER_NETEDIT;
      scroll_type = "grid";
      break;
    case SCREEN_LADDER_SEARCH_RESULT_LIST:
      draw_area = CANVAS_AREA_LADDER_SEARCH_RESULT_LIST;
      scroll_type = "net";
      break;
    case SCREEN_LADDER_SEARCH_REPLACE:
      draw_area = CANVAS_AREA_LADDER_SEARCH_REPLACE;
      scroll_type = "net";
      break;
    default:
      return;
  }

  if (e.deltaY > 0) {
    // Wheel down
    direction = KEYBOARD_DOWN;
  } else if (e.deltaY < 0) {
    // Wheel up
    direction = KEYBOARD_UP;
  }
    
  // calculate the quantity of scroll movement and draw
  if (scroll_type === "grid") {
    if (screen_id === SCREEN_LADDER_NETEDIT) {
      click_scroll_net_edit_move(draw_area, 0, direction);
    } else {
      click_scroll_grid_move(draw_area, 0, direction);
    }
  } else if (scroll_type === "net") {
    click_scroll_net_move(draw_area, 0, direction);
  }
}

/*
 =========================================================================
 @function name  : click_scroll_net
 @argument [evt] : event in the scroll bar clicked
 @description    : scroll of the net unit
 @return         : none
 =========================================================================
*/
function click_scroll_net(evt) {
  // the scroll movement is invalid during popup indication
  // invalid in the case of symbol option is displayed
  if ((g_popup_flg == FLG_ON) || (g_symbol_flg == FLG_ON) || (g_scaling_flg == FLG_ON)) {
    return;
  }
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }
  var lx;
  var ly;
  var rect = evt.target.getBoundingClientRect();
  // if (g_device === 'smt' && top.tpkeyssheet !== undefined) { // using tabletTP
  //   lx = evt.touches[0].clientX - rect.left;
  //   ly = evt.touches[0].clientY - rect.top;
  // } else {
    lx = evt.clientX - rect.left;
    ly = evt.clientY - rect.top;
  // }
  // deceide an area painting picture from scrollarea
  switch(screen_id){
    case SCREEN_LADDER_DISPLAY:
      var draw_area = CANVAS_AREA_LADDER_DISPLAY;
    break;
    case SCREEN_LADDER_SEARCH_RESULT:
      var draw_area = CANVAS_AREA_LADDER_SEARCH_RESULT;
    break;
    case SCREEN_LADDER_EDITOR:
      var draw_area = CANVAS_AREA_LADDER_EDITOR;
    break;
    case SCREEN_LADDER_SEARCH_RESULT_LIST:
      var draw_area = CANVAS_AREA_LADDER_SEARCH_RESULT_LIST;
    break;
    case SCREEN_LADDER_SEARCH_REPLACE:
      var draw_area = CANVAS_AREA_LADDER_SEARCH_REPLACE;
    break;
   default:
    break;
  }

  // calculate the quantity of scroll movement and draw
  if (g_scroll_chg_flg == FLG_OFF) { // using iPendant or opboard screen
    click_scroll_net_move(draw_area, ly, KEYBOARD_NO);
  } else {
    if (lx >= 5) {// 5 is scrollbar width
      return;
    } else {
      click_scroll_net_move(draw_area, ly, KEYBOARD_NO);
    }
  }

  evt = null;
}

/*
 =========================================================================
 @function name            : click_scroll_net_move
 @argument [draw_area]     : the canvas area to draw
 @argument [ly]            : click position
 @argument [keyboard_type] : kind of key which pressed hardkey
 @description              : draw in scroll of the net unit
 @return                   : none
 =========================================================================
*/
function click_scroll_net_move(draw_area, ly, keyboard_type) {
  var click_pos_move = 0;
  var scroll_width = 0;
  var click_info = null;
  var scroll_area_click_flg = FLG_OFF;
  var scroll_low_btn_click_flg = FLG_OFF;
  var dist = 0;  // distance
  var select_level = get_ladder_tree_edit_level();
  var search_level = get_ladder_search_range();
  var replace_level = get_ladder_replace_range();
  if (screen_id ==SCREEN_LADDER_SEARCH_RESULT_LIST) {
    var net_index = g_result_list_net_num_tbl.indexOf(g_disp_net_index + 1);
    var use_grid_num_tbl = JSON.parse(JSON.stringify(g_search_result_list_grid_num));
    var use_net_num_tbl = JSON.parse(JSON.stringify(g_result_list_net_num_tbl));
  } else {
    var net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
    var use_grid_num_tbl = JSON.parse(JSON.stringify(g_grid_edit_num_tbl));
    var use_net_num_tbl = JSON.parse(JSON.stringify(g_net_num_tbl));
  }
  if (screen_id === SCREEN_LADDER_SEARCH_RESULT_LIST) {
    var current_level_net_cnt = g_search_result_list_net_num.length;
  } else if (screen_id === SCREEN_LADDER_SEARCH_REPLACE) { 
    if (replace_level <= 3) {
      var current_level_net_cnt = g_edit_lv_cnt_tbl[replace_level - 1].net_cnt;
    } else if (replace_level >= 4) {
      var current_level_net_cnt = g_edit_sub_pg_tbl[replace_level - 4].net_cnt;
    }
  } else if (screen_id !== SCREEN_LADDER_SEARCH_RESULT) {
    if (select_level <= 3) {
      var current_level_net_cnt = g_edit_lv_cnt_tbl[select_level - 1].net_cnt;
    } else if (select_level >= 4) {
      var current_level_net_cnt = g_edit_sub_pg_tbl[select_level - 4].net_cnt;
    }
  } else {
    if (search_level <= 3) {
      var current_level_net_cnt = g_edit_lv_cnt_tbl[search_level - 1].net_cnt;
    } else if (search_level >= 4) {
      var current_level_net_cnt = g_edit_sub_pg_tbl[search_level - 4].net_cnt;
    }
  }
  switch (draw_area) {
    case CANVAS_AREA_LADDER_SEARCH_RESULT:
    case CANVAS_AREA_LADDER_SEARCH_REPLACE:
      g_search_hit_square_disp_flag = FLG_ON;
      break;
    default:
      break;
  }
  switch (keyboard_type) {
    case KEYBOARD_UP:
      dist = -1;
      break;
    case KEYBOARD_DOWN:
      dist = 1;
      break;
    case KEYBOARD_SHIFT_UP:
      dist = -5;
      break;
    case KEYBOARD_SHIFT_DOWN:
      dist = 5;
      break;
    default:
      if (SBHV_POS_S < ly && ly < SBHV_POS_C) {
        dist = -5;
      } else if (SBV_POS_E - SBHV_POS_C < ly && ly < SBV_POS_E) {
        dist = 5;
      } else if (SBHV_POS_C < ly && ly < SBHV_POS_E) {
        dist = -1;
      } else if (SBV_POS_S < ly && ly < SBV_POS_S + SBHV_POS_C) {
        dist = 1;
      } else {
      }
      break;
  }

  if ((SBHV_POS_S < ly && ly < SBHV_POS_E) || (keyboard_type == KEYBOARD_UP) || (keyboard_type == KEYBOARD_SHIFT_UP)) {
    // pressed the upper button
    if (screen_id == SCREEN_LADDER_EDITOR || screen_id == SCREEN_LADDER_SEARCH_RESULT_LIST) {
      if (g_selected_net_edit_index == 0) { // blue flame stops the top
        // if (g_flick_flg_tbl.scrolling == FLG_ON) {
        //   stop_flick_scroll();
        // }
        return;
      }
    } else {
      if (g_disp_net_index == 0) {
        // if (g_flick_flg_tbl.scrolling == FLG_ON) {
        //   stop_flick_scroll();
        // }
        return;
      }
    }
    click_info = SCROLLBAR_ACTION_UP_BUTTON;

    // Blue flame moves to the top
    if (screen_id == SCREEN_LADDER_EDITOR || screen_id == SCREEN_LADDER_SEARCH_RESULT_LIST) {
      if (click_info == SCROLLBAR_ACTION_UP_BUTTON && g_selected_net_edit_index == 0) { // blue flame the top
        return;
      } else if (click_info == SCROLLBAR_ACTION_UP_BUTTON && g_selected_net_edit_index + dist < g_disp_net_index) { // net scroll by movement blue flame on the top
        g_selected_net_edit_index += dist;
        g_disp_net_index = g_selected_net_edit_index;
        ly_net_p = 0;
      } else {// Only blue flame moves
        // Calculation of the display position
        var bk_g_disp_net_index = g_disp_net_index;
        ly_net_p = 0;
        for (var k = 0; k < g_row_limit; k++) {
          if (g_disp_net_index == g_selected_net_edit_index + dist) {// arrives at the blue movement
            break;
          }
          if (screen_id == SCREEN_LADDER_SEARCH_RESULT_LIST) {
            ly_net_p += use_grid_num_tbl[g_disp_net_index];
          } else {
            ly_net_p += use_grid_num_tbl[g_net_cnt_before_tree + g_disp_net_index];
          }
          g_disp_net_index++;
        }
        g_selected_net_edit_index = g_selected_net_edit_index + dist;
        g_disp_net_index = bk_g_disp_net_index;
      }
      if (g_selected_net_edit_index < 0) {
        g_selected_net_edit_index = 0;
      }  
    } else {
      g_disp_net_index += dist;
    }
    if (g_disp_net_index < 0) {
      g_disp_net_index = 0;
    }
  } else if (SBHV_POS_E < ly && ly < scrollBoxPos.start_y) {
    // pressed the scroll area of the upper part
    click_info = SCROLLBAR_ACTION_UP_BUTTON;
    click_pos_move = Math.floor((ly - SBHV_POS_E) / scrollBoxPos.box_height);
    scrollbar_tbl.ly = click_pos_move;
    g_disp_net_index = click_pos_move;
    g_selected_net_edit_index = g_disp_net_index;
    ly_net_p = 0;
    scroll_area_click_flg = FLG_ON;
  } else if (scrollBoxPos.start_y < ly && ly < scrollBoxPos.start_y + scrollBoxPos.box_height) {
    // pressed the scroll box
  } else if (scrollBoxPos.start_y + scrollBoxPos.box_height < ly && ly < SBV_POS_S) {
    // pressed the scroll area of the lower part
    click_info = SCROLLBAR_ACTION_DOWN_BUTTON;
    click_pos_move = Math.floor((ly - SBHV_POS_E) / scrollBoxPos.box_height);
    scrollbar_tbl.ly = click_pos_move;
    g_disp_net_index = click_pos_move;
    g_selected_net_edit_index = g_disp_net_index;
    ly_net_p = 0;
    scroll_area_click_flg = FLG_ON;
  } else if ((SBV_POS_S < ly && ly < SBV_POS_E) || (keyboard_type == KEYBOARD_DOWN) || (keyboard_type == KEYBOARD_SHIFT_DOWN)) {
    // pressed the lower button
    if (net_index <= grid_List.length - 1 || (net_index > 0 && net_index <= grid_List.length) || g_disp_net_index < current_level_net_cnt - 1) {
      if (g_disp_net_index == current_level_net_cnt - 1) {
        // if (g_flick_flg_tbl.scrolling == FLG_ON) {
        //   stop_flick_scroll();
        // }
        return;
      }  
      click_info = SCROLLBAR_ACTION_DOWN_BUTTON;
      if (screen_id !== SCREEN_LADDER_SEARCH_RESULT && screen_id !== SCREEN_LADDER_SEARCH_REPLACE) {
        if (screen_id === SCREEN_LADDER_SEARCH_RESULT_LIST) {
          if (search_level <= 3) {
            if (old_screen_id == SCREEN_LADDER_DISPLAY) {
              if (search_level > 0) {
                if (g_lv_cnt_tbl[search_level - 1].net_cnt === 1) {
                  return;
                }
              }
            } else {
              if (g_edit_lv_cnt_tbl[search_level - 1].net_cnt === 1) {
                return;
              }
            }
          }
        } else if (select_level <= 3) {
          if (g_edit_lv_cnt_tbl[select_level - 1].net_cnt === 1) {
            return;
          }
        }
      }
      scroll_low_btn_click_flg = FLG_ON;
      //Blue flame moves to the under
      if (screen_id == SCREEN_LADDER_EDITOR || screen_id == SCREEN_LADDER_SEARCH_RESULT_LIST) {
        if ((click_info == SCROLLBAR_ACTION_DOWN_BUTTON && g_selected_net_edit_index + dist >= use_net_num_tbl[g_net_end_count - 1] - g_net_cnt_before_tree) ||
        g_net_end_count == 0) { // net scroll by movement blue flame on the under
          g_disp_net_index = g_selected_net_edit_index + dist;
        }
        // Calculation of the display position
        var bk_g_disp_net_index = g_disp_net_index;
        ly_net_p = 0;
        for (var k = 0; k < g_row_limit; k++) {
          if (g_disp_net_index == g_selected_net_edit_index + dist) {
            break;
          }
          if (screen_id == SCREEN_LADDER_SEARCH_RESULT_LIST) {
            ly_net_p += use_grid_num_tbl[g_disp_net_index];
          } else {
            ly_net_p += use_grid_num_tbl[g_net_cnt_before_tree + g_disp_net_index];
          }
          g_disp_net_index++;
        }
        g_selected_net_edit_index += dist;
        g_disp_net_index = bk_g_disp_net_index;
      } else {
        g_disp_net_index += dist;
      }
      if (g_disp_net_index > current_level_net_cnt - 1) {
        g_disp_net_index = current_level_net_cnt - 1;
      }
      if (g_selected_net_edit_index >= current_level_net_cnt) {//Blue over display from the last net
        g_selected_net_edit_index = current_level_net_cnt - 1;
      }
    } else {
      return;
    }
  } else {
    return;
  }

  // draw the ladder diagram
  draw_ladder_diagram(click_info, draw_area, null, scroll_low_btn_click_flg);
}

/*
 =========================================================================
 @function name  : click_scroll_grid
 @argument [evt] : event in the scroll bar clicked
 @description    : scroll of the grid unit
 @return         : none
 =========================================================================
*/
function click_scroll_grid(evt) {
  // the scroll movement is invalid during popup indication
  // invalid in the case of symbol option is displayed
  if ((g_popup_flg == FLG_ON) || (g_symbol_flg == FLG_ON) || (g_scaling_flg == FLG_ON)) {
    return;
  }
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }
  var lx;
  var ly;
  var rect = evt.target.getBoundingClientRect();
  // if (g_device === 'smt' && top.tpkeyssheet !== undefined) { // using tabletTP
  //   lx = evt.touches[0].clientX - rect.left;
  //   ly = evt.touches[0].clientY - rect.top;
  // } else {
    lx = evt.clientX - rect.left;
    ly = evt.clientY - rect.top;
  // }
  // deceide an area painting picture from scrollarea
  switch(screen_id){
    case SCREEN_LADDER_DISPLAY:
      var draw_area = CANVAS_AREA_LADDER_DISPLAY;
    break;
    case SCREEN_LADDER_SEARCH_RESULT:
      var draw_area = CANVAS_AREA_LADDER_SEARCH_RESULT;
    break;
    case SCREEN_LADDER_EDITOR:
      var draw_area = CANVAS_AREA_LADDER_EDITOR;
    break;
    case SCREEN_LADDER_NETEDIT:
      var draw_area = CANVAS_AREA_LADDER_NETEDIT;
    break;
    case SCREEN_LADDER_SEARCH_RESULT_LIST:
      var draw_area = CANVAS_AREA_LADDER_SEARCH_RESULT_LIST;
    break;
    case SCREEN_LADDER_SEARCH_REPLACE:
      var draw_area = CANVAS_AREA_LADDER_SEARCH_REPLACE;
    break;
   default:
    break;
  }

  // calculate the quantity of scroll movement and draw
  switch (evt.target.id) {
    case "scroll":
      if (g_scroll_chg_flg == FLG_OFF) { // using iPendant or opboard screen
        click_scroll_grid_move(draw_area, ly, KEYBOARD_NO);
      } else {
        if (lx >= 5) {// 5 is scrollbar width
          return;
        } else {
          click_scroll_grid_move(draw_area, ly, KEYBOARD_NO);
        }
      }
      break;
    case "scroll_h":
      if (g_scroll_chg_flg == FLG_OFF) { // using iPendant or opboard screen
        click_scroll_grid_move_h(draw_area, lx, KEYBOARD_NO);
      } else {
        if (ly >= 5) {// 5 is scrollbar_h height
          return;
        } else {
          click_scroll_grid_move_h(draw_area, lx, KEYBOARD_NO);
        }
      }
      break;
    default:
      return;
  }

  evt = null;
}

/*
 =========================================================================
 @function name            : click_scroll_grid_move
 @argument [draw_area]     : the canvas area to draw
 @argument [ly]            : click position
 @argument [keyboard_type] : kind of key which pressed hardkey
 @description              : draw in scroll of the grid unit
 @return                   : none
 =========================================================================
*/
function click_scroll_grid_move(draw_area, ly, keyboard_type) {
  var click_pos_move = 0;
  var scroll_width = 0;
  var scroll_area_click_flg = FLG_OFF;
  var click_info = null;
  var dist = 0;  // distance
  g_search_hit_pos = [-1, -1];
  var tree_level = get_ladder_tree_level();
  var net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
  var current_level_grid_cnt = 0;
  var current_level_net_cnt = 0;
  var search_level = get_ladder_search_range();
  if (screen_id == SCREEN_LADDER_DISPLAY) {
    if (tree_level == 0) {
      current_level_grid_cnt = g_all_grid_cnt;
      current_level_net_cnt = mnemonic_array[mnemonic_array.length - 1].net_num - 1; // -1 is for "END" Order;
    } else if (tree_level <= 3) {
      current_level_grid_cnt = g_lv_cnt_tbl[Number(tree_level) - 1].grid_cnt;
      current_level_net_cnt = g_lv_cnt_tbl[Number(tree_level) - 1].net_cnt;
    } else if (tree_level >= 4) {
      current_level_grid_cnt = g_sub_pg_tbl[Number(tree_level) - 4].grid_cnt;
      current_level_net_cnt = g_sub_pg_tbl[Number(tree_level) - 4].net_cnt;
    }
  } else {
    if (search_level == 0) {
      current_level_grid_cnt = g_all_grid_cnt;
      current_level_net_cnt = mnemonic_array[mnemonic_array.length - 1].net_num - 1; // -1 is for "END" Order;
    } else if (search_level <= 3) {
      current_level_grid_cnt = g_lv_cnt_tbl[Number(search_level) - 1].grid_cnt;
      current_level_net_cnt = g_lv_cnt_tbl[Number(search_level) - 1].net_cnt;
    } else if (search_level >= 4) {
      current_level_grid_cnt = g_sub_pg_tbl[Number(search_level) - 4].grid_cnt;
      current_level_net_cnt = g_sub_pg_tbl[Number(search_level) - 4].net_cnt;
    }
  }
  switch (draw_area) {
    case CANVAS_AREA_LADDER_SEARCH_RESULT:
    case CANVAS_AREA_LADDER_SEARCH_REPLACE:
      g_search_hit_square_disp_flag = FLG_ON;
      break;
    default:
      break;
  }
  switch (keyboard_type) {
    case KEYBOARD_UP:
      dist = -1;
      break;
    case KEYBOARD_DOWN:
      dist = 1;
      break;
    case KEYBOARD_SHIFT_UP:
      dist = -(VIEW_GRID_COL);
      break;
    case KEYBOARD_SHIFT_DOWN:
      dist = VIEW_GRID_COL;
      break;
    default:
      if (SBHV_POS_S < ly && ly <= SBHV_POS_C) {
        dist = -(VIEW_GRID_COL);
        keyboard_type = KEYBOARD_SHIFT_UP;
      } else if (SBV_POS_E - SBHV_POS_C < ly && ly <= SBV_POS_E) {
        dist = VIEW_GRID_COL;
        keyboard_type = KEYBOARD_SHIFT_DOWN;
      } else if (SBHV_POS_C < ly && ly <= SBHV_POS_E) {
        dist = -1;
      } else if (SBV_POS_S < ly && ly <= SBV_POS_S + SBHV_POS_C) {
        dist = 1;
      } else {
      }
      break;
  }

  if((SBHV_POS_S < ly && ly < SBHV_POS_E) || (keyboard_type == KEYBOARD_UP) || (keyboard_type == KEYBOARD_SHIFT_UP)){
    if (scrollbar_tbl.ly === 0) {
      scrollbar_tbl.ly = Math.round((scrollBoxPos.start_y - SBHV_POS_E) / scrollBoxPos.box_height);
    }
    // pressed the upper button
    var scroll_box_high_pos = Math.floor((scrollBoxPos.start_y) * Math.pow(10, 5)) / Math.pow(10, 5);
    if (scroll_box_high_pos <= SBHV_POS_E) {
      // if (g_flick_flg_tbl.scrolling == FLG_ON) {
      //   stop_flick_scroll();
      // }
      return;
    }
    click_info = SCROLLBAR_ACTION_UP_BUTTON;
    scrollbar_tbl.ly += dist;
    if (scrollbar_tbl.ly <= 0) {
      scrollBoxPos.start_y = SBHV_POS_E;
    } else {
      scrollBoxPos.start_y = Math.floor((scrollBoxPos.start_y - (scrollBoxPos.box_height * Math.abs(dist))) * Math.pow(10, 5)) / Math.pow(10, 5);
    }

    // drawing update
    if (keyboard_type === KEYBOARD_SHIFT_UP) {
      g_disp_grid_index += dist;
      if (g_disp_grid_index < 0) {
        if (g_disp_net_index === 0) {
          g_disp_grid_index = 0;
        } else {
          g_disp_net_index--;
          net_index--;
          var net_length = 0;
          for (; g_disp_grid_index < 0; g_disp_net_index--) {
            if (net_index < 0) {
              var bk_VIEW_MAX_COL;
              bk_VIEW_MAX_COL = VIEW_MAX_COL;
              VIEW_MAX_COL = g_width_num;          
              g_net_num_tbl = [];
              g_result_list_net_num_tbl = [];
              net_index = update_list_jump();
              VIEW_MAX_COL = bk_VIEW_MAX_COL;
              if (screen_id === SCREEN_LADDER_SEARCH_RESULT) {
                var bk_g_disp_width_index = g_disp_width_index;
                var bk_scrollbar_tbl_ly = scrollbar_tbl.ly;
                var bk_g_disp_net_index = g_disp_net_index;
                var bk_g_disp_grid_index = g_disp_grid_index;            
                g_search_result_index = 0;
                g_array_search_result_index = [];
                upd_list_result_info(FLG_OFF);
                if (screen_id === SCREEN_LADDER_SEARCH_RESULT || screen_id === SCREEN_LADDER_SEARCH_REPLACE) {
                  var result_net_cnt = 0;
                  for (var i = 0; i < g_array_search_result_netnum.length; i++){
                    if (g_result_index - i < 0) {
                      break;
                    }
                    if (g_array_search_result_netnum[g_result_index - i].net_num == g_array_search_result_netnum[g_result_index].net_num) {
                      result_net_cnt += 1; 
                    } else {
                      break;
                    }
                  }
                  for (var j = 0; j < g_array_search_result_index.length; j++){
                    if (g_array_search_result_index[j].net_index == g_net_cnt_before_tree + g_array_search_result_netnum[g_result_index].net_num) {
                      for (var k = result_net_cnt - 1; k > 0; k--){
                        g_search_result_index += 1;
                      }
                      break;
                    } else {
                      g_search_result_index += 1;
                    }
                  }
                }          
                g_disp_net_index = bk_g_disp_net_index;
                g_disp_grid_index = bk_g_disp_grid_index;
                g_disp_width_index = bk_g_disp_width_index;            
              }
            }
            net_length = grid_List.getDataNum(net_index, iterateArray).length;
            g_disp_grid_index += net_length;
            if (g_disp_grid_index >= 0) {
              break;
            }
            if (g_disp_net_index === 0 && g_disp_grid_index < 0) {
              g_disp_grid_index = 0;
              break;
            }
            net_index--;
          }
        }
      }
    } else {
      g_disp_net_index = g_disp_net_index;
      g_disp_grid_index = g_disp_grid_index - 1;
    }
  }else if(SBHV_POS_E < ly && ly < scrollBoxPos.start_y){
    // pressed the scroll area of the upper part
    if (scrollBoxPos.start_y <= SBHV_POS_E) {
      return;
    }
    click_info = SCROLLBAR_ACTION_UP_BUTTON;
    scroll_width = SCROLEBAR_DEFHEIGHT / current_level_grid_cnt;
    click_pos_move = Math.floor((ly - SBHV_POS_E) / scroll_width);
    scrollbar_tbl.ly = click_pos_move;
    scrollBoxPos.start_y = SBHV_POS_E + scrollBoxPos.box_height * click_pos_move;
    scroll_area_click_flg = FLG_ON;
  }else if(scrollBoxPos.start_y < ly && ly < scrollBoxPos.start_y + scrollBoxPos.box_height){
    // pressed the scroll box
  }else if(scrollBoxPos.start_y + scrollBoxPos.box_height < ly && ly < SBV_POS_S){
    // pressed the scroll area of the lower part
    if(scrollBoxPos.start_y < SBV_POS_S){
      click_info = SCROLLBAR_ACTION_DOWN_BUTTON;
      scroll_width = SCROLEBAR_DEFHEIGHT / current_level_grid_cnt;
      click_pos_move = Math.floor((ly - SBHV_POS_E) / scroll_width);
      scrollbar_tbl.ly = click_pos_move;
      scrollBoxPos.start_y = SBHV_POS_E + scrollBoxPos.box_height * click_pos_move;
      scroll_area_click_flg = FLG_ON;
    } else {
      return;
    }
  }else if((SBV_POS_S < ly && ly < SBV_POS_E) || (keyboard_type == KEYBOARD_DOWN) || (keyboard_type == KEYBOARD_SHIFT_DOWN)){
    // pressed the lower button
    if (scrollbar_tbl.ly === 0) {
      scrollbar_tbl.ly = Math.round((scrollBoxPos.start_y - SBHV_POS_E) / scrollBoxPos.box_height);
    }
    var scroll_box_low_pos = Math.floor((scrollBoxPos.start_y) * Math.pow(10, 5)) / Math.pow(10, 5);
    var scroll_box_max = Math.floor((SBV_POS_S - scrollBoxPos.box_height) * Math.pow(10, 5)) / Math.pow(10, 5);
    if (scroll_box_low_pos < scroll_box_max && scrollbar_tbl.ly < (current_level_grid_cnt - 1)) {
      if (scrollbar_tbl.ly + 1 === current_level_grid_cnt) {
        return;
      }
      click_info = SCROLLBAR_ACTION_DOWN_BUTTON;
      scrollbar_tbl.ly += dist;
      if (scrollbar_tbl.ly === current_level_grid_cnt - 1) {
        scrollBoxPos.start_y = scroll_box_max;
      } else if (scrollbar_tbl.ly > current_level_grid_cnt - 1) {
        scrollbar_tbl.ly = current_level_grid_cnt - 1;
        scrollBoxPos.start_y = scroll_box_max;
        g_disp_net_index = current_level_net_cnt - 1;
        net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
        g_disp_grid_index = grid_List.getDataNum(net_index, iterateArray).length - 1;
      } else {
        scrollBoxPos.start_y = Math.floor((scrollBoxPos.start_y + (scrollBoxPos.box_height * dist)) * Math.pow(10, 5)) / Math.pow(10, 5);
      }
      // drawing update
      if (keyboard_type === KEYBOARD_SHIFT_DOWN) {
        g_disp_grid_index += dist;
        var net_length = 0;
        for (; net_index < grid_List.length; g_disp_net_index++) {
          net_length = grid_List.getDataNum(net_index, iterateArray).length;
          if (g_disp_net_index === (current_level_net_cnt - 1) && g_disp_grid_index > (net_length - 1)) {
            g_disp_grid_index = net_length - 1;
            break;
          }
          if (g_disp_grid_index >= net_length) {
            g_disp_grid_index -= net_length;
          } else if (g_disp_grid_index < net_length || g_disp_grid_index === 0) {
            break;
          }
          net_index++;
        }
      } else {
        g_disp_net_index = g_disp_net_index;
        g_disp_grid_index = g_disp_grid_index + 1;
      }
    } else {
      // if (g_flick_flg_tbl.scrolling == FLG_ON) {
      //   stop_flick_scroll();
      // }
      return;
    }
  } else {
    return;
  }

  // drawing at the time of the pressing calculates scroll area
  if (scroll_area_click_flg == FLG_ON) {
    var tmp_net_index = 0;
    var tmp_index = 0;
    var check_flg = FLG_OFF;
    var offset_len = 0;
    for (var net_cnt = g_net_cnt_before_tree; net_cnt < g_grid_num_tbl.length; net_cnt++) {
      for (var net_cnt_i = 0; net_cnt_i < g_grid_num_tbl[net_cnt]; net_cnt_i++) {
        if (tmp_index == click_pos_move) {
          g_disp_net_index = tmp_net_index;
          g_disp_grid_index = tmp_index - offset_len;
          check_flg = FLG_ON;
          break;
        }
        tmp_index += 1;
      }
      if (check_flg == FLG_ON) {
        break;
      }
      tmp_net_index += 1;
      offset_len += g_grid_num_tbl[net_cnt];
    }
  }

  // guard of the minimum of the scroll movement
  if(scrollbar_tbl.ly < 0){
    scrollbar_tbl.ly = 0;
  }else if(scrollbar_tbl.lx < 0){
    scrollbar_tbl.lx = 0;
  }

  // guard of the maximum of the scroll movement
  if(lengthcount <= scrollbar_tbl.ly){
    scrollbar_tbl.ly = lengthcount - 1;
  }else if(VIEW_MAX_COL <= scrollbar_tbl.lx){
    scrollbar_tbl.lx = VIEW_MAX_COL;
  }

  switch (draw_area) {
    case CANVAS_AREA_LADDER_DISPLAY:
    case CANVAS_AREA_LADDER_SEARCH_RESULT:
    case CANVAS_AREA_LADDER_EDITOR:
    case CANVAS_AREA_LADDER_SEARCH_RESULT_LIST:
    case CANVAS_AREA_LADDER_SEARCH_REPLACE:
      draw_ladder_diagram(click_info, draw_area, null);
      break;
    case CANVAS_AREA_LADDER_NETEDIT:
      draw_ladder_net_edit_diagram(click_info);
      break;
    default:
      return;
  }
}

/*
 =========================================================================
 @function name            : click_scroll_grid_move_h
 @argument [draw_area]     : the canvas area to draw
 @argument [ly]            : click position
 @argument [keyboard_type] : kind of key which pressed hardkey
 @description              : draw in scroll of the grid unit
 @return                   : none
 =========================================================================
*/
function click_scroll_grid_move_h(draw_area, lx, keyboard_type) {
  var click_pos_move = 0;
  var scroll_width = 0;
  var scroll_area_click_flg = FLG_OFF;
  var width_display = 8;
  var scrollbar_box_width = (g_max_col_num - width_display) + 1;
  var click_info = null;
  var dist = 0;
  g_search_hit_pos = [-1, -1];

  switch (draw_area) {
    case CANVAS_AREA_LADDER_SEARCH_RESULT:
    case CANVAS_AREA_LADDER_SEARCH_REPLACE:
      g_search_hit_square_disp_flag = FLG_ON;
      break;
    default:
      break;
  }

  switch (keyboard_type) {
    case KEYBOARD_LEFT:
      dist = -1;
      break;
    case KEYBOARD_RIGHT:
      dist = 1;
      break;
    case KEYBOARD_SHIFT_LEFT:
      dist = -(VIEW_GRID_ROW);
      break;
    case KEYBOARD_SHIFT_RIGHT:
      dist = VIEW_GRID_ROW;
      break;
    default:
      if (SBHV_POS_S < lx && lx <= SBHV_POS_C) {
        if (screen_id === SCREEN_LADDER_NETEDIT) {
          dist = -(VIEW_GRID_ROW - 3);
        } else {
          dist = -(VIEW_GRID_ROW);
        }
      } else if (SBH_POS_E - SBHV_POS_E < lx && lx <= SBH_POS_E - SBHV_POS_C) {
        if (screen_id === SCREEN_LADDER_NETEDIT) {
          dist = VIEW_GRID_ROW - 3;
        } else {
          dist = VIEW_GRID_ROW;
        }
      } else if (SBHV_POS_C < lx && lx <= SBHV_POS_E) {
        dist = -1;
      } else if (SBH_POS_S - SBHV_POS_C <= lx && lx < SBH_POS_S) {
        dist = 1;
      } else if (SBH_POS_E >= lx && lx > SBH_POS_E - SBHV_POS_C) {
        return;
      }
      break;
  }

  if((SBHV_POS_S < lx && lx < SBHV_POS_E) || (keyboard_type == KEYBOARD_LEFT) || (keyboard_type == KEYBOARD_SHIFT_LEFT)){
    // pressed the left button    
    var scroll_box_width_pos = Math.floor((scrollBoxPos.start_x) * Math.pow(10, 5)) / Math.pow(10, 5);
    if (scroll_box_width_pos <= SBHV_POS_E) {
      // if (g_flick_flg_tbl.scrolling == FLG_ON) {
      //   stop_flick_scroll();
      // }
      return;
    } 
    click_info = SCROLLBAR_ACTION_LEFT_BUTTON;
    scrollbar_tbl.lx += dist;
    if (scrollbar_tbl.lx <= 0) {
      scrollBoxPos.start_x = SBHV_POS_E;
    } else {
      scrollBoxPos.start_x = Math.floor((scrollBoxPos.start_x - (scrollBoxPos.box_width * Math.abs(dist))) * Math.pow(10, 5)) / Math.pow(10, 5);
    }

    // drawing update
    g_disp_net_index = g_disp_net_index;
    g_disp_grid_index = g_disp_grid_index;
    g_disp_width_index += dist;
    if (g_disp_width_index < 0) {
      g_disp_width_index = 0;
    }
  }else if(SBHV_POS_E < lx && lx < scrollBoxPos.start_x){
    // pressed the scroll area of the upper part
    if (scrollBoxPos.start_x <= SBHV_POS_E) {
      return;
    }
    if (screen_id == SCREEN_LADDER_NETEDIT) {
      click_info = SCROLLBAR_ACTION_LEFT_BUTTON;
      scroll_width = SCROLEBAR_DEFWIDTH / scrollbar_box_width;
      click_pos_move = Math.floor((lx - SBHV_POS_E) / scroll_width);
      scrollbar_tbl.lx = click_pos_move;
      scrollBoxPos.start_x = SBHV_POS_E + scrollBoxPos.box_width * click_pos_move;
      scroll_area_click_flg = FLG_ON;
    } else {
      click_info = SCROLLBAR_ACTION_LEFT_BUTTON;
      scroll_width = SCROLEBAR_DEFWIDTH / g_max_col_num;
      click_pos_move = Math.floor((lx - SBHV_POS_E) / scroll_width);
      scrollbar_tbl.lx = click_pos_move;
      scrollBoxPos.start_x = SBHV_POS_E + scrollBoxPos.box_width * click_pos_move;
      scroll_area_click_flg = FLG_ON;
    }
  }else if(scrollBoxPos.start_x < lx && lx < scrollBoxPos.start_x + scrollBoxPos.box_width){
    // pressed the scroll box
  }else if(scrollBoxPos.start_x + scrollBoxPos.box_width < lx && lx < SBH_POS_S - SBHV_POS_C){
    // pressed the scroll area of the lower part
    if (scrollBoxPos.start_x < SBH_POS_S - SBHV_POS_C ) {
      if (screen_id == SCREEN_LADDER_NETEDIT) {
        click_info = SCROLLBAR_ACTION_RIGHT_BUTTON;
        scroll_width = SCROLEBAR_DEFWIDTH / scrollbar_box_width;
        click_pos_move = Math.floor((lx - SBHV_POS_E) / scroll_width);
        scrollbar_tbl.lx = click_pos_move;
        scrollBoxPos.start_x = SBHV_POS_E + scrollBoxPos.box_width * click_pos_move;
        scroll_area_click_flg = FLG_ON;
      } else {
        click_info = SCROLLBAR_ACTION_RIGHT_BUTTON;
        scroll_width = SCROLEBAR_DEFWIDTH / g_max_col_num;
        click_pos_move = Math.floor((lx - SBHV_POS_E) / scroll_width);
        scrollbar_tbl.lx = click_pos_move;
        scrollBoxPos.start_x = SBHV_POS_E + scrollBoxPos.box_width * click_pos_move;
        scroll_area_click_flg = FLG_ON;
      }
    } else {
      return;
    }
  }else if((SBH_POS_S - SBHV_POS_C < lx && lx < SBH_POS_E - SBHV_POS_C) || (keyboard_type == KEYBOARD_RIGHT) || (keyboard_type == KEYBOARD_SHIFT_RIGHT)){
    // pressed the lower button
    var scroll_box_low_pos = Math.floor((scrollBoxPos.start_x) * Math.pow(10, 5)) / Math.pow(10, 5);
    var scroll_box_max = Math.floor((SBH_POS_S - SBHV_POS_C - scrollBoxPos.box_width) * Math.pow(10, 5)) / Math.pow(10, 5);
    if (scroll_box_low_pos < scroll_box_max) {
      if ((g_disp_width_index < g_max_col_num - 1 && draw_area !== CANVAS_AREA_LADDER_NETEDIT) ||
          (g_disp_width_index < g_max_col_num - VIEW_GRID_COL && draw_area === CANVAS_AREA_LADDER_NETEDIT)) {
        click_info = SCROLLBAR_ACTION_RIGHT_BUTTON;
        scrollbar_tbl.lx += dist;
        scrollBoxPos.start_x = Math.floor((scrollBoxPos.start_x + (scrollBoxPos.box_width * dist)) * Math.pow(10, 5)) / Math.pow(10, 5);
        if (scrollBoxPos.start_x > scroll_box_max) {
          scrollBoxPos.start_x = scroll_box_max;
        }
        // drawing update
        g_disp_net_index = g_disp_net_index;
        g_disp_grid_index = g_disp_grid_index;
        g_disp_width_index += dist;
        if (g_disp_width_index + VIEW_GRID_COL >= g_max_col_num && draw_area === CANVAS_AREA_LADDER_NETEDIT) {
          var pull_val = (g_disp_width_index + VIEW_GRID_COL) - g_max_col_num;
          g_disp_width_index -= pull_val;
          scrollbar_tbl.lx = g_disp_width_index;
        }
        if (g_disp_width_index > g_width_num - 1) {
          g_disp_width_index = g_width_num - 1;
        }
      } else {
        scrollBoxPos.start_x = scroll_box_max;
        // if (g_flick_flg_tbl.scrolling == FLG_ON) {
        //   stop_flick_scroll();
        // }
        return;
      }
    } else {
      return;
    }
  } else {
    return;
  }

  // drawing at the time of the pressing calculates scroll area
  if (scroll_area_click_flg == FLG_ON) {
    var tmp_index = 0;
    var check_flg = FLG_OFF;
    var offset_len = 0;

    for (var net_cnt = 0; net_cnt < g_max_col_num; net_cnt++) {
      if (tmp_index == click_pos_move) {
        g_disp_net_index = g_disp_net_index;
        g_disp_grid_index = g_disp_grid_index;
        g_disp_width_index = tmp_index;
        check_flg = FLG_ON;
        break;
      }
      tmp_index += 1;
      if (check_flg == FLG_ON) {
        break;
      }
    }
  }

  // guard of the minimum of the scroll movement
  if(scrollbar_tbl.ly < 0){
    scrollbar_tbl.ly = 0;
  }else if(scrollbar_tbl.lx < 0){
    scrollbar_tbl.lx = 0;
  }

  // guard of the maximum of the scroll movement
  if(lengthcount <= scrollbar_tbl.ly){
    scrollbar_tbl.ly = lengthcount - 1;
  }else if(VIEW_MAX_COL <= scrollbar_tbl.lx){
    scrollbar_tbl.lx = VIEW_MAX_COL;
  }

  switch (draw_area) {
    case CANVAS_AREA_LADDER_DISPLAY:
    case CANVAS_AREA_LADDER_SEARCH_RESULT:
    case CANVAS_AREA_LADDER_EDITOR:
    case CANVAS_AREA_LADDER_SEARCH_RESULT_LIST:
    case CANVAS_AREA_LADDER_SEARCH_REPLACE:
      draw_ladder_diagram(click_info, draw_area);
      break;
    case CANVAS_AREA_LADDER_NETEDIT:
      draw_ladder_net_edit_diagram(click_info);
      break;
    default:
      return;
  }
}

/*
 =========================================================================
 @function name          : draw_net_selected
 @argument [lx_net_p]    : left upper X coordinate of the net blue frame
 @argument [ly_net_p]    : left upper Y coordinate of the net blue frame
 @argument [grid_x_size] : width of the grid
 @argument [grid_y_size] : height of the grid
 @description            : drawing of the NET blue frame
 @return                 : none
 =========================================================================
*/
function draw_net_selected(lx_net_p, ly_net_p, grid_x_size, grid_y_size, net_index){
  var copy_net_pos_y = 0;
  var search_level = get_ladder_search_range();
  var replace_level = get_ladder_replace_range();
  var treeedit_level = get_ladder_tree_edit_level();
  if (screen_id == SCREEN_LADDER_SEARCH_RESULT_LIST) {
    var current_net_index = g_result_list_net_num_tbl.indexOf(g_disp_net_index + 1);
  } else {
    var current_net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
  }
  if (screen_id == SCREEN_LADDER_SEARCH_RESULT_LIST) {
    var search_level = get_ladder_search_range();
    var treeedit_level = get_ladder_tree_edit_level();
    if (search_level != treeedit_level && g_from_search_flg == FLG_ON) {
      var draw_selected_net_index = g_result_list_net_num_tbl.indexOf(g_disp_net_index + 1);// from search display
    } else {
      var draw_selected_net_index = g_result_list_net_num_tbl.indexOf(g_selected_net_edit_index + 1);
    }
  } else {
    if (g_from_search_flg == FLG_OFF && g_from_replace_flg == FLG_OFF) {
      var draw_selected_net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_selected_net_edit_index + 1);
    } else {
      if (g_from_search_flg == FLG_ON && search_level == treeedit_level ||
        g_from_replace_flg == FLG_ON && replace_level == treeedit_level) {
        ly_net_p = 0;
        var draw_selected_net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
      } else {
        var draw_selected_net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_selected_net_edit_index + 1);
      }
    }
  }
  // draw a blue quadrangle
  // drawing process start
  ctx.beginPath();  // declaration of the drawing start

  var width_start = 10;  // offset
  var width_end = g_array_grid_pos[ly_net_p][VIEW_GRID_COL - 1].pos_x + grid_x_size;
  // quadrangle(blue)
  ctx.lineWidth  = 3 * g_scale_factor;  // line weight
  ctx.strokeStyle = COLOR_BULE_SD;  // filled style
  ctx.strokeRect(width_start, g_array_grid_pos[ly_net_p][lx_net_p].pos_y, grid_x_size * VIEW_GRID_COL, grid_y_size * grid_List.getDataNum(draw_selected_net_index ,iterateArray).length);
  if (g_copy_net.data != null && g_net_cnt_before_tree + g_disp_net_index <= g_copy_net.index && g_copy_net.index !== null && g_net_num_tbl.indexOf(g_copy_net.index + 1) !== -1) {
    for (var i = g_net_cnt_before_tree + g_disp_net_index; i < g_copy_net.index; i++) {
      copy_net_pos_y += grid_List.getDataNum(current_net_index, iterateArray).length;
      current_net_index++;
    }
    ctx.strokeStyle = COLOR_GREEN;  // filled style
    ctx.strokeRect(width_start, g_array_grid_pos[copy_net_pos_y][lx_net_p].pos_y, grid_x_size * VIEW_GRID_COL, grid_y_size * g_copy_net.hight);
  }
  // appoint transparency
  ctx.globalAlpha = 0.1;

  // filled rectangle(blue) of the permeation
  ctx.fillStyle = COLOR_BULE_SD;
  ctx.fillRect(width_start, g_array_grid_pos[ly_net_p][lx_net_p].pos_y, grid_x_size * VIEW_GRID_COL, grid_y_size * grid_List.getDataNum(draw_selected_net_index ,iterateArray).length);
  if (g_copy_net.data != null && g_net_cnt_before_tree + g_disp_net_index <= g_copy_net.index && g_copy_net.index !== null && g_net_num_tbl.indexOf(g_copy_net.index + 1) !== -1) {
    ctx.fillStyle = COLOR_GREEN;
    ctx.fillRect(width_start, g_array_grid_pos[copy_net_pos_y][lx_net_p].pos_y, grid_x_size * VIEW_GRID_COL, grid_y_size * g_copy_net.hight);
  }
  // return transparency to a standard
  ctx.globalAlpha = 1.0;

  // drawing of the possible figure
  ctx.stroke();

  // declaration of the draw end
  ctx.closePath();
}

/*
 =========================================================================
 @function name : onClick
 @argument [e]  : mouse click event information
 @description   : processing in the click(popup indication of the element information)
 @return        : none
 =========================================================================
*/
function onClick(e) {
  if (g_processing_flg === FLG_ON) {
    return;
  }
  // invalid in the case of symbol option is displayed
  if (g_symbol_flg == FLG_ON || g_scaling_flg == FLG_ON) {
    return;
  }
  if (g_slide_scroll_flg == FLG_ON) {
    g_slide_scroll_flg = FLG_OFF;
    return;
  }
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }

  var lx_p = 0;
  var ly_p = 0;

  var click_pos_x = 0;
  var click_pos_y = 0;

  var lx = 0;
  var ly = 0;
  var rect = e.target.getBoundingClientRect();

  var focus_repaint_flg = false;
  
  lx = e.clientX - rect.left;
  ly = e.clientY - rect.top;

  if (lx > SBH_POS_TOUCH_E - 60) {
    return;
  }

  // the acquisition of the canvas drawing domain
  var drawing_area_info = document.getElementById('canvas_area');
  var drawing_area_width = drawing_area_info.attributes.width.nodeValue;
  var drawing_area_height = drawing_area_info.attributes.height.nodeValue;

  // offset to ajust the draw position(line of both ends of the ladder diagram)
  var canvas_x_offset = 10;
  if (g_scroll_chg_flg == FLG_OFF) { // using iPendant or opboard screen
    var canvas_x_offset_2 = 54;
    var canvas_y_offset = 16;
  } else {
    var canvas_x_offset_2 = 10;
    var canvas_y_offset = 20;
  }

  // calculate size for 1 grid
  var grid_x_size = (drawing_area_width - canvas_x_offset - canvas_x_offset_2 - 10) / VIEW_GRID_COL;
  var grid_y_size = (drawing_area_height - canvas_y_offset) / VIEW_MAX_ROW;

  // stores click position
  g_selected_element_x = Math.floor((lx - canvas_x_offset) / grid_x_size);
  g_selected_element_y = Math.floor(ly / grid_y_size);
  g_selected_element_x = g_selected_element_x + g_disp_width_index;
  g_selected_element_y = g_selected_element_y + g_disp_grid_index;

  // confirm the net number of the element information
  var click_net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
  var click_grid_y_index = g_selected_element_y;
  g_all_click_net_index = g_disp_net_index;
  // acquire a element and calculate net position pressed
  if (g_grid_num_tbl.length - 1 <= click_net_index) {
    return;
  }
  var node = grid_List.get(click_net_index);
  var length_cnt = node.data.length;
  for (k = 0; k < click_grid_y_index + 1; k++) {
    if (click_grid_y_index + 1 <= length_cnt) {
      length_cnt -= node.data.length;
      break;
    }
    click_net_index = click_net_index + 1;
    g_all_click_net_index = g_all_click_net_index + 1;
    node = node.next;
    length_cnt += node.data.length;
  }

  g_click_net_index = click_net_index;

  var click_grid_y = 0;
  if (length_cnt == 0) {
    click_grid_y = click_grid_y_index;
  } else {
    click_grid_y = click_grid_y_index - length_cnt;
  }

  if (mnemonic_array[mnemonic_array.length - 1].net_num - 1 < g_all_click_net_index + 1 || g_selected_element_x > g_width_num - 1) {
    return;
  }

  if (!g_array_grid_detail[grid_List.getDataNum(click_net_index, iterateArray)[click_grid_y][g_selected_element_x].Address]) {
    if (g_click_pos_disp_tbl.pos_ly === -1) {
      return;
    }
    g_click_pos_disp_tbl = { pos_ly: -1, pos_lx: -1, net_index: -1, search_result: g_click_pos_disp_tbl.search_result };
    if (screen_id === SCREEN_LADDER_DISPLAY) {
      draw_ladder_diagram(SCROLLBAR_ACTION_ANY, CANVAS_AREA_LADDER_DISPLAY);
    } else if (screen_id === SCREEN_LADDER_SEARCH_RESULT) {
      g_search_hit_square_disp_flag = FLG_ON;
      draw_ladder_diagram(SCROLLBAR_ACTION_ANY, CANVAS_AREA_LADDER_SEARCH_RESULT);
      if (g_click_pos_disp_tbl.search_result > 0) {
        if (g_search_hit_square_disp_flag === FLG_ON) {
          focus_repaint_flg = FLG_ON;
          search_hit_square(ctx, grid_x_size, grid_y_size, g_search_hit_pos[0], g_search_hit_pos[1], focus_repaint_flg);
          focus_repaint_flg = FLG_OFF;
        } else {
          g_search_hit_square_disp_flag = FLG_ON;
        }
      }
    }
    return;
  }

  for (var ly_p = 0; ly_p < grid_List.getDataNum(0, iterateArray).length; ly_p++) {
    if ((g_array_grid_pos[ly_p][lx_p].pos_y < ly) && (ly < g_array_grid_pos[ly_p][lx_p].pos_y + grid_y_size)) {
      click_pos_tbl.ly = ly_p;
      for (var lx_p = 0; lx_p < grid_List.getDataNum(0, iterateArray)[0].length; lx_p++) {
        // confirm the grid position
        if ((g_array_grid_pos[ly_p][lx_p].pos_x < lx) && (lx < g_array_grid_pos[ly_p][lx_p].pos_x + grid_x_size)) {
          click_pos_tbl.lx = lx_p;
          break;
        }
      }
      break;
    }
  }

  // confirm element(the popup window making information)
  if (g_array_grid_detail[grid_List.getDataNum(click_net_index ,iterateArray)[click_grid_y][g_selected_element_x].Address]) {
    if (screen_id === SCREEN_LADDER_DISPLAY) {
      if (g_pmc_no !== PMC_MEMORY_TYPE_DCS) {
        if (document.getElementById("popbutton_edit_1").style.display === "none" && get_g_read_check_ng_flg() === FLG_OFF) {
          getPmcVarStatus('*SYSTEM*', "$PMC_CFG.$EDIT_ENB", ladder_pmc_val_callback, "popup_edit_button_display");
        }
      }
      document.getElementById("popup_no_comfirm_2").style.display="block";
      document.getElementById("popbutton_coil_1").style.display="block";
      document.getElementById("popbutton_contact_1").style.display = "block";
      document.getElementById("pop_address_2").style.display = "block";
      document.getElementById("pop_symbol_2").style.display = "block";
      document.getElementById("pop_comment_2").style.display = "block";
      document.getElementById("search_category_2_1").style.display = "none";
      document.getElementById("search_category_2_2").style.display = "none";
      document.getElementById("popcomment_2_1").style.display = "none";
      document.getElementById("poptitle_info").disabled = "true";
      document.getElementById("pop_address_2").placeholder = grid_List.getDataNum(click_net_index ,iterateArray)[click_grid_y][g_selected_element_x].Address;
      document.getElementById("pop_symbol_2").placeholder = g_array_grid_detail[grid_List.getDataNum(click_net_index ,iterateArray)[click_grid_y][g_selected_element_x].Address].Symbol;
      if (get_pmc_option_flg(PMC_OPTION_ES) === FLG_OFF) {
        document.getElementById("pop_comment_2").value = g_array_grid_detail[grid_List.getDataNum(click_net_index, iterateArray)[click_grid_y][g_selected_element_x].Address].Comment1;
      } else {
        document.getElementById("pop_comment_2").value = lf_code_change(g_array_grid_detail[grid_List.getDataNum(click_net_index, iterateArray)[click_grid_y][g_selected_element_x].Address].Comment1, "\n");
      }
      Popupbutton();
      canvas.removeEventListener('click', onClick, false);
      g_click_pos_disp_tbl = { pos_ly: click_grid_y, pos_lx: g_selected_element_x, net_index: click_net_index, search_result:g_click_pos_disp_tbl.search_result };
      draw_ladder_diagram(SCROLLBAR_ACTION_ANY, CANVAS_AREA_LADDER_DISPLAY);
    } else if (screen_id === SCREEN_LADDER_SEARCH_RESULT && old_screen_id != SCREEN_LADDER_EDITOR && document.getElementById("popup_no_comfirm_4").style.display != "block") {
      document.getElementById("popup_no_comfirm_4").style.display = "block";
      if (g_pmc_no !== PMC_MEMORY_TYPE_DCS) {
        if (document.getElementById("popbutton_edit_2").style.display === "none" && get_g_read_check_ng_flg() === FLG_OFF) {
          getPmcVarStatus('*SYSTEM*', "$PMC_CFG.$EDIT_ENB", ladder_pmc_val_callback, "popup_edit_button_display");
        }
      }
      document.getElementById("popbutton_coil_2").style.display="block";
      document.getElementById("popbutton_contact_2").style.display = "block";
      document.getElementById("popcomment_4_1").style.display = "none";
      document.getElementById("popcomment_4_2").style.display = "none";
      document.getElementById("poptitle_info_4").disabled = "true";
      document.getElementById("poptitle_info_4").style.display = "block";
      document.getElementById("poptitle_address_4").style.display = "block";
      document.getElementById("poptitle_symbol_4").style.display = "block";
      document.getElementById("poptitle_comment_4").style.display = "block";
      document.getElementById("pop_address_4").style.display = "block";
      document.getElementById("pop_symbol_4").style.display = "block";
      document.getElementById("pop_comment_4").style.display = "block";
      document.getElementById("search_category_4_1").style.display = "none";
      document.getElementById("search_category_4_2").style.display = "none";  
      document.getElementById("search_category_4_3").style.display = "none";  
      document.getElementById("search_category_4_4").style.display = "none";
      document.getElementById("search_category_4_5").style.display = "none";
      document.getElementById("search_category_4_6").style.display = "none";
      document.getElementById("popcomment_4_3").style.display = "none";
      document.getElementById("pop_address_4").placeholder = grid_List.getDataNum(click_net_index ,iterateArray)[click_grid_y][g_selected_element_x].Address;
      document.getElementById("pop_symbol_4").placeholder = g_array_grid_detail[grid_List.getDataNum(click_net_index ,iterateArray)[click_grid_y][g_selected_element_x].Address].Symbol;
      if (get_pmc_option_flg(PMC_OPTION_ES) === FLG_OFF) {
        document.getElementById("pop_comment_4").value = g_array_grid_detail[grid_List.getDataNum(click_net_index, iterateArray)[click_grid_y][g_selected_element_x].Address].Comment1;
      } else {
        document.getElementById("pop_comment_4").value = lf_code_change(g_array_grid_detail[grid_List.getDataNum(click_net_index, iterateArray)[click_grid_y][g_selected_element_x].Address].Comment1, "\n");
      }
      Popupbutton();
      canvas.removeEventListener('click', onClick, false);
      g_click_pos_disp_tbl = { pos_ly: click_grid_y, pos_lx: g_selected_element_x, net_index: click_net_index, search_result:g_click_pos_disp_tbl.search_result};
      draw_ladder_diagram(SCROLLBAR_ACTION_ANY, CANVAS_AREA_LADDER_SEARCH_RESULT);
    }
  }

  e = null;
}

/*
 =========================================================================
 @function name           : entry_target_net_data
 @argument [grid_data]    : draw grid data
 @argument [grid_index]   : draw grid index
 @argument [pos_index]    : draw position index
 @argument [pos_start_iy] : draw start y position
 @description             : [update ladder color]entry target_net_data
 @return                  : none
 =========================================================================
*/
function entry_target_net_data(grid_data, grid_index, pos_index, pos_start_iy) {
  var pos_iy = null;
  var adr_info = [];  // ex:'R0000.1' -> 0...address('R0000'), 1...bit(1)
  var address = "";
  var net_index = 0;
  g_array_grid_update.net_indexs[grid_index] = [];
  for (var iy = 0; iy < grid_data.length; iy++){
    if (iy == pos_index) {
      pos_iy = pos_start_iy;
    }
    for (var ix = 0; ix < grid_data[iy].length; ix++){
      if ((grid_data[iy][ix].Address != '') || (grid_data[iy][ix].SubNo == DEF_SUBROUTINE_TMR.NUM) || (grid_data[iy][ix].SubNo == DEF_SUBROUTINE_TMRC.NUM) || (grid_data[iy][ix].SubNo == DEF_SUBROUTINE_TMRST.NUM) || (grid_data[iy][ix].SubNo == DEF_SUBROUTINE_TMRSS.NUM)) {  // warning magic number
        g_array_grid_update.net_indexs[grid_index].push({ "grid_ix": ix, "grid_iy": iy, "value": null, "old_value": null });
        net_index = g_array_grid_update.net_indexs[grid_index].length - 1;
        if (pos_iy != null) {
          g_array_grid_update.net_indexs[grid_index][net_index]["pos_iy"] = pos_iy;
        }

        if (grid_data[iy][ix].SubNo == DEF_SUBROUTINE_TMR.NUM) {
          var tmr3_addr_name_1 = null;
          var tmr3_addr_name_2 = null;
          if (grid_data[iy][ix].SubParam1 == "1") {
            tmr3_addr_name_1 = "T0000";
            tmr3_addr_name_2 = "T0001";
          } else {
            var subno_number = Number(grid_data[iy][ix].SubParam1);

            tmr3_addr_name_1 = String(subno_number + (subno_number - 2));
            tmr3_addr_name_1 = ("0000" + tmr3_addr_name_1).substr(-4);
            tmr3_addr_name_1 = "T" + tmr3_addr_name_1;

            tmr3_addr_name_2 = String(subno_number + (subno_number - 1));
            tmr3_addr_name_2 = ("0000" + tmr3_addr_name_2).substr(-4);
            tmr3_addr_name_2 = "T" + tmr3_addr_name_2;
          }

          g_pmc_address_table[tmr3_addr_name_1] = (g_pmc_address_table[tmr3_addr_name_1] == null) ? g_pmc_address_table[tmr3_addr_name_1] = { "value": null, "conf": [] } : g_pmc_address_table[tmr3_addr_name_1];
          g_pmc_address_table[tmr3_addr_name_1].conf.push({ "grid_index": grid_index, "net_index": net_index, "for2byte": true });
          g_pmc_address_table[tmr3_addr_name_2] = (g_pmc_address_table[tmr3_addr_name_2] == null) ? g_pmc_address_table[tmr3_addr_name_2] = { "value": null, "conf": [] } : g_pmc_address_table[tmr3_addr_name_2];
          g_pmc_address_table[tmr3_addr_name_2].conf.push({ "grid_index": grid_index, "net_index": net_index, "for2byte": true });

        } else if (grid_data[iy][ix].SubNo == DEF_SUBROUTINE_TMRC.NUM) {
          var tmr54_addr_name_1 = null;
          var tmr54_addr_name_2 = null;

          var subno_char = grid_data[iy][ix].SubParam2.slice(0, 1);
          var subno_number = grid_data[iy][ix].SubParam2.slice(-4);
          subno_number = Number(subno_number);

          tmr54_addr_name_1 = String(subno_number);
          tmr54_addr_name_1 = ("0000" + tmr54_addr_name_1).substr(-4);
          tmr54_addr_name_1 = subno_char + tmr54_addr_name_1;

          tmr54_addr_name_2 = String(subno_number + 1);
          tmr54_addr_name_2 = ("0000" + tmr54_addr_name_2).substr(-4);
          tmr54_addr_name_2 = subno_char + tmr54_addr_name_2;

          g_pmc_address_table[tmr54_addr_name_1] = (g_pmc_address_table[tmr54_addr_name_1] == null) ? g_pmc_address_table[tmr54_addr_name_1] = { "value": null, "conf": [] } : g_pmc_address_table[tmr54_addr_name_1];
          g_pmc_address_table[tmr54_addr_name_1].conf.push({ "grid_index": grid_index, "net_index": net_index, "for2byte_54": 1 });
          g_pmc_address_table[tmr54_addr_name_2] = (g_pmc_address_table[tmr54_addr_name_2] == null) ? g_pmc_address_table[tmr54_addr_name_2] = { "value": null, "conf": [] } : g_pmc_address_table[tmr54_addr_name_2];
          g_pmc_address_table[tmr54_addr_name_2].conf.push({ "grid_index": grid_index, "net_index": net_index, "for2byte_54": 2 });

        } else if ((grid_data[iy][ix].SubNo == DEF_SUBROUTINE_TMRST.NUM) || (grid_data[iy][ix].SubNo == DEF_SUBROUTINE_TMRSS.NUM)) {
          if (isNaN(grid_data[iy][ix].SubParam1)){
            // set time : string
            var tmr221_222_addr_name_1 = null;
            var tmr221_222_addr_name_2 = null;
            var tmr221_222_addr_name_3 = null;
            var tmr221_222_addr_name_4 = null;

            var subno_char = grid_data[iy][ix].SubParam1.slice(0, 1);
            var subno_number = grid_data[iy][ix].SubParam1.slice(-4);
            subno_number = Number(subno_number);

            tmr221_222_addr_name_1 = String(subno_number + 3);
            tmr221_222_addr_name_1 = ("0000" + tmr221_222_addr_name_1).substr(-4);
            tmr221_222_addr_name_1 = subno_char + tmr221_222_addr_name_1;

            tmr221_222_addr_name_2 = String(subno_number + 2);
            tmr221_222_addr_name_2 = ("0000" + tmr221_222_addr_name_2).substr(-4);
            tmr221_222_addr_name_2 = subno_char + tmr221_222_addr_name_2;

            tmr221_222_addr_name_3 = String(subno_number + 1);
            tmr221_222_addr_name_3 = ("0000" + tmr221_222_addr_name_3).substr(-4);
            tmr221_222_addr_name_3 = subno_char + tmr221_222_addr_name_3;

            tmr221_222_addr_name_4 = String(subno_number);
            tmr221_222_addr_name_4 = ("0000" + tmr221_222_addr_name_4).substr(-4);
            tmr221_222_addr_name_4 = subno_char + tmr221_222_addr_name_4;

            g_pmc_address_table[tmr221_222_addr_name_1] = (g_pmc_address_table[tmr221_222_addr_name_1] == null) ? g_pmc_address_table[tmr221_222_addr_name_1] = { "value": null, "conf": [] } : g_pmc_address_table[tmr221_222_addr_name_1];
            g_pmc_address_table[tmr221_222_addr_name_1].conf.push({ "grid_index": grid_index, "net_index": net_index, "for4byte_name": 1 });
            g_pmc_address_table[tmr221_222_addr_name_2] = (g_pmc_address_table[tmr221_222_addr_name_2] == null) ? g_pmc_address_table[tmr221_222_addr_name_2] = { "value": null, "conf": [] } : g_pmc_address_table[tmr221_222_addr_name_2];
            g_pmc_address_table[tmr221_222_addr_name_2].conf.push({ "grid_index": grid_index, "net_index": net_index, "for4byte_name": 2 });
            g_pmc_address_table[tmr221_222_addr_name_3] = (g_pmc_address_table[tmr221_222_addr_name_3] == null) ? g_pmc_address_table[tmr221_222_addr_name_3] = { "value": null, "conf": [] } : g_pmc_address_table[tmr221_222_addr_name_3];
            g_pmc_address_table[tmr221_222_addr_name_3].conf.push({ "grid_index": grid_index, "net_index": net_index, "for4byte_name": 3 });
            g_pmc_address_table[tmr221_222_addr_name_4] = (g_pmc_address_table[tmr221_222_addr_name_4] == null) ? g_pmc_address_table[tmr221_222_addr_name_4] = { "value": null, "conf": [] } : g_pmc_address_table[tmr221_222_addr_name_4];
            g_pmc_address_table[tmr221_222_addr_name_4].conf.push({ "grid_index": grid_index, "net_index": net_index, "for4byte_name": 4 });

            var tmr221_222_addr_addup_time_1 = null;
            var tmr221_222_addr_addup_time_2 = null;
            var tmr221_222_addr_addup_time_3 = null;
            var tmr221_222_addr_addup_time_4 = null;

            var subno_char = grid_data[iy][ix].SubParam2.slice(0, 1);
            var subno_number = grid_data[iy][ix].SubParam2.slice(-4);
            subno_number = Number(subno_number);

            tmr221_222_addr_addup_time_1 = String(subno_number + 3);
            tmr221_222_addr_addup_time_1 = ("0000" + tmr221_222_addr_addup_time_1).substr(-4);
            tmr221_222_addr_addup_time_1 = subno_char + tmr221_222_addr_addup_time_1;

            tmr221_222_addr_addup_time_2 = String(subno_number + 2);
            tmr221_222_addr_addup_time_2 = ("0000" + tmr221_222_addr_addup_time_2).substr(-4);
            tmr221_222_addr_addup_time_2 = subno_char + tmr221_222_addr_addup_time_2;

            tmr221_222_addr_addup_time_3 = String(subno_number + 1);
            tmr221_222_addr_addup_time_3 = ("0000" + tmr221_222_addr_addup_time_3).substr(-4);
            tmr221_222_addr_addup_time_3 = subno_char + tmr221_222_addr_addup_time_3;

            tmr221_222_addr_addup_time_4 = String(subno_number);
            tmr221_222_addr_addup_time_4 = ("0000" + tmr221_222_addr_addup_time_4).substr(-4);
            tmr221_222_addr_addup_time_4 = subno_char + tmr221_222_addr_addup_time_4;

            g_pmc_address_table[tmr221_222_addr_addup_time_1] = (g_pmc_address_table[tmr221_222_addr_addup_time_1] == null) ? g_pmc_address_table[tmr221_222_addr_addup_time_1] = { "value": null, "conf": [] } : g_pmc_address_table[tmr221_222_addr_addup_time_1];
            g_pmc_address_table[tmr221_222_addr_addup_time_1].conf.push({ "grid_index": grid_index, "net_index": net_index, "for4byte_addup_time_str": 1 });
            g_pmc_address_table[tmr221_222_addr_addup_time_2] = (g_pmc_address_table[tmr221_222_addr_addup_time_2] == null) ? g_pmc_address_table[tmr221_222_addr_addup_time_2] = { "value": null, "conf": [] } : g_pmc_address_table[tmr221_222_addr_addup_time_2];
            g_pmc_address_table[tmr221_222_addr_addup_time_2].conf.push({ "grid_index": grid_index, "net_index": net_index, "for4byte_addup_time_str": 2 });
            g_pmc_address_table[tmr221_222_addr_addup_time_3] = (g_pmc_address_table[tmr221_222_addr_addup_time_3] == null) ? g_pmc_address_table[tmr221_222_addr_addup_time_3] = { "value": null, "conf": [] } : g_pmc_address_table[tmr221_222_addr_addup_time_3];
            g_pmc_address_table[tmr221_222_addr_addup_time_3].conf.push({ "grid_index": grid_index, "net_index": net_index, "for4byte_addup_time_str": 3 });
            g_pmc_address_table[tmr221_222_addr_addup_time_4] = (g_pmc_address_table[tmr221_222_addr_addup_time_4] == null) ? g_pmc_address_table[tmr221_222_addr_addup_time_4] = { "value": null, "conf": [] } : g_pmc_address_table[tmr221_222_addr_addup_time_4];
            g_pmc_address_table[tmr221_222_addr_addup_time_4].conf.push({ "grid_index": grid_index, "net_index": net_index, "for4byte_addup_time_str": 4 });

          } else {
            // ste time : value
            var tmr221_222_addr_addup_time_1 = null;
            var tmr221_222_addr_addup_time_2 = null;
            var tmr221_222_addr_addup_time_3 = null;
            var tmr221_222_addr_addup_time_4 = null;

            var subno_char = grid_data[iy][ix].SubParam2.slice(0, 1);
            var subno_number = grid_data[iy][ix].SubParam2.slice(-4);
            subno_number = Number(subno_number);

            tmr221_222_addr_addup_time_1 = String(subno_number + 3);
            tmr221_222_addr_addup_time_1 = ("0000" + tmr221_222_addr_addup_time_1).substr(-4);
            tmr221_222_addr_addup_time_1 = subno_char + tmr221_222_addr_addup_time_1;

            tmr221_222_addr_addup_time_2 = String(subno_number + 2);
            tmr221_222_addr_addup_time_2 = ("0000" + tmr221_222_addr_addup_time_2).substr(-4);
            tmr221_222_addr_addup_time_2 = subno_char + tmr221_222_addr_addup_time_2;

            tmr221_222_addr_addup_time_3 = String(subno_number + 1);
            tmr221_222_addr_addup_time_3 = ("0000" + tmr221_222_addr_addup_time_3).substr(-4);
            tmr221_222_addr_addup_time_3 = subno_char + tmr221_222_addr_addup_time_3;

            tmr221_222_addr_addup_time_4 = String(subno_number);
            tmr221_222_addr_addup_time_4 = ("0000" + tmr221_222_addr_addup_time_4).substr(-4);
            tmr221_222_addr_addup_time_4 = subno_char + tmr221_222_addr_addup_time_4;

            g_pmc_address_table[tmr221_222_addr_addup_time_1] = (g_pmc_address_table[tmr221_222_addr_addup_time_1] == null) ? g_pmc_address_table[tmr221_222_addr_addup_time_1] = { "value": null, "conf": [] } : g_pmc_address_table[tmr221_222_addr_addup_time_1];
            g_pmc_address_table[tmr221_222_addr_addup_time_1].conf.push({ "grid_index": grid_index, "net_index": net_index, "for4byte_addup_time_val": 1 });
            g_pmc_address_table[tmr221_222_addr_addup_time_2] = (g_pmc_address_table[tmr221_222_addr_addup_time_2] == null) ? g_pmc_address_table[tmr221_222_addr_addup_time_2] = { "value": null, "conf": [] } : g_pmc_address_table[tmr221_222_addr_addup_time_2];
            g_pmc_address_table[tmr221_222_addr_addup_time_2].conf.push({ "grid_index": grid_index, "net_index": net_index, "for4byte_addup_time_val": 2 });
            g_pmc_address_table[tmr221_222_addr_addup_time_3] = (g_pmc_address_table[tmr221_222_addr_addup_time_3] == null) ? g_pmc_address_table[tmr221_222_addr_addup_time_3] = { "value": null, "conf": [] } : g_pmc_address_table[tmr221_222_addr_addup_time_3];
            g_pmc_address_table[tmr221_222_addr_addup_time_3].conf.push({ "grid_index": grid_index, "net_index": net_index, "for4byte_addup_time_val": 3 });
            g_pmc_address_table[tmr221_222_addr_addup_time_4] = (g_pmc_address_table[tmr221_222_addr_addup_time_4] == null) ? g_pmc_address_table[tmr221_222_addr_addup_time_4] = { "value": null, "conf": [] } : g_pmc_address_table[tmr221_222_addr_addup_time_4];
            g_pmc_address_table[tmr221_222_addr_addup_time_4].conf.push({ "grid_index": grid_index, "net_index": net_index, "for4byte_addup_time_val": 4 });

          }
        } else {
          if (grid_data[iy][ix].Address != '') {
            adr_info = grid_data[iy][ix].Address.split(".");
            g_array_grid_update.net_indexs[grid_index][net_index]["adr_bit"] = adr_info[1];
            address = adr_info[0];
          } else {
            address = grid_data[iy][ix].SubParam2;  // [for TMRC / setting timer address ]
          }
          if (g_pmc_address_table[address] == null) {
            g_pmc_address_table[address] = { "value": null, "conf": [] };
          }
          g_pmc_address_table[address].conf.push({ "grid_index": grid_index, "net_index": net_index });
        }
      }
    }
    if (pos_iy != null) {
      pos_iy++;
    }
  }
  if (g_array_grid_update.net_indexs[grid_index].length == 0) {
    g_array_grid_update.net_indexs[grid_index] = null;    
  }
}

/*
 =========================================================================
 @function name         : insert_update_ladder_net_data
 @argument [grid_index] : display grid index
 @argument [grid_ix]    : display grid x
 @argument [grid_iy]    : display grid y
 @argument [pos_ix]     : display x position
 @argument [pos_iy]     : display y position
 @description           : [update ladder color]insert update_ladder_net_data
 @return                : none
 =========================================================================
*/
function insert_update_ladder_net_data(grid_index, grid_ix, grid_iy, pos_ix, pos_iy) {
  var pos = g_array_grid_update.net_indexs[grid_index].filter(function (item, index) {
    if ((item.grid_ix == grid_ix) && (item.grid_iy == grid_iy)) {
      item.pos_ix = pos_ix;
      return true;
    }
  });
}

/*
 =========================================================================
 @function name : get_address_value
 @description   : [update ladder color]send interface 'get address value'
 @return        : none
 =========================================================================
*/
var get_address_value = function () {
  if(g_array_grid_update.flg_start == false){
    return;
  }

  if (g_stop_get_val_flg == FLG_ON) {
    return;
  }
  var net_indexs = g_array_grid_update.net_indexs;

  // send 'get pmc address value' interface
  for (var key in g_pmc_address_table) {
    getPmcByteVal(g_pmc_no, key, callback_address_value, g_array_grid_update.identifier);
  }

  chk_update_ladder();

  g_interval_timer = setTimeout(get_address_value, PMC_INTERVAL_TIME);
};

/*
 =========================================================================
 @function name      : callback_address_value
 @argument [status]  : 0->SUCCESS, other->ERROR
 @argument [pmc_num] : pmc number
 @argument [addr]    : pmc address
 @argument [value]   : address value
 @description        : [update ladder color]callback address value
 @return             : none
 =========================================================================
*/
function callback_address_value(status, pmc_num, addr, value, identifier) {
  if (status != IO_SUCCESS) {
    return; // error
  }

  if (document.getElementById('screen_ladder_display').style.display != 'block') {
    return;
  }

  // not displayed data(old data) --> throw
  if ((g_pmc_address_table[addr] == null) || identifier != g_array_grid_update.identifier) {
    return;
  }
    
  g_pmc_address_table[addr].value = value;

}

/*
 =========================================================================
 @function name        : chk_update_ladder
 @description          : [update ladder color]chk update ladder
 @return               : none
 =========================================================================
*/
function chk_update_ladder(){
  var diff_grid_index = [];
  var net_data = [];
  var grid_index = 0;

  for (var addr in g_pmc_address_table) {
    if(g_pmc_address_table[addr].value == null){
      return;
    }
    for (var i = 0; i < g_pmc_address_table[addr]["conf"].length; i++) {
      net_data = g_array_grid_update.net_indexs[g_pmc_address_table[addr]["conf"][i].grid_index][g_pmc_address_table[addr]["conf"][i].net_index];
      if ("adr_bit" in net_data) {
        net_data.value = ((g_pmc_address_table[addr].value & PMC_ADDRESS_BIT_MASK[net_data.adr_bit]) == 0) ? 0 : 1;
      } else {
        if ("for2byte" in g_pmc_address_table[addr]["conf"][i]) {
          if (net_data.value == null) {
            net_data.value = [];
          }
          if (net_data.value.length < 2) {
            net_data.value.length = 2;
          }
          if (Number( addr.substr(-1) ) % 2) {
            net_data.value[1] = g_pmc_address_table[addr].value;
          } else {
            net_data.value[0] = g_pmc_address_table[addr].value;
          }
        } else if ("for2byte_54" in g_pmc_address_table[addr]["conf"][i]){
          if (net_data.value == null) {
            net_data.value = [];
          }
          if (net_data.value.length < 2) {
            net_data.value.length = 2;
          }
          if (g_pmc_address_table[addr]["conf"][i].for2byte_54 == 1) {
            net_data.value[0] = g_pmc_address_table[addr].value;
          } else {
            net_data.value[1] = g_pmc_address_table[addr].value;
          }
        } else if ("for4byte_name" in g_pmc_address_table[addr]["conf"][i]) {
          if (net_data.value == null) {
            net_data.value = [];
          }
          if (net_data.value.length < 4) {
            net_data.value.length = 4;
          }

          if (g_pmc_address_table[addr]["conf"][i].for4byte_name == 1) {
            net_data.value[3] = g_pmc_address_table[addr].value;
          } else if (g_pmc_address_table[addr]["conf"][i].for4byte_name == 2){
            net_data.value[2] = g_pmc_address_table[addr].value;
          } else if (g_pmc_address_table[addr]["conf"][i].for4byte_name == 3){
            net_data.value[1] = g_pmc_address_table[addr].value;
          } else if (g_pmc_address_table[addr]["conf"][i].for4byte_name == 4){
            net_data.value[0] = g_pmc_address_table[addr].value;
          }else{ }
        } else if ("for4byte_addup_time_str" in g_pmc_address_table[addr]["conf"][i]) {
          if (net_data.value == null) {
            net_data.value = [];
          }
          if (net_data.value.length < 4) {
            net_data.value.length = 4;
          }

          if (g_pmc_address_table[addr]["conf"][i].for4byte_addup_time_str == 1) {
            net_data.value[7] = g_pmc_address_table[addr].value;
          } else if (g_pmc_address_table[addr]["conf"][i].for4byte_addup_time_str == 2) {
            net_data.value[6] = g_pmc_address_table[addr].value;
          } else if (g_pmc_address_table[addr]["conf"][i].for4byte_addup_time_str == 3) {
            net_data.value[5] = g_pmc_address_table[addr].value;
          } else if (g_pmc_address_table[addr]["conf"][i].for4byte_addup_time_str == 4) {
            net_data.value[4] = g_pmc_address_table[addr].value;
          } else { }
        } else if ("for4byte_addup_time_val" in g_pmc_address_table[addr]["conf"][i]) {
          if (net_data.value == null) {
            net_data.value = [];
          }
          if (net_data.value.length < 4) {
            net_data.value.length = 4;
          }

          if (g_pmc_address_table[addr]["conf"][i].for4byte_addup_time_val == 1) {
            net_data.value[3] = g_pmc_address_table[addr].value;
          } else if (g_pmc_address_table[addr]["conf"][i].for4byte_addup_time_val == 2) {
            net_data.value[2] = g_pmc_address_table[addr].value;
          } else if (g_pmc_address_table[addr]["conf"][i].for4byte_addup_time_val == 3) {
            net_data.value[1] = g_pmc_address_table[addr].value;
          } else if (g_pmc_address_table[addr]["conf"][i].for4byte_addup_time_val == 4) {
            net_data.value[0] = g_pmc_address_table[addr].value;
          } else { }
        } else {
          net_data.value = g_pmc_address_table[addr].value;
        }
      }
    }
  }

  // check diff value
  flg_diff_data = [];
  for (grid_index = 0; grid_index < g_array_grid_update.net_indexs.length; grid_index++) {
    if (g_array_grid_update.net_indexs[grid_index] != null) {
      for (var net_index = 0; net_index < g_array_grid_update.net_indexs[grid_index].length; net_index++) {
        if (g_array_grid_update.net_indexs[grid_index][net_index].value != g_array_grid_update.net_indexs[grid_index][net_index].old_value) {
          if (diff_grid_index.indexOf(grid_index) == -1) {
            diff_grid_index.push(grid_index);
          }
        }
        // backup value
        g_array_grid_update.net_indexs[grid_index][net_index].old_value = g_array_grid_update.net_indexs[grid_index][net_index].value;
      }
    }
  }
  if (diff_grid_index.length != 0) {
    // initialization of drawing of stopwatch
    g_stopwatch_1_flg = FLG_OFF;
    g_stopwatch_2_flg = FLG_OFF;
    g_stopwatch_3_flg = FLG_OFF;
    g_stopwatch_4_flg = FLG_OFF;
    g_stopwatch_5_flg = FLG_OFF;
    g_stopwatch_6_flg = FLG_OFF;
    if (g_timer_redraw_1 !== -1 && (diff_grid_index.indexOf(g_timer_redraw_1) !== -1)) {
      stopwatch_clear_1(g_timer_redraw_1);
    }
    if (g_timer_redraw_2 !== -1 && (diff_grid_index.indexOf(g_timer_redraw_2) !== -1)) {
      stopwatch_clear_2(g_timer_redraw_2);
    }
    if (g_timer_redraw_3 !== -1 && (diff_grid_index.indexOf(g_timer_redraw_3) !== -1)) {
      stopwatch_clear_3(g_timer_redraw_3);
    }
    if (g_timer_redraw_4 !== -1 && (diff_grid_index.indexOf(g_timer_redraw_4) !== -1)) {
      stopwatch_clear_4(g_timer_redraw_4);
    }
    if (g_timer_redraw_5 !== -1 && (diff_grid_index.indexOf(g_timer_redraw_5) !== -1)) {
      stopwatch_clear_5(g_timer_redraw_5);
    }
    if (g_timer_redraw_6 !== -1 && (diff_grid_index.indexOf(g_timer_redraw_6) !== -1)) {
      stopwatch_clear_6(g_timer_redraw_6);
    }
    for (var i = 0; i < diff_grid_index.length; i++) {
      draw_update_ladder(diff_grid_index[i]);  // update data
    }
  }
}

// TIMERCOUNTER display global variable
// net num for redrawing, timer setting time
var g_timer_redraw_1   = -1;
var g_timer_set_time_1 = 0;
var g_timer_redraw_2   = -1;
var g_timer_set_time_2 = 0;
var g_timer_redraw_3   = -1;
var g_timer_set_time_3 = 0;
var g_timer_redraw_4   = -1;
var g_timer_set_time_4 = 0;
var g_timer_redraw_5   = -1;
var g_timer_set_time_5 = 0;
var g_timer_redraw_6   = -1;
var g_timer_set_time_6 = 0;

// flg in use of stopwatch, flg in delay
var g_stopwatch_1_flg, g_timer_delay_1_flg = FLG_OFF;
var g_stopwatch_2_flg, g_timer_delay_2_flg = FLG_OFF;
var g_stopwatch_3_flg, g_timer_delay_3_flg = FLG_OFF;
var g_stopwatch_4_flg, g_timer_delay_4_flg = FLG_OFF;
var g_stopwatch_5_flg, g_timer_delay_5_flg = FLG_OFF;
var g_stopwatch_6_flg, g_timer_delay_6_flg = FLG_OFF;

// TIMERCOUNTER display global variable
var g_stopwatch_time_1, g_stopwatch_start_time_1, g_stopwatch_time_add_1 = 0;
var g_stopwatch_time_2, g_stopwatch_start_time_2, g_stopwatch_time_add_2 = 0;
var g_stopwatch_time_3, g_stopwatch_start_time_3, g_stopwatch_time_add_3 = 0;
var g_stopwatch_time_4, g_stopwatch_start_time_4, g_stopwatch_time_add_4 = 0;
var g_stopwatch_time_5, g_stopwatch_start_time_5, g_stopwatch_time_add_5 = 0;
var g_stopwatch_time_6, g_stopwatch_start_time_6, g_stopwatch_time_add_6 = 0;

// subroutine 77 color flg
var g_sub77_color_1_flg, g_sub77_color_2_flg, g_sub77_color_3_flg = FLG_OFF;
var g_sub77_color_4_flg, g_sub77_color_5_flg, g_sub77_color_6_flg = FLG_OFF;

// black line flg
var g_stopwatch_black_1_flg, g_stopwatch_black_2_flg, g_stopwatch_black_3_flg = FLG_OFF;
var g_stopwatch_black_4_flg, g_stopwatch_black_5_flg, g_stopwatch_black_6_flg = FLG_OFF;

// change blue line flg
var g_change_cloro_blue_1_flg, g_change_cloro_blue_2_flg, g_change_cloro_blue_3_flg = FLG_OFF;
var g_change_cloro_blue_4_flg, g_change_cloro_blue_5_flg, g_change_cloro_blue_6_flg = FLG_OFF;

// timer reset flg
var g_sub_reset_1_flg, g_sub_reset_2_flg, g_sub_reset_3_flg = FLG_OFF;
var g_sub_reset_4_flg, g_sub_reset_5_flg, g_sub_reset_6_flg = FLG_OFF;

// reach the set time of the add-up timer flg
var g_addup_reach_set_time_1_flg, g_addup_reach_set_time_2_flg, g_addup_reach_set_time_3_flg = FLG_OFF;
var g_addup_reach_set_time_4_flg, g_addup_reach_set_time_5_flg, g_addup_reach_set_time_6_flg = FLG_OFF;

// stopwatch display value
var g_stopwatch_millisec_1, g_stopwatch_sec_1, g_stopwatch_min_1, g_stopwatch_hour_1 = 0;
var g_stopwatch_millisec_2, g_stopwatch_sec_2, g_stopwatch_min_2, g_stopwatch_hour_2 = 0;
var g_stopwatch_millisec_3, g_stopwatch_sec_3, g_stopwatch_min_3, g_stopwatch_hour_3 = 0;
var g_stopwatch_millisec_4, g_stopwatch_sec_4, g_stopwatch_min_4, g_stopwatch_hour_4 = 0;
var g_stopwatch_millisec_5, g_stopwatch_sec_5, g_stopwatch_min_5, g_stopwatch_hour_5 = 0;
var g_stopwatch_millisec_6, g_stopwatch_sec_6, g_stopwatch_min_6, g_stopwatch_hour_6 = 0;

// stopwatch end flg
var g_stopwatch_end_flg_1, g_stopwatch_end_flg_2, g_stopwatch_end_flg_3 = FLG_OFF;
var g_stopwatch_end_flg_4, g_stopwatch_end_flg_5, g_stopwatch_end_flg_6 = FLG_OFF;

/*
 =========================================================================
 @function name      : init_grobal_variable_in_timer
 @argument           : none
 @description        : initialize global variable using in timer subroutine
 @return             : none
 =========================================================================
*/
function init_grobal_variable_in_timer() {
  g_timer_redraw_1 = -1, g_timer_set_time_1 = 0;
  g_timer_redraw_2 = -1, g_timer_set_time_2 = 0;
  g_timer_redraw_3 = -1, g_timer_set_time_3 = 0;
  g_timer_redraw_4 = -1, g_timer_set_time_4 = 0;
  g_timer_redraw_5 = -1, g_timer_set_time_5 = 0;
  g_timer_redraw_6 = -1, g_timer_set_time_6 = 0;

  g_stopwatch_1_flg = FLG_OFF, g_timer_delay_1_flg = FLG_OFF;
  g_stopwatch_2_flg = FLG_OFF, g_timer_delay_2_flg = FLG_OFF;
  g_stopwatch_3_flg = FLG_OFF, g_timer_delay_3_flg = FLG_OFF;
  g_stopwatch_4_flg = FLG_OFF, g_timer_delay_4_flg = FLG_OFF;
  g_stopwatch_5_flg = FLG_OFF, g_timer_delay_5_flg = FLG_OFF;
  g_stopwatch_6_flg = FLG_OFF, g_timer_delay_6_flg = FLG_OFF;

  g_stopwatch_time_1 = 0, g_stopwatch_start_time_1 = undefined, g_stopwatch_time_add_1 = 0;
  g_stopwatch_time_2 = 0, g_stopwatch_start_time_2 = undefined, g_stopwatch_time_add_2 = 0;
  g_stopwatch_time_3 = 0, g_stopwatch_start_time_3 = undefined, g_stopwatch_time_add_3 = 0;
  g_stopwatch_time_4 = 0, g_stopwatch_start_time_4 = undefined, g_stopwatch_time_add_4 = 0;
  g_stopwatch_time_5 = 0, g_stopwatch_start_time_5 = undefined, g_stopwatch_time_add_5 = 0;
  g_stopwatch_time_6 = 0, g_stopwatch_start_time_6 = undefined, g_stopwatch_time_add_6 = 0;
  
  g_sub77_color_1_flg = FLG_OFF, g_sub77_color_2_flg = FLG_OFF, g_sub77_color_3_flg = FLG_OFF;
  g_sub77_color_4_flg = FLG_OFF, g_sub77_color_5_flg = FLG_OFF, g_sub77_color_6_flg = FLG_OFF;

  g_stopwatch_black_1_flg = FLG_OFF, g_stopwatch_black_2_flg = FLG_OFF, g_stopwatch_black_3_flg = FLG_OFF;
  g_stopwatch_black_4_flg = FLG_OFF, g_stopwatch_black_5_flg = FLG_OFF, g_stopwatch_black_6_flg = FLG_OFF;

  g_change_cloro_blue_1_flg = FLG_OFF, g_change_cloro_blue_2_flg = FLG_OFF, g_change_cloro_blue_3_flg = FLG_OFF;
  g_change_cloro_blue_4_flg = FLG_OFF, g_change_cloro_blue_5_flg = FLG_OFF, g_change_cloro_blue_6_flg = FLG_OFF;

  g_sub_reset_1_flg = FLG_OFF, g_sub_reset_2_flg = FLG_OFF, g_sub_reset_3_flg = FLG_OFF;
  g_sub_reset_4_flg = FLG_OFF, g_sub_reset_5_flg = FLG_OFF, g_sub_reset_6_flg = FLG_OFF;

  g_addup_reach_set_time_1_flg = FLG_OFF, g_addup_reach_set_time_2_flg = FLG_OFF, g_addup_reach_set_time_3_flg = FLG_OFF;
  g_addup_reach_set_time_4_flg = FLG_OFF, g_addup_reach_set_time_5_flg = FLG_OFF, g_addup_reach_set_time_6_flg = FLG_OFF;

  g_stopwatch_millisec_1 = 0, g_stopwatch_sec_1 = 0, g_stopwatch_min_1 = 0, g_stopwatch_hour_1 = 0;
  g_stopwatch_millisec_2 = 0, g_stopwatch_sec_2 = 0, g_stopwatch_min_2 = 0, g_stopwatch_hour_2 = 0;
  g_stopwatch_millisec_3 = 0, g_stopwatch_sec_3 = 0, g_stopwatch_min_3 = 0, g_stopwatch_hour_3 = 0;
  g_stopwatch_millisec_4 = 0, g_stopwatch_sec_4 = 0, g_stopwatch_min_4 = 0, g_stopwatch_hour_4 = 0;
  g_stopwatch_millisec_5 = 0, g_stopwatch_sec_5 = 0, g_stopwatch_min_5 = 0, g_stopwatch_hour_5 = 0;
  g_stopwatch_millisec_6 = 0, g_stopwatch_sec_6 = 0, g_stopwatch_min_6 = 0, g_stopwatch_hour_6 = 0;

  g_stopwatch_end_flg_1 = FLG_OFF, g_stopwatch_end_flg_2 = FLG_OFF, g_stopwatch_end_flg_3 = FLG_OFF;
  g_stopwatch_end_flg_4 = FLG_OFF, g_stopwatch_end_flg_5 = FLG_OFF, g_stopwatch_end_flg_6 = FLG_OFF;

  stopwatch_stop_1();
  stopwatch_stop_2();
  stopwatch_stop_3();
  stopwatch_stop_4();
  stopwatch_stop_5();
  stopwatch_stop_6();

}

/*
 =========================================================================
 @function name        : draw_update_ladder
 @argument [net_index] : grid_index
 @description          : [update ladder color]draw diff ladder
 @return               : none
 =========================================================================
*/
function draw_update_ladder(net_index) {
  var current_color = COLOR_BLACK;
  var grid_data = [];
  var net_data = [];
  var grid_ix = 0;
  var grid_iy = 0;
  var pos_ix = 0;
  var pos_iy = 0;
  var value = 0;
  var line_updown_pos_x = 0;
  var line_updown_pos_y = 0;
  var max_pos_iy = 0;
  var call_draw_fig = 'FigureImageDraw_';
  var matrix_color_pattern = {};
  var min_pos_ix = null;
  var min_pos_iy = null;
  var disp_start_grid_ix = 0;
  var disp_start_grid_iy = 0;
  var timer_sub_grid_iy_1 = null, timer_sub_grid_iy_2 = null, timer_sub_grid_iy_3 = null, timer_sub_grid_iy_4 = null, timer_sub_grid_iy_5 = null, timer_sub_grid_iy_6 = null;
  var timer_set_value = {};
  var add_up_value = {};
  var stopwatch_disp_cnt = 0;
  var stopwatch_elem = null;
  var stop_watch_current = 0;
  var timer_current = 0;
  var tmr_current = 0;

  if (screen_id !== SCREEN_LADDER_DISPLAY) {
    return;
  }

  net_data = g_array_grid_update.net_indexs[net_index];
  grid_data = grid_List.getDataNum(net_index ,iterateArray);

  if(net_data === undefined){
    return;
  }
  // change color address point
  for (var pos = 0; pos < net_data.length; pos++) {
    grid_ix = net_data[pos].grid_ix;
    grid_iy = net_data[pos].grid_iy;
    if ((grid_data[grid_iy][grid_ix].SubNo == DEF_SUBROUTINE_TMR.NUM)     ||
        (grid_data[grid_iy][grid_ix].SubNo == DEF_SUBROUTINE_TMRC.NUM)   ||
        (grid_data[grid_iy][grid_ix].SubNo == DEF_SUBROUTINE_TMRST.NUM) ||
        (grid_data[grid_iy][grid_ix].SubNo == DEF_SUBROUTINE_TMRSS.NUM)) {
      if ((grid_data[grid_iy][grid_ix].SubNo == DEF_SUBROUTINE_TMR.NUM) || (grid_data[grid_iy][grid_ix].SubNo == DEF_SUBROUTINE_TMRC.NUM)) {
        if (net_data[pos].value == null) {
          net_data[pos].value = [0, 0];
          timer_set_value[grid_iy + "_" + grid_ix] = (parseInt(net_data[pos].value[1], 10) * 256) + parseInt(net_data[pos].value[0], 10);
        } else {
          timer_set_value[grid_iy + "_" + grid_ix] = (parseInt(net_data[pos].value[1], 10) * 256) + parseInt(net_data[pos].value[0], 10);
        }
      } else if ((grid_data[grid_iy][grid_ix].SubNo == DEF_SUBROUTINE_TMRST.NUM) || (grid_data[grid_iy][grid_ix].SubNo == DEF_SUBROUTINE_TMRSS.NUM)) {
        if (isNaN(grid_data[grid_iy][grid_ix].SubParam1)) {
          if (net_data[pos].value == null) {
            net_data[pos].value = [0, 0, 0, 0, 0, 0, 0, 0];
            timer_set_value[grid_iy + "_" + grid_ix] = (parseInt(net_data[pos].value[3], 10) * (256 * 256 * 256)) + (parseInt(net_data[pos].value[2], 10) * (256 * 256)) + (parseInt(net_data[pos].value[1], 10) * 256) + (parseInt(net_data[pos].value[0], 10));
            add_up_value[grid_iy + "_" + grid_ix]    = (parseInt(net_data[pos].value[7], 10) * (256 * 256 * 256)) + (parseInt(net_data[pos].value[6], 10) * (256 * 256)) + (parseInt(net_data[pos].value[5], 10) * 256) + (parseInt(net_data[pos].value[4], 10));
          } else {
            timer_set_value[grid_iy + "_" + grid_ix] = (parseInt(net_data[pos].value[3], 10) * (256 * 256 * 256)) + (parseInt(net_data[pos].value[2], 10) * (256 * 256)) + (parseInt(net_data[pos].value[1], 10) * 256) + (parseInt(net_data[pos].value[0], 10));
            add_up_value[grid_iy + "_" + grid_ix]    = (parseInt(net_data[pos].value[7], 10) * (256 * 256 * 256)) + (parseInt(net_data[pos].value[6], 10) * (256 * 256)) + (parseInt(net_data[pos].value[5], 10) * 256) + (parseInt(net_data[pos].value[4], 10));
          }
        } else {
          if (net_data[pos].value == null) {
            net_data[pos].value = [0, 0, 0, 0];
            add_up_value[grid_iy + "_" + grid_ix] = (parseInt(net_data[pos].value[3], 10) * (256 * 256 * 256)) + (parseInt(net_data[pos].value[2], 10) * (256 * 256)) + (parseInt(net_data[pos].value[1], 10) * 256) + (parseInt(net_data[pos].value[0], 10));
          } else {
            add_up_value[grid_iy + "_" + grid_ix] = (parseInt(net_data[pos].value[3], 10) * (256 * 256 * 256)) + (parseInt(net_data[pos].value[2], 10) * (256 * 256)) + (parseInt(net_data[pos].value[1], 10) * 256) + (parseInt(net_data[pos].value[0], 10));
          }
        }
      } else { }
    } else {
      if ((grid_data[grid_iy][grid_ix].FigNo == IMAGENO7_RDPT) || (grid_data[grid_iy][grid_ix].FigNo == IMAGENO8_RDNT)) {
        ctx.strokeStyle = COLOR_BLACK;  // unsupported
      } else if (grid_data[grid_iy][grid_ix].FigNo == IMAGENO2_B_CONTACT) {
        ctx.strokeStyle = (net_data[pos].value == 0 ? COLOR_BLUE : COLOR_BLACK);
      } else {
        if (grid_iy == 1) {
          if (grid_data[grid_iy - 1][grid_ix + 2] !== undefined) {
            if ((grid_data[grid_iy - 1][grid_ix + 2].SubNo == DEF_SUBROUTINE_TMRST.NUM || grid_data[grid_iy - 1][grid_ix + 2].SubNo == DEF_SUBROUTINE_TMRSS.NUM)) {
              timer_current = 0;
              for (var i = 0; i < g_stopwatch_pos.length; i++) {
                if (g_stopwatch_pos[i] === net_index) {
                  timer_current = i + 1;
                  break;
                }
              }
              eval("g_addup_reach_set_time_" + timer_current + "_flg = FLG_OFF;");
            }
          }
        }
        ctx.strokeStyle = (net_data[pos].value == 0 ? COLOR_BLACK : COLOR_BLUE);
      }

      matrix_color_pattern[grid_iy + "_" + grid_ix] = ctx.strokeStyle;
      if ("pos_iy" in net_data[pos]) {
        pos_iy = net_data[pos].pos_iy;
        min_pos_iy = (min_pos_iy == null) ? { "val": pos_iy, "grid": grid_iy } : (min_pos_iy.val > pos_iy) ? { "val": pos_iy, "grid": grid_iy } : min_pos_iy;
        if (max_pos_iy < pos_iy) {
          max_pos_iy = pos_iy;
        }
        if ("pos_ix" in net_data[pos]) {
          pos_ix = net_data[pos].pos_ix;
          // draw figure
          ctx.beginPath();
          (ArrFig[call_draw_fig + grid_data[grid_iy][grid_ix].FigNo])(ctx, 3 * g_scale_factor, ctx.strokeStyle, g_array_grid_pos[pos_iy][pos_ix].pos_x, g_array_grid_pos[pos_iy][pos_ix].pos_y, g_array_grid_update.x_size, g_array_grid_update.y_size, grid_data, grid_iy, grid_ix);
          ctx.stroke();  // draw update
        }
      }
    }
  }
  max_pos_iy += 1;
  matrix_color_pattern = create_net_color_matrix(matrix_color_pattern, grid_data);

  for (var i = 0; i < 6; i++){
    stopwatch_elem = document.getElementById('stopwatch_wrapper').children[i].style.cssText;
    if (stopwatch_elem.indexOf('block') !== -1) {
      stopwatch_disp_cnt++;
    }
  }
  // update line
  if (min_pos_iy != null) {
    grid_iy = min_pos_iy.grid;
    for (var pos_iy = min_pos_iy.val; pos_iy < max_pos_iy; pos_iy++) {
      grid_ix = g_disp_width_index;
      for (var pos_ix = 0; pos_ix < VIEW_GRID_COL; pos_ix++) {
        // set color data from x pos
        if (grid_ix >= g_max_col_num) {
          break;
        }
        if (grid_data[grid_iy][grid_ix].FigNo == IMAGENO9_LINE) {
          ctx.beginPath();
          if (((timer_sub_grid_iy_1 == grid_iy) && (g_timer_delay_1_flg == FLG_ON)) ||
            ((timer_sub_grid_iy_2 == grid_iy) && (g_timer_delay_2_flg == FLG_ON)) ||
            ((timer_sub_grid_iy_3 == grid_iy) && (g_timer_delay_3_flg == FLG_ON)) ||
            ((timer_sub_grid_iy_4 == grid_iy) && (g_timer_delay_4_flg == FLG_ON)) ||
            ((timer_sub_grid_iy_5 == grid_iy) && (g_timer_delay_5_flg == FLG_ON)) ||
            ((timer_sub_grid_iy_6 == grid_iy) && (g_timer_delay_6_flg == FLG_ON))) {
            if (((timer_sub_grid_iy_1 == grid_iy) && (g_stopwatch_black_1_flg == FLG_ON)) ||
              ((timer_sub_grid_iy_2 == grid_iy) && (g_stopwatch_black_2_flg == FLG_ON)) ||
              ((timer_sub_grid_iy_3 == grid_iy) && (g_stopwatch_black_3_flg == FLG_ON)) ||
              ((timer_sub_grid_iy_4 == grid_iy) && (g_stopwatch_black_4_flg == FLG_ON)) ||
              ((timer_sub_grid_iy_5 == grid_iy) && (g_stopwatch_black_5_flg == FLG_ON)) ||
              ((timer_sub_grid_iy_6 == grid_iy) && (g_stopwatch_black_6_flg == FLG_ON))) {
              matrix_color_pattern[grid_iy + "_" + grid_ix] = COLOR_BLUE;
            } else {
              if (grid_data[grid_iy][grid_ix - 3].SubNo == DEF_SUBROUTINE_TMRST.NUM || grid_data[grid_iy][grid_ix - 3].SubNo == DEF_SUBROUTINE_TMRSS.NUM) {
                timer_current = 0;
                for (var i = 0; i < g_stopwatch_pos.length; i++) {
                  if (g_stopwatch_pos[i] === net_index) {
                    timer_current = i + 1;
                    break;
                  }
                }
                eval("g_change_cloro_blue_" + timer_current + "_flg = FLG_OFF;");
              }
              matrix_color_pattern[grid_iy + "_" + grid_ix] = COLOR_BLACK;
            }
          } else if (((timer_sub_grid_iy_1 == grid_iy) && (g_addup_reach_set_time_1_flg == FLG_ON)) ||
            ((timer_sub_grid_iy_2 == grid_iy) && (g_addup_reach_set_time_2_flg == FLG_ON)) ||
            ((timer_sub_grid_iy_3 == grid_iy) && (g_addup_reach_set_time_3_flg == FLG_ON)) ||
            ((timer_sub_grid_iy_4 == grid_iy) && (g_addup_reach_set_time_4_flg == FLG_ON)) ||
            ((timer_sub_grid_iy_5 == grid_iy) && (g_addup_reach_set_time_5_flg == FLG_ON)) ||
            ((timer_sub_grid_iy_6 == grid_iy) && (g_addup_reach_set_time_6_flg == FLG_ON))) {
            // reach the set point of the add-up timer
            if (matrix_color_pattern[(grid_iy + 1) + "_" + 0] == COLOR_BLUE) {
              matrix_color_pattern[grid_iy + "_" + grid_ix] = COLOR_BLUE;
            }
          } else if (((g_sub_reset_1_flg == FLG_ON) ||
            (g_sub_reset_2_flg == FLG_ON) ||
            (g_sub_reset_3_flg == FLG_ON) ||
            (g_sub_reset_4_flg == FLG_ON) ||
            (g_sub_reset_5_flg == FLG_ON) ||
            (g_sub_reset_6_flg == FLG_ON))) {
            tmr_current = 0;
            for (var j = 0; j < g_stopwatch_pos.length; j++) {
              if (g_stopwatch_pos[j] === net_index) {
                tmr_current = j + 1;
                break;
              }
            }
            // reset is effective
            if (eval("g_sub_reset_" + tmr_current + "_flg") == FLG_ON) {
              if (((grid_data[grid_iy][grid_ix + 1].SubNo == DEF_SUBROUTINE_TMRST.NUM) || (grid_data[grid_iy][grid_ix + 1].SubNo == DEF_SUBROUTINE_TMRSS.NUM)) && matrix_color_pattern[grid_iy + "_" + (grid_ix - 1)] == COLOR_BLUE) {
                matrix_color_pattern[grid_iy + "_" + grid_ix] = COLOR_BLUE;
              } else {
                matrix_color_pattern[grid_iy + "_" + grid_ix] = COLOR_BLACK;
                if ((grid_data[grid_iy][grid_ix + 1].SubNo == DEF_SUBROUTINE_TMRST.NUM) || (grid_data[grid_iy][grid_ix + 1].SubNo == DEF_SUBROUTINE_TMRSS.NUM)) {
                  eval("g_sub_reset_" + tmr_current + "_flg = FLG_OFF;");
                }
              }
            }
          }
          ctx.strokeStyle = (matrix_color_pattern[grid_iy + "_" + grid_ix] == "") ? COLOR_BLACK : matrix_color_pattern[grid_iy + "_" + grid_ix];
          (ArrFig[call_draw_fig + grid_data[grid_iy][grid_ix].FigNo])(ctx, 3 * g_scale_factor, ctx.strokeStyle, g_array_grid_pos[pos_iy][pos_ix].pos_x, g_array_grid_pos[pos_iy][pos_ix].pos_y, g_array_grid_update.x_size, g_array_grid_update.y_size, grid_data, grid_iy, grid_ix);
          ctx.stroke();  // draw update
        }

        // TIMERCOUNTER real time display
        if ((grid_data[grid_iy][grid_ix].SubNo == DEF_SUBROUTINE_TMR.NUM) || (grid_data[grid_iy][grid_ix].SubNo == DEF_SUBROUTINE_TMRB.NUM) || (grid_data[grid_iy][grid_ix].SubNo == DEF_SUBROUTINE_TMRC.NUM) || (grid_data[grid_iy][grid_ix].SubNo == DEF_SUBROUTINE_TMRBF.NUM) || (grid_data[grid_iy][grid_ix].SubNo == DEF_SUBROUTINE_TMRST.NUM) || (grid_data[grid_iy][grid_ix].SubNo == DEF_SUBROUTINE_TMRSS.NUM)) {
          for (var i = 1; i <= stopwatch_disp_cnt; i++) {
            for (var j = 0; j < g_stopwatch_pos.length; j++){
              if (g_stopwatch_pos[j] === net_index) {
                stop_watch_current = j + 1;
                break;
              }
            }
            switch (grid_data[grid_iy][grid_ix].SubNo) {
              case DEF_SUBROUTINE_TMR.NUM:
                if (grid_data[grid_iy][grid_ix].SubParam1 <= 8) {
                  var tmr3_settime_val = (timer_set_value[grid_iy + "_" + grid_ix] * 48);
                } else {
                  var tmr3_settime_val = (timer_set_value[grid_iy + "_" + grid_ix] * 8);
                }
                var rtn = setRealTimeCounter(stop_watch_current, tmr3_settime_val, net_index);
                break;
              case DEF_SUBROUTINE_TMRB.NUM:
                var rtn = setRealTimeCounter(stop_watch_current, grid_data[grid_iy][grid_ix].SubParam2, net_index);
                break;
              case DEF_SUBROUTINE_TMRC.NUM:
                var rtn = setRealTimeCounter(stop_watch_current, timer_set_value[grid_iy + "_" + grid_ix], net_index);
                break;
              case DEF_SUBROUTINE_TMRBF.NUM:
                var rtn = setRealTimeCounter_off_delay(stop_watch_current, grid_data[grid_iy][grid_ix].SubParam2, net_index);
                break;
              case DEF_SUBROUTINE_TMRST.NUM:
                var color_blue_info = SUB_SIGNAL_NO;
                if (isNaN(grid_data[grid_iy][grid_ix].SubParam1)) {
                  // ste time : string
                  var addup_act_state = DEF_SUBROUTINE_TMR_0.NUM;
                  var grid_iy_comp = grid_iy + 1;
                  var grid_ix_comp = grid_ix - 1;
                  if (matrix_color_pattern[grid_iy_comp + "_" + grid_ix_comp] == COLOR_BLUE) {
                    addup_act_state = DEF_SUBROUTINE_TMRST.NUM;
                    color_blue_info = SUB_SIGNAL_ACT;
                  }
                  // reset
                  if (matrix_color_pattern[grid_iy + "_" + grid_ix_comp] == COLOR_BLUE) {
                    addup_act_state = DEF_SUBROUTINE_TMR_0.NUM;
                    color_blue_info = SUB_SIGNAL_RST;
                    eval("g_sub_reset_" + stop_watch_current + "_flg = FLG_ON;");
                    eval("g_timer_delay_" + stop_watch_current + "_flg = FLG_OFF;");
                    eval("stopwatch_stop_" + stop_watch_current + "();");
                    eval("stopwatch_clear_" + stop_watch_current + "(grid_data[grid_iy][grid_ix].SubNo);");
                    eval("g_stopwatch_time_" + stop_watch_current + "= 0;");
                  }
                  var addup_addr_val = null;
                  addup_addr_val = add_up_value[grid_iy + "_" + grid_ix];
                  var rtn = setRealTimeCounter_addup(stop_watch_current, timer_set_value[grid_iy + "_" + grid_ix], net_index, addup_act_state, addup_addr_val, color_blue_info);
                } else {
                  // ste time : value
                  var addup_act_state = DEF_SUBROUTINE_TMR_0.NUM;
                  var grid_iy_comp = grid_iy + 1;
                  var grid_ix_comp = grid_ix - 1;
                  // act
                  if (matrix_color_pattern[grid_iy_comp + "_" + grid_ix_comp] == COLOR_BLUE) {
                    addup_act_state = DEF_SUBROUTINE_TMRST.NUM;
                    color_blue_info = SUB_SIGNAL_ACT;
                  }
                  // reset
                  if (matrix_color_pattern[grid_iy + "_" + grid_ix_comp] == COLOR_BLUE) {
                    addup_act_state = DEF_SUBROUTINE_TMR_0.NUM;
                    color_blue_info = SUB_SIGNAL_RST;
                    eval("g_sub_reset_" + stop_watch_current + "_flg = FLG_ON;");
                    eval("g_timer_delay_" + stop_watch_current + "_flg = FLG_OFF;");
                    eval("stopwatch_stop_" + stop_watch_current + "();");
                    eval("stopwatch_clear_" + stop_watch_current + "(grid_data[grid_iy][grid_ix].SubNo);");
                    eval("g_stopwatch_time_" + stop_watch_current + "= 0;");
                  }
                  var addup_addr_val = null;
                  addup_addr_val = add_up_value[grid_iy + "_" + grid_ix];
                  var rtn = setRealTimeCounter_addup(stop_watch_current, grid_data[grid_iy][grid_ix].SubParam1, net_index, addup_act_state, addup_addr_val, color_blue_info);
                }
                break;
              case DEF_SUBROUTINE_TMRSS.NUM:
                var color_blue_info = SUB_SIGNAL_NO;
                if (isNaN(grid_data[grid_iy][grid_ix].SubParam1)) {
                  // ste time : string
                  var addup_act_state = DEF_SUBROUTINE_TMR_0.NUM;
                  var grid_iy_comp = grid_iy + 1;
                  var grid_ix_comp = grid_ix - 1;
                  if (matrix_color_pattern[grid_iy_comp + "_" + grid_ix_comp] == COLOR_BLUE) {
                    addup_act_state = DEF_SUBROUTINE_TMRSS.NUM;
                    color_blue_info = SUB_SIGNAL_ACT;
                  }
                  // reset
                  if (matrix_color_pattern[grid_iy + "_" + grid_ix_comp] == COLOR_BLUE) {
                    addup_act_state = DEF_SUBROUTINE_TMR_0.NUM;
                    color_blue_info = SUB_SIGNAL_RST;
                    eval("g_sub_reset_" + stop_watch_current + "_flg = FLG_ON;");
                    eval("g_timer_delay_" + stop_watch_current + "_flg = FLG_OFF;");
                    eval("stopwatch_stop_" + stop_watch_current + "();");
                    eval("stopwatch_clear_" + stop_watch_current + "(grid_data[grid_iy][grid_ix].SubNo);");
                    eval("g_stopwatch_time_" + stop_watch_current + "= 0;");
                  }
                  var addup_addr_val = null;
                  addup_addr_val = add_up_value[grid_iy + "_" + grid_ix];
                  addup_addr_val = addup_addr_val * 1000;
                  var rtn = setRealTimeCounter_addup(stop_watch_current, timer_set_value[grid_iy + "_" + grid_ix], net_index, addup_act_state, addup_addr_val, color_blue_info);
                } else {
                  // ste time : value
                  var addup_act_state = DEF_SUBROUTINE_TMR_0.NUM;
                  var grid_iy_comp = grid_iy + 1;
                  var grid_ix_comp = grid_ix - 1;
                  // act
                  if (matrix_color_pattern[grid_iy_comp + "_" + grid_ix_comp] == COLOR_BLUE) {
                    addup_act_state = DEF_SUBROUTINE_TMRSS.NUM;
                    color_blue_info = SUB_SIGNAL_ACT;
                  }
                  // reset
                  if (matrix_color_pattern[grid_iy + "_" + grid_ix_comp] == COLOR_BLUE) {
                    addup_act_state = DEF_SUBROUTINE_TMR_0.NUM;
                    color_blue_info = SUB_SIGNAL_RST;
                    eval("g_sub_reset_" + stop_watch_current + "_flg = FLG_ON;");
                    eval("g_timer_delay_" + stop_watch_current + "_flg = FLG_OFF;");
                    eval("stopwatch_stop_" + stop_watch_current + "();");
                    eval("stopwatch_clear_" + stop_watch_current + "(grid_data[grid_iy][grid_ix].SubNo);");
                    eval("g_stopwatch_time_" + stop_watch_current + "= 0;");
                  }
                  var addup_addr_val = null;
                  addup_addr_val = add_up_value[grid_iy + "_" + grid_ix];
                  addup_addr_val = addup_addr_val * 1000;
                  var rtn = setRealTimeCounter_addup(stop_watch_current, grid_data[grid_iy][grid_ix].SubParam1, net_index, addup_act_state, addup_addr_val, color_blue_info);
                }
                break;
              default:
                break;
            }
            if (rtn.iy) {
              eval("timer_sub_grid_iy_" + stop_watch_current + "=" + grid_iy);
            }
            if (rtn.flg) {
              break;
            }
          }
        }

        // draw write up and write down setting
        if ((grid_data[grid_iy][grid_ix].NetwriteUp == 1) || (grid_data[grid_iy][grid_ix].NetwriteDown == 1)) {
          line_updown_pos_x = g_array_grid_pos[pos_iy][pos_ix].pos_x + g_array_grid_update.x_size;
          line_updown_pos_y = g_array_grid_update.y_size / 2;
          // draw write up line
          if (grid_data[grid_iy][grid_ix].NetwriteUp == 1) {
            ctx.beginPath();
            if (((timer_sub_grid_iy_1 == grid_iy) && (g_timer_delay_1_flg == FLG_ON)) ||
              ((timer_sub_grid_iy_2 == grid_iy) && (g_timer_delay_2_flg == FLG_ON)) ||
              ((timer_sub_grid_iy_3 == grid_iy) && (g_timer_delay_3_flg == FLG_ON)) ||
              ((timer_sub_grid_iy_4 == grid_iy) && (g_timer_delay_4_flg == FLG_ON)) ||
              ((timer_sub_grid_iy_5 == grid_iy) && (g_timer_delay_5_flg == FLG_ON)) ||
              ((timer_sub_grid_iy_6 == grid_iy) && (g_timer_delay_6_flg == FLG_ON))) {
              if (((timer_sub_grid_iy_1 == grid_iy) && (g_stopwatch_black_1_flg == FLG_ON)) ||
                ((timer_sub_grid_iy_2 == grid_iy) && (g_stopwatch_black_2_flg == FLG_ON)) ||
                ((timer_sub_grid_iy_3 == grid_iy) && (g_stopwatch_black_3_flg == FLG_ON)) ||
                ((timer_sub_grid_iy_4 == grid_iy) && (g_stopwatch_black_4_flg == FLG_ON)) ||
                ((timer_sub_grid_iy_5 == grid_iy) && (g_stopwatch_black_5_flg == FLG_ON)) ||
                ((timer_sub_grid_iy_6 == grid_iy) && (g_stopwatch_black_6_flg == FLG_ON))) {
                matrix_color_pattern[grid_iy + "_" + grid_ix] = COLOR_BLUE;
              } else {
                if (grid_data[grid_iy][grid_ix - 3].SubNo == DEF_SUBROUTINE_TMRST.NUM || grid_data[grid_iy][grid_ix - 3].SubNo == DEF_SUBROUTINE_TMRSS.NUM) {
                  timer_current = 0;
                  for (var i = 0; i < g_stopwatch_pos.length; i++) {
                    if (g_stopwatch_pos[i] === net_index) {
                      timer_current = i + 1;
                      break;
                    }
                  }
                  eval("g_change_cloro_blue_" + timer_current + "_flg = FLG_OFF;");
                }  
                matrix_color_pattern[grid_iy + "_" + grid_ix] = COLOR_BLACK;
              }
            } else if (((timer_sub_grid_iy_1 == grid_iy) && (g_addup_reach_set_time_1_flg == FLG_ON)) ||
              ((timer_sub_grid_iy_2 == grid_iy) && (g_addup_reach_set_time_2_flg == FLG_ON)) ||
              ((timer_sub_grid_iy_3 == grid_iy) && (g_addup_reach_set_time_3_flg == FLG_ON)) ||
              ((timer_sub_grid_iy_4 == grid_iy) && (g_addup_reach_set_time_4_flg == FLG_ON)) ||
              ((timer_sub_grid_iy_5 == grid_iy) && (g_addup_reach_set_time_5_flg == FLG_ON)) ||
              ((timer_sub_grid_iy_6 == grid_iy) && (g_addup_reach_set_time_6_flg == FLG_ON))) {
              // reach the set point of the add-up timer
              if (matrix_color_pattern[(grid_iy + 1) + "_" + 0] == COLOR_BLUE) {
                matrix_color_pattern[grid_iy + "_" + grid_ix] = COLOR_BLUE;
              }
            } else if ((g_sub_reset_1_flg == FLG_ON) ||
              (g_sub_reset_2_flg == FLG_ON) ||
              (g_sub_reset_3_flg == FLG_ON) ||
              (g_sub_reset_4_flg == FLG_ON) ||
              (g_sub_reset_5_flg == FLG_ON) ||
              (g_sub_reset_6_flg == FLG_ON)) {
              tmr_current = 0;
              for (var j = 0; j < g_stopwatch_pos.length; j++) {
                if (g_stopwatch_pos[j] === net_index) {
                  tmr_current = j + 1;
                  break;
                }
              }
              // reset is effective
              if (eval("g_sub_reset_" + tmr_current + "_flg") == FLG_ON) {
                if (((grid_data[grid_iy][grid_ix + 1].SubNo == DEF_SUBROUTINE_TMRST.NUM) || (grid_data[grid_iy][grid_ix + 1].SubNo == DEF_SUBROUTINE_TMRSS.NUM)) && matrix_color_pattern[grid_iy + "_" + (grid_ix - 1)] == COLOR_BLUE) {
                  matrix_color_pattern[grid_iy + "_" + grid_ix] = COLOR_BLUE;
                } else {
                  matrix_color_pattern[grid_iy + "_" + grid_ix] = COLOR_BLACK;
                  if ((grid_data[grid_iy][grid_ix + 1].SubNo == DEF_SUBROUTINE_TMRST.NUM) || (grid_data[grid_iy][grid_ix + 1].SubNo == DEF_SUBROUTINE_TMRSS.NUM)) {
                    eval("g_sub_reset_" + tmr_current + "_flg = FLG_OFF;");
                  }
                }
              }
          } else { }
          ctx.strokeStyle = (matrix_color_pattern[grid_iy + "_" + grid_ix + "_vertical"] == "") ? COLOR_BLACK : matrix_color_pattern[grid_iy + "_" + grid_ix + "_vertical"];
          ctx.moveTo(line_updown_pos_x, g_array_grid_pos[pos_iy][pos_ix].pos_y);
          ctx.lineTo(line_updown_pos_x, g_array_grid_pos[pos_iy][pos_ix].pos_y + line_updown_pos_y);
          ctx.stroke();  // draw update
        } else { }

          // draw write down line
          if (grid_data[grid_iy][grid_ix].NetwriteDown == 1) {
            ctx.beginPath();
            if (((timer_sub_grid_iy_1 == grid_iy) && (g_timer_delay_1_flg == FLG_ON)) ||
                ((timer_sub_grid_iy_2 == grid_iy) && (g_timer_delay_2_flg == FLG_ON)) ||
                ((timer_sub_grid_iy_3 == grid_iy) && (g_timer_delay_3_flg == FLG_ON)) ||
                ((timer_sub_grid_iy_4 == grid_iy) && (g_timer_delay_4_flg == FLG_ON)) ||
                ((timer_sub_grid_iy_5 == grid_iy) && (g_timer_delay_5_flg == FLG_ON)) ||
                ((timer_sub_grid_iy_6 == grid_iy) && (g_timer_delay_6_flg == FLG_ON))) {
              if (((timer_sub_grid_iy_1 == grid_iy) && (g_stopwatch_black_1_flg == FLG_ON)) ||
                  ((timer_sub_grid_iy_2 == grid_iy) && (g_stopwatch_black_2_flg == FLG_ON)) ||
                  ((timer_sub_grid_iy_3 == grid_iy) && (g_stopwatch_black_3_flg == FLG_ON)) ||
                  ((timer_sub_grid_iy_4 == grid_iy) && (g_stopwatch_black_4_flg == FLG_ON)) ||
                  ((timer_sub_grid_iy_5 == grid_iy) && (g_stopwatch_black_5_flg == FLG_ON)) ||
                  ((timer_sub_grid_iy_6 == grid_iy) && (g_stopwatch_black_6_flg == FLG_ON))) {
                matrix_color_pattern[grid_iy + "_" + grid_ix] = COLOR_BLUE;
              } else {
                if (grid_data[grid_iy][grid_ix - 3].SubNo == DEF_SUBROUTINE_TMRST.NUM || grid_data[grid_iy][grid_ix - 3].SubNo == DEF_SUBROUTINE_TMRSS.NUM) {
                  timer_current = 0;
                  for (var i = 0; i < g_stopwatch_pos.length; i++) {
                    if (g_stopwatch_pos[i] === net_index) {
                      timer_current = i + 1;
                      break;
                    }
                  }
                  eval("g_change_cloro_blue_" + timer_current + "_flg = FLG_OFF;");
                }  
                matrix_color_pattern[grid_iy + "_" + grid_ix] = COLOR_BLACK;
              }
            } else if (((timer_sub_grid_iy_1 == grid_iy) && (g_addup_reach_set_time_1_flg == FLG_ON)) ||
                       ((timer_sub_grid_iy_2 == grid_iy) && (g_addup_reach_set_time_2_flg == FLG_ON)) ||
                       ((timer_sub_grid_iy_3 == grid_iy) && (g_addup_reach_set_time_3_flg == FLG_ON)) ||
                       ((timer_sub_grid_iy_4 == grid_iy) && (g_addup_reach_set_time_4_flg == FLG_ON)) ||
                       ((timer_sub_grid_iy_5 == grid_iy) && (g_addup_reach_set_time_5_flg == FLG_ON)) ||
                       ((timer_sub_grid_iy_6 == grid_iy) && (g_addup_reach_set_time_6_flg == FLG_ON))) {
                // reach the set point of the add-up timer
              if (matrix_color_pattern[(grid_iy + 1) + "_" + 0] == COLOR_BLUE) {
                matrix_color_pattern[grid_iy + "_" + grid_ix] = COLOR_BLUE;
              }
            } else if ((g_sub_reset_1_flg == FLG_ON) ||
                       (g_sub_reset_2_flg == FLG_ON) ||
                       (g_sub_reset_3_flg == FLG_ON) ||
                       (g_sub_reset_4_flg == FLG_ON) ||
                       (g_sub_reset_5_flg == FLG_ON) ||
                       (g_sub_reset_6_flg == FLG_ON)) {
                       tmr_current = 0;
                       for (var j = 0; j < g_stopwatch_pos.length; j++) {
                         if (g_stopwatch_pos[j] === net_index) {
                           tmr_current = j + 1;
                           break;
                         }
                       }
              // reset is effective
              if (eval("g_sub_reset_" + tmr_current + "_flg") == FLG_ON) {
                if (((grid_data[grid_iy][grid_ix + 1].SubNo == DEF_SUBROUTINE_TMRST.NUM) || (grid_data[grid_iy][grid_ix + 1].SubNo == DEF_SUBROUTINE_TMRSS.NUM)) && matrix_color_pattern[grid_iy + "_" + (grid_ix - 1)] == COLOR_BLUE) {
                  matrix_color_pattern[grid_iy + "_" + grid_ix] = COLOR_BLUE;
                } else {
                  matrix_color_pattern[grid_iy + "_" + grid_ix] = COLOR_BLACK;
                  if ((grid_data[grid_iy][grid_ix + 1].SubNo == DEF_SUBROUTINE_TMRST.NUM) || (grid_data[grid_iy][grid_ix + 1].SubNo == DEF_SUBROUTINE_TMRSS.NUM)) {
                    eval("g_sub_reset_" + tmr_current + "_flg = FLG_OFF;");
                  }
                }
              }
            } else { }
            ctx.strokeStyle = (matrix_color_pattern[(grid_iy + 1) + "_" + grid_ix + "_vertical"] == "") ? COLOR_BLACK : matrix_color_pattern[(grid_iy + 1) + "_" + grid_ix + "_vertical"];
            ctx.moveTo(line_updown_pos_x, g_array_grid_pos[pos_iy][pos_ix].pos_y + line_updown_pos_y);
            ctx.lineTo(line_updown_pos_x, g_array_grid_pos[pos_iy][pos_ix].pos_y + line_updown_pos_y * 2);
            ctx.stroke();  // draw update
          } else { }
        }
        grid_ix++;
      }
      grid_iy++;
    }
  }
  ctx.closePath();
}

/*
 =========================================================================
 @function name        : setRealTimeCounter
 @argument [num]       : set flg number
 @argument [set_time]  : set time value
 @argument [net_index] : net index
 @description          : set real time counter(for TMR, TMRC function)
 @return               : flg == stopwatch_flg => on, iy == color is blue and delay flg => on
 =========================================================================
*/
function setRealTimeCounter(num, set_time, net_index) {
  var rtn = {"flg" : false, "iy": false};
  eval("var stopwatch_flg = g_stopwatch_" + num + "_flg;");
  eval("var timer_delay_flg = g_timer_delay_" + num + "_flg;");
  eval("var timer_num_sec = Number(document.getElementById('stopwatch_param_" + num + "_2').innerText);");
  eval("var timer_num_milli = Number(document.getElementById('stopwatch_param_" + num + "_3').innerText);");
  var timer_num = (timer_num_sec * 1000) + timer_num_milli;
  if (stopwatch_flg == FLG_OFF) {
    rtn.flg = true;
    // stopwatch(the first) processing
    eval("g_stopwatch_" + num + "_flg = " + FLG_ON + ";");
    if ((ctx.strokeStyle == COLOR_BLUE) && (timer_delay_flg == FLG_OFF) && (timer_num === 0)) {
      eval("g_timer_set_time_" + num + "=" + set_time + ";");
      eval("g_timer_delay_" + num + "_flg = " + FLG_ON + ";");
      eval("g_timer_redraw_" + num + " = " + net_index + ";");
      eval("g_stopwatch_end_flg_" + num + " = FLG_OFF;");
      eval("stopwatch_start_" + num + "(DEF_SUBROUTINE_TMR_0.NUM);");
      rtn.iy = true;
    } else {
      // drop flg on redraw (line color : black)
      if (timer_delay_flg == FLG_ON) {
        eval("g_timer_delay_" + num + "_flg = " + FLG_OFF + ";");
      }
    }
  }
  return rtn;
}

/*
 =========================================================================
 @function name        : setRealTimeCounter_off_delay
 @argument [num]       : set flg number
 @argument [set_time]  : set time value
 @argument [net_index] : net index
 @description          : set real time counter(for TMR, TMRC function)
 @return               : flg == stopwatch_flg => on, iy == color is black and delay flg => on
 =========================================================================
*/
function setRealTimeCounter_off_delay(num, set_time, net_index) {
  var rtn = {"flg" : false, "iy": false};
  eval("var stopwatch_flg = g_stopwatch_" + num + "_flg;");
  eval("var timer_delay_flg = g_timer_delay_" + num + "_flg;");
  if (ctx.strokeStyle == COLOR_BLUE) {
    eval("g_sub77_color_" + num + "_flg = FLG_ON;");
    eval("g_timer_delay_" + num + "_flg=" + "FLG_OFF;");
    rtn.flg = true;
  } else {
    if ((stopwatch_flg == FLG_OFF) && (ctx.strokeStyle == COLOR_BLACK)) {
      rtn.flg = true;
      // stopwatch(the first) processing
      eval("g_stopwatch_" + num + "_flg = " + FLG_ON + ";");
      if ((ctx.strokeStyle == COLOR_BLACK) && (timer_delay_flg == FLG_OFF) && eval("g_sub77_color_" + num + "_flg == FLG_ON")) {
        eval("g_timer_set_time_" + num + "=" + set_time + ";");
        eval("g_timer_delay_" + num + "_flg = " + FLG_ON + ";");
        eval("g_timer_redraw_" + num + " = " + net_index + ";");
        eval("stopwatch_clear_" + num + "();");
        eval("g_stopwatch_end_flg_" + num + " = FLG_OFF;");
        eval("stopwatch_start_" + num + "(DEF_SUBROUTINE_TMR_0.NUM);");
        rtn.iy = true;
        eval("g_stopwatch_black_" + num + "_flg = FLG_ON;");
      } else {
        // drop flg on redraw (line color : blue)
        if (timer_delay_flg == FLG_ON) {
          eval("g_timer_delay_" + num + "_flg = " + FLG_OFF + ";");
          eval("g_stopwatch_black_" + num + "_flg = FLG_OFF;");
        }
      }
    }
  }
  return rtn;
}

/*
 =========================================================================
 @function name        : setRealTimeCounter_addup
 @argument [num]       : set flg number
 @argument [set_time]  : set time value
 @argument [net_index] : net index
 @description          : set real time counter(for TMR, TMRC function)
 @return               : flg == stopwatch_flg => on, iy == color is blue and delay flg => on
 =========================================================================
*/
function setRealTimeCounter_addup(num, set_time, net_index, addup_act_state, addup_addr_val, color_blue_info) {
  var rtn = {"flg" : false, "iy": false};
  eval("var stopwatch_flg = g_stopwatch_" + num + "_flg;");
  eval("var timer_delay_flg = g_timer_delay_" + num + "_flg;");

  if (stopwatch_flg == FLG_OFF) {
    rtn.flg = true;
    // stopwatch(the first) processing
    eval("g_stopwatch_" + num + "_flg = " + FLG_ON + ";");
    rtn.iy = true;
    if ((color_blue_info == SUB_SIGNAL_ACT) && (timer_delay_flg == FLG_OFF)) {
      eval("g_timer_set_time_" + num + "=" + set_time + ";");
      eval("g_timer_delay_" + num + "_flg = " + FLG_ON + ";");
      eval("g_timer_redraw_" + num + " = " + net_index + ";");
      eval("g_addup_reach_set_time_" + num + "_flg = FLG_OFF;");
      eval("stopwatch_clear_" + num + "();");
      eval("g_stopwatch_end_flg_" + num + " = FLG_OFF;");
      eval("stopwatch_start_" + num + "(addup_act_state," + addup_addr_val + ");");
      rtn.iy = true;
    } else {
      // drop flg on redraw (line color : blue)
      if (timer_delay_flg == FLG_ON) {
        eval("g_timer_delay_" + num + "_flg = " + FLG_OFF + ";");
        eval("g_addup_reach_set_time_" + num + "_flg = FLG_ON;");
      }
      if (color_blue_info == SUB_SIGNAL_NO) {
        eval("stopwatch_stop_" + num + "();");
        eval("stopwatch_clear_" + num + "(DEF_SUBROUTINE_TMRST.NUM);");
      }
    }
  }
  return rtn;
}

/*
 =========================================================================
 @function name        : create_net_color_matrix
 @argument [matrix]    : matrix color pattern
 @argument [grid_data] : display grid data
 @description          : [update ladder color]create net color matrix
 @return               : online matrix color pattern
 =========================================================================
*/
function create_net_color_matrix(matrix, grid_data) {
  var chk_sepalate_pos = [];
  var online_matrix = [];
  var top_iy = 0;

  // check sepalate position between item and coil
  for (var iy = 0; iy < grid_data.length; iy++){
    if (grid_data[iy][g_max_col_num - 1].FigNo != IMAGENO0_BLANK) {
      if (iy != 0) {
        for (var ix = g_max_col_num - 2; ix >= 0; ix--) {
          if (grid_data[iy][ix].NetwriteUp == 1) {
            chk_sepalate_pos[iy] = ix; 
            for (var up_y = iy; up_y >= 0; up_y--){
              if (grid_data[iy][ix].NetwriteUp != 1) {
                break;
              }
              chk_sepalate_pos[up_y] = ix;
            }
            break;
          }
        }
      } else {
        chk_sepalate_pos[iy] = 0; 
      }
    }
  }

  // set start y position
  for (iy = 0; iy < grid_data.length; iy++){
    online_matrix[iy + "_0"] = matrix[iy + "_0"] ? matrix[iy + "_0"] : "";
  }
  
  // set item color(without x == 0)
  for (var ix = 0; ix < g_max_col_num; ix++) {
    if (ix != 0) {
      for (iy = grid_data.length - 1; iy >= 0; iy--) {
        if (online_matrix[iy + "_" + (ix - 1) + "_vertical"] != null) {
          // search top position in vertical line
          for (var chk_iy = iy; chk_iy >= 0; chk_iy--) {
            if (online_matrix[chk_iy + "_" + (ix - 1) + "_vertical"] == null) {
              top_iy = chk_iy;
              break;
            }
          }
          for (var chk_iy = iy; chk_iy > top_iy; chk_iy--) {
            // exist item or line
            if ((grid_data[chk_iy][ix].FigNo != IMAGENO0_BLANK) || ((ix - 1) == chk_sepalate_pos[iy])) {
              // re-coating vertical line and set base line color
              online_matrix[chk_iy + "_" + (ix - 1) + "_vertical"] = online_matrix[top_iy + "_" + (ix - 1) + "pos"];
              online_matrix[chk_iy + "_" + ix] = online_matrix[top_iy + "_" + (ix - 1) + "pos"];
            } else {  // not exist item or line
              online_matrix[chk_iy + "_" + ix] = "";
            }
          }
          iy = top_iy + 1;
        } else {
          online_matrix[iy + "_" + ix] = online_matrix[iy + "_" + (ix - 1) + "pos"] ? online_matrix[iy + "_" + (ix - 1) + "pos"] : online_matrix[iy + "_" + (ix - 1)];
        }
      }
      // check item color
      for (iy = grid_data.length - 1; iy >= 0; iy--) {
        if (matrix[iy + "_" + ix] != null) {
          if ((online_matrix[iy + "_" + ix] == COLOR_BLUE) && (matrix[iy + "_" + ix] == COLOR_BLACK)) {
            online_matrix[iy + "_" + ix] = COLOR_BLACK;
          }
        }
      }
    }

    // set net write down
    for (iy = 0; iy < grid_data.length; iy++) {
      if (grid_data[iy][ix].NetwriteDown == 1) {
        top_iy = iy;
        var flg_connect = false;
        var flg_contact = false;
        for (var chk_iy = iy; chk_iy < grid_data.length; chk_iy++) {
          if (grid_data[chk_iy][ix].FigNo != IMAGENO0_BLANK) {
            flg_contact = true;
          }
          if (online_matrix[chk_iy + "_" + ix] == COLOR_BLUE) {
            flg_connect = true;
          }
          if (grid_data[chk_iy][ix].NetwriteDown != 1) {
            break;
          }
        }
        if (flg_contact) {
          online_matrix[top_iy + "_" + ix + "pos"] = flg_connect ? COLOR_BLUE : COLOR_BLACK;
        }
        iy = chk_iy;
      }

      // set net write up
      flg_connect = false;
      for (; chk_iy >= top_iy; chk_iy--) {
        // set vertical color
        if (grid_data[chk_iy][ix].NetwriteUp == 1) {
          if ((online_matrix[top_iy + "_" + ix + "pos"] != COLOR_BLACK) &&
             ((online_matrix[chk_iy + "_" + ix] == COLOR_BLUE) || (grid_data[iy][ix].FigNo == IMAGENO0_BLANK))) {
            flg_connect = true;
          }
          online_matrix[chk_iy + "_" + ix + "_vertical"] = flg_connect ? COLOR_BLUE : COLOR_BLACK;
        } else {
          break;
        }
      }
    }
  }
  return online_matrix;
}


/*
 =========================================================================
 @function name                : stopwatch_start_1
 @argument[addup_act_state]    : status of the timer subroutine
 @argument[addup_addr_val]     : value of add-up address
 @description                  : stopwatch start function(the first)
 @return                       : none
 =========================================================================
*/
function stopwatch_start_1(addup_act_state, addup_addr_val) {
  if (g_stopwatch_start_time_1 === undefined) {
    var start_date = new Date();
    g_stopwatch_start_time_1 = start_date.getTime();
  }

  var now_date = new Date();
  if ((addup_act_state == DEF_SUBROUTINE_TMRST.NUM) || (addup_act_state == DEF_SUBROUTINE_TMRSS.NUM)) {
    g_stopwatch_time_1 = now_date.getTime() - g_stopwatch_start_time_1 + g_stopwatch_time_add_1 + addup_addr_val;
  } else {
    g_stopwatch_time_1 = now_date.getTime() - g_stopwatch_start_time_1 + g_stopwatch_time_add_1;
  }

  if (addup_act_state == DEF_SUBROUTINE_TMRST.NUM) {
    // millsec
    g_stopwatch_millisec_1 = g_stopwatch_time_1 % 1000;
    if (g_stopwatch_millisec_1 < 10) {
      g_stopwatch_millisec_1 = '0' + g_stopwatch_millisec_1;
    }
    if (g_stopwatch_millisec_1 < 100) {
      g_stopwatch_millisec_1 = '0' + g_stopwatch_millisec_1;
    }
    // second
    g_stopwatch_sec_1 = Math.floor(g_stopwatch_time_1 / 1000) % 60;
    if (g_stopwatch_sec_1 < 10) {
      g_stopwatch_sec_1 = '0' + g_stopwatch_sec_1;
    }
    // minutes
    g_stopwatch_min_1 = Math.floor(g_stopwatch_time_1 / 1000 / 60);
    if (g_stopwatch_min_1 < 10) {
      g_stopwatch_min_1 = '0' + g_stopwatch_min_1;
    }

    document.getElementById('stopwatch_param_1_1').innerHTML = g_stopwatch_min_1;
    document.getElementById('stopwatch_param_1_2').innerHTML = g_stopwatch_sec_1;
    document.getElementById('stopwatch_param_1_3').innerHTML = g_stopwatch_millisec_1;
  
    document.getElementById('stopwatch_timer_unit_1_1').innerHTML = ":";
    document.getElementById('stopwatch_timer_unit_1_2').innerHTML = ":";
  } else if (addup_act_state == DEF_SUBROUTINE_TMRSS.NUM) {
    // second
    g_stopwatch_sec_1 = Math.floor(g_stopwatch_time_1 / 1000) % 60;
    if (g_stopwatch_sec_1 < 10) {
      g_stopwatch_sec_1 = '0' + g_stopwatch_sec_1;
    }
    // minutes
    g_stopwatch_min_1 = Math.floor(g_stopwatch_time_1 / 1000 / 60) % 60;
    if (g_stopwatch_min_1 < 10) {
      g_stopwatch_min_1 = '0' + g_stopwatch_min_1;
    }
    // hour
    g_stopwatch_hour_1 = Math.floor(Math.floor(g_stopwatch_time_1 / 1000 / 60) / 60);
    if (g_stopwatch_hour_1 < 10) {
      g_stopwatch_hour_1 = '0' + g_stopwatch_hour_1;
    }

    document.getElementById('stopwatch_param_1_1').innerHTML = g_stopwatch_hour_1;
    document.getElementById('stopwatch_param_1_2').innerHTML = g_stopwatch_min_1;
    document.getElementById('stopwatch_param_1_3').innerHTML = g_stopwatch_sec_1;
  
    document.getElementById('stopwatch_timer_unit_1_1').innerHTML = ":";
    document.getElementById('stopwatch_timer_unit_1_2').innerHTML = ":";
  } else {
    // millsec
    g_stopwatch_millisec_1 = g_stopwatch_time_1 % 1000;
    if (g_stopwatch_millisec_1 < 10) {
      g_stopwatch_millisec_1 = '0' + g_stopwatch_millisec_1;
    }
    if (g_stopwatch_millisec_1 < 100) {
      g_stopwatch_millisec_1 = '0' + g_stopwatch_millisec_1;
    }
    // second
    g_stopwatch_sec_1 = Math.floor(g_stopwatch_time_1 / 1000);
    if (g_stopwatch_sec_1 < 10) {
      g_stopwatch_sec_1 = '0' + g_stopwatch_sec_1;
    }

    document.getElementById('stopwatch_param_1_1').innerHTML = "";
    document.getElementById('stopwatch_param_1_2').innerHTML = g_stopwatch_sec_1;
    document.getElementById('stopwatch_param_1_3').innerHTML = g_stopwatch_millisec_1;
  
    document.getElementById('stopwatch_timer_unit_1_1').innerHTML = "";
    document.getElementById('stopwatch_timer_unit_1_2').innerHTML = ".";
  }

  // set timer
  var set_timer_millisec_1 = g_stopwatch_time_1 % 1000;
  if (set_timer_millisec_1 < 10) {
    set_timer_millisec_1 = '0' + set_timer_millisec_1;
  }
  if (set_timer_millisec_1 < 100) {
    set_timer_millisec_1 = '0' + set_timer_millisec_1;
  }
  var set_timer_sec_1 = Math.floor(g_stopwatch_time_1 / 1000);
  if (set_timer_sec_1 < 10) {
    set_timer_sec_1 = '0' + set_timer_sec_1;
  }

  var set_timer_val_1 = (Number(set_timer_sec_1) * 1000) + Number(set_timer_millisec_1);
  // stop the stopwatch with the timer setting(plus-minus 100ms)
  if (((g_timer_set_time_1 - 100) < Number(set_timer_val_1)) || (g_timer_set_time_1 < Number(set_timer_val_1))) {
    if (((addup_act_state == DEF_SUBROUTINE_TMRST.NUM) || (addup_act_state == DEF_SUBROUTINE_TMRSS.NUM)) && (g_change_cloro_blue_1_flg == FLG_OFF)) {
      g_change_cloro_blue_1_flg = FLG_ON;
      g_stopwatch_1_flg = FLG_OFF;
      draw_update_ladder(g_timer_redraw_1);
    } else {
      if ((addup_act_state != DEF_SUBROUTINE_TMRST.NUM) && (addup_act_state != DEF_SUBROUTINE_TMRSS.NUM)) {
        stopwatch_stop_1();
        g_stopwatch_1_flg = FLG_OFF;
        draw_update_ladder(g_timer_redraw_1);
        return;
      }
    }
  }
  if (g_stopwatch_end_flg_1 != FLG_ON) {
    stopwatch_1 = setTimeout("stopwatch_start_1(" + addup_act_state + "," + addup_addr_val + ")", 1);
  }
}

/*
 =========================================================================
 @function name : stopwatch_stop_1
 @argument      : none
 @description   : stopwatch stop function(the first)
 @return        : none
 =========================================================================
*/
function stopwatch_stop_1() {
  clearTimeout(stopwatch_1);
  g_stopwatch_end_flg_1 = FLG_ON;
  g_stopwatch_start_time_1 = undefined;
  g_stopwatch_time_add_1 = g_stopwatch_time_1;
}

/*
 =========================================================================
 @function name : stopwatch_clear_1
 @argument      : none
 @description   : stopwatch clear function(the first)
 @return        : none
 =========================================================================
*/
function stopwatch_clear_1(sub_num) {
  g_stopwatch_start_time_1 = undefined;
  g_stopwatch_time_add_1 = 0;
  var clear_stop_watch_current;
  for (var i = 0; i < g_stopwatch_pos.length; i++) {
    if (g_stopwatch_pos[i] === sub_num) {
      clear_stop_watch_current = i + 1;
      break;
    }
  }
  eval("g_stopwatch_end_flg_" + clear_stop_watch_current + " = FLG_ON;");
  if ((sub_num == DEF_SUBROUTINE_TMRST.NUM) || (sub_num == DEF_SUBROUTINE_TMRSS.NUM)) {
    document.getElementById('stopwatch_param_1_1').innerHTML = '0';
    document.getElementById('stopwatch_param_1_2').innerHTML = '00';
    document.getElementById('stopwatch_param_1_3').innerHTML = '000';
    document.getElementById('stopwatch_timer_unit_1_1').innerHTML = ':';
    document.getElementById('stopwatch_timer_unit_1_2').innerHTML = ':';
    for (var i = 0; i < g_stopwatch_pos.length; i++) {
      if (g_stopwatch_pos[i] === sub_num) {
        clear_stop_watch_current = i + 1;
        break;
      }
    }
    eval("g_stopwatch_end_flg_" + i + " = FLG_ON;");
  } else {
    document.getElementById('stopwatch_param_1_1').innerHTML = '';
    document.getElementById('stopwatch_param_1_2').innerHTML = '00';
    document.getElementById('stopwatch_param_1_3').innerHTML = '000';
    document.getElementById('stopwatch_timer_unit_1_1').innerHTML = '';
    document.getElementById('stopwatch_timer_unit_1_2').innerHTML = '.';
  }
}
/*
 =========================================================================
 @function name                : stopwatch_start_2
 @argument[addup_act_state]    : status of the timer subroutine
 @argument[addup_addr_val]     : value of add-up address
 @description                  : stopwatch start function(the second)
 @return                       : none
 =========================================================================
*/
function stopwatch_start_2(addup_act_state, addup_addr_val) {
  if (g_stopwatch_start_time_2 === undefined) {
    var start_date = new Date();
    g_stopwatch_start_time_2 = start_date.getTime();
  }

  var now_date = new Date();
  if ((addup_act_state == DEF_SUBROUTINE_TMRST.NUM) || (addup_act_state == DEF_SUBROUTINE_TMRSS.NUM)) {
    g_stopwatch_time_2 = now_date.getTime() - g_stopwatch_start_time_2 + g_stopwatch_time_add_2 + addup_addr_val;
  } else {
    g_stopwatch_time_2 = now_date.getTime() - g_stopwatch_start_time_2 + g_stopwatch_time_add_2;
  }

  if (addup_act_state == DEF_SUBROUTINE_TMRST.NUM) {
    // millsec
    g_stopwatch_millisec_2 = g_stopwatch_time_2 % 1000;
    if (g_stopwatch_millisec_2 < 10) {
      g_stopwatch_millisec_2 = '0' + g_stopwatch_millisec_2;
    }
    if (g_stopwatch_millisec_2 < 100) {
      g_stopwatch_millisec_2 = '0' + g_stopwatch_millisec_2;
    }
    // second
    g_stopwatch_sec_2 = Math.floor(g_stopwatch_time_2 / 1000) % 60;
    if (g_stopwatch_sec_2 < 10) {
      g_stopwatch_sec_2 = '0' + g_stopwatch_sec_2;
    }
    // minutes
    g_stopwatch_min_2 = Math.floor(g_stopwatch_time_2 / 1000 / 60);
    if (g_stopwatch_min_2 < 10) {
      g_stopwatch_min_2 = '0' + g_stopwatch_min_2;
    }

    document.getElementById('stopwatch_param_2_1').innerHTML = g_stopwatch_min_2;
    document.getElementById('stopwatch_param_2_2').innerHTML = g_stopwatch_sec_2;
    document.getElementById('stopwatch_param_2_3').innerHTML = g_stopwatch_millisec_2;
  
    document.getElementById('stopwatch_timer_unit_2_1').innerHTML = ":";
    document.getElementById('stopwatch_timer_unit_2_2').innerHTML = ":";
  } else if (addup_act_state == DEF_SUBROUTINE_TMRSS.NUM) {
    // second
    g_stopwatch_sec_2 = Math.floor(g_stopwatch_time_2 / 1000) % 60;
    if (g_stopwatch_sec_2 < 10) {
      g_stopwatch_sec_2 = '0' + g_stopwatch_sec_2;
    }
    // minutes
    g_stopwatch_min_2 = Math.floor(g_stopwatch_time_2 / 1000 / 60) % 60;
    if (g_stopwatch_min_2 < 10) {
      g_stopwatch_min_2 = '0' + g_stopwatch_min_2;
    }
    // hour
    g_stopwatch_hour_2 = Math.floor(Math.floor(g_stopwatch_time_2 / 1000 / 60) / 60);
    if (g_stopwatch_hour_2 < 10) {
      g_stopwatch_hour_2 = '0' + g_stopwatch_hour_2;
    }

    document.getElementById('stopwatch_param_2_1').innerHTML = g_stopwatch_hour_2;
    document.getElementById('stopwatch_param_2_2').innerHTML = g_stopwatch_min_2;
    document.getElementById('stopwatch_param_2_3').innerHTML = g_stopwatch_sec_2;
  
    document.getElementById('stopwatch_timer_unit_2_1').innerHTML = ":";
    document.getElementById('stopwatch_timer_unit_2_2').innerHTML = ":";
  } else {
    // millsec
    g_stopwatch_millisec_2 = g_stopwatch_time_2 % 1000;
    if (g_stopwatch_millisec_2 < 10) {
      g_stopwatch_millisec_2 = '0' + g_stopwatch_millisec_2;
    }
    if (g_stopwatch_millisec_2 < 100) {
      g_stopwatch_millisec_2 = '0' + g_stopwatch_millisec_2;
    }
    // second
    g_stopwatch_sec_2 = Math.floor(g_stopwatch_time_2 / 1000);
    if (g_stopwatch_sec_2 < 10) {
      g_stopwatch_sec_2 = '0' + g_stopwatch_sec_2;
    }

    document.getElementById('stopwatch_param_2_1').innerHTML = "";
    document.getElementById('stopwatch_param_2_2').innerHTML = g_stopwatch_sec_2;
    document.getElementById('stopwatch_param_2_3').innerHTML = g_stopwatch_millisec_2;
  
    document.getElementById('stopwatch_timer_unit_2_1').innerHTML = "";
    document.getElementById('stopwatch_timer_unit_2_2').innerHTML = ".";
  }

  // set timer
  var set_timer_millisec_2 = g_stopwatch_time_2 % 1000;
  if (set_timer_millisec_2 < 10) {
    set_timer_millisec_2 = '0' + set_timer_millisec_2;
  }
  if (set_timer_millisec_2 < 100) {
    set_timer_millisec_2 = '0' + set_timer_millisec_2;
  }
  var set_timer_sec_2 = Math.floor(g_stopwatch_time_2 / 1000);
  if (set_timer_sec_2 < 10) {
    set_timer_sec_2 = '0' + set_timer_sec_2;
  }

  var set_timer_val_2 = (Number(set_timer_sec_2) * 1000) + Number(set_timer_millisec_2);
  // stop the stopwatch with the timer setting(plus-minus 100ms)
  if (((g_timer_set_time_2 - 100) < Number(set_timer_val_2)) || (g_timer_set_time_2 < Number(set_timer_val_2))) {
    if (((addup_act_state == DEF_SUBROUTINE_TMRST.NUM) || (addup_act_state == DEF_SUBROUTINE_TMRSS.NUM)) && (g_change_cloro_blue_2_flg == FLG_OFF)) {
      g_change_cloro_blue_2_flg = FLG_ON;
      g_stopwatch_2_flg = FLG_OFF;
      draw_update_ladder(g_timer_redraw_2);
    } else {
      if ((addup_act_state != DEF_SUBROUTINE_TMRST.NUM) && (addup_act_state != DEF_SUBROUTINE_TMRSS.NUM)) {
        stopwatch_stop_2();
        g_stopwatch_2_flg = FLG_OFF;
        draw_update_ladder(g_timer_redraw_2);
        return;
      }
    }
  }
  if (g_stopwatch_end_flg_2 != FLG_ON) {
    stopwatch_2 = setTimeout("stopwatch_start_2(" + addup_act_state + "," + addup_addr_val + ")", 1);
  }
}

/*
 =========================================================================
 @function name : stopwatch_stop_2
 @argument      : none
 @description   : stopwatch stop function(the second)
 @return        : none
 =========================================================================
*/
function stopwatch_stop_2() {
  clearTimeout( stopwatch_2 );
  g_stopwatch_start_time_2 = undefined;
  g_stopwatch_end_flg_2 = FLG_ON;
  g_stopwatch_time_add_2 = g_stopwatch_time_2;
}

/*
 =========================================================================
 @function name : stopwatch_clear_2
 @argument      : none
 @description   : stopwatch clear function(the second)
 @return        : none
 =========================================================================
*/
function stopwatch_clear_2(sub_num) {
  g_stopwatch_start_time_2 = undefined;
  g_stopwatch_time_add_2 = 0;
  var clear_stop_watch_current;
  for (var i = 0; i < g_stopwatch_pos.length; i++) {
    if (g_stopwatch_pos[i] === sub_num) {
      clear_stop_watch_current = i + 1;
      break;
    }
  }
  eval("g_stopwatch_end_flg_" + clear_stop_watch_current + " = FLG_ON;");
  if ((sub_num == DEF_SUBROUTINE_TMRST.NUM) || (sub_num == DEF_SUBROUTINE_TMRSS.NUM)) {
    document.getElementById('stopwatch_param_2_1').innerHTML = '0';
    document.getElementById('stopwatch_param_2_2').innerHTML = '00';
    document.getElementById('stopwatch_param_2_3').innerHTML = '000';
    document.getElementById('stopwatch_timer_unit_2_1').innerHTML = ':';
    document.getElementById('stopwatch_timer_unit_2_2').innerHTML = ':';
  } else {
    document.getElementById('stopwatch_param_2_1').innerHTML = '';
    document.getElementById('stopwatch_param_2_2').innerHTML = '00';
    document.getElementById('stopwatch_param_2_3').innerHTML = '000';
    document.getElementById('stopwatch_timer_unit_2_1').innerHTML = '';
    document.getElementById('stopwatch_timer_unit_2_2').innerHTML = '.';
  }
}
/*
 =========================================================================
 @function name                : stopwatch_start_3
 @argument[addup_act_state]    : status of the timer subroutine
 @argument[addup_addr_val]     : value of add-up address
 @description                  : stopwatch start function(the third)
 @return                       : none
 =========================================================================
*/
function stopwatch_start_3(addup_act_state, addup_addr_val) {
  if (g_stopwatch_start_time_3 === undefined) {
    var start_date = new Date();
    g_stopwatch_start_time_3 = start_date.getTime();
  }

  var now_date = new Date();
  if ((addup_act_state == DEF_SUBROUTINE_TMRST.NUM) || (addup_act_state == DEF_SUBROUTINE_TMRSS.NUM)) {
    g_stopwatch_time_3 = now_date.getTime() - g_stopwatch_start_time_3 + g_stopwatch_time_add_3 + addup_addr_val;
  } else {
    g_stopwatch_time_3 = now_date.getTime() - g_stopwatch_start_time_3 + g_stopwatch_time_add_3;
  }

  if (addup_act_state == DEF_SUBROUTINE_TMRST.NUM) {
    // millsec
    g_stopwatch_millisec_3 = g_stopwatch_time_3 % 1000;
    if (g_stopwatch_millisec_3 < 10) {
      g_stopwatch_millisec_3 = '0' + g_stopwatch_millisec_3;
    }
    if (g_stopwatch_millisec_3 < 100) {
      g_stopwatch_millisec_3 = '0' + g_stopwatch_millisec_3;
    }
    // second
    g_stopwatch_sec_3 = Math.floor(g_stopwatch_time_3 / 1000) % 60;
    if (g_stopwatch_sec_3 < 10) {
      g_stopwatch_sec_3 = '0' + g_stopwatch_sec_3;
    }
    // minutes
    g_stopwatch_min_3 = Math.floor(g_stopwatch_time_3 / 1000 / 60 );
    if (g_stopwatch_min_3 < 10) {
      g_stopwatch_min_3 = '0' + g_stopwatch_min_3;
    }

    document.getElementById('stopwatch_param_3_1').innerHTML = g_stopwatch_min_3;
    document.getElementById('stopwatch_param_3_2').innerHTML = g_stopwatch_sec_3;
    document.getElementById('stopwatch_param_3_3').innerHTML = g_stopwatch_millisec_3;
  
    document.getElementById('stopwatch_timer_unit_3_1').innerHTML = ":";
    document.getElementById('stopwatch_timer_unit_3_2').innerHTML = ":";
  } else if (addup_act_state == DEF_SUBROUTINE_TMRSS.NUM) {
    // second
    g_stopwatch_sec_3 = Math.floor(g_stopwatch_time_3 / 1000) % 60;
    if (g_stopwatch_sec_3 < 10) {
      g_stopwatch_sec_3 = '0' + g_stopwatch_sec_3;
    }
    // minutes
    g_stopwatch_min_3 = Math.floor(g_stopwatch_time_3 / 1000 /60 ) % 60;
    if (g_stopwatch_min_3 < 10) {
      g_stopwatch_min_3 = '0' + g_stopwatch_min_3;
    }
    // hour
    g_stopwatch_hour_3 = Math.floor(Math.floor(g_stopwatch_time_3 / 1000 / 60) / 60);
    if (g_stopwatch_hour_3 < 10) {
      g_stopwatch_hour_3 = '0' + g_stopwatch_hour_3;
    }

    document.getElementById('stopwatch_param_3_1').innerHTML = g_stopwatch_hour_3;
    document.getElementById('stopwatch_param_3_2').innerHTML = g_stopwatch_min_3;
    document.getElementById('stopwatch_param_3_3').innerHTML = g_stopwatch_sec_3;
  
    document.getElementById('stopwatch_timer_unit_3_1').innerHTML = ":";
    document.getElementById('stopwatch_timer_unit_3_2').innerHTML = ":";
  } else {
    // millsec
    g_stopwatch_millisec_3 = g_stopwatch_time_3 % 1000;
    if (g_stopwatch_millisec_3 < 10) {
      g_stopwatch_millisec_3 = '0' + g_stopwatch_millisec_3;
    }
    if (g_stopwatch_millisec_3 < 100) {
      g_stopwatch_millisec_3 = '0' + g_stopwatch_millisec_3;
    }
    // second
    g_stopwatch_sec_3 = Math.floor(g_stopwatch_time_3 / 1000);
    if (g_stopwatch_sec_3 < 10) {
      g_stopwatch_sec_3 = '0' + g_stopwatch_sec_3;
    }

    document.getElementById('stopwatch_param_3_1').innerHTML = "";
    document.getElementById('stopwatch_param_3_2').innerHTML = g_stopwatch_sec_3;
    document.getElementById('stopwatch_param_3_3').innerHTML = g_stopwatch_millisec_3;
  
    document.getElementById('stopwatch_timer_unit_3_1').innerHTML = "";
    document.getElementById('stopwatch_timer_unit_3_2').innerHTML = ".";
  }

  // set timer
  var set_timer_millisec_3 = g_stopwatch_time_3 % 1000;
  if (set_timer_millisec_3 < 10) {
    set_timer_millisec_3 = '0' + set_timer_millisec_3;
  }
  if (set_timer_millisec_3 < 100) {
    set_timer_millisec_3 = '0' + set_timer_millisec_3;
  }
  var set_timer_sec_3 = Math.floor(g_stopwatch_time_3 / 1000);
  if (set_timer_sec_3 < 10) {
    set_timer_sec_3 = '0' + set_timer_sec_3;
  }

  var set_timer_val_3 = (Number(set_timer_sec_3) * 1000) + Number(set_timer_millisec_3);
  // stop the stopwatch with the timer setting(plus-minus 100ms)
  if (((g_timer_set_time_3 - 100) < Number(set_timer_val_3)) || (g_timer_set_time_3 < Number(set_timer_val_3))) {
    if (((addup_act_state == DEF_SUBROUTINE_TMRST.NUM) || (addup_act_state == DEF_SUBROUTINE_TMRSS.NUM)) && (g_change_cloro_blue_3_flg == FLG_OFF)) {
      g_change_cloro_blue_3_flg = FLG_ON;
      g_stopwatch_3_flg = FLG_OFF;
      draw_update_ladder(g_timer_redraw_3);
    } else {
      if ((addup_act_state != DEF_SUBROUTINE_TMRST.NUM) && (addup_act_state != DEF_SUBROUTINE_TMRSS.NUM)){
        stopwatch_stop_3();
        g_stopwatch_3_flg = FLG_OFF;
        draw_update_ladder(g_timer_redraw_3);
        return;
      }
    }
  }
  if (g_stopwatch_end_flg_3 != FLG_ON) {
    stopwatch_3 = setTimeout("stopwatch_start_3(" + addup_act_state + "," + addup_addr_val + ")", 1);
  }
}

/*
 =========================================================================
 @function name : stopwatch_stop_3
 @argument      : none
 @description   : stopwatch stop function(the third)
 @return        : none
 =========================================================================
*/
function stopwatch_stop_3() {
  clearTimeout( stopwatch_3 );
  g_stopwatch_start_time_3 = undefined;
  g_stopwatch_end_flg_3 = FLG_ON;
  g_stopwatch_time_add_3 = g_stopwatch_time_3;
}

/*
 =========================================================================
 @function name : stopwatch_clear_3
 @argument      : none
 @description   : stopwatch clear function(the third)
 @return        : none
 =========================================================================
*/
function stopwatch_clear_3(sub_num) {
  g_stopwatch_start_time_3 = undefined;
  g_stopwatch_time_add_3 = 0;
  var clear_stop_watch_current;
  for (var i = 0; i < g_stopwatch_pos.length; i++) {
    if (g_stopwatch_pos[i] === sub_num) {
      clear_stop_watch_current = i + 1;
      break;
    }
  }
  eval("g_stopwatch_end_flg_" + clear_stop_watch_current + " = FLG_ON;");
  if ((sub_num == DEF_SUBROUTINE_TMRST.NUM) || (sub_num == DEF_SUBROUTINE_TMRSS.NUM)) {
    document.getElementById('stopwatch_param_3_1').innerHTML = '0';
    document.getElementById('stopwatch_param_3_2').innerHTML = '00';
    document.getElementById('stopwatch_param_3_3').innerHTML = '000';
    document.getElementById('stopwatch_timer_unit_3_1').innerHTML = ':';
    document.getElementById('stopwatch_timer_unit_3_2').innerHTML = ':';
  } else {
    document.getElementById('stopwatch_param_3_1').innerHTML = '';
    document.getElementById('stopwatch_param_3_2').innerHTML = '00';
    document.getElementById('stopwatch_param_3_3').innerHTML = '000';
    document.getElementById('stopwatch_timer_unit_3_1').innerHTML = '';
    document.getElementById('stopwatch_timer_unit_3_2').innerHTML = '.';
  }
}
/*
 =========================================================================
 @function name                : stopwatch_start_4
 @argument[addup_act_state]    : status of the timer subroutine
 @argument[addup_addr_val]     : value of add-up address
 @description                  : stopwatch start function(the fourth)
 @return                       : none
 =========================================================================
*/
function stopwatch_start_4(addup_act_state, addup_addr_val) {
  if (g_stopwatch_start_time_4 === undefined) {
    var start_date = new Date();
    g_stopwatch_start_time_4 = start_date.getTime();
  }

  var now_date = new Date();
  if ((addup_act_state == DEF_SUBROUTINE_TMRST.NUM) || (addup_act_state == DEF_SUBROUTINE_TMRSS.NUM)) {
    g_stopwatch_time_4 = now_date.getTime() - g_stopwatch_start_time_4 + g_stopwatch_time_add_4 + addup_addr_val;
  } else {
    g_stopwatch_time_4 = now_date.getTime() - g_stopwatch_start_time_4 + g_stopwatch_time_add_4;
  }

  if (addup_act_state == DEF_SUBROUTINE_TMRST.NUM) {
    // millsec
    g_stopwatch_millisec_4 = g_stopwatch_time_4 % 1000;
    if (g_stopwatch_millisec_4 < 10) {
      g_stopwatch_millisec_4 = '0' + g_stopwatch_millisec_4;
    }
    if (g_stopwatch_millisec_4 < 100) {
      g_stopwatch_millisec_4 = '0' + g_stopwatch_millisec_4;
    }
    // second
    g_stopwatch_sec_4 = Math.floor(g_stopwatch_time_4 / 1000) % 60;
    if (g_stopwatch_sec_4 < 10) {
      g_stopwatch_sec_4 = '0' + g_stopwatch_sec_4;
    }
    // minutes
    g_stopwatch_min_4 = Math.floor(g_stopwatch_time_4 / 1000 / 60 );
    if (g_stopwatch_min_4 < 10) {
      g_stopwatch_min_4 = '0' + g_stopwatch_min_4;
    }

    document.getElementById('stopwatch_param_4_1').innerHTML = g_stopwatch_min_4;
    document.getElementById('stopwatch_param_4_2').innerHTML = g_stopwatch_sec_4;
    document.getElementById('stopwatch_param_4_3').innerHTML = g_stopwatch_millisec_4;
  
    document.getElementById('stopwatch_timer_unit_4_1').innerHTML = ":";
    document.getElementById('stopwatch_timer_unit_4_2').innerHTML = ":";
  } else if (addup_act_state == DEF_SUBROUTINE_TMRSS.NUM) {
    // second
    g_stopwatch_sec_4 = Math.floor(g_stopwatch_time_4 / 1000) % 60;
    if (g_stopwatch_sec_4 < 10) {
      g_stopwatch_sec_4 = '0' + g_stopwatch_sec_4;
    }
    // minutes
    g_stopwatch_min_4 = Math.floor(g_stopwatch_time_4 / 1000 /60 ) % 60;
    if (g_stopwatch_min_4 < 10) {
      g_stopwatch_min_4 = '0' + g_stopwatch_min_4;
    }
    // hour
    g_stopwatch_hour_4 = Math.floor(Math.floor(g_stopwatch_time_4 / 1000 / 60) / 60);
    if (g_stopwatch_hour_4 < 10) {
      g_stopwatch_hour_4 = '0' + g_stopwatch_hour_4;
    }

    document.getElementById('stopwatch_param_4_1').innerHTML = g_stopwatch_hour_4;
    document.getElementById('stopwatch_param_4_2').innerHTML = g_stopwatch_min_4;
    document.getElementById('stopwatch_param_4_3').innerHTML = g_stopwatch_sec_4;
  
    document.getElementById('stopwatch_timer_unit_4_1').innerHTML = ":";
    document.getElementById('stopwatch_timer_unit_4_2').innerHTML = ":";
  } else {
    // millsec
    g_stopwatch_millisec_4 = g_stopwatch_time_4 % 1000;
    if (g_stopwatch_millisec_4 < 10) {
      g_stopwatch_millisec_4 = '0' + g_stopwatch_millisec_4;
    }
    if (g_stopwatch_millisec_4 < 100) {
      g_stopwatch_millisec_4 = '0' + g_stopwatch_millisec_4;
    }
    // second
    g_stopwatch_sec_4 = Math.floor(g_stopwatch_time_4 / 1000);
    if (g_stopwatch_sec_4 < 10) {
      g_stopwatch_sec_4 = '0' + g_stopwatch_sec_4;
    }

    document.getElementById('stopwatch_param_4_1').innerHTML = "";
    document.getElementById('stopwatch_param_4_2').innerHTML = g_stopwatch_sec_4;
    document.getElementById('stopwatch_param_4_3').innerHTML = g_stopwatch_millisec_4;
  
    document.getElementById('stopwatch_timer_unit_4_1').innerHTML = "";
    document.getElementById('stopwatch_timer_unit_4_2').innerHTML = ".";
  }

  // set timer
  var set_timer_millisec_4 = g_stopwatch_time_4 % 1000;
  if (set_timer_millisec_4 < 10) {
    set_timer_millisec_4 = '0' + set_timer_millisec_4;
  }
  if (set_timer_millisec_4 < 100) {
    set_timer_millisec_4 = '0' + set_timer_millisec_4;
  }
  var set_timer_sec_4 = Math.floor(g_stopwatch_time_4 / 1000);
  if (set_timer_sec_4 < 10) {
    set_timer_sec_4 = '0' + set_timer_sec_4;
  }

  var set_timer_val_4 = (Number(set_timer_sec_4) * 1000) + Number(set_timer_millisec_4);
  // stop the stopwatch with the timer setting(plus-minus 100ms)
  if (((g_timer_set_time_4 - 100) < Number(set_timer_val_4)) || (g_timer_set_time_4 < Number(set_timer_val_4))) {
    if (((addup_act_state == DEF_SUBROUTINE_TMRST.NUM) || (addup_act_state == DEF_SUBROUTINE_TMRSS.NUM)) && (g_change_cloro_blue_4_flg == FLG_OFF)) {
      g_change_cloro_blue_4_flg = FLG_ON;
      g_stopwatch_4_flg = FLG_OFF;
      draw_update_ladder(g_timer_redraw_4);
    } else {
      if ((addup_act_state != DEF_SUBROUTINE_TMRST.NUM) && (addup_act_state != DEF_SUBROUTINE_TMRSS.NUM)){
        stopwatch_stop_4();
        g_stopwatch_4_flg = FLG_OFF;
        draw_update_ladder(g_timer_redraw_4);
        return;
      }
    }
  }
  if (g_stopwatch_end_flg_4 != FLG_ON) {
    stopwatch_4 = setTimeout("stopwatch_start_4(" + addup_act_state + "," + addup_addr_val + ")", 1);
  }
}

/*
 =========================================================================
 @function name : stopwatch_stop_4
 @argument      : none
 @description   : stopwatch stop function(the fourth)
 @return        : none
 =========================================================================
*/
function stopwatch_stop_4() {
  clearTimeout( stopwatch_4 );
  g_stopwatch_start_time_4 = undefined;
  g_stopwatch_end_flg_4 = FLG_ON;
  g_stopwatch_time_add_4 = g_stopwatch_time_4;
}

/*
 =========================================================================
 @function name : stopwatch_clear_4
 @argument      : none
 @description   : stopwatch clear function(the fourth)
 @return        : none
 =========================================================================
*/
  function stopwatch_clear_4(sub_num) {
    g_stopwatch_start_time_4 = undefined;
    g_stopwatch_time_add_4 = 0;
    var clear_stop_watch_current;
    for (var i = 0; i < g_stopwatch_pos.length; i++) {
      if (g_stopwatch_pos[i] === sub_num) {
        clear_stop_watch_current = i + 1;
        break;
      }
    }
    eval("g_stopwatch_end_flg_" + clear_stop_watch_current + " = FLG_ON;");
    if ((sub_num == DEF_SUBROUTINE_TMRST.NUM) || (sub_num == DEF_SUBROUTINE_TMRSS.NUM)) {
      document.getElementById('stopwatch_param_4_1').innerHTML = '0';
      document.getElementById('stopwatch_param_4_2').innerHTML = '00';
      document.getElementById('stopwatch_param_4_3').innerHTML = '000';
      document.getElementById('stopwatch_timer_unit_4_1').innerHTML = ':';
      document.getElementById('stopwatch_timer_unit_4_2').innerHTML = ':';
    } else {
      document.getElementById('stopwatch_param_4_1').innerHTML = '';
      document.getElementById('stopwatch_param_4_2').innerHTML = '00';
      document.getElementById('stopwatch_param_4_3').innerHTML = '000';
      document.getElementById('stopwatch_timer_unit_4_1').innerHTML = '';
      document.getElementById('stopwatch_timer_unit_4_2').innerHTML = '.';
    }
  }
/*
 =========================================================================
 @function name                : stopwatch_start_5
 @argument[addup_act_state]    : status of the timer subroutine
 @argument[addup_addr_val]     : value of add-up address
 @description                  : stopwatch start function(the fifth)
 @return                       : none
 =========================================================================
*/
function stopwatch_start_5(addup_act_state, addup_addr_val) {
  if (g_stopwatch_start_time_5 === undefined) {
    var start_date = new Date();
    g_stopwatch_start_time_5 = start_date.getTime();
  }

  var now_date = new Date();
  if ((addup_act_state == DEF_SUBROUTINE_TMRST.NUM) || (addup_act_state == DEF_SUBROUTINE_TMRSS.NUM)) {
    g_stopwatch_time_5 = now_date.getTime() - g_stopwatch_start_time_5 + g_stopwatch_time_add_5 + addup_addr_val;
  } else {
    g_stopwatch_time_5 = now_date.getTime() - g_stopwatch_start_time_5 + g_stopwatch_time_add_5;
  }

  if (addup_act_state == DEF_SUBROUTINE_TMRST.NUM) {
    // millsec
    g_stopwatch_millisec_5 = g_stopwatch_time_5 % 1000;
    if (g_stopwatch_millisec_5 < 10) {
      g_stopwatch_millisec_5 = '0' + g_stopwatch_millisec_5;
    }
    if (g_stopwatch_millisec_5 < 100) {
      g_stopwatch_millisec_5 = '0' + g_stopwatch_millisec_5;
    }
    // second
    g_stopwatch_sec_5 = Math.floor(g_stopwatch_time_5 / 1000) % 60;
    if (g_stopwatch_sec_5 < 10) {
      g_stopwatch_sec_5 = '0' + g_stopwatch_sec_5;
    }
    // minutes
    g_stopwatch_min_5 = Math.floor(g_stopwatch_time_5 / 1000 / 60);
    if (g_stopwatch_min_5 < 10) {
      g_stopwatch_min_5 = '0' + g_stopwatch_min_5;
    }

    document.getElementById('stopwatch_param_5_1').innerHTML = g_stopwatch_min_5;
    document.getElementById('stopwatch_param_5_2').innerHTML = g_stopwatch_sec_5;
    document.getElementById('stopwatch_param_5_3').innerHTML = g_stopwatch_millisec_5;

    document.getElementById('stopwatch_timer_unit_5_1').innerHTML = ":";
    document.getElementById('stopwatch_timer_unit_5_2').innerHTML = ":";
  } else if (addup_act_state == DEF_SUBROUTINE_TMRSS.NUM) {
    // second
    g_stopwatch_sec_5 = Math.floor(g_stopwatch_time_5 / 1000) % 60;
    if (g_stopwatch_sec_5 < 10) {
      g_stopwatch_sec_5 = '0' + g_stopwatch_sec_5;
    }
    // minutes
    g_stopwatch_min_5 = Math.floor(g_stopwatch_time_5 / 1000 / 60) % 60;
    if (g_stopwatch_min_5 < 10) {
      g_stopwatch_min_5 = '0' + g_stopwatch_min_5;
    }
    // hour
    g_stopwatch_hour_5 = Math.floor(Math.floor(g_stopwatch_time_5 / 1000 / 60) / 60);
    if (g_stopwatch_hour_5 < 10) {
      g_stopwatch_hour_5 = '0' + g_stopwatch_hour_5;
    }

    document.getElementById('stopwatch_param_5_1').innerHTML = g_stopwatch_hour_5;
    document.getElementById('stopwatch_param_5_2').innerHTML = g_stopwatch_min_5;
    document.getElementById('stopwatch_param_5_3').innerHTML = g_stopwatch_sec_5;

    document.getElementById('stopwatch_timer_unit_5_1').innerHTML = ":";
    document.getElementById('stopwatch_timer_unit_5_2').innerHTML = ":";
  } else {
    // millsec
    g_stopwatch_millisec_5 = g_stopwatch_time_5 % 1000;
    if (g_stopwatch_millisec_5 < 10) {
      g_stopwatch_millisec_5 = '0' + g_stopwatch_millisec_5;
    }
    if (g_stopwatch_millisec_5 < 100) {
      g_stopwatch_millisec_5 = '0' + g_stopwatch_millisec_5;
    }
    // second
    g_stopwatch_sec_5 = Math.floor(g_stopwatch_time_5 / 1000);
    if (g_stopwatch_sec_5 < 10) {
      g_stopwatch_sec_5 = '0' + g_stopwatch_sec_5;
    }

    document.getElementById('stopwatch_param_5_1').innerHTML = "";
    document.getElementById('stopwatch_param_5_2').innerHTML = g_stopwatch_sec_5;
    document.getElementById('stopwatch_param_5_3').innerHTML = g_stopwatch_millisec_5;

    document.getElementById('stopwatch_timer_unit_5_1').innerHTML = "";
    document.getElementById('stopwatch_timer_unit_5_2').innerHTML = ".";
  }

  // set timer
  var set_timer_millisec_5 = g_stopwatch_time_5 % 1000;
  if (set_timer_millisec_5 < 10) {
    set_timer_millisec_5 = '0' + set_timer_millisec_5;
  }
  if (set_timer_millisec_5 < 100) {
    set_timer_millisec_5 = '0' + set_timer_millisec_5;
  }
  var set_timer_sec_5 = Math.floor(g_stopwatch_time_5 / 1000);
  if (set_timer_sec_5 < 10) {
    set_timer_sec_5 = '0' + set_timer_sec_5;
  }

  var set_timer_val_5 = (Number(set_timer_sec_5) * 1000) + Number(set_timer_millisec_5);
  // stop the stopwatch with the timer setting(plus-minus 100ms)
  if (((g_timer_set_time_5 - 100) < Number(set_timer_val_5)) || (g_timer_set_time_5 < Number(set_timer_val_5))) {
    if (((addup_act_state == DEF_SUBROUTINE_TMRST.NUM) || (addup_act_state == DEF_SUBROUTINE_TMRSS.NUM)) && (g_change_cloro_blue_5_flg == FLG_OFF)) {
      g_change_cloro_blue_5_flg = FLG_ON;
      g_stopwatch_5_flg = FLG_OFF;
      draw_update_ladder(g_timer_redraw_5);
    } else {
      if ((addup_act_state != DEF_SUBROUTINE_TMRST.NUM) && (addup_act_state != DEF_SUBROUTINE_TMRSS.NUM)) {
        stopwatch_stop_5();
        g_stopwatch_5_flg = FLG_OFF;
        draw_update_ladder(g_timer_redraw_5);
        return;
      }
    }
  }
  if (g_stopwatch_end_flg_5 != FLG_ON) {
    stopwatch_5 = setTimeout("stopwatch_start_5(" + addup_act_state + "," + addup_addr_val + ")", 1);
  }
}

/*
 =========================================================================
 @function name : stopwatch_stop_5
 @argument      : none
 @description   : stopwatch stop function(the fifth)
 @return        : none
 =========================================================================
*/
function stopwatch_stop_5() {
  clearTimeout(stopwatch_5);
  g_stopwatch_start_time_5 = undefined;
  g_stopwatch_end_flg_5 = FLG_ON;
  g_stopwatch_time_add_5 = g_stopwatch_time_5;
}

/*
 =========================================================================
 @function name : stopwatch_clear_5
 @argument      : none
 @description   : stopwatch clear function(the fifth)
 @return        : none
 =========================================================================
*/
function stopwatch_clear_5(sub_num) {
  g_stopwatch_start_time_5 = undefined;
  g_stopwatch_time_add_5 = 0;
  var clear_stop_watch_current;
  for (var i = 0; i < g_stopwatch_pos.length; i++) {
    if (g_stopwatch_pos[i] === sub_num) {
      clear_stop_watch_current = i + 1;
      break;
    }
  }
  eval("g_stopwatch_end_flg_" + clear_stop_watch_current + " = FLG_ON;");
  if ((sub_num == DEF_SUBROUTINE_TMRST.NUM) || (sub_num == DEF_SUBROUTINE_TMRSS.NUM)) {
    document.getElementById('stopwatch_param_5_1').innerHTML = '0';
    document.getElementById('stopwatch_param_5_2').innerHTML = '00';
    document.getElementById('stopwatch_param_5_3').innerHTML = '000';
    document.getElementById('stopwatch_timer_unit_5_1').innerHTML = ':';
    document.getElementById('stopwatch_timer_unit_5_2').innerHTML = ':';
  } else {
    document.getElementById('stopwatch_param_5_1').innerHTML = '';
    document.getElementById('stopwatch_param_5_2').innerHTML = '00';
    document.getElementById('stopwatch_param_5_3').innerHTML = '000';
    document.getElementById('stopwatch_timer_unit_5_1').innerHTML = '';
    document.getElementById('stopwatch_timer_unit_5_2').innerHTML = '.';
  }
}
  
/*
 =========================================================================
 @function name                : stopwatch_start_6
 @argument[addup_act_state]    : status of the timer subroutine
 @argument[addup_addr_val]     : value of add-up address
 @description                  : stopwatch start function(the sixth)
 @return                       : none
 =========================================================================
*/
function stopwatch_start_6(addup_act_state, addup_addr_val) {
  if (g_stopwatch_start_time_6 === undefined) {
    var start_date = new Date();
    g_stopwatch_start_time_6 = start_date.getTime();
  }

  var now_date = new Date();
  if ((addup_act_state == DEF_SUBROUTINE_TMRST.NUM) || (addup_act_state == DEF_SUBROUTINE_TMRSS.NUM)) {
    g_stopwatch_time_6 = now_date.getTime() - g_stopwatch_start_time_6 + g_stopwatch_time_add_6 + addup_addr_val;
  } else {
    g_stopwatch_time_6 = now_date.getTime() - g_stopwatch_start_time_6 + g_stopwatch_time_add_6;
  }

  if (addup_act_state == DEF_SUBROUTINE_TMRST.NUM) {
    // millsec
    g_stopwatch_millisec_6 = g_stopwatch_time_6 % 1000;
    if (g_stopwatch_millisec_6 < 10) {
      g_stopwatch_millisec_6 = '0' + g_stopwatch_millisec_6;
    }
    if (g_stopwatch_millisec_6 < 100) {
      g_stopwatch_millisec_6 = '0' + g_stopwatch_millisec_6;
    }
    // second
    g_stopwatch_sec_6 = Math.floor(g_stopwatch_time_6 / 1000) % 60;
    if (g_stopwatch_sec_6 < 10) {
      g_stopwatch_sec_6 = '0' + g_stopwatch_sec_6;
    }
    // minutes
    g_stopwatch_min_6 = Math.floor(g_stopwatch_time_6 / 1000 / 60 );
    if (g_stopwatch_min_6 < 10) {
      g_stopwatch_min_6 = '0' + g_stopwatch_min_6;
    }

    document.getElementById('stopwatch_param_6_1').innerHTML = g_stopwatch_min_6;
    document.getElementById('stopwatch_param_6_2').innerHTML = g_stopwatch_sec_6;
    document.getElementById('stopwatch_param_6_3').innerHTML = g_stopwatch_millisec_6;
  
    document.getElementById('stopwatch_timer_unit_6_1').innerHTML = ":";
    document.getElementById('stopwatch_timer_unit_6_2').innerHTML = ":";
  } else if (addup_act_state == DEF_SUBROUTINE_TMRSS.NUM) {
    // second
    g_stopwatch_sec_6 = Math.floor(g_stopwatch_time_6 / 1000) % 60;
    if (g_stopwatch_sec_6 < 10) {
      g_stopwatch_sec_6 = '0' + g_stopwatch_sec_6;
    }
    // minutes
    g_stopwatch_min_6 = Math.floor(g_stopwatch_time_6 / 1000 /60 ) % 60;
    if (g_stopwatch_min_6 < 10) {
      g_stopwatch_min_6 = '0' + g_stopwatch_min_6;
    }
    // hour
    g_stopwatch_hour_6 = Math.floor(Math.floor(g_stopwatch_time_6 / 1000 / 60) / 60);
    if (g_stopwatch_hour_6 < 10) {
      g_stopwatch_hour_6 = '0' + g_stopwatch_hour_6;
    }

    document.getElementById('stopwatch_param_6_1').innerHTML = g_stopwatch_hour_6;
    document.getElementById('stopwatch_param_6_2').innerHTML = g_stopwatch_min_6;
    document.getElementById('stopwatch_param_6_3').innerHTML = g_stopwatch_sec_6;
  
    document.getElementById('stopwatch_timer_unit_6_1').innerHTML = ":";
    document.getElementById('stopwatch_timer_unit_6_2').innerHTML = ":";
  } else {
    // millsec
    g_stopwatch_millisec_6 = g_stopwatch_time_6 % 1000;
    if (g_stopwatch_millisec_6 < 10) {
      g_stopwatch_millisec_6 = '0' + g_stopwatch_millisec_6;
    }
    if (g_stopwatch_millisec_6 < 100) {
      g_stopwatch_millisec_6 = '0' + g_stopwatch_millisec_6;
    }
    // second
    g_stopwatch_sec_6 = Math.floor(g_stopwatch_time_6 / 1000);
    if (g_stopwatch_sec_6 < 10) {
      g_stopwatch_sec_6 = '0' + g_stopwatch_sec_6;
    }

    document.getElementById('stopwatch_param_6_1').innerHTML = "";
    document.getElementById('stopwatch_param_6_2').innerHTML = g_stopwatch_sec_6;
    document.getElementById('stopwatch_param_6_3').innerHTML = g_stopwatch_millisec_6;
  
    document.getElementById('stopwatch_timer_unit_6_1').innerHTML = "";
    document.getElementById('stopwatch_timer_unit_6_2').innerHTML = ".";
  }

  // set timer
  var set_timer_millisec_6 = g_stopwatch_time_6 % 1000;
  if (set_timer_millisec_6 < 10) {
    set_timer_millisec_6 = '0' + set_timer_millisec_6;
  }
  if (set_timer_millisec_6 < 100) {
    set_timer_millisec_6 = '0' + set_timer_millisec_6;
  }
  var set_timer_sec_6 = Math.floor(g_stopwatch_time_6 / 1000);
  if (set_timer_sec_6 < 10) {
    set_timer_sec_6 = '0' + set_timer_sec_6;
  }

  var set_timer_val_6 = (Number(set_timer_sec_6) * 1000) + Number(set_timer_millisec_6);
  // stop the stopwatch with the timer setting(plus-minus 100ms)
  if (((g_timer_set_time_6 - 100) < Number(set_timer_val_6)) || (g_timer_set_time_6 < Number(set_timer_val_6))) {
    if (((addup_act_state == DEF_SUBROUTINE_TMRST.NUM) || (addup_act_state == DEF_SUBROUTINE_TMRSS.NUM)) && (g_change_cloro_blue_6_flg == FLG_OFF)) {
      g_change_cloro_blue_6_flg = FLG_ON;
      g_stopwatch_6_flg = FLG_OFF;
      draw_update_ladder(g_timer_redraw_6);
    } else {
      if ((addup_act_state != DEF_SUBROUTINE_TMRST.NUM) && (addup_act_state != DEF_SUBROUTINE_TMRSS.NUM)){
        stopwatch_stop_6();
        g_stopwatch_6_flg = FLG_OFF;
        draw_update_ladder(g_timer_redraw_6);
        return;
      }
    }
  }
  if (g_stopwatch_end_flg_6 != FLG_ON) {
    stopwatch_6 = setTimeout("stopwatch_start_6(" + addup_act_state + "," + addup_addr_val + ")", 1);
  }
}

/*
 =========================================================================
 @function name : stopwatch_stop_6
 @argument      : none
 @description   : stopwatch stop function(the sixth)
 @return        : none
 =========================================================================
*/
function stopwatch_stop_6() {
  clearTimeout( stopwatch_6 );
  g_stopwatch_start_time_6 = undefined;
  g_stopwatch_end_flg_6 = FLG_ON;
  g_stopwatch_time_add_6 = g_stopwatch_time_6;
}

/*
 =========================================================================
 @function name : stopwatch_clear_6
 @argument      : none
 @description   : stopwatch clear function(the sixth)
 @return        : none
 =========================================================================
*/
function stopwatch_clear_6(sub_num) {
  g_stopwatch_start_time_6 = undefined;
  g_stopwatch_time_add_6 = 0;
  var clear_stop_watch_current;
  for (var i = 0; i < g_stopwatch_pos.length; i++) {
    if (g_stopwatch_pos[i] === sub_num) {
      clear_stop_watch_current = clear_stop_watch_current + 1;
      break;
    }
  }
  eval("g_stopwatch_end_flg_" + clear_stop_watch_current + " = FLG_ON;");
  if ((sub_num == DEF_SUBROUTINE_TMRST.NUM) || (sub_num == DEF_SUBROUTINE_TMRSS.NUM)) {
    document.getElementById('stopwatch_param_6_1').innerHTML = '0';
    document.getElementById('stopwatch_param_6_2').innerHTML = '00';
    document.getElementById('stopwatch_param_6_3').innerHTML = '000';
    document.getElementById('stopwatch_timer_unit_6_1').innerHTML = ':';
    document.getElementById('stopwatch_timer_unit_6_2').innerHTML = ':';
  } else {
    document.getElementById('stopwatch_param_6_1').innerHTML = '';
    document.getElementById('stopwatch_param_6_2').innerHTML = '00';
    document.getElementById('stopwatch_param_6_3').innerHTML = '000';
    document.getElementById('stopwatch_timer_unit_6_1').innerHTML = '';
    document.getElementById('stopwatch_timer_unit_6_2').innerHTML = '.';
  }
}

/*
 =========================================================================
 @function name : ladder_disp_coil_search
 @description   : coil search from lader display
 @return        : none
 =========================================================================
*/
function ladder_disp_coil_search() {
  var address = document.getElementById('pop_address_2').placeholder;
  var search_category = SEARCH_CATEGORY_COIL;
  var back_search_kind = search_kind;
  g_search_category = SEARCH_CATEGORY_COIL;
  g_pop_search_flg = FLG_ON;
  old_screen_id = SCREEN_LADDER_NONE;
  closeDialog();
  var tree_level = get_ladder_tree_level();
  set_ladder_search_range(tree_level);
  if (old_screen_id === SCREEN_LADDER_DISPLAY) {
    old_screen_id = SCREEN_LADDER_TREE;
  }
  if (!ladder_search_processing_func(address, search_category, FLG_OFF)) {
    error_search_display_popup(search_category);
  } else {
    document.getElementById("screen_ladder_display").style.display = 'none';
  }
  search_kind = back_search_kind;
  g_pop_search_flg = FLG_OFF;
}



/*
 =========================================================================
 @function name : ladder_disp_edit_move
 @argument      : from_screen
 @description   : press the popup button
 @return        : none
 =========================================================================
*/
function ladder_disp_edit_move(from_screen) {
  if (g_get_system_var_flg === FLG_ON) {
    return;
  } else {
    g_get_system_var_flg = FLG_ON;
    // get var
    getPmcVarStatus('*SYSTEM*', "$PMC_CFG.$EDIT_ENB", ladder_pmc_val_callback, "ladder_disp_edit_move", from_screen);
  }
}
/*
 =========================================================================
 @function name : ladder_disp_edit_move_func
 @argument      : from_screen
 @description   : Transition from popup button to display ladder net edit
 @return        : none
 =========================================================================
*/
function ladder_disp_edit_move_func(from_screen) {
  var net_edit_move_flg = FLG_ON;
  var select_x = g_click_pos_disp_tbl.pos_lx;
  var select_y = g_click_pos_disp_tbl.pos_ly;
  var node = grid_List.get(g_click_net_index);
  var disp_net_index = g_click_net_index;
  var tree_level = get_ladder_tree_level();
  var disp_width_index = g_disp_width_index;
  var wk_net_cnt = 0;
  var search_current_lv_flg = FLG_OFF;
  if (g_sub_pg_tbl.length === 0) {
    for (var j = 0; j < g_lv_cnt_tbl.length; j++){
      wk_net_cnt = wk_net_cnt + g_lv_cnt_tbl[j].net_cnt;
      if (g_net_cnt_before_tree + g_all_click_net_index + 1 <= wk_net_cnt) {
        treeeditmenu_kind = String(j + 1);
        break;
      }
    }
  } else {
    for (var k = 0; k < g_lv_cnt_tbl.length; k++){
      wk_net_cnt = wk_net_cnt + g_lv_cnt_tbl[k].net_cnt;
      if (g_net_cnt_before_tree + g_all_click_net_index + 1 <= wk_net_cnt) {
        treeeditmenu_kind = String(k + 1);
        search_current_lv_flg = FLG_ON;
        break;
      }
    }
    if (search_current_lv_flg === FLG_OFF) {
      for (var l = 0; l < g_sub_pg_tbl.length; l++){
        wk_net_cnt = wk_net_cnt + g_sub_pg_tbl[l].net_cnt;
        if (g_net_cnt_before_tree + g_all_click_net_index + 1 <= wk_net_cnt) {
          treeeditmenu_kind = String(l + 4);
          search_current_lv_flg = FLG_OFF;
          break;
        }
      }        
    }
  }
  addClassExclusively(document.getElementById('treeEditMenu'), document.getElementById(treeeditmenu_kind).children[0], 'tree-menu-selected');
  if (tree_level === "0") {
    if (node.level !== "1") {
      for (var i = disp_net_index; 0 <= i; i--) {
        if (node.subnum !== 0) {
          if (grid_List.getDataNum(i, iterateArray)[0][2].SubNo === DEF_SUBROUTINE_SP.NUM) {
            disp_net_index = disp_net_index - i;
            break;
          }
        } else {
          if (grid_List.getDataNum(i, iterateArray)[0][1].SubNo === DEF_SUBROUTINE_END1.NUM || grid_List.getDataNum(i, iterateArray)[0][1].SubNo === DEF_SUBROUTINE_END2.NUM) {
            disp_net_index = disp_net_index - (i + 1);
            break;
          }
        }
      }
    }
  }
  closeDialog();
  document.getElementById('stopwatch_1').style.display = 'none';
  document.getElementById('stopwatch_2').style.display = 'none';
  document.getElementById('stopwatch_3').style.display = 'none';
  document.getElementById('stopwatch_4').style.display = 'none';
  document.getElementById('stopwatch_5').style.display = 'none';
  document.getElementById('stopwatch_6').style.display = 'none';
  if (from_screen === SCREEN_LADDER_SEARCH_RESULT) {
    init_search_result(FLG_OFF, net_edit_move_flg);
    move_to_ladder_display("screen_ladder_search_result", net_edit_move_flg);
  }
  old_screen_id = SCREEN_LADDER_NONE;
  move_to_ladder_tree("screen_ladder_display", net_edit_move_flg);
  move_to_ladder_tree_edit("screen_ladder_tree", net_edit_move_flg);
  move_to_ladder_editor("screen_ladder_tree_edit", net_edit_move_flg);
  if (from_screen !== SCREEN_LADDER_SEARCH_RESULT) {
    if (Number(get_ladder_tree_edit_level()) > 1 && tree_level == "0") {
      g_disp_net_index = g_all_click_net_index - g_net_cnt_before_tree;
    } else {
      g_disp_net_index = g_all_click_net_index;
    }
  } else {
    if (Number(get_ladder_tree_edit_level()) <= 3) {
      if (Number(get_ladder_tree_edit_level()) == 1) {
        g_net_cnt_before_tree = 0;
      } else if (Number(get_ladder_tree_edit_level()) == 2) {
        g_net_cnt_before_tree = g_lv_cnt_tbl[0].net_cnt;
      } else if (Number(get_ladder_tree_edit_level()) == 3) {
        g_net_cnt_before_tree = g_lv_cnt_tbl[0].net_cnt + g_lv_cnt_tbl[1].net_cnt;
      }
    } else if (Number(get_ladder_tree_edit_level()) >= 4) {
      for (var k = 0; k < g_lv_cnt_tbl.length; k++) {
        g_net_cnt_before_tree = g_net_cnt_before_tree + g_lv_cnt_tbl[k].net_cnt;
      }
      for (var l = 0; l < Number(get_ladder_tree_edit_level()) - 4; l++) {
        g_net_cnt_before_tree = g_net_cnt_before_tree + g_sub_pg_tbl[l].net_cnt;
      }
    }
    if (Number(get_ladder_tree_edit_level()) > 1 && g_search_range == "0") {
      g_disp_net_index = g_all_click_net_index - g_net_cnt_before_tree;
    } else {
      g_disp_net_index = g_all_click_net_index;
    }

  }
  g_disp_width_index = disp_width_index;
  move_to_ladder_net_edit("screen_ladder_editor", null, net_edit_move_flg);
  if (from_screen !== SCREEN_LADDER_SEARCH_RESULT) {
    if (Number(get_ladder_tree_edit_level()) > 1 && tree_level == "0") {
      if (Number(get_ladder_tree_edit_level()) <= 3) {
        if (Number(get_ladder_tree_edit_level()) == 1) {
          g_net_cnt_before_tree = 0;
        } else if (Number(get_ladder_tree_edit_level()) == 2) {
          g_net_cnt_before_tree = g_lv_cnt_tbl[0].net_cnt;
        } else if (Number(get_ladder_tree_edit_level()) == 3) {
          g_net_cnt_before_tree = g_lv_cnt_tbl[0].net_cnt + g_lv_cnt_tbl[1].net_cnt;
        }
      } else if (Number(get_ladder_tree_edit_level()) >= 4) {
        for (var k = 0; k < g_lv_cnt_tbl.length; k++) {
          g_net_cnt_before_tree = g_net_cnt_before_tree + g_lv_cnt_tbl[k].net_cnt;
        }
        for (var l = 0; l < Number(get_ladder_tree_edit_level()) - 4; l++) {
          g_net_cnt_before_tree = g_net_cnt_before_tree + g_sub_pg_tbl[l].net_cnt;
        }
      }
      g_disp_net_index = g_disp_net_index - g_net_cnt_before_tree;
      g_selected_net_edit_index = g_disp_net_index;
    }
  }
  g_selected_element_x = select_x;
  g_selected_element_y = select_y;
  draw_ladder_net_edit_diagram(SCROLLBAR_ACTION_ANY);
  net_edit_move_flg = FLG_OFF; 
}

/*
 =========================================================================
 @function name : ladder_disp_contact_search
 @description   : contact search from ladder display
 @return        : none
 =========================================================================
*/
function ladder_disp_contact_search() {
  var address = document.getElementById('pop_address_2').placeholder;
  var search_category = SEARCH_CATEGORY_CONTACT;
  var back_search_kind = search_kind;
  g_search_category = SEARCH_CATEGORY_CONTACT;
  g_pop_search_flg = FLG_ON;
  old_screen_id = SCREEN_LADDER_NONE;
  closeDialog();
  var tree_level = get_ladder_tree_level();
  set_ladder_search_range(tree_level);
  if (old_screen_id === SCREEN_LADDER_DISPLAY) {
    old_screen_id = SCREEN_LADDER_TREE;
  }
  if (!ladder_search_processing_func(address, search_category, FLG_OFF)) {
    error_search_display_popup(search_category);
  } else {
    document.getElementById("screen_ladder_display").style.display = 'none';
  }
  search_kind = back_search_kind;
  g_pop_search_flg = FLG_OFF;
}

/*
 =========================================================================
 @function name : error_search_display_popup
 @argument      : none
 @description   : popup display when there is not a candidate at the time of before bottun pressing
 @return        : none
 =========================================================================
*/
function error_search_display_popup(search_category) {
  document.getElementById("popup_no_comfirm_2").style.display = "block";
  document.getElementById("search_category_2_2").style.display = "none";
  document.getElementById("search_category_2_1").style.display = "none";
  document.getElementById("popcomment_2_1").style.display = "block";
  document.getElementById("popbutton_coil_1").style.display = "none";
  document.getElementById("popbutton_contact_1").style.display = "none";
  document.getElementById("popbutton_edit_1").style.display = "none";
  document.getElementById("pop_address_2").style.display = "none";
  document.getElementById("pop_symbol_2").style.display = "none";
  document.getElementById("pop_comment_2").style.display = "none";
  if (search_category === SEARCH_CATEGORY_CONTACT) {
    document.getElementById("search_category_2_1").style.display = "block";
  } else {
    document.getElementById("search_category_2_2").style.display = "block";
  }
  Popupbutton();
  canvas.removeEventListener('click', onClick, false);
}

/*
 =========================================================================
 @function name          : draw_disp_result_red_square
 @argument [grid_x_size] : width of the grid
 @argument [grid_y_size] : height of the grid
 @argument [clicked]     : click information
 @description            : drawing of the red frame
 @return                 : none
 =========================================================================
*/
function draw_disp_result_red_square(grid_x_size, grid_y_size, grid_pos_y, grid_pos_x) {

  var focus_pos_x = grid_pos_x;
  var focus_pos_y = grid_pos_y;

  if ((focus_pos_x <= 0) || (focus_pos_y <= 0)) {
    return;
  }

  // drawing process start
  ctx.beginPath();  // declaration of the drawing start

  // quadrangle(red)
  ctx.strokeStyle = COLOR_RED;  // filled style
  // appoint transparency
  ctx.globalAlpha = 0.1;

  // filled rectangle(red) of the permeation
  ctx.fillStyle = COLOR_RED;
  ctx.fillRect(focus_pos_x, focus_pos_y, grid_x_size, grid_y_size);
  // return transparency to a standard
  ctx.globalAlpha = 1.0;

  // drawing of the possible figure
  ctx.stroke();

  // declaration of the draw end
  ctx.closePath();

}

/*
 =========================================================================
 @function name : popup_edit_button_display
 @argument      : value
 @description   : popup edit button display when edit mode on or off
 @return        : none
 =========================================================================
*/
function popup_edit_button_display(value) {
  if (value === "FALSE") {
    if (screen_id === SCREEN_LADDER_SEARCH_RESULT && old_screen_id != SCREEN_LADDER_EDITOR && document.getElementById("popup_no_comfirm_4").style.display === "block") {
      document.getElementById("popbutton_edit_2").style.display = "none";
    } else {
      document.getElementById("popbutton_edit_1").style.display = "none";
    }
  } else {
    if (screen_id === SCREEN_LADDER_SEARCH_RESULT && old_screen_id != SCREEN_LADDER_EDITOR && document.getElementById("popup_no_comfirm_4").style.display === "block") {
      document.getElementById("popbutton_edit_2").style.display = "block";
    } else {
      document.getElementById("popbutton_edit_1").style.display = "block";
    }
  }
}

/*
 =========================================================================
 @function name : update_list_down
 @argument      : 
 @description   : 
 @return        : none
 =========================================================================
*/
function update_list_down() {
  //update next
  // create grid_List
  if (screen_id == SCREEN_LADDER_SEARCH_RESULT_LIST && old_screen_id == SCREEN_LADDER_DISPLAY) {
    setg_array_grid_info(g_make_grid_list_pos.upd_margin__next_pos, CREATE_LIST_LIMIT, mnemonic_array, null, FLG_ON);
  } else if (screen_id == SCREEN_LADDER_SEARCH_RESULT_LIST && old_screen_id == SCREEN_LADDER_EDITOR) {
    setg_array_grid_info(g_make_edit_grid_list_pos.upd_margin__next_pos, CREATE_LIST_LIMIT, mnemo_write_array, null, FLG_ON);
  } else if ((screen_id === SCREEN_LADDER_SEARCH && old_screen_id == SCREEN_LADDER_DISPLAY) || screen_id === SCREEN_LADDER_DISPLAY || (screen_id == SCREEN_LADDER_SEARCH_RESULT && old_screen_id == SCREEN_LADDER_DISPLAY)) {
    setg_array_grid_info(g_make_grid_list_pos.upd_margin__next_pos, CREATE_LIST_LIMIT, mnemonic_array, null);
  } else {
    if (get_ladder_tree_edit_level() <= 3) {
      if (g_make_edit_grid_list_pos.upd_margin__next_pos < 0 || g_make_edit_grid_list_pos.upd_margin__next_pos < g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) - 1].mnemo_pos) {
        g_make_edit_grid_list_pos.upd_margin__next_pos = g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) - 1].mnemo_pos;
      }
    } else if (get_ladder_tree_edit_level() >= 4) {
      if (g_make_edit_grid_list_pos.upd_margin__next_pos < g_edit_sub_pg_tbl[Number(get_ladder_tree_edit_level()) - 4].mnemo_pos) {
        g_make_edit_grid_list_pos.upd_margin__next_pos = g_edit_sub_pg_tbl[Number(get_ladder_tree_edit_level()) - 4].mnemo_pos;
      }
    }
    setg_array_grid_info(g_make_edit_grid_list_pos.upd_margin__next_pos, CREATE_LIST_LIMIT, mnemo_write_array, null);
  }
  iterateArray = [];
  iterateArray = grid_List.pushIterateArray();
  // calc current grid_List position for display
  if (g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1) !== -1) {
    net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
  }
  if (screen_id === SCREEN_LADDER_EDITOR || (screen_id == SCREEN_LADDER_SEARCH_RESULT && old_screen_id == SCREEN_LADDER_EDITOR) || screen_id === SCREEN_LADDER_SEARCH_REPLACE) {
    // data copy of the level unit(for tree menu choice)
    glist_edit_node_no = null;
    // calc current grid_List position for editor
    if (g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1) !== -1) {
      net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
    } else {
      for (var i = 0; i < mnemo_write_array.length; i++){
        if (g_net_cnt_before_tree + g_disp_net_index + 1 == mnemo_write_array[i].net_num) {
          g_net_num_tbl = [];
          g_result_list_net_num_tbl = [];
          setg_array_grid_info(i, CREATE_LIST_LIMIT, mnemo_write_array, null, FLG_ON);
          iterateArray = [];
          iterateArray = grid_List.pushIterateArray();        
          net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
          break;
        }
      }
    }
  } else if (screen_id === SCREEN_LADDER_SEARCH_RESULT_LIST) {
    // calc current grid_List position for display
    if (g_result_list_net_num_tbl.indexOf(g_disp_net_index + 1) !== -1) {
      net_index = g_result_list_net_num_tbl.indexOf(g_disp_net_index + 1);
    } else {
      for (var i = 0; i < mnemonic_array.length; i++){
        if (g_search_result_list_net_num[g_disp_net_index] == mnemonic_array[i].net_num) {
          g_net_num_tbl = [];
          g_result_list_net_num_tbl = [];
          setg_array_grid_info(i, CREATE_LIST_LIMIT, mnemonic_array, null, FLG_ON);
          iterateArray = [];
          iterateArray = grid_List.pushIterateArray();        
          net_index = g_result_list_net_num_tbl.indexOf(g_disp_net_index + 1);
          break;
        }
      }
    }
  }
  return net_index;
}

/*
 =========================================================================
 @function name : update_list_jump
 @argument      : 
 @description   : 
 @return        : none
 =========================================================================
*/
function update_list_jump() {
  if (screen_id !== SCREEN_LADDER_REPLACE && screen_id !== SCREEN_LADDER_SEARCH_REPLACE && old_screen_id !== SCREEN_LADDER_REPLACE) {
    var search_level = get_ladder_search_range();
  } else {
    var search_level = get_ladder_replace_range();
  }
  var select_tree_level = get_ladder_tree_level();
  var select_tree_edit_level = get_ladder_tree_edit_level();

  //update prev or scrollbar touch
  var prev_margin_grid_cnt = 0; // create list end position
  var start_net_num, create_list_start_pos;
  if ((screen_id === SCREEN_LADDER_SEARCH && old_screen_id == SCREEN_LADDER_DISPLAY) || screen_id === SCREEN_LADDER_DISPLAY || (screen_id == SCREEN_LADDER_SEARCH_RESULT && old_screen_id == SCREEN_LADDER_DISPLAY)) {
    //calc margin16 grid
    for (var start_margin_cnt = g_net_cnt_before_tree + g_disp_net_index; start_margin_cnt < g_grid_num_tbl.length - 1; start_margin_cnt++) {
      prev_margin_grid_cnt = prev_margin_grid_cnt + g_grid_num_tbl[start_margin_cnt];
      if (prev_margin_grid_cnt >= UPDATE_PREV_MARGIN_POS) {
        break;
      }
    }
    //calc margin200 grid & calc create list end position
    for (start_net_num = g_net_cnt_before_tree + g_disp_net_index - 1; start_net_num >= 0; start_net_num--) {
      prev_margin_grid_cnt = prev_margin_grid_cnt + g_grid_num_tbl[start_net_num];
      if (prev_margin_grid_cnt >= CREATE_LIST_LIMIT) {
        start_net_num++;
        break;
      }
    }
    //calc create list start position
    if (start_net_num > g_net_cnt_before_tree) {
      for (create_list_start_pos = 0; create_list_start_pos <= mnemonic_array.length; create_list_start_pos++) {
        if (mnemonic_array[create_list_start_pos].net_num == undefined) {
          continue;
        } else if (start_net_num == mnemonic_array[create_list_start_pos].net_num) {
          break;
        }
      }
      setg_array_grid_info(create_list_start_pos, prev_margin_grid_cnt, mnemonic_array, null);
    } else if (screen_id === SCREEN_LADDER_SEARCH_RESULT || screen_id === SCREEN_LADDER_SEARCH) {
      if (search_level == 0) {
        setg_array_grid_info(0, CREATE_LIST_LIMIT, mnemonic_array, null);
      } else if (search_level <= 3) {
        setg_array_grid_info(g_lv_cnt_tbl[search_level - 1].mnemo_pos, CREATE_LIST_LIMIT, mnemonic_array, null);
      } else if (search_level >= 4) {
        setg_array_grid_info(g_sub_pg_tbl[search_level - 4].mnemo_pos, CREATE_LIST_LIMIT, mnemonic_array, null);
      }
    } else {
      if (select_tree_level == 0) {
        setg_array_grid_info(0, CREATE_LIST_LIMIT, mnemonic_array, null);
      } else if (select_tree_level <= 3) {
        setg_array_grid_info(g_lv_cnt_tbl[select_tree_level - 1].mnemo_pos, CREATE_LIST_LIMIT, mnemonic_array, null);
      } else if (select_tree_level >= 4) {
        setg_array_grid_info(g_sub_pg_tbl[select_tree_level - 4].mnemo_pos, CREATE_LIST_LIMIT, mnemonic_array, null);
      }
    }
  } else if (screen_id !== SCREEN_LADDER_SEARCH_RESULT_LIST) {
    //calc margin16 grid
    for (var start_margin_cnt = g_disp_net_index + g_net_cnt_before_tree; start_margin_cnt < g_grid_edit_num_tbl.length - 1; start_margin_cnt++) {
      prev_margin_grid_cnt = prev_margin_grid_cnt + g_grid_edit_num_tbl[start_margin_cnt];
      if (prev_margin_grid_cnt >= UPDATE_PREV_MARGIN_POS) {
        break;
      }
    }
    //calc margin200 grid & calc create list end position
    for (start_net_num = g_disp_net_index + g_net_cnt_before_tree - 1; start_net_num >= 0; start_net_num--) {
      prev_margin_grid_cnt = prev_margin_grid_cnt + g_grid_edit_num_tbl[start_net_num];
      if (prev_margin_grid_cnt >= CREATE_LIST_LIMIT) {
        start_net_num++;
        break;
      }
    }
    //calc create list start position
    if (start_net_num > g_net_cnt_before_tree) {
      for (create_list_start_pos = 0; create_list_start_pos <= mnemo_write_array.length; create_list_start_pos++) {
        if (mnemo_write_array[create_list_start_pos].net_num == undefined) {
          continue;
        } else if (start_net_num == mnemo_write_array[create_list_start_pos].net_num) {
          break;
        }
      }
      //Create from the top
      if (search_level == select_tree_edit_level || screen_id === SCREEN_LADDER_EDITOR) {
        if (select_tree_edit_level <= 3) {
          if (create_list_start_pos < g_edit_lv_cnt_tbl[select_tree_edit_level - 1].mnemo_pos) {
            create_list_start_pos = g_edit_lv_cnt_tbl[select_tree_edit_level - 1].mnemo_pos;
          }
        } else if (select_tree_edit_level >= 4) {
          if (create_list_start_pos < g_edit_sub_pg_tbl[select_tree_edit_level - 4].mnemo_pos) {
            create_list_start_pos = g_edit_sub_pg_tbl[select_tree_edit_level - 4].mnemo_pos;
          }
        }
      } else {
        if (search_level <= 3) {
          if (create_list_start_pos < g_edit_lv_cnt_tbl[search_level - 1].mnemo_pos) {
            create_list_start_pos = g_edit_lv_cnt_tbl[search_level - 1].mnemo_pos;
          }
        } else if (search_level >= 4) {
          if (create_list_start_pos < g_edit_sub_pg_tbl[search_level - 4].mnemo_pos) {
            create_list_start_pos = g_edit_sub_pg_tbl[search_level - 4].mnemo_pos;
          }
        }
      }
      setg_array_grid_info(create_list_start_pos, prev_margin_grid_cnt, mnemo_write_array, null);
    } else if (screen_id === SCREEN_LADDER_SEARCH_RESULT || screen_id === SCREEN_LADDER_SEARCH || screen_id === SCREEN_LADDER_REPLACE || screen_id === SCREEN_LADDER_SEARCH_REPLACE) {
      if (search_level <= 3) {
        setg_array_grid_info(g_edit_lv_cnt_tbl[search_level - 1].mnemo_pos, CREATE_LIST_LIMIT, mnemo_write_array, null);
      } else if (search_level >= 4) {
        setg_array_grid_info(g_edit_sub_pg_tbl[search_level - 4].mnemo_pos, CREATE_LIST_LIMIT, mnemo_write_array, null);
      }
    } else {
      if (select_tree_edit_level <= 3) {
        setg_array_grid_info(g_edit_lv_cnt_tbl[select_tree_edit_level - 1].mnemo_pos, CREATE_LIST_LIMIT, mnemo_write_array, null);
      } else if (select_tree_edit_level >= 4) {
        setg_array_grid_info(g_edit_sub_pg_tbl[select_tree_edit_level - 4].mnemo_pos, CREATE_LIST_LIMIT, mnemo_write_array, null);
      }
    }
  } else if (screen_id === SCREEN_LADDER_SEARCH_RESULT_LIST) {
    if (old_screen_id == SCREEN_LADDER_DISPLAY) {
      var use_mnemo_array = JSON.parse(JSON.stringify(mnemonic_array));
      var use_lv_cnt_tbl = JSON.parse(JSON.stringify(g_lv_cnt_tbl));
      var use_sub_pg_tbl = JSON.parse(JSON.stringify(g_sub_pg_tbl));
    } else if (old_screen_id == SCREEN_LADDER_EDITOR || old_screen_id == SCREEN_LADDER_REPLACE) {
      var use_mnemo_array = JSON.parse(JSON.stringify(mnemo_write_array));
      var use_lv_cnt_tbl = JSON.parse(JSON.stringify(g_edit_lv_cnt_tbl));
      var use_sub_pg_tbl = JSON.parse(JSON.stringify(g_edit_sub_pg_tbl));
    }  
    //calc margin16 grid
    for (var start_margin_cnt = g_disp_net_index; start_margin_cnt < g_search_result_list_grid_num.length - 1; start_margin_cnt++) {
      prev_margin_grid_cnt = prev_margin_grid_cnt + g_search_result_list_grid_num[start_margin_cnt];
      if (prev_margin_grid_cnt >= UPDATE_PREV_MARGIN_POS) {
        break;
      }
    }
    //calc margin200 grid & calc create list end position
    for (start_net_num = g_disp_net_index - 1; start_net_num >= 0; start_net_num--) {
      prev_margin_grid_cnt = prev_margin_grid_cnt + g_search_result_list_grid_num[start_net_num];
      if (prev_margin_grid_cnt >= CREATE_LIST_LIMIT) {
        start_net_num++;
        break;
      }
    }
    start_net_num = g_search_result_list_net_num[start_net_num];
    //calc create list start position
    if (start_net_num > g_net_cnt_before_tree) {
      for (create_list_start_pos = 0; create_list_start_pos <= use_mnemo_array.length; create_list_start_pos++) {
        if (use_mnemo_array[create_list_start_pos].net_num == undefined) {
          continue;
        } else if (start_net_num == use_mnemo_array[create_list_start_pos].net_num) {
          break;
        }
      }
      //Create from the top
      if (search_level > 0 && search_level <= 3) {
        if (create_list_start_pos < use_lv_cnt_tbl[search_level - 1].mnemo_pos) {
          create_list_start_pos = use_lv_cnt_tbl[search_level - 1].mnemo_pos;
        }
      } else if (search_level >= 4) {
        if (create_list_start_pos < use_sub_pg_tbl[search_level - 4].mnemo_pos) {
          create_list_start_pos = use_sub_pg_tbl[search_level - 4].mnemo_pos;
        }
      }
      setg_array_grid_info(create_list_start_pos, prev_margin_grid_cnt, use_mnemo_array, null, FLG_ON);
    } else {
      if (search_level == 0) {
        setg_array_grid_info(0, CREATE_LIST_LIMIT, use_mnemo_array, null, FLG_ON);
      } else if (search_level <= 3) {
        setg_array_grid_info(use_lv_cnt_tbl[search_level - 1].mnemo_pos, CREATE_LIST_LIMIT, use_mnemo_array, null, FLG_ON);
      } else if (search_level >= 4) {
        setg_array_grid_info(use_sub_pg_tbl[search_level - 4].mnemo_pos, CREATE_LIST_LIMIT, use_mnemo_array, null, FLG_ON);
      }
    }
  }
  iterateArray = [];
  iterateArray = grid_List.pushIterateArray();
  if (screen_id === SCREEN_LADDER_SEARCH_RESULT_LIST) {
    // calc current grid_List position for display
    if (g_result_list_net_num_tbl.indexOf(g_disp_net_index + 1) !== -1) {
      net_index = g_result_list_net_num_tbl.indexOf(g_disp_net_index + 1);
    }
  } else {
    // calc current grid_List position for editor
    if (g_net_num_tbl.indexOf(g_disp_net_index + g_net_cnt_before_tree + 1) !== -1) {
      net_index = g_net_num_tbl.indexOf(g_disp_net_index + g_net_cnt_before_tree + 1);
    }
  }
  return net_index;
}

/*
 =========================================================================
 @function name : touchstart_scroll
 @argument [e]  : event in the touch move
 @description   : scroll of the grid and net unit
 @return        : none
 =========================================================================
*/
// function touchstart_scroll(evt) {
//   if ((g_popup_flg == FLG_ON) || (g_symbol_flg == FLG_ON) || (g_scaling_flg == FLG_ON)) {
//     return;
//   }
//   //init flick param
//   g_stop_get_val_flg = FLG_OFF;
//   clearTimeout(g_flick_timer);
//   g_flick_flg_tbl.vertical = FLG_OFF;
//   g_flick_flg_tbl.horizontal = FLG_OFF;
//   g_diff_flick_tbl = { pos_x: 0, route_x: 0, pos_y: 0, route_y: 0 };
//   var touch_elem = evt.target.id;
//   var rect = evt.target.getBoundingClientRect();
//   g_first_scroll_flg = FLG_ON;
//   //get flick start time
//   g_flick_tmr_tbl.start = new Date();
//   //get flick start pos
//   if (evt.touches.length == 1) {
//     g_flick_start_pos_tbl = { pos_x: evt.touches[0].pageX, pos_y: evt.touches[0].pageY };
//   } else {
//     g_flick_start_pos_tbl = { pos_x: 0, pos_y: 0 };
//   }
//   if (touch_elem == "canvas_area") { //touch canvas_area
//     g_screen_move_x = evt.touches[0].pageX;
//     g_screen_move_y = evt.touches[0].pageY;
//     if (evt.touches.length == 2) { // switch scale mode
//       g_switch_scale_flg = FLG_ON;
//     }
//     canvas.addEventListener('touchmove', touchmove_scroll, false);
//   } else if (touch_elem == "scroll") { //touch vertical scroll_bar
//     if (evt.touches.length >= 2) {
//       return;
//     }
//     var touch_move_y = evt.touches[0].clientY - rect.top;
//     if ((screen_id === SCREEN_LADDER_DISPLAY || old_screen_id === SCREEN_LADDER_DISPLAY) && screen_id !== SCREEN_LADDER_SEARCH_RESULT_LIST) {
//       click_scroll_grid(evt);
//     } else if (screen_id === SCREEN_LADDER_NETEDIT) {
//       click_scroll_net_edit(evt);
//     } else {
//       click_scroll_net(evt);
//     }
//     if ((touch_move_y > SBHV_POS_E) && (touch_move_y < scrollcanvas.height - (SBHV_POS_E))) {
//       scrollcanvas.addEventListener('touchmove', touchmove_scrollbar, false);
//     } else {
//       return;
//     }
//   } else if (touch_elem == "scroll_h") { //touch horizontal scroll_bar
//     if (evt.touches.length >= 2) {
//       return;
//     }
//     var touch_move_x = evt.touches[0].clientX - rect.left;
//     click_scroll_grid(evt);
//     if ((touch_move_x > SBHV_POS_E) && (touch_move_x < scrollcanvas_h.width - (SBHV_POS_E + SBHV_POS_C))) {
//       scrollcanvas_h.addEventListener('touchmove', touchmove_scrollbar, false);
//     } else {
//       return;
//     }
//   }
// }
/*
 =========================================================================
 @function name : touchend_scroll
 @description   : scroll of the grid and net unit
 @return        : none
 =========================================================================
*/
// function touchend_scroll(evt) {
//   if ((g_popup_flg == FLG_ON) || (g_symbol_flg == FLG_ON) || (g_scaling_flg == FLG_ON)) {
//     return;
//   }
//   //get flick end time
//   g_flick_tmr_tbl.end = new Date();
//   //difference between start and end times
//   var diff_time = g_flick_tmr_tbl.end.getTime() - g_flick_tmr_tbl.start.getTime();
//   //get flick end pos
//   var flick_end_pos_y = evt.changedTouches[0].pageY;
//   var flick_end_pos_x = evt.changedTouches[0].pageX;
//   //calculation of distance
//   if (g_flick_start_pos_tbl.pos_y !== 0 && g_flick_start_pos_tbl.pos_x !== 0) {
//     g_diff_flick_tbl.route_y = g_flick_start_pos_tbl.pos_y - flick_end_pos_y;
//     g_diff_flick_tbl.pos_y = Math.abs(g_flick_start_pos_tbl.pos_y - flick_end_pos_y);
//     g_diff_flick_tbl.route_x = g_flick_start_pos_tbl.pos_x - flick_end_pos_x;
//     g_diff_flick_tbl.pos_x = Math.abs(g_flick_start_pos_tbl.pos_x - flick_end_pos_x);
//   } else {
//     g_diff_flick_tbl = { pos_x: 0, route_x: 0, pos_y: 0, route_y: 0 };
//   }
//   //init touch offset
//   g_screen_move_x = 0;
//   g_screen_move_y = 0;
//   g_base_position = 0;
//   g_h_scroll_flg = FLG_OFF;
//   g_scroll_flg = FLG_OFF;
//   g_first_scroll_flg = FLG_ON;
//   if (screen_id == SCREEN_LADDER_DISPLAY) {
//     draw_ladder_diagram(SCROLLBAR_ACTION_NO_ACTION, CANVAS_AREA_LADDER_DISPLAY);
//   }
//   //flick processing
//   if (diff_time < FLICK_UP_LIMIT_TMR && diff_time > FLICK_LOW_LIMIT_TMR &&
//       g_switch_scale_flg == FLG_OFF && (evt.changedTouches[0].target.id !== "scroll" && evt.changedTouches[0].target.id !== "scroll_h")) {
//     if (g_diff_flick_tbl.pos_y >= FLICK_LOW_LIMIT_DIST && g_diff_flick_tbl.pos_y <= FLICK_UP_LIMIT_DIST) {
//       //vertical
//       g_stop_get_val_flg = FLG_ON;
//       g_flick_flg_tbl = { vertical: FLG_ON, horizontal: FLG_OFF, scrolling: FLG_ON };
//       g_flick_tmr_tbl.start = new Date();
//       g_flick_tmr_tbl.end = new Date();
//       g_flick_timer = setTimeout(flick_scroll_func, 0);
//     } else if (g_diff_flick_tbl.pos_x >= FLICK_LOW_LIMIT_DIST && g_diff_flick_tbl.pos_x <= FLICK_UP_LIMIT_DIST) {
//       //horizontal
//       g_stop_get_val_flg = FLG_ON;
//       g_flick_flg_tbl = { vertical: FLG_OFF, horizontal: FLG_ON, scrolling: FLG_ON };
//       g_flick_tmr_tbl.start = new Date();
//       g_flick_tmr_tbl.end = new Date();
//       g_flick_timer = setTimeout(flick_scroll_func, 0);
//     } else {
//       g_switch_scale_flg = FLG_OFF; // switch scroll mode
//       g_stop_get_val_flg = FLG_OFF;
//       canvas.removeEventListener('touchmove', touchmove_scroll, false);
//       scrollcanvas.removeEventListener('touchmove', touchmove_scrollbar, false);
//       scrollcanvas_h.removeEventListener('touchmove', touchmove_scrollbar, false);
//     }
//   } else if (evt.touches.length == 0) {
//     g_switch_scale_flg = FLG_OFF; // switch scroll mode
//     g_stop_get_val_flg = FLG_OFF;
//     canvas.removeEventListener('touchmove', touchmove_scroll, false);
//     scrollcanvas.removeEventListener('touchmove', touchmove_scrollbar, false);
//     scrollcanvas_h.removeEventListener('touchmove', touchmove_scrollbar, false);
//   } else if (evt.touches.length == 1) {
//     g_switch_scale_flg = FLG_OFF; // switch scroll mode
//     g_screen_move_x = evt.touches[0].pageX;
//     g_screen_move_y = evt.touches[0].pageY;
//   }
// }
/*
 =========================================================================
 @function name : touchmove_scroll
 @argument [e]  : event in the touch move
 @description   : scroll of the grid and net unit
 @return        : none
 =========================================================================
*/
// function touchmove_scroll(evt) {
//   if ((g_popup_flg == FLG_ON) || (g_symbol_flg == FLG_ON) || (g_scaling_flg == FLG_ON) || evt.touches.length >= 3) {
//     return;
//   }
//   var touch_pos_table = evt.changedTouches;
//   if (touch_pos_table.length === 2 && (screen_id === SCREEN_LADDER_DISPLAY || screen_id === SCREEN_LADDER_EDITOR)) {
//     //scale process
//     g_switch_scale_flg = FLG_ON;
//     var move_position = 0;
//     var touch_x_1 = touch_pos_table[0].pageX;
//     var touch_y_1 = touch_pos_table[0].pageY;
//     var touch_x_2 = touch_pos_table[1].pageX;
//     var touch_y_2 = touch_pos_table[1].pageY;
//     if (g_base_position == 0) {
//       // reference position
//       g_base_position = Math.sqrt(Math.pow(touch_x_2 - touch_x_1, 2) + Math.pow(touch_y_2 - touch_y_1, 2));
//     } else {
//       // position after movement
//       move_position = Math.sqrt(Math.pow(touch_x_2 - touch_x_1, 2) + Math.pow(touch_y_2 - touch_y_1, 2));
//     }
//     if (move_position !== 0) {
//       // ratio after reference and movement
//       var scale = move_position / g_base_position;
//       if (scale < PINCH_IN_SPEED) {
//         if (g_stop_get_val_flg == FLG_OFF) {
//           g_stop_get_val_flg = FLG_ON;
//         }
//         // scale down
//         if (g_tmp_scaling_no == 1) {
//           if (g_scaling_sizefit_col >= 8 && g_scaling_sizefit_col <= 11) {
//             g_tmp_scaling_no = 5;
//           } else if (g_scaling_sizefit_col >= 12 && g_scaling_sizefit_col <= 15) {
//             g_tmp_scaling_no = 6;
//           }
//         } else {
//           switch (g_scale_factor) {
//             case SCALING_200PERCENT:
//             case SCALING_133PERCENT:
//             case SCALING_100PERCENT:
//             case SCALING_066PERCENT:
//               g_tmp_scaling_no += 1;
//               break;
//             default:
//               break;
//           }
//         }
//         g_base_position = 0;
//       } else if (scale > PINCH_OUT_SPEED) {
//         if (g_stop_get_val_flg == FLG_OFF) {
//           g_stop_get_val_flg = FLG_ON;
//         }
//         // scale up
//         if (g_tmp_scaling_no == 1) {
//           if (g_scaling_sizefit_col == 8) {
//             g_tmp_scaling_no = 3;
//           } else if (g_scaling_sizefit_col >= 9 && g_scaling_sizefit_col <= 12) {
//             g_tmp_scaling_no = 4;
//           } else {
//             g_tmp_scaling_no = 5;
//           }
//         } else {
//           switch (g_scale_factor) {
//             case SCALING_133PERCENT:
//             case SCALING_100PERCENT:
//             case SCALING_066PERCENT:
//             case SCALING_050PERCENT:
//               g_tmp_scaling_no -= 1;
//               break;
//             default:
//               break;
//           }
//         }
//         g_base_position = 0;
//       }
//       if (screen_id === SCREEN_LADDER_DISPLAY) {
//         // update of the inside information
//         select_scaling_button = g_tmp_scaling_no;
//         ladder_display_scaling_menu_bkcolor(g_tmp_scaling_no);
//         g_edit_menu = document.getElementById('scaleMenu_5').children;
//         g_tmp_scaling_no_editor = g_tmp_scaling_no;
//         ladder_editor_menu_bkcolor(g_tmp_scaling_no);
//         ladder_display_scalingSet(g_tmp_scaling_no);
//         // symbol information was updated,redraw
//         draw_ladder_diagram(SCROLLBAR_ACTION_NO_ACTION, CANVAS_AREA_LADDER_DISPLAY);
//       } else if (screen_id === SCREEN_LADDER_EDITOR) {
//         // update of the inside information
//         select_scaling_button = g_tmp_scaling_no;
//         g_tmp_scaling_no_editor = select_scaling_button;
//         g_tmp_scaling_no = select_scaling_button;
//         ladder_editor_menu_bkcolor(select_scaling_button);
//         ladder_display_scalingSet(g_tmp_scaling_no);
//         // symbol information was updated,redraw
//         draw_ladder_diagram(SCROLLBAR_ACTION_NO_ACTION, CANVAS_AREA_LADDER_EDITOR);
//       }
//     } else {
//     }
//   } else if (touch_pos_table.length === 1 && g_switch_scale_flg == FLG_OFF) {
//     //scroll process
//     var scroll_type = null;
//     var draw_area = null;
//     switch (screen_id) {
//       case SCREEN_LADDER_DISPLAY:
//         draw_area = CANVAS_AREA_LADDER_DISPLAY;
//         scroll_type = "grid";
//         break;
//       case SCREEN_LADDER_SEARCH_RESULT:
//         draw_area = CANVAS_AREA_LADDER_SEARCH_RESULT;
//         if (old_screen_id === SCREEN_LADDER_DISPLAY) {
//           scroll_type = "grid";
//         } else {
//           scroll_type = "net";
//         }
//         break;
//       case SCREEN_LADDER_EDITOR:
//         draw_area = CANVAS_AREA_LADDER_EDITOR;
//         scroll_type = "net";
//         break;
//       case SCREEN_LADDER_NETEDIT:
//         draw_area = CANVAS_AREA_LADDER_NETEDIT;
//         scroll_type = "grid";
//         break;
//       case SCREEN_LADDER_SEARCH_RESULT_LIST:
//         draw_area = CANVAS_AREA_LADDER_SEARCH_RESULT_LIST;
//         scroll_type = "net";
//         break;
//       case SCREEN_LADDER_SEARCH_REPLACE:
//         draw_area = CANVAS_AREA_LADDER_SEARCH_REPLACE;
//         scroll_type = "net";
//         break;
//       default:
//         return;
//     }
//     if (g_h_scroll_flg == FLG_OFF && g_scroll_flg == FLG_OFF) {
//       var move_screen_move_x = evt.touches[0].pageX;
//       var move_screen_move_y = evt.touches[0].pageY;
//       move_screen_move_x = Math.abs(move_screen_move_x - g_screen_move_x);
//       move_screen_move_y = Math.abs(move_screen_move_y - g_screen_move_y);
//       if (move_screen_move_x > move_screen_move_y) {
//         if (g_screen_move_x + SCROLL_MARGIN < evt.changedTouches[0].pageX || g_screen_move_x - SCROLL_MARGIN > evt.changedTouches[0].pageX) {
//           g_h_scroll_flg = FLG_ON;
//         }
//       } else {
//         if (g_screen_move_y + SCROLL_MARGIN < evt.changedTouches[0].pageY || g_screen_move_y - SCROLL_MARGIN > evt.changedTouches[0].pageY) {
//           g_scroll_flg = FLG_ON;
//         }
//       }
//     }
//     if (g_scroll_flg == FLG_ON) {
//       if (g_screen_move_y < evt.changedTouches[0].pageY) {
//         if (g_scroll_route_tbl.up == FLG_ON) {
//           g_scroll_route_tbl.up = FLG_OFF;
//           g_first_scroll_flg = FLG_ON;
//         }
//       } else {
//         if (g_scroll_route_tbl.up == FLG_OFF) {
//           g_scroll_route_tbl.up = FLG_ON;
//           g_first_scroll_flg = FLG_ON;
//         }
//       }
//       var drawing_area_info = document.getElementById('canvas_area');
//       var drawing_area_height = drawing_area_info.attributes.height.nodeValue;
//       if (g_scroll_chg_flg == FLG_OFF) { // using iPendant or opboard screen
//         var canvas_y_offset = 16;
//       } else {
//         var canvas_y_offset = 20;
//       }
//       if (g_first_scroll_flg == FLG_ON) {
//         var grid_y_size = ((drawing_area_height - canvas_y_offset) / VIEW_GRID_COL) / 4;
//       } else {
//         var grid_y_size = (drawing_area_height - canvas_y_offset) / VIEW_GRID_COL;
//       }
//       if (g_stop_get_val_flg == FLG_OFF) {
//         g_stop_get_val_flg = FLG_ON;
//       }
//       if (g_screen_move_y + grid_y_size < evt.changedTouches[0].pageY) {
//         if (g_first_scroll_flg == FLG_ON) {
//           g_first_scroll_flg = FLG_OFF;
//         }
//         if (scroll_type === "grid") {
//           if (screen_id === SCREEN_LADDER_NETEDIT) {
//             click_scroll_net_edit_move(draw_area, 0, KEYBOARD_UP);
//           } else {
//             click_scroll_grid_move(draw_area, 0, KEYBOARD_UP);
//           }
//         } else if (scroll_type === "net") {
//           click_scroll_net_move(draw_area, 0, KEYBOARD_UP);
//         }
//         g_screen_move_y = evt.touches[0].pageY;
//       } else if (g_screen_move_y - grid_y_size > evt.changedTouches[0].pageY) {
//         if (g_first_scroll_flg == FLG_ON) {
//           g_first_scroll_flg = FLG_OFF;
//         }
//         if (scroll_type === "grid") {
//           if (screen_id === SCREEN_LADDER_NETEDIT) {
//             click_scroll_net_edit_move(draw_area, 0, KEYBOARD_DOWN);
//           } else {
//             click_scroll_grid_move(draw_area, 0, KEYBOARD_DOWN);
//           }
//         } else if (scroll_type === "net") {
//           click_scroll_net_move(draw_area, 0, KEYBOARD_DOWN);
//         }
//         g_screen_move_y = evt.touches[0].pageY;
//       }
//     }
//     if (g_h_scroll_flg == FLG_ON) {
//       if (g_screen_move_x < evt.changedTouches[0].pageX) {
//         if (g_scroll_route_tbl.right == FLG_ON) {
//           g_scroll_route_tbl.right = FLG_OFF;
//           g_first_scroll_flg = FLG_ON;
//         }
//       } else {
//         if (g_scroll_route_tbl.right == FLG_OFF) {
//           g_scroll_route_tbl.right = FLG_ON;
//           g_first_scroll_flg = FLG_ON;
//         }
//       }
//       var drawing_area_info = document.getElementById('canvas_area');
//       var drawing_area_width = drawing_area_info.attributes.width.nodeValue;
//       var canvas_x_offset = 10;
//       if (g_scroll_chg_flg == FLG_OFF) { // using iPendant or opboard screen
//         var canvas_x_offset_2 = 54;
//       } else {
//         var canvas_x_offset_2 = 10;
//       }
//       if (g_first_scroll_flg == FLG_ON) {
//         var grid_x_size = ((drawing_area_width - canvas_x_offset - canvas_x_offset_2 - 10) / VIEW_GRID_COL) / 4;
//       } else {
//         var grid_x_size = (drawing_area_width - canvas_x_offset - canvas_x_offset_2 - 10) / VIEW_GRID_COL;
//       }
//       if (g_stop_get_val_flg == FLG_OFF) {
//         g_stop_get_val_flg = FLG_ON;
//       }
//       if (g_screen_move_x + grid_x_size < evt.changedTouches[0].pageX) {
//         if (g_first_scroll_flg == FLG_ON) {
//           g_first_scroll_flg = FLG_OFF;
//         }
//         click_scroll_grid_move_h(draw_area, lx = 0, KEYBOARD_LEFT);
//         g_screen_move_x = evt.touches[0].pageX;
//       } else if (g_screen_move_x - grid_x_size > evt.changedTouches[0].pageX) {
//         if (g_first_scroll_flg == FLG_ON) {
//           g_first_scroll_flg = FLG_OFF;
//         }
//         click_scroll_grid_move_h(draw_area, lx = 0, KEYBOARD_RIGHT);
//         g_screen_move_x = evt.touches[0].pageX;
//       }
//     }
//   } else {
//     return;
//   }
// }
/*
 =========================================================================
 @function name : touchmove_scrollbar
 @argument [e]  : event in the touch move
 @description   : scroll of the grid and net unit
 @return        : none
 =========================================================================
*/
// function touchmove_scrollbar(evt) {
//   if ((g_popup_flg == FLG_ON) || (g_symbol_flg == FLG_ON) || (g_scaling_flg == FLG_ON)) {
//     return;
//   }
//   var touch_elem = evt.target.id;
//   var rect = evt.target.getBoundingClientRect();
//   if (touch_elem == "scroll") {
//     //scroll process
//     var touch_move_y = evt.touches[0].clientY - rect.top;
//     if ((touch_move_y > SBHV_POS_E) && (touch_move_y < scrollcanvas.height - (SBHV_POS_E))) {
//       if (g_stop_get_val_flg == FLG_OFF) {
//         g_stop_get_val_flg = FLG_ON;
//       }
//       if ((screen_id === SCREEN_LADDER_DISPLAY || old_screen_id === SCREEN_LADDER_DISPLAY) && screen_id !== SCREEN_LADDER_SEARCH_RESULT_LIST) {
//         click_scroll_grid(evt);
//       } else if (screen_id === SCREEN_LADDER_NETEDIT) {
//         click_scroll_net_edit(evt);
//       } else {
//         click_scroll_net(evt);
//       }
//     } else {
//       return;
//     }
//   } else if (touch_elem == "scroll_h") {
//     var touch_move_x = evt.touches[0].clientX - rect.left;
//     if ((touch_move_x > SBHV_POS_E) && (touch_move_x < scrollcanvas_h.width - (SBHV_POS_E + SBHV_POS_C))) {
//       if (g_stop_get_val_flg == FLG_OFF) {
//         g_stop_get_val_flg = FLG_ON;
//       }
//       click_scroll_grid(evt);
//     } else {
//       return;
//     }
//   }
// }
/*
 =========================================================================
 @function name : flick_scroll_func
 @description   : loop scroll when flicked
 @return        : none
 =========================================================================
*/
// var flick_scroll_func = function () {
//   var scroll_type = null;
//   var draw_area = null;
//   switch (screen_id) {
//     case SCREEN_LADDER_DISPLAY:
//       draw_area = CANVAS_AREA_LADDER_DISPLAY;
//       scroll_type = "grid";
//       break;
//     case SCREEN_LADDER_SEARCH_RESULT:
//       draw_area = CANVAS_AREA_LADDER_SEARCH_RESULT;
//       if (old_screen_id === SCREEN_LADDER_DISPLAY) {
//         scroll_type = "grid";
//       } else {
//         scroll_type = "net";
//       }
//       break;
//     case SCREEN_LADDER_EDITOR:
//       draw_area = CANVAS_AREA_LADDER_EDITOR;
//       scroll_type = "net";
//       break;
//     case SCREEN_LADDER_NETEDIT:
//       draw_area = CANVAS_AREA_LADDER_NETEDIT;
//       scroll_type = "grid";
//       break;
//     case SCREEN_LADDER_SEARCH_RESULT_LIST:
//       draw_area = CANVAS_AREA_LADDER_SEARCH_RESULT_LIST;
//       scroll_type = "net";
//       break;
//     case SCREEN_LADDER_SEARCH_REPLACE:
//       draw_area = CANVAS_AREA_LADDER_SEARCH_REPLACE;
//       scroll_type = "net";
//       break;
//     default:
//       return;
//   }
//   if (g_flick_flg_tbl.vertical == FLG_ON) {
//     if (g_diff_flick_tbl.route_y < 0) {
//       if (scroll_type === "grid") {
//         if (screen_id === SCREEN_LADDER_NETEDIT) {
//           click_scroll_net_edit_move(draw_area, 0, KEYBOARD_UP);
//         } else {
//           click_scroll_grid_move(draw_area, 0, KEYBOARD_UP);
//         }
//       } else if (scroll_type === "net") {
//         click_scroll_net_move(draw_area, 0, KEYBOARD_UP);
//       }
//     } else {
//       if (scroll_type === "grid") {
//         if (screen_id === SCREEN_LADDER_NETEDIT) {
//           click_scroll_net_edit_move(draw_area, 0, KEYBOARD_DOWN);
//         } else {
//           click_scroll_grid_move(draw_area, 0, KEYBOARD_DOWN);
//         }
//       } else if (scroll_type === "net") {
//         click_scroll_net_move(draw_area, 0, KEYBOARD_DOWN);
//       }
//     }
//     if (g_flick_flg_tbl.scrolling == FLG_ON) {
//       // keep scrolling 
//       g_flick_timer = setTimeout(flick_scroll_func, FLICK_INTERVAL_TIME);
//     }
//   } else {
//     if (g_diff_flick_tbl.route_x < 0) {
//       click_scroll_grid_move_h(draw_area, lx = 0, KEYBOARD_LEFT);
//     } else {
//       click_scroll_grid_move_h(draw_area, lx = 0, KEYBOARD_RIGHT);
//     }
//     if (g_flick_flg_tbl.scrolling == FLG_ON) {
//       // keep scrolling 
//       g_flick_timer = setTimeout(flick_scroll_func, FLICK_INTERVAL_TIME);
//     }
//   }
// };

/*
 =========================================================================
 @function name : stop_flick_scroll
 @description   : stop scrolling
 @return        : none
 =========================================================================
*/
// function stop_flick_scroll() {
//   //init flick param
//   g_stop_get_val_flg = FLG_OFF;
//   clearTimeout(g_flick_timer);
//   g_flick_flg_tbl = { vertical: FLG_OFF, horizontal: FLG_OFF, scrolling: FLG_OFF };
//   g_diff_flick_tbl = { pos_x: 0, route_x: 0, pos_y: 0, route_y: 0 };
//   if (screen_id == SCREEN_LADDER_DISPLAY) {
//     draw_ladder_diagram(SCROLLBAR_ACTION_NO_ACTION, CANVAS_AREA_LADDER_DISPLAY);
//   }
//   if (g_device === 'smt' && top.tpkeyssheet !== undefined) { // using tabletTP
//     canvas.removeEventListener('touchmove', touchmove_scroll, false);
//     scrollcanvas.removeEventListener('touchmove', touchmove_scrollbar, false);
//     scrollcanvas_h.removeEventListener('touchmove', touchmove_scrollbar, false);
//   }
// }


/*
 =========================================================================
 @function name             : header_net_counts
 @argument [net_end_count]  : the last visible net
 @description               : show net number in header
 @return                    : none
 =========================================================================
*/
function header_net_counts(net_end_count) {
  if (screen_id == SCREEN_LADDER_DISPLAY) {
    var headert = document.getElementById("headert_disp_net_view_area");
    var tree_level = get_ladder_tree_level();
    var use_lv_cnt_tbl = JSON.parse(JSON.stringify(g_lv_cnt_tbl));
    var use_sub_pg_tbl = JSON.parse(JSON.stringify(g_sub_pg_tbl));
    var use_mnemonic_array = JSON.parse(JSON.stringify(mnemonic_array));
  } else if (screen_id == SCREEN_LADDER_EDITOR) {
    var headert = document.getElementById("headert_edit_net_view_area");
    var tree_level = get_ladder_tree_edit_level();
    var use_lv_cnt_tbl = JSON.parse(JSON.stringify(g_edit_lv_cnt_tbl));
    var use_sub_pg_tbl = JSON.parse(JSON.stringify(g_edit_sub_pg_tbl));
    var use_mnemonic_array = JSON.parse(JSON.stringify(mnemo_write_array));
  }
  var first_view_net = g_disp_net_index + 1;
  first_view_net = ("00000" + String(first_view_net)).slice(-5);
  var last_view_net = g_net_num_tbl[net_end_count] - g_net_cnt_before_tree;
  last_view_net = ("00000" + String(last_view_net)).slice(-5);
  if (tree_level == 0) {
    var all_net = use_mnemonic_array[use_mnemonic_array.length - 1].net_num - 1;
  } else if (tree_level <= 3 && tree_level > 0) {
    var all_net = use_lv_cnt_tbl[tree_level - 1].net_cnt;
  } else if (tree_level >= 4) {
    var all_net = use_sub_pg_tbl[tree_level - 4].net_cnt;
  }
  headert.innerHTML =  first_view_net + " - " + last_view_net + " [" + all_net + "]";
}
// end of file                                                                                                                                                                                          /*
 * @fileoverview : PMC Ladder iHMI ladder program edit script
 * @char-code    : SJIS
 * @NewLineCode  : LF
 */

/**
  Constant definition
**/
var HEADER_ID_LADDER_EDIT = "headert_5";

/**
  Global(Only this file)
**/
var g_tmp_symbol_no_editor = SYMBOL_KIND_ADDRESS_SYMBOL;
var select_symbol_button = 3;  // symbol menu selection operation
var g_tmp_scaling_no_editor = 4;
var g_tmp_func_no = 1;
var g_tmp_net_no = 1;

var g_edit_menu = null;
var g_edit_menu_no = 0;
var EDIT_MENU_SYMBOL = 7;
var EDIT_MENU_SCALING = 9;
var EDIT_MENU_ACT = 3;
var EDIT_MENU_NET = 4;
var g_tmp_menu_no = 0;
var g_list_tree_edit_length = 0;
var g_copy_net = {};
var copy_scroll_box;
var operation_prohibited_subnum = [
  DEF_SUBROUTINE_COM.NUM,
  DEF_SUBROUTINE_COME.NUM,
  DEF_SUBROUTINE_JMP.NUM,
  DEF_SUBROUTINE_JMPE.NUM,
  DEF_SUBROUTINE_JMPB.NUM,
  DEF_SUBROUTINE_JMPC.NUM,
  DEF_SUBROUTINE_LBL.NUM,
  DEF_SUBROUTINE_CALL.NUM,
  DEF_SUBROUTINE_CALLU.NUM,
  DEF_SUBROUTINE_SP.NUM,
  DEF_SUBROUTINE_SPE.NUM,
  DEF_SUBROUTINE_END1.NUM,
  DEF_SUBROUTINE_END2.NUM,
  DEF_SUBROUTINE_END3.NUM,
  DEF_SUBROUTINE_END.NUM,
  DEF_SUBROUTINE_NOP.NUM,
  DEF_SUBROUTINE_CS.NUM,
  DEF_SUBROUTINE_CM.NUM,
  DEF_SUBROUTINE_CE.NUM,
  DEF_SUBROUTINE_FBST.NUM
];
var g_net_cnt_before_tree = 0;
var g_bk_edit_all_grid_cnt = 0;
/*
 =========================================================================
 @function name : ladder_editor_click_f1_button
 @argument      : none
 @description   : processing in the case of pushed down(clicked) F1 key
 @return        : none
 =========================================================================
*/
function ladder_editor_click_f1_button() {
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }
  if (g_processing_flg === FLG_ON) {
    return;
  }
  // in the case of opened the menu of function, close the menu
  if (document.getElementById('func_menu_5_3').style.display == 'block') {
    document.getElementById('func_menu_5_3').style.display = 'none';
    document.getElementById('func_btn_5_3').innerHTML = func_btn_3inner;
    document.getElementById('worldDiv').style.zIndex = 2;
    document.onkeydown = ladder_editor_keydown;
    g_symbol_flg = FLG_OFF;
    return;
  }
  if (document.getElementById('func_menu_5_4').style.display == 'block') {
    document.getElementById('func_menu_5_4').style.display = 'none';
    document.getElementById('func_btn_5_4').innerHTML = func_btn_4inner;
    document.getElementById('worldDiv').style.zIndex = 2;
    document.onkeydown = ladder_editor_keydown;
    g_symbol_flg = FLG_OFF;
    return;
  }
  g_net_cnt_before_tree = 0;
  g_bk_edit_all_grid_cnt = 0;

  // perform completion processing to Ladder Tree Edit Screen
  delete_line_only_net();
  move_to_ladder_tree_edit("screen_ladder_editor");
  scrollBoxPos.start_y = 0;

  var update_flg_editor = get_g_array_update_flg(SCREEN_LADDER_EDITOR);
  var update_flg_net_editor = get_g_array_update_flg(SCREEN_LADDER_NETEDIT);
  var update_flg_replace = get_g_array_update_flg(SCREEN_LADDER_REPLACE);
  var update_flg_search_replace = get_g_array_update_flg(SCREEN_LADDER_SEARCH_REPLACE);
  var del_count = 0;
  for (var i = 0; i < mnemo_write_array.length; i++) {
    if (mnemo_write_array[i].net_num !== undefined) {
      mnemo_write_array[i].net_num = mnemo_write_array[i].net_num - del_count;
    }
    if (mnemo_write_array[i].Order === "INSERT_NET") {
      g_net_num_tbl.pop();
      g_grid_edit_num_tbl.splice(mnemo_write_array[i].net_num - 1, 1);
      mnemo_write_array.splice(i, 1);
      del_count++;
      i--;
    }
  }
  if (del_count > 0) {
    if (get_ladder_tree_edit_level() <= 3) {
      //upd grid & net count
      g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) - 1].net_cnt = g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) - 1].net_cnt - del_count;
      g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) - 1].grid_cnt = g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) - 1].grid_cnt - del_count;
    } else if (get_ladder_tree_edit_level() >= 4) {
      //upd grid & net count
      g_edit_sub_pg_tbl[Number(get_ladder_tree_edit_level()) - 4].net_cnt = g_edit_sub_pg_tbl[Number(get_ladder_tree_edit_level()) - 4].net_cnt - del_count;
      g_edit_sub_pg_tbl[Number(get_ladder_tree_edit_level()) - 4].grid_cnt = g_edit_sub_pg_tbl[Number(get_ladder_tree_edit_level()) - 4].grid_cnt - del_count;
    }
    if (get_ladder_tree_edit_level() <= 3) {
      //upd mnemonic position
      if (get_ladder_tree_edit_level() < g_edit_lv_cnt_tbl.length) {
        for (var k = 0; k < g_edit_lv_cnt_tbl.length; k++) {
          if (g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) + k] == undefined) {
            break;
          }
          g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) + k].mnemo_pos = g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) + k].mnemo_pos - del_count;
        }
      }
      if (g_edit_sub_pg_tbl.length !== 0) {
        for (var l = 0; l < g_edit_sub_pg_tbl.length; l++) {
          g_edit_sub_pg_tbl[l].mnemo_pos = g_edit_sub_pg_tbl[l].mnemo_pos - del_count;
        }
      }
    } else if (get_ladder_tree_edit_level() >= 4) {
      //upd mnemonic position
      for (var m = 0; m < g_edit_sub_pg_tbl.length; m++) {
        if (g_edit_sub_pg_tbl[(Number(get_ladder_tree_edit_level()) + m) - 3] == undefined) {
          break;
        }
        g_edit_sub_pg_tbl[(Number(get_ladder_tree_edit_level()) + m) - 3].mnemo_pos = g_edit_sub_pg_tbl[(Number(get_ladder_tree_edit_level()) + m) - 3].mnemo_pos - del_count;
      }
    }
  }
  if (update_flg_editor === FLG_ON || update_flg_net_editor === FLG_ON || update_flg_replace === FLG_ON || update_flg_search_replace === FLG_ON) {
    mnemonic_array = JSON.parse(JSON.stringify(mnemo_write_array)); //mnemonic_array is backup
    g_lv_cnt_tbl = JSON.parse(JSON.stringify(g_edit_lv_cnt_tbl));
    g_sub_pg_tbl = JSON.parse(JSON.stringify(g_edit_sub_pg_tbl));
    g_make_grid_list_pos = JSON.parse(JSON.stringify(g_make_edit_grid_list_pos));
    g_grid_num_tbl = JSON.parse(JSON.stringify(g_grid_edit_num_tbl));
    g_all_grid_cnt = g_edit_all_grid_cnt;
    lengthcount = g_all_grid_cnt + 3;
    set_g_array_update_flg(SCREEN_LADDER_TREE_EDIT);
  }
}

/*
 =========================================================================
 @function name : ladder_editor_click_f2_button
 @argument      : none
 @description   : processing in the case of pushed down(clicked) F2 key
 @return        : none
 =========================================================================
*/
function ladder_editor_click_f2_button() {
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }
  if (g_processing_flg === FLG_ON) {
    return;
  }
  // in the case of opened the menu of function, close the menu
  if(document.getElementById('func_menu_5_3').style.display == 'block'){
    document.getElementById('func_menu_5_3').style.display = 'none';
    document.getElementById('func_btn_5_3').innerHTML = func_btn_3inner;
    document.getElementById('worldDiv').style.zIndex = 2;
    document.onkeydown = ladder_editor_keydown;
    g_symbol_flg = FLG_OFF;
    return;
  }
  if(document.getElementById('func_menu_5_4').style.display == 'block'){
    document.getElementById('func_menu_5_4').style.display = 'none';
    document.getElementById('func_btn_5_4').innerHTML = func_btn_4inner;
    document.getElementById('worldDiv').style.zIndex = 2;
    document.onkeydown = ladder_editor_keydown;
    g_symbol_flg = FLG_OFF;
    return;
  }

  // transit to the edit screen
  move_to_ladder_net_edit("screen_ladder_editor");
}

/*
 =========================================================================
 @function name : ladder_editor_click_f7_button
 @argument      : none
 @description   : processing in the case of pushed down(clicked) F7 key
 @return        : none
 =========================================================================
*/
function ladder_editor_click_f7_button() {
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }
  // in the case of opened the menu of function, close the menu
   if(document.getElementById('func_menu_5_9').style.display == 'block'){
     document.getElementById('func_menu_5_9').style.display = 'none';
     document.getElementById('func_btn_5_9').innerHTML = func_btn_4inner;
     g_scaling_flg = FLG_OFF;
   }
  // symbol menu popup : display -> non-display
  if(document.getElementById('func_menu_5_7').style.display == 'block'){
    ladder_editor_symbol_menu_button(select_symbol_button);
    g_symbol_flg = FLG_OFF;
  } else {
    document.onkeydown = ladder_editor_menu_keydown;
    g_edit_menu = document.getElementById('symbolMenu_5').children;
    g_edit_menu_no = EDIT_MENU_SYMBOL;
    ladder_editor_reset_menu_no();
    ladder_editor_menu_bkcolor(g_tmp_menu_no);

    // symbol menu popup : non-display -> display
    document.getElementById('func_menu_5_7').style.display = 'block';
    func_btn_2inner = document.getElementById('func_btn_5_7').innerHTML;
    var rep5_3_1 = func_btn_2inner.replace("[","|");
    var rep5_3_2 = rep5_3_1.replace("]","|");
    document.getElementById('func_btn_5_7').innerHTML = rep5_3_2;
    document.getElementById('worldDiv').style.zIndex = 0;
    g_symbol_flg = FLG_ON;
  }
}
/*
 =========================================================================
 @function name : ladder_editor_click_f4_button
 @argument      : none
 @description   : processing in the case of pushed down(clicked) F4 key
 @return        : none
 =========================================================================
*/
function ladder_editor_click_f4_button() {
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }
  if (g_processing_flg === FLG_ON) {
    return;
  }
  // in the case of opened the menu of function, close the menu
  if(document.getElementById('func_menu_5_3').style.display == 'block'){
    document.getElementById('func_menu_5_3').style.display = 'none';
    document.getElementById('func_btn_5_3').innerHTML = func_btn_3inner;
  }
  // net menu popup : display -> non-display
  if(document.getElementById('func_menu_5_4').style.display == 'block'){
    document.getElementById('func_menu_5_4').style.display = 'none';
    document.getElementById('func_btn_5_4').innerHTML = func_btn_4inner;
    document.getElementById('worldDiv').style.zIndex = 2;
    document.onkeydown = ladder_editor_keydown;
    g_symbol_flg = FLG_OFF;
  } else {
    document.onkeydown = ladder_editor_menu_keydown;
    g_edit_menu = document.getElementById('netMenu_5').children;
    g_edit_menu_no = EDIT_MENU_NET;
    ladder_editor_reset_menu_no();

    // net menu popup : non-display -> display
    document.getElementById('func_menu_5_4').style.display = 'block';
    ladder_editor_menu_bkcolor(g_tmp_menu_no);
    func_btn_4inner = document.getElementById('func_btn_5_4').innerHTML;
    var rep5_4_1 = func_btn_4inner.replace("[","|");
    var rep5_4_2 = rep5_4_1.replace("]","|");
    document.getElementById('func_btn_5_4').innerHTML = rep5_4_2;
    document.getElementById('worldDiv').style.zIndex = 0;
    g_symbol_flg = FLG_ON;
  }

}
/*
 =========================================================================
 @function name : ladder_editor_click_f9_button
 @argument      : none
 @description   : processing in the case of pushed down(clicked) F9 key
 @return        : none
 =========================================================================
*/
function ladder_editor_click_f9_button() {
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }
  // in the case of opened the menu of function, close the menu
   if(document.getElementById('func_menu_5_7').style.display == 'block'){
     document.getElementById('func_menu_5_7').style.display = 'none';
     document.getElementById('func_btn_5_7').innerHTML = func_btn_2inner;
     g_symbol_flg = FLG_OFF;
   }
  // symbol menu popup : display -> non-display
  if(document.getElementById('func_menu_5_9').style.display == 'block'){
    ladder_editor_scaling_menu_button(select_scaling_button);
    g_scaling_flg = FLG_OFF;
  } else {
    document.onkeydown = ladder_editor_menu_keydown;
    g_edit_menu = document.getElementById('scaleMenu_5').children;
    g_edit_menu_no = EDIT_MENU_SCALING;
    ladder_editor_reset_menu_no();
    ladder_editor_menu_bkcolor(select_scaling_button);

    // symbol menu popup : non-display -> display
    document.getElementById('func_menu_5_9').style.display = 'block';
    func_btn_4inner = document.getElementById('func_btn_5_9').innerHTML;
    var rep5_4_1 = func_btn_4inner.replace("[","|");
    var rep5_4_2 = rep5_4_1.replace("]","|");
    document.getElementById('func_btn_5_9').innerHTML = rep5_4_2;
    document.getElementById('worldDiv').style.zIndex = 0;
    g_scaling_flg = FLG_ON;
  }
}

/*
 =========================================================================
 @function name        : ladder_editor_scaling_menu_button
 @argument [symbol_no] : selected the magnification
 @description          : change of magnification choice background color during magnification choice
 @return               : none
 =========================================================================
*/
function ladder_editor_scaling_menu_button(scaling_no) {
  document.getElementById('func_menu_5_9').style.display = 'none';
  document.getElementById('func_btn_5_9').innerHTML = func_btn_4inner;
  document.getElementById('worldDiv').style.zIndex = 2;

  // update of the inside information
  select_scaling_button = scaling_no;
  g_tmp_scaling_no_editor = select_scaling_button;
  g_tmp_scaling_no = select_scaling_button;
  ladder_editor_menu_bkcolor(select_scaling_button);
  ladder_display_scalingSet(scaling_no);

  // symbol information was updated,redraw
  draw_ladder_diagram(SCROLLBAR_ACTION_NO_ACTION, CANVAS_AREA_LADDER_EDITOR);

  // return key handler to ladder editor screen
  document.onkeydown = ladder_editor_keydown;
  g_scaling_flg = FLG_OFF;
}

/*
 =========================================================================
 @function name : ladder_editor_click_fnext_button
 @argument      : none
 @description   : processing in the case of pushed down(clicked) Fnext key
 @return        : none
 =========================================================================
*/
function ladder_editor_click_fnext_button() {
  if (g_processing_flg === FLG_ON) {
    return;
  }
  // in the case of opened the menu of function, close the menu
    if(document.getElementById('func_menu_5_3').style.display == 'block'){
      document.getElementById('func_menu_5_3').style.display = 'none';
      document.getElementById('func_btn_5_3').innerHTML = func_btn_3inner;
      document.getElementById('worldDiv').style.zIndex = 2;
      document.onkeydown = ladder_editor_keydown;
        g_symbol_flg = FLG_OFF;
      return;
    }
  // symbol menu popup : display -> non-display
    if(document.getElementById('func_menu_5_7').style.display == 'block'){
      document.getElementById('func_menu_5_7').style.display = 'none';
      document.getElementById('func_btn_5_7').innerHTML = func_btn_2inner;
      document.getElementById('worldDiv').style.zIndex = 2;
      document.onkeydown = ladder_editor_keydown;
        g_symbol_flg = FLG_OFF;
      return;
    }
      // net menu popup : display -> non-display
    if(document.getElementById('func_menu_5_4').style.display == 'block'){
      document.getElementById('func_menu_5_4').style.display = 'none';
      document.getElementById('func_btn_5_4').innerHTML = func_btn_4inner;
      document.getElementById('worldDiv').style.zIndex = 2;
      document.onkeydown = ladder_editor_keydown;
      g_symbol_flg = FLG_OFF;
      return;
    }
     if(document.getElementById('func_menu_5_9').style.display == 'block'){
       document.getElementById('func_menu_5_9').style.display = 'none';
       document.getElementById('func_btn_5_9').innerHTML = func_btn_4inner;
       document.getElementById('worldDiv').style.zIndex = 2;
       document.onkeydown = ladder_editor_keydown;
       g_symbol_flg = FLG_OFF;
       g_scaling_flg = FLG_OFF;
       return;
     }
  
    if (document.getElementById('function_button_5').style.display == 'block') {
      document.getElementById('function_button_5').style.display = 'none';
      document.getElementById('function_button_5_2').style.display = 'block';
    } else {
      
      document.getElementById('function_button_5').style.display = 'block';
      document.getElementById('function_button_5_2').style.display = 'none';
    }

}

/*
 =========================================================================
 @function name : ladder_net_insert
 @argument      : none
 @description   : inserte of choice net
 @return        : none
 =========================================================================
*/
function ladder_net_insert() {
  var insert_check = net_operation_check();
  var insert_mnemo_flg = FLG_OFF;
  var current_net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_selected_net_edit_index + 1);
  if (insert_check !== DEF_SUBROUTINE_SP.NUM) {
    var insert_net = create_net();
    var insert_mnemo_info = { Order: "INSERT_NET", address: null, VirtualAddress: null, pal_address: null, net_num: g_net_cnt_before_tree + g_selected_net_edit_index + 1 };
    for (var i = 0; i < mnemo_write_array.length; i++){
      if (mnemo_write_array[i].net_num !== undefined) {
        if (g_net_cnt_before_tree + g_selected_net_edit_index + 1 === mnemo_write_array[i].net_num && insert_mnemo_flg === FLG_OFF) {
          mnemo_write_array.splice(i, 0, insert_mnemo_info);
          insert_mnemo_flg = FLG_ON;
        } else if (insert_mnemo_flg === FLG_ON) {
          mnemo_write_array[i].net_num = mnemo_write_array[i].net_num + 1;
        }
      }
    }
    if (get_ladder_tree_edit_level() <= 3) {
      //upd net count
      g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) - 1].net_cnt = g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) - 1].net_cnt + 1;
      g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) - 1].grid_cnt = g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) - 1].grid_cnt + 1;
    } else if (get_ladder_tree_edit_level() >= 4) {
      //upd net count
      g_edit_sub_pg_tbl[Number(get_ladder_tree_edit_level()) - 4].net_cnt = g_edit_sub_pg_tbl[Number(get_ladder_tree_edit_level()) - 4].net_cnt + 1;
      g_edit_sub_pg_tbl[Number(get_ladder_tree_edit_level()) - 4].grid_cnt = g_edit_sub_pg_tbl[Number(get_ladder_tree_edit_level()) - 4].grid_cnt + 1;
    }
    if (get_ladder_tree_edit_level() <= 3) {
      //upd mnemonic position
      if (get_ladder_tree_edit_level() < g_edit_lv_cnt_tbl.length) {
        for (var k = 0; k < g_edit_lv_cnt_tbl.length; k++) {
          if (g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) + k] == undefined) {
            break;
          }
          g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) + k].mnemo_pos = g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) + k].mnemo_pos + 1;
        }
      }
      if (g_edit_sub_pg_tbl.length !== 0) {
        for (var l = 0; l < g_edit_sub_pg_tbl.length; l++) {
          g_edit_sub_pg_tbl[l].mnemo_pos = g_edit_sub_pg_tbl[l].mnemo_pos + 1;
        }
      }
    } else if (get_ladder_tree_edit_level() >= 4) {
      //upd mnemonic position
      for (var m = 0; m < g_edit_sub_pg_tbl.length; m++) {
        if (g_edit_sub_pg_tbl[(Number(get_ladder_tree_edit_level()) + m) - 3] == undefined) {
          break;
        }
        g_edit_sub_pg_tbl[(Number(get_ladder_tree_edit_level()) + m) - 3].mnemo_pos = g_edit_sub_pg_tbl[(Number(get_ladder_tree_edit_level()) + m) - 3].mnemo_pos + 1;
      }
    }

    g_grid_edit_num_tbl.splice(g_net_cnt_before_tree + g_selected_net_edit_index, 0, 1);
    g_net_num_tbl.push(g_net_num_tbl[g_net_num_tbl.length - 1] + 1);
    grid_List.insertTo(insert_net,current_net_index,grid_List.getLevel(current_net_index),grid_List.getSubNum(current_net_index), g_net_cnt_before_tree + g_selected_net_edit_index + 1);
    if (g_net_cnt_before_tree + g_selected_net_edit_index <= g_copy_net.index && g_copy_net.index !== null) {
      g_copy_net.index++;
    }
    iterateArray = [];
    iterateArray = grid_List.pushIterateArray();
    draw_figure(CANVAS_AREA_LADDER_EDITOR);
  } else {
    document.getElementById("popup_no_comfirm_5").style.display="block";
    document.getElementById("poptitle").placeholder = "";
    document.getElementById("popcomment_5_1").style.display="none";
    document.getElementById("popcomment_5_2").style.display="none";
    document.getElementById("popcomment_5_3").style.display="block";
    document.getElementById("popcomment_5_4").style.display="none";
    document.getElementById("popcomment_5_5").style.display = "none";
    Popupbutton();
  }
}
/*
 =========================================================================
 @function name : ladder_net_delete
 @argument      : none
 @description   : delete of choice net
 @return        : none
 =========================================================================
*/
function ladder_net_delete() {
  var delete_check = net_operation_check();
  var del_mnemo_cnt= 0;
  var mnemo_delete_flg = FLG_OFF;
  var current_net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_selected_net_edit_index + 1);
  var insert_net_flg = FLG_OFF;
  if (delete_check === true) {
    grid_List.remove(current_net_index);
    g_net_num_tbl.pop();
    g_grid_edit_num_tbl.splice(g_net_cnt_before_tree + g_selected_net_edit_index, 1);
    g_edit_all_grid_cnt = g_edit_all_grid_cnt - iterateArray[current_net_index].data.length;
    if (g_net_cnt_before_tree + g_selected_net_edit_index < g_copy_net.index) {
      g_copy_net.index--;
    } else if (g_net_cnt_before_tree + g_selected_net_edit_index === g_copy_net.index){
      g_copy_net.index = null;
    }
    for (var i = 0; i < mnemo_write_array.length; i++) {
      if (mnemo_write_array[i].net_num !== undefined) {
        if (g_net_cnt_before_tree + g_selected_net_edit_index + 1 === mnemo_write_array[i].net_num && mnemo_delete_flg === FLG_OFF) {
          if (mnemo_write_array[i].Order === "INSERT_NET") {
            insert_net_flg = FLG_ON;
          }
          for (var j = 0; j < mnemo_write_array.length; j++) {
            if (mnemo_write_array[i].net_num === undefined || g_net_cnt_before_tree + g_selected_net_edit_index + 1 === mnemo_write_array[i].net_num) {
              mnemo_write_array.splice(i, 1);
              del_mnemo_cnt++;
              j--;
            } else if (g_net_cnt_before_tree + g_selected_net_edit_index + 1 < mnemo_write_array[i].net_num) {
              mnemo_write_array[i].net_num = mnemo_write_array[i].net_num - 1;
              mnemo_delete_flg = FLG_ON;
              break;
            }
          }
        } else if (mnemo_delete_flg === FLG_ON) {
          mnemo_write_array[i].net_num = mnemo_write_array[i].net_num - 1;
        }
      }
    }
    if (get_ladder_tree_edit_level() <= 3) {
      //upd grid & net count
      if (insert_net_flg === FLG_OFF) {
        g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) - 1].grid_cnt = g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) - 1].grid_cnt - iterateArray[current_net_index].data.length;
      } else {
        g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) - 1].grid_cnt = g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) - 1].grid_cnt - 1;
      }
      g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) - 1].net_cnt = g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) - 1].net_cnt - 1;
      //upd mnemonic position
      if (get_ladder_tree_edit_level() < g_edit_lv_cnt_tbl.length) {
        for (var k = 0; k < g_edit_lv_cnt_tbl.length; k++) {
          if (g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) + k] == undefined) {
            break;
          }
          g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) + k].mnemo_pos = g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) + k].mnemo_pos - del_mnemo_cnt;
        }
      }
      if (g_edit_sub_pg_tbl.length !== 0) {
        for (var l = 0; l < g_edit_sub_pg_tbl.length; l++) {
          g_edit_sub_pg_tbl[l].mnemo_pos = g_edit_sub_pg_tbl[l].mnemo_pos - del_mnemo_cnt;
        }
      }
    } else if (get_ladder_tree_edit_level() >= 4) {
      //upd grid & net count
      if (insert_net_flg === FLG_OFF) {
        g_edit_sub_pg_tbl[Number(get_ladder_tree_edit_level()) - 4].grid_cnt = g_edit_sub_pg_tbl[Number(get_ladder_tree_edit_level()) - 4].grid_cnt - iterateArray[current_net_index].data.length;
      } else {
        g_edit_sub_pg_tbl[Number(get_ladder_tree_edit_level()) - 4].grid_cnt = g_edit_sub_pg_tbl[Number(get_ladder_tree_edit_level()) - 4].grid_cnt - 1;
      }
      g_edit_sub_pg_tbl[Number(get_ladder_tree_edit_level()) - 4].net_cnt = g_edit_sub_pg_tbl[Number(get_ladder_tree_edit_level()) - 4].net_cnt - 1;
      //upd mnemonic position
      for (var m = 0; m < g_edit_sub_pg_tbl.length; m++) {
        if (g_edit_sub_pg_tbl[(Number(get_ladder_tree_edit_level()) + m) - 3] == undefined) {
          break;
        }
        g_edit_sub_pg_tbl[(Number(get_ladder_tree_edit_level()) + m) - 3].mnemo_pos = g_edit_sub_pg_tbl[(Number(get_ladder_tree_edit_level()) + m) - 3].mnemo_pos - del_mnemo_cnt;
      }
    }
    g_make_edit_grid_list_pos.upd_margin__next_pos = Number(g_make_edit_grid_list_pos.upd_margin__next_pos) - del_mnemo_cnt;
    iterateArray = [];
    iterateArray = grid_List.pushIterateArray();
    if (grid_List.length == 0) {
      net_index = update_list_down();
    }
    draw_figure(CANVAS_AREA_LADDER_EDITOR);
  } else {
    document.getElementById("popup_no_comfirm_5").style.display="block";
    document.getElementById("poptitle").placeholder = "";
    document.getElementById("popcomment_5_1").style.display="none";
    document.getElementById("popcomment_5_2").style.display="none";
    document.getElementById("popcomment_5_3").style.display="none";
    document.getElementById("popcomment_5_4").style.display="block";
    document.getElementById("popcomment_5_5").style.display = "none";
    Popupbutton();
  }

}

/*
 =========================================================================
 @function name : ladder_net_copy
 @argument      : none
 @description   : copy information of the choice net
 @return        : none
 =========================================================================
*/
function ladder_net_copy() {
  copy_scroll_box = scrollBoxPos.start_y;
  var copy_check = net_operation_check();
  var temp_mnemo_info;
  var current_net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_selected_net_edit_index + 1);
  if (copy_check === true) {
    g_copy_net.data = grid_List.getData(current_net_index);
    g_copy_net.data = JSON.parse(JSON.stringify(g_copy_net.data));
    iterateArray = [];
    iterateArray = grid_List.pushIterateArray();
    g_copy_net.hight = grid_List.getData(current_net_index).length;
    g_copy_net.index = g_net_cnt_before_tree + g_selected_net_edit_index;
    g_copy_net.current_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_selected_net_edit_index + 1);
    g_copy_net.mnemo_info = [];
    for (var i = 0; i < mnemonic_array.length; i++){
      if (g_copy_net.mnemo_info.length !== 0) {
        break;
      }
      if (mnemo_write_array[i].net_num !== undefined) {
        if (g_copy_net.index + 1 === mnemo_write_array[i].net_num) {
          for (var j = i; j < mnemo_write_array.length; j++) {
            if (mnemo_write_array[j].net_num === undefined || g_copy_net.index + 1 === mnemo_write_array[j].net_num) {
              temp_mnemo_info = JSON.parse(JSON.stringify(mnemo_write_array[j]));
              g_copy_net.mnemo_info.push(temp_mnemo_info);
            } else if(g_copy_net.index + 1 < mnemo_write_array[j].net_num){
              break;
            }
          }
        }
      }
    }
    draw_figure(CANVAS_AREA_LADDER_EDITOR);
  } else {
    document.getElementById("popup_no_comfirm_5").style.display="block";
    document.getElementById("poptitle").placeholder = "";
    document.getElementById("popcomment_5_1").style.display="block";
    document.getElementById("popcomment_5_2").style.display="none";
    document.getElementById("popcomment_5_3").style.display="none";
    document.getElementById("popcomment_5_4").style.display="none";
    document.getElementById("popcomment_5_5").style.display = "none";
    Popupbutton();
  }

}

/*
 =========================================================================
 @function name : ladder_net_paste
 @argument      : none
 @description   : paste of choice net
 @return        : none
 =========================================================================
*/
function ladder_net_paste() {
  var paste_check = net_operation_check();
  var mnemo_push_flg = FLG_OFF;
  var current_net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_selected_net_edit_index + 1);
  if (g_copy_net.data === null || paste_check === DEF_SUBROUTINE_SP.NUM) {
    document.getElementById("popup_no_comfirm_5").style.display="block";
    document.getElementById("poptitle").placeholder = "";
    document.getElementById("popcomment_5_1").style.display="none";
    document.getElementById("popcomment_5_2").style.display="block";
    document.getElementById("popcomment_5_3").style.display="none";
    document.getElementById("popcomment_5_4").style.display="none";
    document.getElementById("popcomment_5_5").style.display = "none";
    Popupbutton();
  } else {
    g_copy_net.mnemo_info[0].net_num = g_net_cnt_before_tree + g_selected_net_edit_index + 1;
    g_grid_edit_num_tbl.splice(g_net_cnt_before_tree + g_selected_net_edit_index,0, g_copy_net.hight);
    g_edit_all_grid_cnt = g_edit_all_grid_cnt + g_copy_net.hight;
    for (var i = 0; i < mnemo_write_array.length; i++){
      if (mnemo_write_array[i].net_num !== undefined) {
        if (g_net_cnt_before_tree + g_selected_net_edit_index + 1 === mnemo_write_array[i].net_num && mnemo_push_flg === FLG_OFF ) {
          for (var j = 0; j < g_copy_net.mnemo_info.length; j++) {
            mnemo_write_array.splice(i + j, 0, JSON.parse(JSON.stringify(g_copy_net.mnemo_info[j])));
          }
          mnemo_push_flg = FLG_ON;
        } else if (mnemo_push_flg === FLG_ON) {
          mnemo_write_array[i].net_num = mnemo_write_array[i].net_num + 1;
        }
      }
    }
    if (get_ladder_tree_edit_level() <= 3) {
      //upd grid & net count
      g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) - 1].grid_cnt = g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) - 1].grid_cnt + g_copy_net.data.length;
      g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) - 1].net_cnt = g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) - 1].net_cnt + 1;
      //upd mnemonic position
      if (get_ladder_tree_edit_level() < g_edit_lv_cnt_tbl.length) {
        for (var k = 0; k < g_edit_lv_cnt_tbl.length; k++) {
          if (g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) + k] == undefined) {
            break;
          }
          g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) + k].mnemo_pos = g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) + k].mnemo_pos + g_copy_net.mnemo_info.length;
        }
      }
      if (g_edit_sub_pg_tbl.length !== 0) {
        for (var l = 0; l < g_edit_sub_pg_tbl.length; l++) {
          g_edit_sub_pg_tbl[l].mnemo_pos = g_edit_sub_pg_tbl[l].mnemo_pos + g_copy_net.mnemo_info.length;
        }
      }
    } else if (get_ladder_tree_edit_level() >= 4) {
      //upd grid & net count
      g_edit_sub_pg_tbl[Number(get_ladder_tree_edit_level()) - 4].grid_cnt = g_edit_sub_pg_tbl[Number(get_ladder_tree_edit_level()) - 4].grid_cnt + g_copy_net.data.length;
      g_edit_sub_pg_tbl[Number(get_ladder_tree_edit_level()) - 4].net_cnt = g_edit_sub_pg_tbl[Number(get_ladder_tree_edit_level()) - 4].net_cnt + 1;
      //upd mnemonic position
      for (var m = 0; m < g_edit_sub_pg_tbl.length; m++) {
        if (g_edit_sub_pg_tbl[(Number(get_ladder_tree_edit_level()) + m) - 3] == undefined) {
          break;
        }
        g_edit_sub_pg_tbl[(Number(get_ladder_tree_edit_level()) + m) - 3].mnemo_pos = g_edit_sub_pg_tbl[(Number(get_ladder_tree_edit_level()) + m) - 3].mnemo_pos + g_copy_net.mnemo_info.length;
      }
    }
    g_net_num_tbl.push(g_net_num_tbl.length + 1);
    g_make_edit_grid_list_pos.upd_margin__next_pos = Number(g_make_edit_grid_list_pos.upd_margin__next_pos) + g_copy_net.mnemo_info.length;
    grid_List.insertTo(g_copy_net.data,current_net_index,grid_List.getLevel(current_net_index),grid_List.getSubNum(current_net_index), g_net_cnt_before_tree + g_selected_net_edit_index + 1);
    if (g_net_cnt_before_tree + g_selected_net_edit_index <= g_copy_net.index && g_copy_net.index !== null) {
      g_copy_net.index++;
    } 
    iterateArray = [];
    iterateArray = grid_List.pushIterateArray();
    draw_figure(CANVAS_AREA_LADDER_EDITOR);
  }
}
/*
 =========================================================================
 @function name : create_net
 @argument      : none
 @description   : Net making for insertion
 @return        : none
 =========================================================================
*/
function create_net() {
  var insert_net = [];
  insert_net[0] = [];
  for(var i = 0; i < g_width_num;i++) {
    insert_net[0].push(create_grid());
    insert_net[0][i].FigNo = IMAGENO9_LINE;
  }
  return insert_net;
}
/*
 =========================================================================
 @function name : net_operation_check
 @argument      : none
 @description   : check whether prohibition subrutine is included
 @return        : true:normal / false:subnum
 =========================================================================
*/

function net_operation_check() {
  var net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_selected_net_edit_index + 1);
  var array = grid_List.getData(net_index);
  for (var y = 0; y < array.length;y++) {
    for (var x = 0; x < array[y].length;x++) {
      var not_operation_subroutine = operation_prohibited_subnum.indexOf(array[y][x].SubNo);
      if (not_operation_subroutine != -1) {
        return operation_prohibited_subnum[not_operation_subroutine];
      }
    }
  }
  return true;
}

/*
 =========================================================================
 @function name : init_copy_net
 @argument      : none
 @description   : initialize sequence for copy storage
 @return        : none
 =========================================================================
*/
function init_copy_net() {
  g_copy_net.hight = null;
  g_copy_net.index = null;
  g_copy_net.data = null;
  g_copy_net.current_index = null;
  g_copy_net.mnemo_info = null;
}

/*
 =========================================================================
 @function name : move_to_ladder_editor
 @argument [id] : the element id of the origin of transition
 @description   : API whitch changes in Ladder Editor Screen
 @return        : none
 =========================================================================
*/
function move_to_ladder_editor(id, net_edit_move_flg) {
  var net_index = 0;
  var grid_index = 0;
  var tree_edit_level = get_ladder_tree_edit_level();
  var bk_VIEW_MAX_COL;
  var mnemo_start_net = g_net_num_tbl[0];
  g_end_order_hit_flg = FLG_OFF;
  if (id !== "screen_ladder_netedit") {
    g_bk_edit_all_grid_cnt = g_edit_all_grid_cnt;
  }
  if (id == "screen_ladder_tree_edit") { //init blue flame position
    g_selected_net_edit_index = 0;
    ly_net_p = 0;
    lx_net_p = 0;
  }
  bk_VIEW_MAX_COL = VIEW_MAX_COL;
  VIEW_MAX_COL = g_width_num;
  make_sub_pg_flg = FLG_ON;
  g_net_cnt_before_tree = 0;
  read_address_conversion_flg = FLG_OFF;
  if (net_edit_move_flg === FLG_ON && get_ladder_tree_level() == "0") {
    if (tree_edit_level == 2 || tree_edit_level >= 4) {
      read_address_conversion_flg = FLG_ON;
    }
    g_net_cnt_before_tree = 0;
  } else {
    if (tree_edit_level <= 3) {
      if (tree_edit_level == 1) {
        g_net_cnt_before_tree = 0;
      } else if (tree_edit_level == 2) {
        read_address_conversion_flg = FLG_ON;
        g_net_cnt_before_tree = g_edit_lv_cnt_tbl[0].net_cnt;
      } else if (tree_edit_level == 3) {
        g_net_cnt_before_tree = g_edit_lv_cnt_tbl[0].net_cnt + g_edit_lv_cnt_tbl[1].net_cnt;
      }
    } else if (tree_edit_level >= 4) {
      read_address_conversion_flg = FLG_ON;
      for (var k = 0; k < g_edit_lv_cnt_tbl.length; k++) {
        g_net_cnt_before_tree = g_net_cnt_before_tree + g_edit_lv_cnt_tbl[k].net_cnt;
      }
      for (var l = 0; l < tree_edit_level - 4; l++) {
        g_net_cnt_before_tree = g_net_cnt_before_tree + g_edit_sub_pg_tbl[l].net_cnt;
      }
    }
  }
  grid_List = new List();
  g_net_num_tbl = [];
  g_result_list_net_num_tbl = [];
  g_make_grid_list_pos.temp_grid_cnt = 0;
  g_make_edit_grid_list_pos.temp_grid_cnt = 0;
  if (net_edit_move_flg === FLG_ON) {
    if (tree_edit_level <= 3) {
      setg_array_grid_info(g_lv_cnt_tbl[Number(tree_edit_level) - 1].mnemo_pos, CREATE_LIST_LIMIT, mnemo_write_array, null);
    } else if (tree_edit_level >= 4) {
      setg_array_grid_info(g_sub_pg_tbl[Number(tree_edit_level) - 4].mnemo_pos, CREATE_LIST_LIMIT, mnemo_write_array, null);
    }
    if (g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_all_click_net_index + 1) == -1) {
      var bk_VIEW_MAX_COL;
      bk_VIEW_MAX_COL = VIEW_MAX_COL;
      VIEW_MAX_COL = g_width_num;
      g_make_grid_list_pos.temp_grid_cnt = 0;
      grid_List = new List();
      g_net_num_tbl = [];
      g_result_list_net_num_tbl = [];
      var prev_margin_grid_cnt = 0; // create list end position
      var start_net_num, create_list_start_pos;
      if (screen_id !== SCREEN_LADDER_EDITOR) {
        //calc margin16 grid
        for (var start_margin_cnt = g_net_cnt_before_tree + g_all_click_net_index; start_margin_cnt < g_grid_num_tbl.length - 1; start_margin_cnt++) {
          prev_margin_grid_cnt = prev_margin_grid_cnt + g_grid_num_tbl[start_margin_cnt];
          if (prev_margin_grid_cnt >= UPDATE_PREV_MARGIN_POS) {
            break;
          }
        }
        //calc margin200 grid & calc create list end position
        for (start_net_num = g_net_cnt_before_tree + g_all_click_net_index - 1; start_net_num >= 0; start_net_num--) {
          prev_margin_grid_cnt = prev_margin_grid_cnt + g_grid_num_tbl[start_net_num];
          if (prev_margin_grid_cnt >= CREATE_LIST_LIMIT) {
            start_net_num++;
            break;
          }
        }
        //calc create list start position
        if (start_net_num > g_net_cnt_before_tree) {
          for (create_list_start_pos = 0; create_list_start_pos <= mnemonic_array.length; create_list_start_pos++) {
            if (mnemonic_array[create_list_start_pos].net_num == undefined) {
              continue;
            } else if (start_net_num == mnemonic_array[create_list_start_pos].net_num) {
              break;
            }
          }
          setg_array_grid_info(create_list_start_pos, prev_margin_grid_cnt, mnemonic_array, null);
        } else if (tree_edit_level == 0) {
          setg_array_grid_info(0, CREATE_LIST_LIMIT, mnemonic_array, null);
        } else if (tree_edit_level <= 3) {
          setg_array_grid_info(g_lv_cnt_tbl[tree_edit_level - 1].mnemo_pos, CREATE_LIST_LIMIT, mnemonic_array, null);
        } else if (tree_edit_level >= 4) {
          setg_array_grid_info(g_sub_pg_tbl[tree_edit_level - 4].mnemo_pos, CREATE_LIST_LIMIT, mnemonic_array, null);
        }
      }
      iterateArray = [];
      iterateArray = grid_List.pushIterateArray();
      // calc current grid_List position for display
      if (g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_all_click_net_index + 1) !== -1) {
        net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_all_click_net_index + 1);
      }
      VIEW_MAX_COL = bk_VIEW_MAX_COL;
    }

  } else if (id === "screen_ladder_netedit") {
    for (var i = 0; i < mnemo_write_array.length; i++){
      if (mnemo_write_array[i].net_num == undefined) {
        continue;
      } else if (mnemo_write_array[i].net_num === mnemo_start_net) {
        var mnemo_start_pos = i;
        setg_array_grid_info(mnemo_start_pos, CREATE_LIST_LIMIT, mnemo_write_array, null);
        break;
      }
    }
  } else {
    g_net_num_tbl = [];
    g_result_list_net_num_tbl = [];
    if (tree_edit_level <= 3) {
      en_route_array.length = 0;
      setg_array_grid_info(g_edit_lv_cnt_tbl[tree_edit_level - 1].mnemo_pos, CREATE_LIST_LIMIT, mnemo_write_array, null);
    }
    if (tree_edit_level >= 4) {
      en_route_array.length = 0;
      setg_array_grid_info(g_edit_sub_pg_tbl[tree_edit_level - 4].mnemo_pos, CREATE_LIST_LIMIT, mnemo_write_array, null);
    }
  }
  VIEW_MAX_COL = bk_VIEW_MAX_COL;
  iterateArray = [];
  iterateArray = grid_List.pushIterateArray();
  var sub_name_array = [];      // all sub program name array

  var edit_list_info_data = [];
  var edit_list_info_level = 0;
  var edit_list_info_subnum = 0;
  init_copy_net();
  // add words of "RUNNING" or "STOP" to header character string
  var headert_elem = document.getElementById(HEADER_ID_LADDER_EDIT);
  getPmcRunStatus(g_pmc_no, function (pmc_num, status) {
    if (g_pmc_no == PMC_MEMORY_TYPE_DCS) {
      headert_elem.innerHTML = (status == PMC_RUNNING) ? headert + safety + pmc_lang_table['LadderEdit'].headert_5 + pmc_status_run : headert + safety + pmc_lang_table['LadderEdit'].headert_5 + pmc_status_stop;
    } else {
      headert_elem.innerHTML = (status == PMC_RUNNING) ? headert + g_pmc_no + pmc_lang_table['LadderEdit'].headert_5 + pmc_status_run : headert + g_pmc_no + pmc_lang_table['LadderEdit'].headert_5 + pmc_status_stop;
    }
  });

  if (id === 'screen_ladder_tree_edit') {
    // initialization of the draw start position
    g_disp_net_index = 0;
    g_disp_grid_index = 0;
    g_disp_width_index = 0;

    // close popup during the reading
    ladder_tree_edit_writing_flg = FLG_OFF;
    document.getElementById("popup_no_comfirm_1").style.display = "none";
    //set focus
    document.getElementById('treeEditMenu').disabled = false;
    set_tree_edit_focus();
    if (net_edit_move_flg === undefined) {
      Popdownbutton();
    }
  }
  else if (id === 'screen_ladder_replace') {
    g_search_replace_cnt = 0;
    iterateArray = [];
    iterateArray = grid_List.pushIterateArray();
  } else if (id === 'screen_ladder_search_replace') {
    scrollBoxPos.start_y = 0;
    scrollBoxPos.start_x = 0;
    g_search_replace_no_next_flg = FLG_OFF;
    g_search_replace_cnt = 0;
    iterateArray = [];
    iterateArray = grid_List.pushIterateArray();
  }

  if (net_edit_move_flg === undefined) {
    screen_id = SCREEN_LADDER_EDITOR;
    draw_figure(CANVAS_AREA_LADDER_EDITOR);
  }

  g_edit_menu = document.getElementById('symbolMenu_5').children;
  g_edit_menu_no = EDIT_MENU_SYMBOL;
  ladder_editor_reset_menu_no();
  ladder_editor_menu_bkcolor(g_tmp_menu_no);
  document.getElementById('screen_ladder_editor').style.display = 'block';
  document.getElementById('worldDiv').style.display = 'block';
  document.getElementById('function_button_5').style.display = 'block';
  document.getElementById('function_button_5_2').style.display = 'none';
  document.getElementById(id).style.display = 'none';
  document.onkeydown = ladder_editor_keydown;
  if (net_edit_move_flg === undefined) {
    get_pmc_data_from_server(PMC_DATA_LOAD_KIND.PMC_DATA_COMPARE);
  }
}

/*
 =========================================================================
 @function name               : push_list_info
 @argument [list_info_data]   : sequence information of list
 @argument [list_info_level]  : level information of list
 @argument [list_info_subnum] : Subnum information of list
 @description                 : push information of the list
 @return                      : none
 =========================================================================
*/
function push_list_info(list_kind, list_info_data, list_info_level, list_info_subnum) {
  wk_glist = copy_list_info(list_info_data);
  list_kind.push(wk_glist, list_info_level, list_info_subnum);
  wk_glist = [];
}

/*
 =========================================================================
 @function name             : copy_list_info
 @argument [list_info_data] : copy source information
 @description               : copy edit_List information
 @return [wk_glist]         : copy source information
 =========================================================================
*/
function copy_list_info(list_info_data) {
  var wk_glist = [];
  for (var iy = 0; iy < list_info_data.length; iy++) {
    wk_glist[iy] = [];
    for (var ix = 0; ix < list_info_data[iy].length; ix++) {
      wk_glist[iy][ix] = {};
      for (var key in list_info_data[iy][ix]) {
        wk_glist[iy][ix][key] = list_info_data[iy][ix][key];
      }
    }
  }
  return wk_glist;
}
/*
 =========================================================================
 @function name : ladder_editor_keydown
 @description   : processing in the case of pressed(clicked) hard key
 @return        : none
 =========================================================================
*/
function ladder_editor_keydown(event) {
  if (g_processing_flg === FLG_ON) {
    return;
  }
  var key_code = event.keyCode;
  var key_shift = event.shiftKey;
  var key_ctrl = event.ctrlKey;
  // invalidity of the key to notify a browser of
  invalidate_notification_key(event);

  // during popup is only close button valid
  if (g_popup_flg === FLG_ON) {
    switch (key_code) {
      case 52:  // function4 key(TP environment)
      case 115:  // function4 key
        closeDialog();
        break;   
      default:
        break;
    }
    return;
  }
  // if ((key_code == 9 || key_code == 33 || key_code == 34 || key_code == 38 || key_code == 40 || key_code == 37 || key_code == 39) && g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }

  switch (key_code) {
    case 9:  // keyboard up or keyboard down
      if (key_shift == false) {
        // keyboard down(TP environment)
        click_scroll_net_move(CANVAS_AREA_LADDER_EDITOR, ly = 0, KEYBOARD_DOWN);
      } else {
        // keyboard up(TP environment)
        click_scroll_net_move(CANVAS_AREA_LADDER_EDITOR, ly = 0, KEYBOARD_UP);
      }
      break;
    case 13:  // keyboard enter
      ladder_editor_click_f2_button();
      break;
    case 33:  // shift + keyboard up (PC PageUp)
      click_scroll_net_move(CANVAS_AREA_LADDER_EDITOR, ly = 0, KEYBOARD_SHIFT_UP);
      break;
    case 34:  // shift + keyboard down (PC PageDown)
      click_scroll_net_move(CANVAS_AREA_LADDER_EDITOR, ly = 0, KEYBOARD_SHIFT_DOWN);
      break;
    case 38:  // keyboard up
      click_scroll_net_move(CANVAS_AREA_LADDER_EDITOR, ly = 0, KEYBOARD_UP);
      break;
    case 40:  // keyboard down
      click_scroll_net_move(CANVAS_AREA_LADDER_EDITOR, ly = 0, KEYBOARD_DOWN);
      break;
    case 37:  // keyboard left
      if (key_shift == false) {
        click_scroll_grid_move_h(CANVAS_AREA_LADDER_EDITOR, ly = 0, KEYBOARD_LEFT);
      } else {
        click_scroll_grid_move_h(CANVAS_AREA_LADDER_EDITOR, ly = 0, KEYBOARD_SHIFT_LEFT);
      }
      break;
    case 39:  // keyboard right
      if (key_shift == false) {
        click_scroll_grid_move_h(CANVAS_AREA_LADDER_EDITOR, ly = 0, KEYBOARD_RIGHT);
      } else {
        click_scroll_grid_move_h(CANVAS_AREA_LADDER_EDITOR, ly = 0, KEYBOARD_SHIFT_RIGHT);
      }
      break;
    case 49:  // function1 key(TP environment)
      if (key_ctrl == true) {
        if (document.getElementById('function_button_5').style.display == 'block') {
          ladder_editor_click_f1_button();
        }
      }
      break;
    case 112:  // function1 key
      if (document.getElementById('function_button_5').style.display == 'block') {
        ladder_editor_click_f1_button();
      }
      break;
    case 50:  // function2 key(TP environment)
      if (key_ctrl == true) {
        if (document.getElementById('function_button_5').style.display == 'block') {
          ladder_editor_click_f2_button();
        } else  {
          ladder_editor_click_f7_button();
        }
      }
      break;
    case 113:  // function2 key
      if (document.getElementById('function_button_5').style.display == 'block') {
        ladder_editor_click_f2_button();
      } else  {
        ladder_editor_click_f7_button();
      }

      break;
    case 51:  // function3 key(TP environment)
      if (key_ctrl == true) {
        if (document.getElementById('function_button_5').style.display == 'block') {
          ladder_editor_click_f3_button();
        }
      }
      break;
    case 114:  // function3 key
      if (document.getElementById('function_button_5').style.display == 'block') {
        ladder_editor_click_f3_button();
      }
      break;
    case 52:  // function4 key(TP environment)
      if (key_ctrl == true) {
        if (document.getElementById('function_button_5').style.display == 'block') {
          ladder_editor_click_f4_button();
        } else  {
          ladder_editor_click_f9_button();
        }
      }
      break;
    case 115:  // function4 key
      if (document.getElementById('function_button_5').style.display == 'block') {
        ladder_editor_click_f4_button();
      } else  {
        ladder_editor_click_f9_button();
      }
      break;
    case 53:  // function5 key(TP environment)
      if (key_ctrl == true) {
        if (document.getElementById('function_button_5').style.display == 'block') {
          ladder_editor_click_f5_button();
        }
      }
      break;
    case 27:  // prev button(TP environment)
      if (document.getElementById('function_button_5').style.display == 'block') {
        ladder_editor_click_f5_button();
      } else  {
        ladder_editor_click_fnext_button();
      }
      break;
    case 116:  // function5 key
      if (document.getElementById('function_button_5').style.display == 'block') {
        ladder_editor_click_f5_button();
      }
      break;
    case 54:
      if (key_ctrl == true) {
        ladder_editor_click_fnext_button();
      }
      break;
    case 117:
      ladder_editor_click_fnext_button();
    default:
      break;
  }
}
/*
 =========================================================================
 @function name     : ladder_editor_reset_menu_no
 @argument          : none
 @description       : reset selected menu
 @return            : none
 =========================================================================
*/

function ladder_editor_reset_menu_no() {
  switch (g_edit_menu_no) {
    case EDIT_MENU_SYMBOL:
      g_tmp_menu_no = g_tmp_symbol_no_editor;
      break;
    case EDIT_MENU_SCALING:
      g_tmp_menu_no = g_tmp_scaling_no_editor;
      break;
    case EDIT_MENU_ACT:
      g_tmp_menu_no = g_tmp_func_no;
      break;
    case EDIT_MENU_NET:
      g_tmp_menu_no = g_tmp_net_no;
      break;
    default:
      return;
  }
}
/*
 =========================================================================
 @function name     : ladder_editor_menu_enter
 @argument          : none
 @description       : processing in the case of pushed down(clicked) enter key
 @return            : none
 =========================================================================
*/

function ladder_editor_menu_enter() {
  switch (g_edit_menu_no) {
    case EDIT_MENU_SYMBOL:
      ladder_editor_symbol_menu_button(g_tmp_menu_no);
      break;
    case EDIT_MENU_SCALING:
      ladder_editor_scaling_menu_button(g_tmp_menu_no);
      break;
    case EDIT_MENU_ACT:
      ladder_display_action_menu_button(g_tmp_menu_no);
      break;
    case EDIT_MENU_NET:
      ladder_action_menu_button(g_tmp_menu_no);
      break;
    default:
      return;
  }
}
/*
 =========================================================================
 @function name     : ladder_editor_menu_prev
 @argument          : none
 @description       : processing in the case of pushed down(clicked) prev key
 @return            : none
 =========================================================================
*/

function ladder_editor_menu_prev() {
  switch (g_edit_menu_no) {
    case EDIT_MENU_SYMBOL:
      ladder_editor_click_f7_button();
      break;
    case EDIT_MENU_SCALING:
      ladder_editor_click_f9_button();
      break;
    case EDIT_MENU_ACT:
      ladder_editor_click_f3_button();
      break;
    case EDIT_MENU_NET:
      ladder_editor_click_f4_button();
      break;
    default:
      return;
  }
}

/*
 =========================================================================
 @function name : ladder_editor_menu_keydown
 @argument      : none
 @description   : kind of key which pressed hardkey(displayed symbol menu)
 @return        : none
 =========================================================================
*/
function ladder_editor_menu_keydown(event) {
  var menu_top = 1;
  
  var key_code = event.keyCode;
  var key_shift = event.shiftKey;
  var key_ctrl = event.ctrlKey;
  // invalidity of the key to notify a browser of
  invalidate_notification_key(event);

  switch (key_code) {
  case 9:  // keyboard up or keyboard down
    if (key_shift == false) {
      // keyboard down(TP environment)
      g_tmp_menu_no += 1;
      if (g_tmp_menu_no < g_edit_menu.length) {
      } else {
        g_tmp_menu_no = menu_top;
      }
      ladder_editor_menu_bkcolor(g_tmp_menu_no);
    } else {
      // keyboard up(TP environment)
      g_tmp_menu_no -= 1;
      if (0 < g_tmp_menu_no) {
      } else {
        g_tmp_menu_no = g_edit_menu.length - 1;
      }
      ladder_editor_menu_bkcolor(g_tmp_menu_no);
    }
      break;
      case 49:  // 1 key
    case 97:  // 1 key
      if (key_ctrl == false) {
        g_tmp_menu_no = 1;
        if (g_tmp_menu_no > g_edit_menu.length - 1) {
          break;
        }
        ladder_editor_menu_bkcolor(g_tmp_menu_no);
      } else if (key_code == 49 && key_ctrl == true){
        if(g_edit_menu_no === EDIT_MENU_ACT || g_edit_menu_no === EDIT_MENU_NET){
          ladder_editor_click_f1_button();
        }
      }
      break;
    case 50:  // 2 key
    case 98:  // 2 key
      if (key_ctrl == false) {
        g_tmp_menu_no = 2;
        if (g_tmp_menu_no > g_edit_menu.length - 1) {
          break;
        }
        ladder_editor_menu_bkcolor(g_tmp_menu_no);
      } else if (key_code == 50 && key_ctrl == true){
        if(g_edit_menu_no === EDIT_MENU_ACT || g_edit_menu_no === EDIT_MENU_NET){
          ladder_editor_click_f2_button();
        }else if (g_edit_menu_no === EDIT_MENU_SYMBOL || g_edit_menu_no === EDIT_MENU_SCALING) {
          ladder_editor_click_f7_button();
        }
      }
      break;
    case 51:  // 3 key
    case 99:  // 3 key
      if (key_ctrl == false) {
        g_tmp_menu_no = 3;
        if (g_tmp_menu_no > g_edit_menu.length - 1) {
          break;
        }
        ladder_editor_menu_bkcolor(g_tmp_menu_no);
      } else if (key_code == 51 && key_ctrl == true){
        if(g_edit_menu_no === EDIT_MENU_ACT || g_edit_menu_no === EDIT_MENU_NET){
          ladder_editor_click_f3_button();
        }
      }
      break;
    case 52:  // 4 key
    case 100:  // 4 key
      if (key_ctrl == false) {
        g_tmp_menu_no = 4;
        if (g_tmp_menu_no > g_edit_menu.length - 1) {
          break;
        }
        ladder_editor_menu_bkcolor(g_tmp_menu_no);
      } else if (key_code == 52 && key_ctrl == true){
        if (g_edit_menu_no === EDIT_MENU_ACT || g_edit_menu_no === EDIT_MENU_NET) {
          ladder_editor_click_f4_button();
        } else if (g_edit_menu_no === EDIT_MENU_SYMBOL || g_edit_menu_no === EDIT_MENU_SCALING) {
          ladder_editor_click_f9_button();
        }  
      }
      break;
    case 53:  // 5 key
    case 101:  // 5 key
      if (key_ctrl == false) {
        g_tmp_menu_no = 5;
        if (g_tmp_menu_no > g_edit_menu.length - 1) {
          break;
        }
        ladder_editor_menu_bkcolor(g_tmp_menu_no);
      } else if (key_code == 53 && key_ctrl == true) {
        if (g_edit_menu_no === EDIT_MENU_ACT || g_edit_menu_no === EDIT_MENU_NET) {
          ladder_editor_click_f5_button();
        }
      }
      break;
    case 54:  // 6 key
    case 102:  // 6 key
      if (key_ctrl == false) {
        g_tmp_menu_no = 6;
        if (g_tmp_menu_no > g_edit_menu.length - 1) {
          break;
        }
        ladder_editor_menu_bkcolor(g_tmp_menu_no);
      } else if(key_code == 54 && key_ctrl == true) {
        ladder_editor_click_fnext_button();
      }
    break;
  case 13:  // enter
    ladder_editor_menu_enter();
    break;
  case 27:  // prev button(TP environment)
    ladder_editor_menu_prev();
    break;
  case 38:  // keyboard up
    g_tmp_menu_no -= 1;
    if (0 < g_tmp_menu_no) {
    } else {
      g_tmp_menu_no = g_edit_menu.length - 1;
    }
    ladder_editor_menu_bkcolor(g_tmp_menu_no);
    break;
  case 40:  // keyboard down
    g_tmp_menu_no += 1;
    if (g_tmp_menu_no < g_edit_menu.length) {
    } else {
      g_tmp_menu_no = menu_top;
    }
    ladder_editor_menu_bkcolor(g_tmp_menu_no);
    break;
  case 112:  // function1 key
    if (g_edit_menu_no === EDIT_MENU_ACT || g_edit_menu_no === EDIT_MENU_NET) {
      ladder_editor_click_f1_button();
    }
    break;
  case 113:  // function2 key
    if (g_edit_menu_no === EDIT_MENU_ACT || g_edit_menu_no === EDIT_MENU_NET) {
      ladder_editor_click_f2_button();
    }else if (g_edit_menu_no === EDIT_MENU_SYMBOL || g_edit_menu_no === EDIT_MENU_SCALING) {
      ladder_editor_click_f7_button();
    }
    break; 
  case 114:  // function3 key
  if (g_edit_menu_no === EDIT_MENU_ACT || g_edit_menu_no === EDIT_MENU_NET) {
    ladder_editor_click_f3_button();
    }
    break; 
  case 115:  // function4 key
   if (g_edit_menu_no === EDIT_MENU_ACT || g_edit_menu_no === EDIT_MENU_NET) {
      ladder_editor_click_f4_button();
    } else if (g_edit_menu_no === EDIT_MENU_SYMBOL || g_edit_menu_no === EDIT_MENU_SCALING) {
      ladder_editor_click_f9_button();
    }
    break;
  case 116:  // function5 key
    if (g_edit_menu_no === EDIT_MENU_ACT || g_edit_menu_no === EDIT_MENU_NET) {
      ladder_editor_click_f5_button();
    }
    break;
  case 117:
    ladder_editor_click_fnext_button();
    break;
  default:
    break;
  }
}
/*
 =========================================================================
 @function name          : ladder_editor_menu_bkcolor
 @argumen [g_tmp_menu_no]: menu number during the choice
 @description            : redraw with the information of the selected menu
 @return                 : none
 =========================================================================
*/

function ladder_editor_menu_bkcolor(g_tmp_menu_no) {
  for (var i = 1; i < g_edit_menu.length; i += 1) {
    g_edit_menu[i].style.backgroundColor = '#e1e7ec';
  }
  if (document.getElementById('func_menu_5_3').style.display === "block" || document.getElementById('func_menu_5_4').style.display === "block") {
    g_edit_menu[g_tmp_menu_no].style.backgroundColor = '#0e90b8';
    return;
  } else {
    g_edit_menu[g_tmp_menu_no].style.backgroundColor = '#0e90b8';
  }
}

/*
 =========================================================================
 @function name        : ladder_editor_symbol_menu_button
 @argument [symbol_no] : selected symbol
 @description          : redraw with the information of the selected symbol
 @return               : none
 =========================================================================
*/
function ladder_editor_symbol_menu_button(symbol_no) {
  document.getElementById('func_menu_5_7').style.display = 'none';
  document.getElementById('func_btn_5_7').innerHTML = func_btn_2inner;
  document.getElementById('worldDiv').style.zIndex = 2;
  g_symbol_flg = FLG_OFF;
  switch(symbol_no){
  case SYMBOL_KIND_ADDRESS:
  case SYMBOL_KIND_SYMBOL:
  case SYMBOL_KIND_ADDRESS_SYMBOL:
  case SYMBOL_KIND_COMMENT:
  case SYMBOL_KIND_ADDRESS_COMMENT:
  case SYMBOL_KIND_SYMBOL_COMMENT:
    break;
  default:
    return;
  }

  // update internal information
  select_symbol_button = symbol_no;
  g_tmp_symbol_no_editor = select_symbol_button;
  g_tmp_symbol_no = select_symbol_button;
  ladder_editor_menu_bkcolor(select_symbol_button);
  ladder_display_symbol_menu_bkcolor(select_symbol_button);

  // since the symbol information has been changed, redrawing
  draw_ladder_diagram(SCROLLBAR_ACTION_UP_BUTTON, CANVAS_AREA_LADDER_EDITOR);
  document.onkeydown = ladder_editor_keydown;
}

/*
 =========================================================================
 @function name : ladder_editor_click_f3_button
 @argument      : none
 @description   : processing in the case of pushed down(clicked) F3 key
 @return        : none
 =========================================================================
*/
function ladder_editor_click_f3_button() {
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }
  if (g_processing_flg === FLG_ON) {
    return;
  }
  if(document.getElementById('func_menu_5_4').style.display == 'block'){
    document.getElementById('func_menu_5_4').style.display = 'none';
    document.getElementById('func_btn_5_4').innerHTML = func_btn_4inner;
  }
  // function menu popup : display -> non-display
  if(document.getElementById('func_menu_5_3').style.display == 'block'){
    document.getElementById('func_menu_5_3').style.display = 'none';
    document.getElementById('func_btn_5_3').innerHTML = func_btn_3inner;
    document.getElementById('worldDiv').style.zIndex = 2;
    document.onkeydown = ladder_editor_keydown;
    g_symbol_flg = FLG_OFF;
  } else {
    document.onkeydown = ladder_editor_menu_keydown;
    g_edit_menu = document.getElementById('actMenu_5').children;
    g_edit_menu_no = EDIT_MENU_ACT;
    ladder_editor_reset_menu_no();

    // function menu popup : non-display -> display
    document.getElementById('func_menu_5_3').style.display = 'block';
    ladder_editor_menu_bkcolor(g_tmp_menu_no);
    func_btn_3inner = document.getElementById('func_btn_5_3').innerHTML;
    var rep5_4_1 = func_btn_3inner.replace("[","|");
    var rep5_4_2 = rep5_4_1.replace("]","|");
    document.getElementById('func_btn_5_3').innerHTML = rep5_4_2;
    document.getElementById('worldDiv').style.zIndex = 0;
    g_symbol_flg = FLG_ON;
  }
}

/*
 =========================================================================
 @function name     : ladder_display_action_menu_button
 @argument [act_no] : function selected by the function menu
 @description       : the function menu selection operation
 @return            : none
 =========================================================================
*/
function ladder_display_action_menu_button(act_no) {
  document.getElementById('func_menu_5_3').style.display = 'none';
  document.getElementById('func_btn_5_3').innerHTML = func_btn_3inner;
  document.getElementById('worldDiv').style.zIndex = 2;
  g_symbol_flg = FLG_OFF;
  switch(act_no){
  case FUNC_KIND_SEARCH:
    old_screen_id = SCREEN_LADDER_EDITOR;
    ladder_editor_menu_bkcolor(act_no);
    move_to_ladder_search('screen_ladder_editor');
    break;

  case FUNC_KIND_REPLACE:
    ladder_editor_menu_bkcolor(act_no);
    move_to_ladder_replace('screen_ladder_editor');
    break;

  case FUNC_KIND_SYMBOL_COMMENT:
    ladder_editor_menu_bkcolor(act_no);
    if (get_pmc_option_flg(PMC_OPTION_ES) === FLG_OFF) {
      move_to_symbol_comment_editor('screen_ladder_editor');
    } else {
      document.getElementById("popup_no_comfirm_5").style.display = "block";
      document.getElementById("poptitle").placeholder = "";
      document.getElementById("popcomment_5_1").style.display = "none";
      document.getElementById("popcomment_5_2").style.display = "none";
      document.getElementById("popcomment_5_3").style.display = "none";
      document.getElementById("popcomment_5_4").style.display = "none";
      document.getElementById("popcomment_5_5").style.display = "block";
      Popupbutton();
      document.onkeydown = ladder_editor_keydown;
    }
    break;

    default:
      document.onkeydown = ladder_editor_keydown;
    return;
  }
}

/*
 =========================================================================
 @function name     : ladder_action_menu_button
 @argument [net_no] : menu number during the choice
 @description       : the function menu selection operation
 @return            : none
 =========================================================================
*/

function ladder_action_menu_button(net_no) {
  document.getElementById('func_menu_5_4').style.display = 'none';
  document.getElementById('func_btn_5_4').innerHTML = func_btn_4inner;
  document.getElementById('worldDiv').style.zIndex = 2;
  document.onkeydown = ladder_editor_keydown;
  g_symbol_flg = FLG_OFF;
  switch(net_no){
    case FUNC_NET_COPY:
      ladder_editor_menu_bkcolor(net_no);
      ladder_net_copy();
      break;  
    case FUNC_NET_PASTE:
      ladder_editor_menu_bkcolor(net_no);
      ladder_net_paste();
      break;
    case FUNC_NET_INSERT:
      ladder_editor_menu_bkcolor(net_no);
      ladder_net_insert();
      break;
    case FUNC_NET_DELETE:
      ladder_editor_menu_bkcolor(net_no);
      ladder_net_delete();
      break;
    default:
      return;
    }
  if (net_no !== FUNC_NET_COPY) {
    set_g_array_update_flg(SCREEN_LADDER_EDITOR);
  }
}
/*
 =========================================================================
 @function name : ladder_editor_click_f5_button
 @argument      : none
 @description   : processing in the case of pushed down(clicked) F5 key
 @return        : none
 =========================================================================
*/
function ladder_editor_click_f5_button() {
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }
  if (g_processing_flg === FLG_ON) {
    return;
  }
  // in the case of opened the menu of function, close the menu
  if(document.getElementById('func_menu_5_3').style.display == 'block'){
    document.getElementById('func_menu_5_3').style.display = 'none';
    document.getElementById('func_btn_5_3').innerHTML = func_btn_3inner;
    document.getElementById('worldDiv').style.zIndex = 2;
    document.onkeydown = ladder_editor_keydown;
    g_symbol_flg = FLG_OFF;
    return;
  }
  if(document.getElementById('func_menu_5_4').style.display == 'block'){
    document.getElementById('func_menu_5_4').style.display = 'none';
    document.getElementById('func_btn_5_4').innerHTML = func_btn_4inner;
    document.getElementById('worldDiv').style.zIndex = 2;
    document.onkeydown = ladder_editor_keydown;
    g_symbol_flg = FLG_OFF;
    return;
  }

  // in the case of cancel, to destroy editing contents
  iterateArray = null;
  wk_glist = null;
  move_to_ladder_tree_edit("screen_ladder_editor");
  scrollBoxPos.start_y = 0;
  mnemo_write_array = JSON.parse(JSON.stringify(mnemonic_array)); //mnemonic_array is backup
  g_edit_lv_cnt_tbl = JSON.parse(JSON.stringify(g_lv_cnt_tbl));
  g_edit_sub_pg_tbl = JSON.parse(JSON.stringify(g_sub_pg_tbl));
  g_make_edit_grid_list_pos = JSON.parse(JSON.stringify(g_make_grid_list_pos));
  g_grid_edit_num_tbl = JSON.parse(JSON.stringify(g_grid_num_tbl));
  g_edit_all_grid_cnt = g_bk_edit_all_grid_cnt;
  g_bk_edit_all_grid_cnt = 0;

  initialize_g_array_update_flg(SCREEN_LADDER_EDITOR);
  initialize_g_array_update_flg(SCREEN_LADDER_NETEDIT);
  initialize_g_array_update_flg(SCREEN_LADDER_REPLACE);
  initialize_g_array_update_flg(SCREEN_LADDER_SEARCH_REPLACE);
}

/*
 =========================================================================
 @function name  : click_net
 @argument [evt] : event in the case of draw range is clicked
 @description    : choose net of the grid which clicked
 @return         : none
 =========================================================================
*/
function click_net(evt) {
  if ((g_popup_flg == FLG_ON) || (g_symbol_flg == FLG_ON) || (g_scaling_flg == FLG_ON) || (g_processing_flg == FLG_ON)) {
    return;
  }
  if (g_slide_scroll_flg == FLG_ON) {
    g_slide_scroll_flg = FLG_OFF;
    return;
  }
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }

  var lx_p = 0;
  var ly_p = 0;

  var lx = 0;
  var ly = 0;
  var rect = evt.target.getBoundingClientRect();

  if (screen_id == SCREEN_LADDER_SEARCH_RESULT_LIST) {
    var current_level = get_ladder_search_range();
    var use_lv_cnt_tbl = JSON.parse(JSON.stringify(g_lv_cnt_tbl));
    var use_sub_pg_tbl = JSON.parse(JSON.stringify(g_sub_pg_tbl));
    var use_grid_num_tbl = JSON.parse(JSON.stringify(g_search_result_list_grid_num));
    var use_net_num_tbl = JSON.parse(JSON.stringify(g_result_list_net_num_tbl));
  } else {
    var current_level = get_ladder_tree_edit_level();
    var use_lv_cnt_tbl = JSON.parse(JSON.stringify(g_edit_lv_cnt_tbl));
    var use_sub_pg_tbl = JSON.parse(JSON.stringify(g_edit_sub_pg_tbl));
    var use_grid_num_tbl = JSON.parse(JSON.stringify(g_grid_edit_num_tbl));
    var use_net_num_tbl = JSON.parse(JSON.stringify(g_net_num_tbl));
  }

  if (screen_id == SCREEN_LADDER_SEARCH_RESULT_LIST) {
    var current_level_net_cnt = g_search_result_list_grid_num.length;
  } else if (current_level <= 3 && current_level > 0) {
    var current_level_net_cnt = use_lv_cnt_tbl[Number(current_level) - 1].net_cnt;
  } else if (current_level >= 4) {
    var current_level_net_cnt = use_sub_pg_tbl[Number(current_level) - 4].net_cnt;
  } else {
    current_level_net_cnt = mnemonic_array[mnemonic_array.length - 1].net_num - 1;
  }

  lx = evt.clientX - rect.left;
  ly = evt.clientY - rect.top;

  // the acquisition of the canvas drawing domain
  var drawing_area_info = document.getElementById('canvas_area');
  var drawing_area_width = drawing_area_info.attributes.width.nodeValue;
  var drawing_area_height = drawing_area_info.attributes.height.nodeValue;

  // offset to ajust the draw position(line of both ends of the ladder diagram)
  var canvas_x_offset = 10;
  if (g_scroll_chg_flg == FLG_OFF) { // using iPendant or opboard screen
    var canvas_x_offset_2 = 54;
    var canvas_y_offset = 16;
  } else {
    var canvas_x_offset_2 = 10;
    var canvas_y_offset = 20;
  }

  // calculate size for 1 grid
  var grid_x_size = (drawing_area_width - canvas_x_offset - canvas_x_offset_2 - 10) / VIEW_GRID_COL;
  var grid_y_size = (drawing_area_height - canvas_y_offset) / VIEW_GRID_ROW;

  // quadrangle drawing coordinate
  g_selected_element_x = Math.floor((lx - canvas_x_offset) / grid_x_size);
  g_selected_element_y = Math.floor(ly / grid_y_size);
  g_selected_element_x = g_selected_element_x + g_disp_width_index;
  g_selected_element_y = g_selected_element_y + g_disp_grid_index;


  net_index = use_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
  grid_index = g_selected_element_y;

  var click_x_invalid = evt.clientX;
  if (click_x_invalid < window.innerWidth && click_x_invalid > window.innerWidth - 50) {
    return;
  }

  // acquire element and calculate net position pressed
  if (current_level_net_cnt <= g_disp_net_index + 1) {
    return;
  }
  var bk_g_disp_net_index = g_disp_net_index;
  if (screen_id == SCREEN_LADDER_SEARCH_RESULT_LIST || screen_id == SCREEN_LADDER_EDITOR) {
    if (screen_id == SCREEN_LADDER_SEARCH_RESULT_LIST) {
      ly_net_p = use_grid_num_tbl[g_disp_net_index];
    } else {
      ly_net_p = use_grid_num_tbl[g_net_cnt_before_tree + g_disp_net_index];
    }
    for (k = 0; k < grid_index + 1; k++) {
      if (grid_index + 1 <= ly_net_p) {
        if (screen_id == SCREEN_LADDER_SEARCH_RESULT_LIST) {
          ly_net_p -= use_grid_num_tbl[g_disp_net_index];
        } else {
          ly_net_p -= use_grid_num_tbl[g_net_cnt_before_tree + g_disp_net_index];
        }
        break;
      }
      g_disp_net_index++;
      if (screen_id == SCREEN_LADDER_SEARCH_RESULT_LIST) {
        ly_net_p += use_grid_num_tbl[g_disp_net_index];
      } else {
        ly_net_p += use_grid_num_tbl[g_net_cnt_before_tree + g_disp_net_index];
      }
    }
  
    // return if involved at a place beyond net_length
    if (current_level_net_cnt <= g_disp_net_index) {
      g_disp_net_index = bk_g_disp_net_index;
      return;
    }
    g_selected_net_edit_index = g_disp_net_index;
    if (screen_id == SCREEN_LADDER_SEARCH_RESULT_LIST) {
      if (use_net_num_tbl[g_net_end_count - 1] > g_disp_net_index) {// Only blue flame moves
        g_disp_net_index = bk_g_disp_net_index;
      } else if (use_net_num_tbl[g_net_end_count - 1] == g_disp_net_index) {// touch display last net
        ly_net_p = 0;
      }
    } else {
      if (use_net_num_tbl[g_net_end_count - 1] - g_net_cnt_before_tree > g_disp_net_index) {// Only blue flame moves
        g_disp_net_index = bk_g_disp_net_index;
      } else if (use_net_num_tbl[g_net_end_count - 1] - g_net_cnt_before_tree == g_disp_net_index) {// touch display last net
        ly_net_p = 0;
      }
    }  
  } else {
    var length_cnt = use_grid_num_tbl[g_net_cnt_before_tree + g_disp_net_index];
    for (k = 0; k < grid_index + 1; k++){
      if (grid_index + 1 <= length_cnt) {
        length_cnt -= use_grid_num_tbl[g_net_cnt_before_tree + g_disp_net_index];
        break;
      }
      g_disp_net_index++;
      length_cnt += use_grid_num_tbl[g_net_cnt_before_tree + g_disp_net_index];
    }
  
    // return if involved at a place beyond net_length
    if (current_level_net_cnt <= g_disp_net_index) {
      g_disp_net_index = bk_g_disp_net_index;
      return;
    }
  }
  g_disp_grid_index = 0;

  scrollBoxPos.start_y = SBHV_POS_E + scrollBoxPos.box_height * g_disp_net_index;
  if (screen_id === SCREEN_LADDER_EDITOR) {
    draw_ladder_diagram(SCROLLBAR_ACTION_ANY, CANVAS_AREA_LADDER_EDITOR);
  } else if (screen_id === SCREEN_LADDER_SEARCH_RESULT && old_screen_id === SCREEN_LADDER_EDITOR) {
    g_search_hit_square_disp_flag = FLG_ON;
    draw_ladder_diagram(SCROLLBAR_ACTION_ANY,CANVAS_AREA_LADDER_SEARCH_RESULT);
  } else if (screen_id === SCREEN_LADDER_SEARCH_RESULT_LIST) {
    draw_ladder_diagram(SCROLLBAR_ACTION_ANY,CANVAS_AREA_LADDER_SEARCH_RESULT_LIST);
  } else if (screen_id === SCREEN_LADDER_SEARCH_REPLACE) {
    g_search_hit_square_disp_flag = FLG_ON;
    draw_ladder_diagram(SCROLLBAR_ACTION_ANY,CANVAS_AREA_LADDER_SEARCH_REPLACE);
  } else { }

}
/*
 =========================================================================
 @function name     : delete_line_only_net
 @argument          : none
 @description       : delete net only for horizontal line
 @return            : none
 =========================================================================
*/

function delete_line_only_net() {
  var net_index = grid_List.length -1;

  grid_List.forEach_hsre(net_index, iterateArray, function(data, i, level, subnum){
    if (data.length === 1 && grid_List.getDataNum(i ,iterateArray)[0][0].FigNo === IMAGENO9_LINE) {
      grid_List.remove(i);
    }
  });
}
// end of file                                                                                                                                                                        /*
 * @fileoverview : PMC Ladder iHMI ladder program element edit script
 * @char-code    : SJIS
 * @NewLineCode  : LF
 */

/**
  Constant definition
**/
var HEADER_ID_LADDER_ELEM_EDIT = "headert_8";

/**
  Global(Only this file)
**/

/*
 =========================================================================
 @function name : move_to_ladder_element_editor
 @argument [id] : the element id of the origin of transition
 @description   : ladder element editor transition API
 @return        : none
 =========================================================================
*/
function move_to_ladder_element_editor(id) {
  // add words to header character string(running or stopped)
  var headert_elem = document.getElementById(HEADER_ID_LADDER_ELEM_EDIT);
  getPmcRunStatus(g_pmc_no, function (pmc_num, status) {
    if (g_pmc_no == PMC_MEMORY_TYPE_DCS) {
      headert_elem.innerHTML = (status == PMC_RUNNING) ? headert + safety + pmc_lang_table['LadderElemEdit'].headert_8 + pmc_status_run : headert + safety + pmc_lang_table['LadderElemEdit'].headert_8 + pmc_status_stop;
    } else {
      headert_elem.innerHTML = (status == PMC_RUNNING) ? headert + g_pmc_no + pmc_lang_table['LadderElemEdit'].headert_8 + pmc_status_run : headert + g_pmc_no + pmc_lang_table['LadderElemEdit'].headert_8 + pmc_status_stop;
    }
  });

  document.activeElement.blur();
  document.getElementById('screen_ladder_element_editor').style.display = 'block';
  document.getElementById('worldDiv').style.display = 'none';
  document.getElementById(id).style.display = 'none';
  document.onkeydown = ladder_element_editor_keydown;
  get_pmc_data_from_server(PMC_DATA_LOAD_KIND.PMC_DATA_COMPARE);
}

/*
 =========================================================================
 @function name : ladder_element_editor_keydown
 @argument      : none
 @description   : processing at the time of the hard key pressing
 @return        : none
 =========================================================================
*/
function ladder_element_editor_keydown(event) {
  var key_code = event.keyCode;
  var key_ctrl = event.ctrlKey;
  var key_shift = event.shiftKey;
  // notify a browser to invalidity of the key
  invalidate_notification_key(event);

  // during popup is only close button valid
  if (g_popup_flg === FLG_ON) {
    switch (key_code) {
      case 52:  // function4 key(TP environment)
      case 115:  // function4 key
        closeDialog();
        break;   
      default:
        break;
    }
    return;
  }

  switch (key_code) {
  case 49:  // function1 key(TP environment)
    if (key_ctrl == true) {
      ladder_element_editor_click_f1_button();
    }
    break;
  case 112:  // function1 key
    ladder_element_editor_click_f1_button();
      break;
  case 53:  // function5 key(TP environment)
    if (key_ctrl == true) {
      ladder_element_editor_click_f5_button();
    }
    break;
  case 27:  // prev button(TP environment)
  case 116:  // function5 key
    ladder_element_editor_click_f5_button();
    break;
  case 13:  // enter key
    if(g_device === "smt") document.activeElement.blur();
    break;
  default:
    break;
  }
}

/*
 =========================================================================
 @function name : ladder_element_editor_click_f1_button
 @argument      : none
 @description   : F1 key click processing
 @return        : none
 =========================================================================
*/
function ladder_element_editor_click_f1_button() {
  screen_id = SCREEN_LADDER_ELEMENT_EDITOR;
  // input check start
  var elem_addr_str_new = document.getElementById('intbox.inbox.elem.addr').value;
  if(elem_addr_str_new.trim().length > 0){
    // character count check
    if(elem_addr_str_new.trim().length < 9){
      // character string check
      if (elem_addr_str_new.match(/[^A-TX-Za-tx-z0-9\.]/g)) {
          document.getElementById("popup_no_comfirm_8").style.display = "block";
          document.getElementById("poptitle").placeholder = "";
          document.getElementById("popcomment_8_1").style.display = "none";
          document.getElementById("popcomment_8_2").style.display = "block";
          document.getElementById("popcomment_8_3").style.display = "none";
          Popupbutton();
      } else if (!elem_addr_str_new.match(/^[A-TX-Za-tx-z]{1}[0-9]{0,5}\.[0-9]{1}$/)) {
        document.getElementById("popup_no_comfirm_8").style.display = "block";
        document.getElementById("poptitle").placeholder = "";
        document.getElementById("popcomment_8_1").style.display = "none";
        document.getElementById("popcomment_8_2").style.display = "none";
        document.getElementById("popcomment_8_3").style.display = "block";
        Popupbutton();
      } else {
        // input check OK
        // character string correction
        if (elem_addr_str_new.match(/[A-TX-Za-tx-z]{1}[0-9]{0,3}\.[0-9]{1}$/)) {
          var char_kind = elem_addr_str_new.substr(0, 1);
          var addr_num = elem_addr_str_new.substr(1);
          var addr_num4 = ('0000' + addr_num).slice(-6);
          elem_addr_str_new = char_kind + addr_num4;
        }
        if (elem_addr_str_new.match(/[A-TX-Za-tx-z]{1}[0-9]{5}\.[0-9]{1}$/)) {
          if (elem_addr_str_new.substr(1, 1) === '0') {
            document.getElementById("popup_no_comfirm_8").style.display = "block";
            document.getElementById("poptitle").placeholder = "";
            document.getElementById("popcomment_8_1").style.display = "none";
            document.getElementById("popcomment_8_2").style.display = "none";
            document.getElementById("popcomment_8_3").style.display = "block";
            Popupbutton();
            return;
          }
        }
        elem_addr_str_new = elem_addr_str_new.toUpperCase();
        var elem_address_table = elem_addr_addition(elem_addr_str_new);
        var addr_check_result = replace_address_check(elem_address_table);
        if (addr_check_result === FLG_ON) {
          // replace address of the display structure
          if (elem_addr_str_old === grid_List.getData(0)[g_selected_element_y][g_selected_element_x].Address) {
              grid_List.setDataAddress(elem_address_table[0], 0, g_selected_element_y, g_selected_element_x);
          }
          move_to_ladder_net_edit("screen_ladder_element_editor");
        } else {
          document.getElementById("popup_no_comfirm_8").style.display = "block";
          document.getElementById("poptitle").placeholder = "";
          document.getElementById("popcomment_8_1").style.display = "none";
          document.getElementById("popcomment_8_2").style.display = "none";
          document.getElementById("popcomment_8_3").style.display = "block";
          Popupbutton();
        }
      }
    } else {
      document.getElementById("popup_no_comfirm_8").style.display="block";
      document.getElementById("poptitle").placeholder = "";
      document.getElementById("popcomment_8_1").style.display="none";
      document.getElementById("popcomment_8_2").style.display="block";
      document.getElementById("popcomment_8_3").style.display="none";
      Popupbutton();
    }
  } else {
    // when replace character string non-input popup
    document.getElementById("popup_no_comfirm_8").style.display="block";
    document.getElementById("poptitle").placeholder = "";
    document.getElementById("popcomment_8_1").style.display="block";
    document.getElementById("popcomment_8_2").style.display="none";
    document.getElementById("popcomment_8_3").style.display="none";
    Popupbutton();
  }
  // text inputting is invalid at the time of the popup indication
  if (g_popup_flg === FLG_ON) {
    document.getElementById('intbox.inbox.elem.addr').disabled = "true";
  } else {
    document.getElementById('intbox.inbox.elem.addr').disabled = "";
  }
}

/*
 =========================================================================
 @function name : ladder_element_editor_click_f5_button
 @argument      : none
 @description   : F5 key click processing
 @return        : none
 =========================================================================
*/
function ladder_element_editor_click_f5_button() {
  move_to_ladder_net_edit("screen_ladder_element_editor", FLG_ON);
}

/*
 =========================================================================
 @function name          : elem_addr_check
 @argument [dataview]    : address conversion table
 @argument [char_kind]   : top letter of the address
 @argument [addr_num_16] : second character - fifth character or second character - sixth character to a hexadecimal number
 @description            : unjust address check function
 @return [0/-1]          : within range/out of range
 =========================================================================
*/
function elem_addr_check(dataview,char_kind,addr_num_16){
  var tebleoffset = 0x1AC + DEFMEM;
  // acquire a letter from a address conversion table
  var position = dataview.getUint32(tebleoffset,true)+DEFMEM;  // address conversion table start position
  var teblelength = dataview.getUint32(position,true);
  // address range check
  for (var i = 0; i < (teblelength); i++) {
    if(char_kind === String.fromCharCode(dataview.getUint16(position+6,true))){
      if(addr_num_16 >= dataview.getUint32(position+16,true) && addr_num_16 < (dataview.getUint32(position+16,true) + dataview.getUint32(position+12,true))){
        new_vaddress_nobit = (addr_num_16 - dataview.getUint32(position+16,true)) + dataview.getUint32(position+8,true);
        return 0;
      }
    }
  position+=16;
  }
  return -1;
}

/*
 =========================================================================
 @function name                   : elem_addr_addition
 @argument [elem_addr_str_new]    : address conversion object
 @description                     : unjust address check function
 @return [0/-1]                   : within range/out of range
 =========================================================================
*/
function elem_addr_addition(elem_addr_str_new) {
  var tree_level = Number(get_ladder_tree_edit_level());
  var replace_level = Number(get_ladder_replace_range());
  var sub_program_tree_level = 4;
  var char_kind = elem_addr_str_new.substr(0, 1);
  var address_num = elem_addr_str_new.split(char_kind)[1];
  var elem_address_table = [elem_addr_str_new];

  if (screen_id === SCREEN_LADDER_REPLACE || screen_id === SCREEN_LADDER_SEARCH_REPLACE) {
    if (tree_level !== replace_level) {
      tree_level = replace_level;
    }
  }
  if (tree_level === 2 || sub_program_tree_level <= tree_level) {
    if (char_kind === "X") {
      var add_char_kind = "V";
      var add_address = add_char_kind + address_num;
      elem_address_table.push(add_address);
    } else if (char_kind === "F") {
      var add_char_kind = "U";
      var add_address = add_char_kind + address_num;
      elem_address_table.push(add_address);
    } else if (char_kind === "M") {
      var add_char_kind = "W";
      var add_address = add_char_kind + address_num;
      elem_address_table.push(add_address);
    }
  }
  return elem_address_table;
}

// end of file
                                                                                                                                             L A D D E  R _ E R R O   R _ LADDER~5JS    eXeX eXh7  BI T . J S      L A D D E  R _ N E T _   E D LADDER~6JS    eXeX eX'w BE . J S      L A D D E  R _ R E P L   A C LADDER~7JS    eXeX eXR  B. J S    q  L A D D E  qR _ S E A R   C H LADDER~8JS    eXeX eX+ B_ R E P L  QA C E . J S     L A D D E  QR _ S E A R   C H LADDER~9JS    eXeX eX1p  B_ R E S U  L T . J S     L A D D E  R _ S E A R   C H /*
 * @fileoverview : PMC Ladder iHMI error pmc read script
 * @char-code    : SJIS
 * @NewLineCode  : LF
 */

/**
  Constant definition
**/
var SCREEN_ID_ERROR_PMC_READ = "screen_ladder_error_pmc_read";
var TEXT_AREA_ID_ERROR_PMC_READ_AREA = "ladder_error_pmc_read_area";
var HEADERT_ERROR_PMC_READ = "headert_error_pmc_read";
/**
  Global(Only this file)
**/
var g_wk_err_type = null;

/*
 =========================================================================
 @function name       : move_to_error_pmc_read
 @argument [err_type] : error kind
 @description         : PMC read error screen transition API
 @return              : none
 =========================================================================
*/
function move_to_error_pmc_read(err_type) {
  var headert_elem = document.getElementById(HEADERT_ERROR_PMC_READ);
  if (g_pmc_no === PMC_MEMORY_TYPE_DCS) {
    headert_elem.innerHTML = headert + safety + pmc_lang_table['PMC_Read_Error'].headert_error_pmc_read;
  } else {
    headert_elem.innerHTML = headert + g_pmc_no + pmc_lang_table['PMC_Read_Error'].headert_error_pmc_read;
  }
  document.getElementById("popup_no_comfirm_9").style.display="none";
  document.getElementById("popcomment_9_1").style.display="none";
  document.getElementById("popcomment_9_2").style.display = "none";
  Popdownbutton();
  document.getElementById('screen_ladder_tree').style.display = 'none';
  ladder_error_pmc_read_disp(err_type);  
  document.onkeydown = ladder_error_pmc_read_keydown;
  document.getElementById(SCREEN_ID_ERROR_PMC_READ).style.display = 'block';

  if (DEBUG_PAGE_SW === 1) {
    g_wk_err_type = err_type;
    document.getElementById(SCREEN_ID_LADDER_DEBUG_LOG_PAGE).style.display = 'none';
    document.getElementById(SCREEN_ID_LADDER_DEBUG_IF_TEST_PAGE).style.display = 'none';
  }
  ladder_error_pmc_read_pmc_menu_tmp(g_pmc_no);
  setTimeout(function () {
    g_processing_flg = FLG_OFF;
    if (top.tpkeyssheet !== undefined) {
      if (g_device === "smt") {
        top.tpkeyssheet.document.addEventListener('touchstart', ladder_keysheet_click);
        top.tpkeyssheet.document.addEventListener('touchend', ladder_keysheet_click);
      } else {
        top.tpkeyssheet.document.addEventListener('mousedown', ladder_keysheet_click);
        top.tpkeyssheet.document.addEventListener('mouseup', ladder_keysheet_click);
      }
    }
  }, 10);

}

/*
 =========================================================================
 @function name : ladder_error_pmc_read_keydown
 @argument      : none
 @description   : processing in the case of pressed(clicked) hard key
                 (at the time of the menu non-display)
 @return        : none
 =========================================================================
*/
function ladder_error_pmc_read_keydown(event) {
  var key_code = event.keyCode;
  var key_ctrl = event.ctrlKey;
  // notify a browser to invalidity of the key
  invalidate_notification_key(event);

  switch (key_code) {
  case 49:  // function1 key(TP environment)
    if (key_ctrl == true) {
      ladder_error_pmc_read_click_f1_button();
    }
    break;
  case 50:
    if  (key_ctrl == true) {
      ladder_error_pmc_read_click_f2_button();
    }
    break;
  case 112:  // function1 key
    ladder_error_pmc_read_click_f1_button();
    break;
  case 113:
  ladder_error_pmc_read_click_f2_button();
    break;
  default:
    break;
  }
}

/*
 =========================================================================
 @function name : ladder_error_pmc_read_keydown
 @argument      : none
 @description   : processing in the case of pressed(clicked) hard key
                  (at the time of PMC menu indication)
 @return        : none
 =========================================================================
*/
function  ladder_error_pmc_read_pmcmenu_keydown(event) {
  var key_code = event.keyCode;
  var key_shift = event.shiftKey;
  var key_ctrl = event.ctrlKey;
  // notify a browser to invalidity of the key
  invalidate_notification_key(event);

  switch (key_code) {
  case 9:  // keyboard up or keyboard down
    if (key_shift == false) {
      // keyboard down(TP environment)
      g_tmp_pmc_no = multiple_pmc_down(g_tmp_pmc_no);
      ladder_tree_pmc_menu_tmp(g_tmp_pmc_no);
      ladder_error_pmc_read_pmc_menu_tmp(g_tmp_pmc_no);
    } else {
      // keyboard up(TP environment)
      g_tmp_pmc_no = multiple_pmc_up(g_tmp_pmc_no);
      ladder_tree_pmc_menu_tmp(g_tmp_pmc_no);
      ladder_error_pmc_read_pmc_menu_tmp(g_tmp_pmc_no);
    }
      break;
      case 49:  // 1 key
      case 97:  // 1 key
        if (key_ctrl == false) {
          g_tmp_pmc_no = 1;
          ladder_tree_pmc_menu_tmp(g_tmp_pmc_no);
          ladder_error_pmc_read_pmc_menu_tmp(g_tmp_pmc_no);
          } else if (key_code == 49 && key_ctrl == true) {
            ladder_error_pmc_read_click_f1_button();
          }
        break;
      case 50:  // 2 key
      case 98:  // 2 key
        if (key_ctrl == false) {
          g_tmp_pmc_no = 2;
          ladder_tree_pmc_menu_tmp(g_tmp_pmc_no);
          ladder_error_pmc_read_pmc_menu_tmp(g_tmp_pmc_no);
          }else if (key_code == 50 && key_ctrl == true) {
            ladder_error_pmc_read_click_f2_button();
          }
        break;
      case 51:  // 3 key
      case 99:  // 3 key
        if (key_ctrl == false) {
          g_tmp_pmc_no = 3;
          ladder_tree_pmc_menu_tmp(g_tmp_pmc_no);
          ladder_error_pmc_read_pmc_menu_tmp(g_tmp_pmc_no);
          }
        break;
      case 52:  // 4 key
      case 100:  // 4 key
        if (key_ctrl == false) {
          g_tmp_pmc_no = 4;
          ladder_tree_pmc_menu_tmp(g_tmp_pmc_no);
          ladder_error_pmc_read_pmc_menu_tmp(g_tmp_pmc_no);
          }
        break;
      case 53:  // 5 key
      case 101:  // 5 key
        if (key_ctrl == false) {
          g_tmp_pmc_no = 5;
          ladder_tree_pmc_menu_tmp(g_tmp_pmc_no);
          ladder_error_pmc_read_pmc_menu_tmp(g_tmp_pmc_no);
          }
        break;
      case 54:  // 6 key
      case 102:  // 6 key
        if (key_ctrl == false) {
          g_tmp_pmc_no = 6;
          ladder_tree_pmc_menu_tmp(g_tmp_pmc_no);
          ladder_error_pmc_read_pmc_menu_tmp(g_tmp_pmc_no);
          }
      break;  
  case 13:  // enter
    ladder_error_pmc_menu_button(g_tmp_pmc_no);
    break;
  case 27:  // prev button(TP environment)
    ladder_error_pmc_read_click_f2_button();
    break;
  case 38:  // keyboard up
    g_tmp_pmc_no = multiple_pmc_up(g_tmp_pmc_no);
    ladder_tree_pmc_menu_tmp(g_tmp_pmc_no);
    ladder_error_pmc_read_pmc_menu_tmp(g_tmp_pmc_no);
    break;
  case 40:  // keyboard down
    g_tmp_pmc_no = multiple_pmc_down(g_tmp_pmc_no);
    ladder_tree_pmc_menu_tmp(g_tmp_pmc_no);
    ladder_error_pmc_read_pmc_menu_tmp(g_tmp_pmc_no);
    break;
  case 112:  // function1 key
    ladder_error_pmc_read_click_f1_button();
    break;
  case 113:  // function2 key
    ladder_error_pmc_read_click_f2_button();
    break; 
  default:
    break;
  }
}

/*
 =========================================================================
 @function name : ladder_error_pmc_read_click_f1_button
 @argument      : none
 @description   : F1 key click processing
 @return        : none
 =========================================================================
*/
function ladder_error_pmc_read_click_f1_button() {
  if (document.getElementById('func_menu_error_pmc_read').style.display == 'block') {
    document.getElementById('func_menu_error_pmc_read').style.display = 'none';
    document.getElementById('func_btn_error_pmc_read_2').innerHTML = func_btn_2inner;
    ladder_tree_pmc_menu_tmp(g_pmc_no);
    ladder_error_pmc_read_pmc_menu_tmp(g_pmc_no);
    document.onkeydown = ladder_error_pmc_read_keydown;
    return;
  } else {
    // display the last file if push down F1
    g_tmp_pmc_no = g_prev_pmc;
    g_pmc_no = g_prev_pmc;
    pmc_menu_button_processing(g_pmc_no);
  }
}

/*
 =========================================================================
 @function name : ladder_error_pmc_read_click_f2_button
 @argument      : none
 @description   : F2 key click processing
 @return        : none
 =========================================================================
*/
function ladder_error_pmc_read_click_f2_button() {
  if (document.getElementById('func_menu_error_pmc_read').style.display == 'block') {
    document.getElementById('func_menu_error_pmc_read').style.display = 'none';
    document.getElementById('func_btn_error_pmc_read_2').innerHTML = func_btn_2inner;
    ladder_error_pmc_read_pmc_menu_tmp(g_tmp_pmc_no);
    document.onkeydown = ladder_error_pmc_read_keydown;
  } else {
    document.getElementById('func_menu_error_pmc_read').style.display = 'block';
    func_btn_2inner = document.getElementById('func_btn_error_pmc_read_2').innerHTML;
    var rep9_2_1 = func_btn_2inner.replace("[", "|");
    var rep9_2_2 = rep9_2_1.replace("]", "|");
    document.getElementById('func_btn_error_pmc_read_2').innerHTML = rep9_2_2;
    document.onkeydown = ladder_error_pmc_read_pmcmenu_keydown;
  
    g_tmp_pmc_no = g_pmc_no;
  }
}

/*
 =========================================================================
 @function name       : ladder_error_pmc_read_disp
 @argument [err_type] : error kind
 @description         : display a PMC read error to a screen
 @return              : none
 =========================================================================
*/
function ladder_error_pmc_read_disp(err_type) {

  var sentence_elem = document.getElementById(TEXT_AREA_ID_ERROR_PMC_READ_AREA);
  sentence_elem.value = "";

  sentence_elem.value += dispcomment_error_pmc_read_1 + "\n" + "\n";
  sentence_elem.value += pmc_read_error_list[err_type].error_comment + "\n" + "\n";
  if (g_pmc_no != 6) {
    sentence_elem.value += headert + multi_pmc_type + " : " + headert + g_pmc_no;
  } else {
    sentence_elem.value += headert + multi_pmc_type + " : " + safety_pmc + headert;
  }

}

/*
 =========================================================================
 @function name              : ladder_error_pmc_read_pmc_menu_tmp
 @argument [pmc_memory_type] : the PMC-No which was chosen
 @description                : change a background color of the selected PMC-No
 @return                     : none
 =========================================================================
*/
function ladder_error_pmc_read_pmc_menu_tmp(pmc_memory_type) { 
  document.getElementById('pmcMenu_error_pmc_read1').style.backgroundColor = COLOR_LIGHT_GRAY;
  document.getElementById('pmcMenu_error_pmc_read2').style.backgroundColor = COLOR_LIGHT_GRAY;
  document.getElementById('pmcMenu_error_pmc_read3').style.backgroundColor = COLOR_LIGHT_GRAY;
  document.getElementById('pmcMenu_error_pmc_read4').style.backgroundColor = COLOR_LIGHT_GRAY;
  document.getElementById('pmcMenu_error_pmc_read5').style.backgroundColor = COLOR_LIGHT_GRAY;
  document.getElementById('pmcMenu_error_pmc_read6').style.backgroundColor = COLOR_LIGHT_GRAY;
  switch (pmc_memory_type) {
    case PMC_MEMORY_TYPE_1:
      document.getElementById('pmcMenu_error_pmc_read1').style.backgroundColor = '#0e90b8';
      break;
    case PMC_MEMORY_TYPE_2:
      document.getElementById('pmcMenu_error_pmc_read2').style.backgroundColor = '#0e90b8';
      break;
    case PMC_MEMORY_TYPE_3:
      document.getElementById('pmcMenu_error_pmc_read3').style.backgroundColor = '#0e90b8';
      break;
    case PMC_MEMORY_TYPE_4:
      document.getElementById('pmcMenu_error_pmc_read4').style.backgroundColor = '#0e90b8';
      break;
    case PMC_MEMORY_TYPE_5:
      document.getElementById('pmcMenu_error_pmc_read5').style.backgroundColor = '#0e90b8';
      break;
    case PMC_MEMORY_TYPE_DCS:
      document.getElementById('pmcMenu_error_pmc_read6').style.backgroundColor = '#0e90b8';
      break;
    default:
      break;
  }
}

/*
 =========================================================================
 @function name     : ladder_error_pmc_menu_button
 @argument [pmc_no] : the PMC-No. which was chosen
 @description       : reading of the selected PMC-No
 @return            : none
 =========================================================================
*/
function ladder_error_pmc_menu_button(pmc_no) {
  ladder_error_pmc_read_click_f2_button();
  if (g_pmc_no != pmc_no) {
    g_pmc_no = pmc_no;
    pmc_menu_button_processing(pmc_no);
  }
}

/*
 =========================================================================
 @function name     : pmc_menu_button_processing
 @argument [pmc_no] : the PMC-No. which was chosen
 @description       : processing at the time of the menu button pressing
 @return            : none
 =========================================================================
*/
function pmc_menu_button_processing(pmc_no) {
  document.getElementById(SCREEN_ID_ERROR_PMC_READ).style.display = 'none';
  if (DEBUG_PAGE_SW === 1) {
    document.getElementById(SCREEN_ID_LADDER_DEBUG_LOG_PAGE).style.display = 'none';
    document.getElementById(SCREEN_ID_LADDER_DEBUG_IF_TEST_PAGE).style.display = 'none';
  }
  ladder_tree_pmc_menu_tmp(pmc_no);
  ladder_error_pmc_read_pmc_menu_tmp(pmc_no);
  treeJson = [];
  mnemonic_array.length = 0;
  mnemo_write_array.length = 0;
  g_all_grid_cnt = 0;
  g_lv_cnt_tbl = [];
  g_sub_pg_tbl = [];
  sub_pg_cnt = 0;
  each_grid_cnt = 0;
  each_net_cnt = 0;
  g_grid_num_tbl = [];
  make_sub_pg_flg = FLG_OFF;
  grid_List = new List();
  g_set_net_grid_comp_flg = FLG_OFF;
  read_address_conversion_flg = FLG_OFF;
  document.getElementById("popup_no_comfirm_9").style.display="block";
  document.getElementById("popcomment_9_1").style.display="block";
  Popupbutton();
  requestPmcUpdate(pmc_no, pmcFileUpdateCallback);
  if (document.getElementById('func_menu_error_pmc_read').style.display == 'block') {
    document.getElementById('func_menu_error_pmc_read').style.display = 'none';
    document.onkeydown = ladder_tree_keydown;
  }
}


/*
 =========================================================================
 @function name : get_err_type
 @argument      : none
 @description   : acquisition error type
 @return        : error type
 =========================================================================
*/
function get_err_type() {
  return g_wk_err_type;
}

// end of file.
                                                                            /*
 * @fileoverview : PMC Ladder iHMI ladder program net edit script
 * @char-code    : SJIS
 * @NewLineCode  : LF
 */

/**
  Constant definition
**/
var HEADER_ID_LADDER_NET_EDIT = "headert_6";

/**
  Global(Only this file)
**/
var ladder_net_edit_id = "screen_ladder_netedit";
var g_net_info_copy_array = [];    // the net edit screen temporary storage structure
var g_hit_flg = FLG_OFF;
var g_subroutine_flg = FLG_OFF;    // subroutine draw flg in the net edit screen
var g_net_edit_flg = FLG_OFF;
var g_paste_insert_flg = FLG_OFF;
var display_grid_height = 0;
var lengthcount_net_edit = 0;
var click_cnt = 0;
var ly_net_p = 0;
var lx_net_p = 0;
var click_grid_lx;
var click_grid_ly;
var g_selected_element_x = 0;
var g_selected_element_y = 0;
// stores touched a grid
var g_selected_element_x_before = 0;
var g_selected_element_y_before = 0;
var g_disp_net_index_before = 0;
var focus_net_edit_popup_ok_flg = FLG_OFF;
var focus_overwrite_flg = null;

var g_netedit_menu = null;
var g_netedit_menu_no = 0;
var g_tmp_netedit_menu_no = 1;
var g_prev_edit_data = null;

var g_sub_param_info = null;
var g_before_grid_num = 0; // Number of grids before editing
/*
 =========================================================================
 @function name : record
 @argument      : none
 @description   : function for Undo and Redo
 @return        : none
 =========================================================================
*/
var record = function () {
  this.operation_array_index = 0;
  this.operation_array = [];
};
record.prototype = {
  // addition to the array to record of the operation history
  array_add: function (data) {
    for (var i = 0; i < this.operation_array_index; i++) {
      this.operation_array.shift();
    }
    if (this.operation_array.length > 10) {
      this.operation_array.pop();
    }
    this.operation_array_index = 0;
    this.operation_array.unshift(JSON.parse(JSON.stringify(data)));
  },
  // initialization of the array
  delete: function () {
    this.operation_array_index = 0;
    this.operation_array = [];
  },
  // the acquisition of the array
  get_array: function () {
    return this.operation_array;
  },
   
  get_array_index: function () {
    return this.operation_array_index;
  },
 
  array_index_increment: function () {
    this.operation_array_index += 1;
    return this.operation_array_index;
  },
   
  array_index_decrement: function () {
    this.operation_array_index -= 1;
    return this.operation_array_index;
  }
};
var net_edit_record = new record();
 
/*
 =========================================================================
 @function name : ladder_netedit_click_f1_button
 @argument      : none
 @description   : processing in the case of pushed down(clicked) F1 key
 @return        : none
 =========================================================================
*/
function ladder_netedit_click_f1_button() {
  var bk_disp_net_index;
  var split_array = [];
  var upd_mnemo_comp_flg = FLG_OFF;
  var menu_open_ret = ladder_netedit_menu_open_check();
  var before_mnemo_cnt = 0;
  var bk_VIEW_MAX_COL;
  var create_net_edit_flg = FLG_ON;
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }
  if (menu_open_ret === true) {
    return;
  }
  g_processing_flg = FLG_ON;
  var ret = false;
  var grid_List_backup = new List();
  var insert_net_flg = FLG_OFF;

  if (get_ladder_tree_edit_level() == 2 || get_ladder_tree_edit_level() >= 4) {
    var address_conv_flg = FLG_ON;
  } else {
    var address_conv_flg = FLG_OFF;
  }
  // backup the list structure just after net edit
  wk_glist = JSON.parse(JSON.stringify(grid_List.getData(0)));
  grid_List_backup.push(wk_glist, grid_List.getLevel(0), grid_List.getSubNum(0));

  // net error check processing
  ret = net_creation_error_check();
  if (ret == false) {
    g_processing_flg = FLG_OFF;
    return;
  }
  ret = ladder_error_check(grid_List);
  if (ret == false) {
    net_edit_update_err_popup(NET_EDIT_ERROR_NET_INTERRPTED);
    g_processing_flg = FLG_OFF;
    return;
  }

  if (g_subroutine_flg === FLG_OFF) {
    // automatic formatting start
    // the first line blank padding process
    net_auto_formatting();
    // height packed processing
    ret = vertically_net(grid_List);
    if (ret == false) {
      net_edit_list_restore(grid_List_backup);
      g_processing_flg = FLG_OFF;
      return;
    }
    // width packed processing
    ret = horizontally_net(grid_List);
    if (ret == false) {
      net_edit_list_restore(grid_List_backup);
      net_edit_update_err_popup(NET_EDIT_ERROR_INVALID_NET);
      g_processing_flg = FLG_OFF;
      return;
    }

    // recheck net interruption after automatic formatting
    ret = net_creation_error_check2();
    if (ret == false) {
      net_edit_list_restore(grid_List_backup);
      g_processing_flg = FLG_OFF;
      return;
    }
    ret = ladder_error_check(grid_List);
    if (ret == false) {
      net_edit_list_restore(grid_List_backup);
      net_edit_update_err_popup(NET_IS_TOO_COMPLICATED);
      g_processing_flg = FLG_OFF;
      return;
    }
  }
  bk_disp_net_index = g_disp_net_index;
  g_disp_net_index = g_disp_net_index_before;
  g_disp_grid_index = 0;
  grid_List_edit_write();
  g_disp_net_index = bk_disp_net_index;
  var bk_iterateArray = iterateArray;
  var before_mnemo_length = mnemo_write_array.length;
  iterateArray = [];
  split_array = [];
  iterateArray = grid_List.pushIterateArray();
  var temp_split_array = split_ladder(grid_List);
  split_array.push(temp_split_array[0]);
  read_write_check_ng_flg = conversion(split_array, address_conv_flg);
  var mnemo_cnt = mnemo_write_array.length - before_mnemo_length;
  var upd_mnemo_info = [];
  for (var i = 0; i < mnemo_cnt; i++) {
    if (i + 1 === mnemo_cnt) {
      upd_mnemo_info.unshift(mnemo_write_array[mnemo_write_array.length - 1]);
      mnemo_write_array.pop();
    } else {
      upd_mnemo_info.unshift(mnemo_write_array[mnemo_write_array.length - 1]);
      delete upd_mnemo_info[upd_mnemo_info.length - (1 + i)].net_num;
      mnemo_write_array.pop();
    }
  }
  pushpop_check(upd_mnemo_info);
  grid_List = new List();
  g_make_grid_list_pos.temp_grid_cnt = 0;
  en_route_array.length = 0;
  bk_VIEW_MAX_COL = VIEW_MAX_COL;
  VIEW_MAX_COL = g_width_num;
  setg_array_grid_info(0, CREATE_LIST_LIMIT, upd_mnemo_info, create_net_edit_flg);
  VIEW_MAX_COL = bk_VIEW_MAX_COL;
  iterateArray = [];
  iterateArray = grid_List.pushIterateArray();
  ret = ladder_error_check(grid_List);
  if (ret == false) {
    iterateArray = bk_iterateArray;
    net_edit_list_restore(grid_List_backup);
    net_edit_update_err_popup(NET_EDIT_ERROR_INVALID_NET);
    g_processing_flg = FLG_OFF;
    return;
  }
  if (g_subroutine_flg === FLG_OFF) {
    g_grid_edit_num_tbl[g_net_cnt_before_tree + g_selected_net_edit_index] = iterateArray[0].data.length;
    upd_mnemo_info[0].net_num = g_net_cnt_before_tree + g_selected_net_edit_index + 1;
    for (var j = 0; j < mnemo_write_array.length; j++) {
      if (mnemo_write_array[j].net_num !== undefined) {
        if (upd_mnemo_comp_flg === FLG_ON) {
          if (get_ladder_tree_edit_level() <= 3) {
            if (get_ladder_tree_edit_level() < g_edit_lv_cnt_tbl.length) {
              for (var k = 0; k < g_edit_lv_cnt_tbl.length; k++) {
                if (g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) + k] == undefined) {
                  break;
                }
                if (insert_net_flg === FLG_ON) {
                  g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) + k].mnemo_pos = g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) + k].mnemo_pos + upd_mnemo_info.length - 1;
                } else {
                  g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) + k].mnemo_pos = g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) + k].mnemo_pos + (upd_mnemo_info.length - before_mnemo_cnt);
                }
              }
            }
            if (g_edit_sub_pg_tbl.length !== 0) {
              for (var l = 0; l < g_edit_sub_pg_tbl.length; l++) {
                if (insert_net_flg === FLG_ON) {
                  g_edit_sub_pg_tbl[l].mnemo_pos = g_edit_sub_pg_tbl[l].mnemo_pos + upd_mnemo_info.length - 1;
                } else {
                  g_edit_sub_pg_tbl[l].mnemo_pos = g_edit_sub_pg_tbl[l].mnemo_pos + (upd_mnemo_info.length - before_mnemo_cnt);
                }
              }
            }
          } else if (get_ladder_tree_edit_level() >= 4) {
            if (get_ladder_tree_edit_level() < g_edit_sub_pg_tbl.length + 3) {
              for (var n = 0; n < g_edit_sub_pg_tbl.length; n++) {
                if (g_edit_sub_pg_tbl[(Number(get_ladder_tree_edit_level()) + n) - 3] == undefined) {
                  break;
                }
                if (insert_net_flg === FLG_ON) {
                  g_edit_sub_pg_tbl[(Number(get_ladder_tree_edit_level()) + n) - 3].mnemo_pos = g_edit_sub_pg_tbl[(Number(get_ladder_tree_edit_level()) + n) - 3].mnemo_pos + upd_mnemo_info.length - 1;
                } else {
                  g_edit_sub_pg_tbl[(Number(get_ladder_tree_edit_level()) + n) - 3].mnemo_pos = g_edit_sub_pg_tbl[(Number(get_ladder_tree_edit_level()) + n) - 3].mnemo_pos + (upd_mnemo_info.length - before_mnemo_cnt);
                }
              }
            }
          }
          g_make_edit_grid_list_pos.upd_margin__next_pos = Number(g_make_edit_grid_list_pos.upd_margin__next_pos) + (upd_mnemo_info.length - before_mnemo_cnt);
          break;
        }
        if (g_net_cnt_before_tree + g_selected_net_edit_index + 1 === mnemo_write_array[j].net_num) {
          for (var m = 0; m <= mnemo_write_array.length; m++) {
            if (mnemo_write_array[j].net_num === undefined || g_net_cnt_before_tree + g_selected_net_edit_index + 1 === mnemo_write_array[j].net_num) {
              if (mnemo_write_array[j].Order === "INSERT_NET") {
                insert_net_flg = FLG_ON;
              }
              mnemo_write_array.splice(j, 1);
              before_mnemo_cnt++;
              m--;
            } else if (g_net_cnt_before_tree + g_selected_net_edit_index + 1 < mnemo_write_array[j].net_num) {
              for (var n = 0; n < upd_mnemo_info.length; n++) {
                mnemo_write_array.splice(j + n, 0, upd_mnemo_info[n]);
              }
              upd_mnemo_comp_flg = FLG_ON;
              break;
            }
          }
        }
      }
    }
    if (insert_net_flg === FLG_OFF) {
      g_edit_all_grid_cnt = g_edit_all_grid_cnt + (iterateArray[0].data.length - g_before_grid_num);
    } else {
      g_edit_all_grid_cnt = g_edit_all_grid_cnt + iterateArray[0].data.length;
    }
    if (get_ladder_tree_edit_level() <= 3) {
      //upd grid & net count
      if (insert_net_flg === FLG_ON) {
        g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) - 1].grid_cnt = g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) - 1].grid_cnt - 1;
        g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) - 1].grid_cnt = g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) - 1].grid_cnt + iterateArray[0].data.length;
      } else {
        g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) - 1].grid_cnt = g_edit_lv_cnt_tbl[Number(get_ladder_tree_edit_level()) - 1].grid_cnt + (iterateArray[0].data.length - g_before_grid_num);
      }
    } else if (get_ladder_tree_edit_level() >= 4) {
      //upd grid & net count
      if (insert_net_flg === FLG_ON) {
        g_edit_sub_pg_tbl[Number(get_ladder_tree_edit_level()) - 4].grid_cnt = g_edit_sub_pg_tbl[Number(get_ladder_tree_edit_level()) - 4].grid_cnt - 1;
        g_edit_sub_pg_tbl[Number(get_ladder_tree_edit_level()) - 4].grid_cnt = g_edit_sub_pg_tbl[Number(get_ladder_tree_edit_level()) - 4].grid_cnt + iterateArray[0].data.length;
      } else {
        g_edit_sub_pg_tbl[Number(get_ladder_tree_edit_level()) - 4].grid_cnt = g_edit_sub_pg_tbl[Number(get_ladder_tree_edit_level()) - 4].grid_cnt + (iterateArray[0].data.length - g_before_grid_num);
      }
    }
  } else {
    var target_info = g_sub_param_info.pos_info[g_sub_param_info.index];
    if (target_info !== undefined) {
      var target = grid_List.getDataNum(0, iterateArray)[target_info.grid_y][target_info.grid_x];
      var chk_obj;
      switch (target.SubNo) {
        case DEF_SUBROUTINE_CTRB.NUM:
          chk_obj = check_numerical_param({ start: DEF_SUBROUTINE_CTRB.PRESET_MIN, end: DEF_SUBROUTINE_CTRB.PRESET_MAX });
          break;
        case DEF_SUBROUTINE_TMRB.NUM:
        case DEF_SUBROUTINE_TMRBF.NUM:
          // The set time value of TMRB and the set time value of TMRBF are the same
          chk_obj = check_numerical_param({ start: DEF_SUBROUTINE_TMRB.TIME_MIN, end: DEF_SUBROUTINE_TMRB.TIME_MAX });
          break;
      }
    }
    for (var m = 0; m < mnemo_write_array.length; m++) {
      if (upd_mnemo_comp_flg === FLG_ON) {
        break;
      }
      if (mnemo_write_array[m].net_num !== undefined) {
        if (g_net_cnt_before_tree + g_selected_net_edit_index + 1 === mnemo_write_array[m].net_num) {
          for (var n = 0; n < upd_mnemo_info.length; n++) {
            if (upd_mnemo_info[n].address !== undefined) {
              mnemo_write_array[m + n].Order = upd_mnemo_info[n].Order;
              mnemo_write_array[m + n].address = upd_mnemo_info[n].address;
              mnemo_write_array[m + n].VirtualAddress = upd_mnemo_info[n].VirtualAddress;
            } else if ((upd_mnemo_info[n].Order === "TMRB" || upd_mnemo_info[n].Order === "TMRBF" || upd_mnemo_info[n].Order === "CTRB") && chk_obj !== undefined) {
              if (chk_obj.result) {
                mnemo_write_array[m + n].SubParam2 = chk_obj.update_data;
                mnemo_write_array[m + n].SubParamRawData[1] = chk_obj.update_data;
              }
            }
            if (n + 1 === upd_mnemo_info.length) {
              upd_mnemo_comp_flg = FLG_ON;
            }
          }
        }
      }
    }
  }
  g_selected_element_x_before = 0;
  g_selected_element_y_before = 0;
  g_subroutine_flg = FLG_OFF;
  g_net_edit_flg = FLG_OFF;
  scrollBoxPos.start_y = 0;
  scrollBoxPos.start_x = 0;
  net_edit_record.delete();
  VIEW_GRID_ROW = BEFORE_VIEW_GRID_ROW;
  VIEW_GRID_COL = BEFORE_VIEW_GRID_COL;
  VIEW_MAX_ROW = BEFORE_VIEW_MAX_ROW;
  VIEW_MAX_COL = BEFORE_VIEW_MAX_COL;
  document.getElementById("a_contact").style.visibility = "hidden";
  document.getElementById("b_contact").style.visibility = "hidden";
  document.getElementById("coil").style.visibility = "hidden";
  document.getElementById("not_coil").style.visibility = "hidden";
  document.getElementById("horizontal_line").style.visibility = "hidden";
  document.getElementById("vertical_line").style.visibility = "hidden";
  document.getElementById("set_coil").style.visibility = "hidden";
  document.getElementById("reset_coil").style.visibility = "hidden";
  document.getElementById("reset_button").style.visibility = "hidden";
  document.getElementById("undo").style.visibility = "hidden";
  document.getElementById("redo").style.visibility = "hidden";

  iterateArray = bk_iterateArray;
  move_to_ladder_editor(ladder_net_edit_id);
  setTimeout(function () {
    g_processing_flg = FLG_OFF;
  }, 10);
}

/*
 =========================================================================
 @function name : ladder_netedit_click_f2_button
 @argument      : none
 @description   : processing in the case of pushed down(clicked) F2 key
 @return        : none
 =========================================================================
*/
function ladder_netedit_click_f2_button() {
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }
  var menu_open_ret = ladder_netedit_menu_open_check();
  if (menu_open_ret === true) {
    return;
  }

  if ((grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].FigNo >= IMAGENO1_A_CONTACT) &&
      (grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].FigNo <= IMAGENO8_RDNT)) {
    move_to_ladder_element_editor(ladder_net_edit_id);
  } else {
    return;
  }
}

/*
 =========================================================================
 @function name : ladder_netedit_click_f4_button
 @argument      : none
 @description   : processing in the case of pushed down(clicked) F4 key
 @return        : none
 =========================================================================
*/
function ladder_netedit_click_f4_button() {
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }
  // element action menu popup : display -> non-display
  if(document.getElementById('func_menu_6_4').style.display === 'block' || document.getElementById('func_menu_6_4_subroutine').style.display === 'block'){
    ladder_netedit_ele_menu_button(NETEDIT_ELE_KIND_NONE);
  } else {
    if (g_subroutine_flg === FLG_OFF) {
      g_netedit_menu = document.getElementById('eleMenu_6').children;
      document.getElementById('func_menu_6_4').style.display = 'block';
    } else {
      g_netedit_menu = document.getElementById('eleMenu_6_subroutine').children;
      document.getElementById('func_menu_6_4_subroutine').style.display = 'block';
    }
    document.onkeydown = ladder_netedit_menu_keydown;
    g_netedit_menu_no = NETEDIT_MENU_ELE;
    ladder_netedit_reset_menu_no();
    ladder_netedit_menu_bkcolor(g_tmp_netedit_menu_no);

    // element action menu popup : non-display -> display
    func_btn_4inner = document.getElementById('func_btn_6_4').innerHTML;
    var rep6_4_1 = func_btn_4inner.replace("[","|");
    var rep6_4_2 = rep6_4_1.replace("]","|");
    document.getElementById('func_btn_6_4').innerHTML = rep6_4_2;
    document.getElementById('worldDiv').style.zIndex = 0;
    g_symbol_flg = FLG_ON;
  }
}

/*
 =========================================================================
 @function name : ladder_netedit_reset_menu_no
 @argument      : none
 @description   : reset menu selected position
 @return        : none
 =========================================================================
*/
function ladder_netedit_reset_menu_no() {
  var start_menu_no = 1;
  switch (g_netedit_menu_no) {
    case NETEDIT_MENU_ELE:
      g_tmp_netedit_menu_no = start_menu_no;
      break;
    default:
      return;
  }
}

/*
 =========================================================================
 @function name : ladder_netedit_menu_enter
 @argument      : none
 @description   : menu choice processing
 @return        : none
 =========================================================================
*/
function ladder_netedit_menu_enter() {
  switch (g_netedit_menu_no) {
    case NETEDIT_MENU_ELE:
      ladder_netedit_ele_menu_button(g_tmp_netedit_menu_no);
      break;
    default:
      return;
  }
}

/*
 =========================================================================
 @function name : ladder_netedit_menu_enter
 @argument      : none
 @description   : menu return processing
 @return        : none
 =========================================================================
*/
function ladder_netedit_menu_prev() {
  switch (g_netedit_menu_no) {
    case NETEDIT_MENU_ELE:
      ladder_netedit_click_f4_button();
      break;
    default:
      return;
  }
}

/*
 =========================================================================
 @function name : ladder_netedit_menu_keydown
 @argument      : none
 @description   : kind of key which pressed hardkey(displayed menu)
 @return        : none
 =========================================================================
*/
function ladder_netedit_menu_keydown(event) {
  var menu_top = 1;
  
  var key_code = event.keyCode;
  var key_shift = event.shiftKey;
  var key_ctrl = event.ctrlKey;
  // invalidity of the key to notify a browser of
  invalidate_notification_key(event);

  switch (key_code) {
  case 9:  // keyboard up or keyboard down
    if (key_shift == false) {
      // keyboard down(TP environment)
      g_tmp_netedit_menu_no += 1;
      if (g_tmp_netedit_menu_no < g_netedit_menu.length) {
      } else {
        g_tmp_netedit_menu_no = menu_top;
      }
      ladder_netedit_menu_bkcolor(g_tmp_netedit_menu_no);
    } else {
      // keyboard up(TP environment)
      g_tmp_netedit_menu_no -= 1;
      if (0 < g_tmp_netedit_menu_no) {
      } else {
        g_tmp_netedit_menu_no = g_netedit_menu.length - 1;
      }
      ladder_netedit_menu_bkcolor(g_tmp_netedit_menu_no);
    }
      break;
      case 49:  // 1 key
      case 97:  // 1 key
        if (key_ctrl == false) {
          g_tmp_netedit_menu_no = 1;
          if (g_tmp_netedit_menu_no > g_netedit_menu.length - 1) {
            break;
          }
          ladder_netedit_menu_bkcolor(g_tmp_netedit_menu_no);
        } else if (key_code == 49 && key_ctrl == true) {
          ladder_netedit_click_f1_button();
        }
        break;
      case 50:  // 2 key
      case 98:  // 2 key
        if (key_ctrl == false) {
          g_tmp_netedit_menu_no = 2;
          if (g_tmp_netedit_menu_no > g_netedit_menu.length - 1) {
            break;
          }
          ladder_netedit_menu_bkcolor(g_tmp_netedit_menu_no);
        } else if (key_code == 50 && key_ctrl == true) {
          ladder_netedit_click_f2_button();
        }
        break;
      case 51:  // 3 key
      case 99:  // 3 key
        if (key_ctrl == false) {
          g_tmp_netedit_menu_no = 3;
          if (g_tmp_netedit_menu_no > g_netedit_menu.length - 1) {
            break;
          }
          ladder_netedit_menu_bkcolor(g_tmp_netedit_menu_no);
        }
        break;
      case 52:  // 4 key
      case 100:  // 4 key
        if (key_ctrl == false) {
          g_tmp_netedit_menu_no = 4;
          if (g_tmp_netedit_menu_no > g_netedit_menu.length - 1) {
            break;
          }
          ladder_netedit_menu_bkcolor(g_tmp_netedit_menu_no);
        } else if(key_code == 52 && key_ctrl == true){
          ladder_netedit_click_f4_button();
        }
        break;
      case 53:  // 5 key
        if (key_code == 53 && key_ctrl == true) {
          ladder_netedit_click_f5_button();
        }
        break;
  case 13:  // enter
    ladder_netedit_menu_enter();
    break;
  case 27:  // prev button(TP environment)
    ladder_netedit_menu_prev();
    break;
  case 38:  // keyboard up
    g_tmp_netedit_menu_no -= 1;
    if (0 < g_tmp_netedit_menu_no) {
    } else {
      g_tmp_netedit_menu_no = g_netedit_menu.length - 1;
    }
    ladder_netedit_menu_bkcolor(g_tmp_netedit_menu_no);
    break;
  case 40:  // keyboard down
    g_tmp_netedit_menu_no += 1;
    if (g_tmp_netedit_menu_no < g_netedit_menu.length) {
    } else {
      g_tmp_netedit_menu_no = menu_top;
    }
    ladder_netedit_menu_bkcolor(g_tmp_netedit_menu_no);
    break;
  case 112:  // function1 key
    ladder_netedit_click_f1_button();
  break;
  case 113:  // function2 key
    ladder_netedit_click_f2_button();
  break; 
  case 115:  // function4 key
    ladder_netedit_click_f4_button();
    break;
  case 116:  // function5 key
    ladder_netedit_click_f5_button();
    break; 
  default:
    break;
  }
}

/*
 =========================================================================
 @function name                    : ladder_netedit_menu_bkcolor
 @argument [g_tmp_netedit_menu_no] : menu which was chosen
 @description                      : redraw with the information of the selected menu
 @return                           : none
 =========================================================================
*/
function ladder_netedit_menu_bkcolor(g_tmp_netedit_menu_no) {
  for (var i = 1; i < g_netedit_menu.length; i += 1) {
    g_netedit_menu[i].style.backgroundColor = COLOR_LIGHT_GRAY;
  }
  g_netedit_menu[g_tmp_netedit_menu_no].style.backgroundColor = COLOR_MENU_SELECTED;
}

/*
 =========================================================================
 @function name        : ladder_netedit_ele_menu_button
 @argument [menu_no]   : selected menu no
 @description          : the net operation menu selection processing
 @return               : none
 =========================================================================
*/
function ladder_netedit_ele_menu_button(menu_no) {
  document.getElementById('func_menu_6_4').style.display = 'none';
  document.getElementById('func_menu_6_4_subroutine').style.display = 'none';
  document.getElementById('func_btn_6_4').innerHTML = func_btn_4inner;
  document.getElementById('worldDiv').style.zIndex = 2;
  document.onkeydown = ladder_net_edit_keydown;
  g_symbol_flg = FLG_OFF;

  switch (menu_no) {
    case NETEDIT_ELE_KIND_COPY:
      copy_ladder_grid();
      break;
    case NETEDIT_ELE_KIND_PASTE:
      if (g_subroutine_flg === FLG_OFF) {
        net_edit_paste_check();
      } else {
        paste_ladder_grid();
      }
      break;
    case NETEDIT_ELE_KIND_INSERT:
      insert_netedit_button('func_btn_6_next_2');
      document.getElementById('function_button_6').style.display = 'none';
      document.getElementById('function_button_6_2').style.display = 'block';
      document.getElementById('id_net_editor_comment1').style.display = 'block';
      break;
    case NETEDIT_ELE_KIND_DELETE:
      click_reset_button();
      break;
    default:
      return;
  }
}

/*
 =========================================================================
 @function name        : ladder_netedit_menu_open_check
 @argument [menu_no]   : none
 @description          : display check of the menu
 @return               : none
 =========================================================================
*/
function ladder_netedit_menu_open_check() {
  // in the case of opened the menu, close the menu
  if(document.getElementById('func_menu_6_4').style.display === 'block' || document.getElementById('func_menu_6_4_subroutine').style.display === 'block'){
    document.getElementById('func_menu_6_4').style.display = 'none';
    document.getElementById('func_menu_6_4_subroutine').style.display = 'none';
    document.getElementById('func_btn_6_4').innerHTML = func_btn_4inner;
    document.getElementById('worldDiv').style.zIndex = 2;
    document.onkeydown = ladder_net_edit_keydown;
    g_symbol_flg = FLG_OFF;
    return true;
  }
  return false;
}

/*
 =========================================================================
 @function name : ladder_netedit_click_f5_button
 @argument      : none
 @description   : processing in the case of pushed down(clicked) F5 key
 @return        : none
 =========================================================================
*/
function ladder_netedit_click_f5_button() {
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }
  var menu_open_ret = ladder_netedit_menu_open_check();
  if (menu_open_ret === true) {
    return;
  }
  g_processing_flg = FLG_ON;
  g_subroutine_flg = FLG_OFF;
  g_net_edit_flg = FLG_OFF;
  scrollBoxPos.start_y = 0;
  scrollBoxPos.start_x = 0;
  // in the case of cancellation, destroy editing contents
  grid_List = null;
  iterateArray = null;
  wk_glist = null;

  g_disp_grid_index = 0;
  
  g_selected_element_x_before = 0;
  g_selected_element_y_before = 0;
  g_subroutine_flg = FLG_OFF;
  g_net_edit_flg = FLG_OFF;
  scrollBoxPos.start_y = 0;
  scrollBoxPos.start_x = 0;
  net_edit_record.delete();
  VIEW_GRID_ROW = BEFORE_VIEW_GRID_ROW;
  VIEW_GRID_COL = BEFORE_VIEW_GRID_COL;
  VIEW_MAX_ROW = BEFORE_VIEW_MAX_ROW;
  VIEW_MAX_COL = BEFORE_VIEW_MAX_COL;
  document.getElementById("a_contact").style.visibility = "hidden";
  document.getElementById("b_contact").style.visibility = "hidden";
  document.getElementById("coil").style.visibility = "hidden";
  document.getElementById("not_coil").style.visibility = "hidden";
  document.getElementById("horizontal_line").style.visibility = "hidden";
  document.getElementById("vertical_line").style.visibility = "hidden";
  document.getElementById("set_coil").style.visibility = "hidden";
  document.getElementById("reset_coil").style.visibility = "hidden";
  document.getElementById("reset_button").style.visibility = "hidden";
  document.getElementById("undo").style.visibility = "hidden";
  document.getElementById("redo").style.visibility = "hidden";

  move_to_ladder_editor(ladder_net_edit_id);
  setTimeout(function () {
    g_processing_flg = FLG_OFF;
  }, 10);
}

/*
 =========================================================================
 @function name : ladder_netedit_click_f7_button
 @argument      : none
 @description   : processing in the case of pushed down(clicked) F7 key
 @return        : none
 =========================================================================
*/
function ladder_netedit_click_f7_button() {
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }
  ladder_netedit_insert_row_button();
}

/*
 =========================================================================
 @function name : ladder_netedit_click_f8_button
 @argument      : none
 @description   : processing in the case of pushed down(clicked) F8 key
 @return        : none
 =========================================================================
*/
function ladder_netedit_click_f8_button() {
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }
  ladder_netedit_insert_column("front");
}

/*
 =========================================================================
 @function name : ladder_netedit_click_f9_button
 @argument      : none
 @description   : processing in the case of pushed down(clicked) F9 key
 @return        : none
 =========================================================================
*/
function ladder_netedit_click_f9_button() {
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }
  ladder_netedit_insert_column("back");
}

/*
 =========================================================================
 @function name : ladder_netedit_click_f10_button
 @argument      : none
 @description   : processing in the case of pushed down(clicked) F10 key
 @return        : none
 =========================================================================
*/
function ladder_netedit_click_f10_button() {
  insert_netedit_button('func_menu_6_4_subroutine');
  document.getElementById('function_button_6').style.display = 'block';
  document.getElementById('function_button_6_2').style.display = 'none';
  document.getElementById('id_net_editor_comment1').style.display = 'none';
}

/*
 =========================================================================
 @function  name         : insert_netedit_button
 @argument [insert_elem] : Place to insert an netEditButton
 @description            : processing in the case of pushed down(clicked) F10 key
 @return                 : none
 =========================================================================
*/
function insert_netedit_button(insert_elem) {
  var net_edit_button_style_table = [
    //id               width  height   left   bottom
    ['a_contact',       -1,    -1,      -1,     -1],
    ['b_contact',       -1,    -1,      -1,     -1],
    ['coil',            -1,    -1,      -1,     -1],
    ['not_coil',        -1,    -1,      -1,     -1],
    ['horizontal_line', -1,    -1,      -1,     -1],
    ['vertical_line',   -1,    -1,      -1,     -1],
    ['set_coil',        -1,    -1,      -1,     -1],
    ['reset_coil',      -1,    -1,      -1,     -1],
    ['reset_button',    -1,    -1,      -1,     -1],
    ['undo',            -1,    -1,      -1,     -1],
    ['redo',            -1,    -1,      -1,     -1]
  ];
  var net_edit_button = document.getElementsByClassName('net_edit_button');
  var net_edit_button_length = net_edit_button.length;
  var net_edit_button_id = [];
  var insert_elem = document.getElementById(insert_elem);
  for (var i = 0; net_edit_button.length > i; i++) {
    net_edit_button_id[i] = net_edit_button[i].id;
    for (var m = 0; net_edit_button_style_table.length > m; m++) {
      if (net_edit_button_style_table[m][0] === net_edit_button_id[i]) {
        net_edit_button_style_table[m][1] = document.getElementById(net_edit_button_id[i]).style.width;
        net_edit_button_style_table[m][2] = document.getElementById(net_edit_button_id[i]).style.height;
        net_edit_button_style_table[m][3] = document.getElementById(net_edit_button_id[i]).style.left;
        if (net_edit_button_style_table[m][0] === 'reset_button') {
          net_edit_button_style_table[m][4] = document.getElementById(net_edit_button_id[i]).style.bottom;
        }
        break;
      }
    }
  }
  for (var j = 0; net_edit_button_length > j; j++) {
    net_edit_button[0].parentNode.removeChild(net_edit_button[0]);
  }
  for (var k = 0; net_edit_button_id.length > k; k++) {
    var elem = document.createElement("input");
    elem.setAttribute('id', net_edit_button_id[k]);
    elem.setAttribute('class', 'net_edit_button');
    elem.setAttribute('type', 'image');
    elem.setAttribute('tabinex', '-1');
    elem.setAttribute('src', 'icon/net_edit_' + (k + 1) + '.png');
    elem.setAttribute('onclick', 'click_' + net_edit_button_id[k] + '();');
    insert_elem.parentNode.appendChild(elem);
  }
  for (var l = 0; net_edit_button.length > l; l++) {
    document.getElementById(net_edit_button_id[l]).style.visibility = "visible";
    document.getElementById(net_edit_button_id[l]).style.outline = "none";
    document.getElementById(net_edit_button_id[l]).style.width = net_edit_button_style_table[l][1];
    document.getElementById(net_edit_button_id[l]).style.height = net_edit_button_style_table[l][2];
    document.getElementById(net_edit_button_id[l]).style.left = net_edit_button_style_table[l][3];
    if (net_edit_button_id[l] === 'reset_button') {
      document.getElementById(net_edit_button_id[l]).style.bottom = net_edit_button_style_table[l][4];
    }
  }
  Popupbutton();
  Popdownbutton();
}

/*
 =========================================================================
 @function name : move_to_ladder_net_edit
 @argument [id] : the element id of the origin of transition
 @description   : API whitch changes in ladder display screen
 @return        : none
 =========================================================================
*/
function move_to_ladder_net_edit(id, cancel_flg, net_edit_move_flg) {
  var not_subroutine_only_flg = FLG_OFF;
  var not_line_only_flg = FLG_OFF;
  // add words of "RUNNING" or "STOP" to header character string
  var headert_elem = document.getElementById(HEADER_ID_LADDER_NET_EDIT);
  getPmcRunStatus(g_pmc_no, function (pmc_num, status) {
    if (g_pmc_no == PMC_MEMORY_TYPE_DCS) {
      headert_elem.innerHTML = (status == PMC_RUNNING) ? headert + safety + pmc_lang_table['LadderNetEdit'].headert_6 + pmc_status_run : headert + safety + pmc_lang_table['LadderNetEdit'].headert_6 + pmc_status_stop;
    } else {
      headert_elem.innerHTML = (status == PMC_RUNNING) ? headert + g_pmc_no + pmc_lang_table['LadderNetEdit'].headert_6 + pmc_status_run : headert + g_pmc_no + pmc_lang_table['LadderNetEdit'].headert_6 + pmc_status_stop;
    }
  });

  if (id === 'screen_ladder_editor') {
    if (net_edit_move_flg !== undefined) {
      g_prev_edit_data = JSON.stringify(grid_List.getDataNum(g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1), iterateArray));
    } else {
      g_prev_edit_data = JSON.stringify(grid_List.getDataNum(g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_selected_net_edit_index + 1), iterateArray));
    }
    // evacuate in col/row
    BEFORE_VIEW_GRID_ROW = VIEW_GRID_ROW;
    BEFORE_VIEW_GRID_COL = VIEW_GRID_COL;
    BEFORE_VIEW_MAX_ROW  = VIEW_MAX_ROW;
    BEFORE_VIEW_MAX_COL  = VIEW_MAX_COL;

    // set to net_edit col/row
    VIEW_GRID_COL = 8;
    VIEW_GRID_ROW = 8;
    VIEW_MAX_ROW  = 8;
    VIEW_MAX_COL  = 8;
    var current_net_index = g_net_cnt_before_tree + g_selected_net_edit_index;
    if (net_edit_move_flg !== undefined) {
      current_net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
      g_selected_net_edit_index = g_disp_net_index;
    }
    if (g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_selected_net_edit_index + 1) !== -1) {
      current_net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_selected_net_edit_index + 1);
    }
    // check only for subroutine
    for (var y = 0; y < grid_List.getDataNum(g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_selected_net_edit_index + 1) ,iterateArray).length; y++) {
      for (var x = 0; x < VIEW_MAX_COL; x++) {
        if(grid_List.getDataNum(g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_selected_net_edit_index + 1) ,iterateArray)[y][x].FigNo != IMAGENO0_BLANK && grid_List.getDataNum(g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_selected_net_edit_index + 1) ,iterateArray)[y][x].FigNo != IMAGENO9_LINE){
          not_subroutine_only_flg = FLG_ON;
          break;
        } else if (grid_List.getDataNum(g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_selected_net_edit_index + 1) ,iterateArray)[y][x].SubNo != 0) {
          not_line_only_flg = FLG_ON;
        } else {}
      }
    }

    if(not_subroutine_only_flg === FLG_ON || not_line_only_flg === FLG_OFF){
      grid_List = new List();
      g_disp_net_index_before = current_net_index;
      // data copy of the net unit
      wk_glist = JSON.parse(JSON.stringify(grid_List.getDataNum(g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_selected_net_edit_index + 1), iterateArray)));
      g_before_grid_num = wk_glist.length;
      grid_List.push(wk_glist,grid_List.getLevel(g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_selected_net_edit_index + 1)),grid_List.getSubNum(g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_selected_net_edit_index + 1)));
      // grid_List.push(wk_glist,grid_List.getLevel(g_disp_net_index),grid_List.getSubNum(g_disp_net_index));
    } else {
      // only in the case of subroutine, screen do not change
      VIEW_GRID_ROW = BEFORE_VIEW_GRID_ROW; 
      VIEW_GRID_COL = BEFORE_VIEW_GRID_COL; 
      VIEW_MAX_ROW = BEFORE_VIEW_MAX_ROW; 
      VIEW_MAX_COL = BEFORE_VIEW_MAX_COL; 
      return;
    }

    if (g_disp_width_index > (g_width_num - VIEW_MAX_COL)) {
      g_disp_width_index = (g_width_num - VIEW_MAX_COL);
    }
  }

  // it supports speedup of the ladder drawing_20180904
  // after initialization, copy it from target list in array
  iterateArray = [];
  iterateArray = grid_List.pushIterateArray();

  document.getElementById('screen_ladder_netedit').style.display = 'block';
  document.getElementById('worldDiv').style.display = 'block';
  document.getElementById(id).style.display = 'none';
  document.onkeydown = ladder_net_edit_keydown;

  if (id == 'screen_ladder_editor') {
    scrollBoxPos.start_y = 0;
    document.getElementById('function_button_6').style.display = 'block';
    document.getElementById('function_button_6_2').style.display = 'none';
}

  if (id === 'screen_ladder_element_editor') {
    draw_ladder_net_edit_diagram(SCROLLBAR_ACTION_ANY);
  } else {
    draw_ladder_net_edit();
    // in the case of subroutine drawing, horizontal_line/vertical_line/set_coil/reset_coil/reset_button is not displayed
    if (g_subroutine_flg == FLG_ON) {
      document.getElementById("a_contact").style.visibility = "visible";
      document.getElementById("b_contact").style.visibility = "visible";
      document.getElementById("coil").style.visibility = "visible";
      document.getElementById("not_coil").style.visibility = "visible";
    } else {
      document.getElementById("a_contact").style.visibility = "visible";
      document.getElementById("b_contact").style.visibility = "visible";
      document.getElementById("coil").style.visibility = "visible";
      document.getElementById("not_coil").style.visibility = "visible";
      document.getElementById("horizontal_line").style.visibility = "visible";
      document.getElementById("vertical_line").style.visibility = "visible";
      document.getElementById("set_coil").style.visibility = "visible";
      document.getElementById("reset_coil").style.visibility = "visible";
      document.getElementById("reset_button").style.visibility = "visible";
      document.getElementById("undo").style.visibility = "visible";
      document.getElementById("redo").style.visibility = "visible";
    }
  }

  if (id === 'screen_ladder_element_editor' && cancel_flg === FLG_ON) {
  } else {
    net_edit_record.array_add(grid_List.getDataNum(0 ,iterateArray));
  }
  get_pmc_data_from_server(PMC_DATA_LOAD_KIND.PMC_DATA_COMPARE);
}

/*
 =========================================================================
 @function name : onfocus_net_edit_ok_button
 @argument      : none
 @description   : in error check, ON focus processing of the OK button of the popup screen
 @return        : none
 =========================================================================
*/
function onfocus_net_edit_ok_button() {
  focus_net_edit_popup_ok_flg = FLG_ON;
}

/*
 =========================================================================
 @function name : outfocus_net_edit_ok_button
 @argument      : none
 @description   : in error check, OUT focus processing of the OK button of the popup screen
 @return        : none
 =========================================================================
*/
function outfocus_net_edit_ok_button() {
  focus_net_edit_popup_ok_flg = FLG_OFF;
}

/*
 =========================================================================
 @function name : ladder_net_edit_keydown
 @argument      : none
 @description   : processing in the case of pressed(clicked) hard key
 @return        : none
 =========================================================================
*/
function ladder_net_edit_keydown(event) {
  var key_code = event.keyCode;
  var key_shift = event.shiftKey;
  var key_ctrl = event.ctrlKey;
  // invalidity of the key to notify a browser of
  invalidate_notification_key(event);

  // while display popup, only CLOSE is effective
  if (g_popup_flg === FLG_ON) {
    switch (key_code) {
      case 13:  // enter key
        if(focus_net_edit_popup_ok_flg === FLG_ON){
          closeDialog();
        }
        break;
      case 52:  // function4 key(TP environment)
      case 115:  // function4 key
        closeDialog();
        break;   
      default:
        break;
    }
    return;
  }
  // if ((key_code == 9 || key_code == 33 || key_code == 34 || key_code == 38 || key_code == 40 || key_code == 37 || key_code == 39) && g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }
  switch (key_code) {
    case 13:  // enter
      if ((g_selected_element_x == g_selected_element_x_before) && (g_selected_element_y == g_selected_element_y_before)) {
        ladder_netedit_click_f2_button();
      }else{}
      break;
    case 9:  // keyboard up or keyboard down
      if (key_shift == false) {
        // keyboard down
        net_edit_keyboard_down(KEYBOARD_DOWN);
        break;
      } else {
        // keyboard up
        net_edit_keyboard_up(KEYBOARD_UP);
        break;
      }
    case 33:  // shift + keyboard up (PC PageUp)
      if (g_subroutine_flg === FLG_OFF) {
        net_edit_keyboard_up(KEYBOARD_SHIFT_UP);
      }
      break;
    case 34:  // shift + keyboard down (PC PageDown)
      if (g_subroutine_flg === FLG_OFF) {
        net_edit_keyboard_down(KEYBOARD_SHIFT_DOWN);
      }
      break;
    case 38:  // keyboard up
      if (key_shift == false) {
        net_edit_keyboard_up(KEYBOARD_UP);
      }
      break;
    case 40:  // keyboard down
      if (key_shift == false) {
        net_edit_keyboard_down(KEYBOARD_DOWN);
      }
      break;
    case 37:  // keyboard left
      if (key_shift == false) {
        net_edit_keyboard_left(KEYBOARD_LEFT);
      } else {
        if (g_subroutine_flg === FLG_OFF) {
          net_edit_keyboard_left(KEYBOARD_SHIFT_LEFT);
        }
      }
      break;
    case 39:  // keyboard right
      if (key_shift == false) {
        net_edit_keyboard_right(KEYBOARD_RIGHT);
      } else {
        if (g_subroutine_flg === FLG_OFF) {
          net_edit_keyboard_right(KEYBOARD_SHIFT_RIGHT);
        }
      }
      break;
    case 49:  // function1 key(TP environment)
      if (key_ctrl == true) {
        if (document.getElementById('function_button_6').style.display === 'block') {
          ladder_netedit_click_f1_button();
        }
      }
      break;
    case 112:  // function1 key
      if (document.getElementById('function_button_6').style.display === 'block') {
        ladder_netedit_click_f1_button();
      }
      break;
    case 50:  // function2 key(TP environment)
      if (key_ctrl == true) {
        if (document.getElementById('function_button_6').style.display === 'block') {
          ladder_netedit_click_f2_button();
        } else {
          ladder_netedit_click_f7_button();
        }
      }
      break;
    case 113:  // function2 key
      if (document.getElementById('function_button_6').style.display === 'block') {
        ladder_netedit_click_f2_button();
      } else {
        ladder_netedit_click_f7_button();
      }
      break;
    case 51:  // function3 key(TP environment)
      if (key_ctrl == true) {
        if (document.getElementById('function_button_6').style.display === 'block') {
          return;
        } else {
          ladder_netedit_click_f8_button();
        }
      }
      break;
    case 114:  // function3 key
      if (document.getElementById('function_button_6').style.display === 'block') {
        return;
      } else {
        ladder_netedit_click_f8_button();
      }
      break;
    case 52:  // function4 key(TP environment)
      if (key_ctrl == true) {
        if (document.getElementById('function_button_6').style.display === 'block') {
          ladder_netedit_click_f4_button();
        } else {
          ladder_netedit_click_f9_button();
        }
      }
      break;
    case 115:  // function4 key
      if (document.getElementById('function_button_6').style.display === 'block') {
        ladder_netedit_click_f4_button();
      } else {
        ladder_netedit_click_f9_button();
      }
      break;
    case 53:  // function5 key(TP environment)
      if (key_ctrl == true) {
        if (document.getElementById('function_button_6').style.display === 'block') {
          ladder_netedit_click_f5_button();
        } else {
          ladder_netedit_click_f10_button();
        }
      }
      break;
    case 27:  // prev button(TP environment)
    case 116:  // function5 key
      if (document.getElementById('function_button_6').style.display === 'block') {
        ladder_netedit_click_f5_button();
      } else {
        ladder_netedit_click_f10_button();
      }
      break;
    default:
      break;
  }
  // store the hardkey operated the grid
  g_selected_element_x_before = g_selected_element_x;
  g_selected_element_y_before = g_selected_element_y;
}

/*
 =========================================================================
 @function name : net_edit_keyboard_up
 @argument [keyboard_type] : kind of key which pressed hardkey
 @description   : processing in the case of pressed(clicked) upper key of the net edit screen
 @return        : none
 =========================================================================
*/
function net_edit_keyboard_up(keyboard_type) {
  var dist = 0;  // distance
  switch (keyboard_type) {
    case KEYBOARD_UP:
      dist = -1;
      break;
    case KEYBOARD_SHIFT_UP:
      dist = -5;
      break;
    default:
      break;
  }

  if (g_subroutine_flg == FLG_ON) {
    // there is subroutine to the net edit screen
    grid_List.forEach(function (data, i, level, subnum) {
      for (ly_i = g_selected_element_y - 1; 0 <= ly_i; ly_i--) {
        for (lx_i = 0; lx_i < data[ly_i].length; lx_i++) {
          if (grid_List.getDataNum(0 ,iterateArray)[ly_i][lx_i].Address != '') {
            g_selected_element_x = lx_i;
            g_selected_element_y = ly_i;

            if (g_selected_element_y < 0) {
              g_selected_element_y = 0;
              break;
            }
            if (g_disp_grid_index > g_selected_element_y) {
              g_disp_grid_index = g_selected_element_y;
              scrollBoxPos.start_y = SBHV_POS_E + scrollBoxPos.box_height * g_disp_grid_index;
            }

            var disp_start_width = g_selected_element_x - (VIEW_GRID_COL - 1);
            if (disp_start_width >= 0) {
              g_disp_width_index = disp_start_width;
            } else {
              g_disp_width_index = 0;
            }
            scrollBoxPos.start_x = SBHV_POS_E + scrollBoxPos.box_width * g_disp_width_index;

            draw_ladder_net_edit_diagram(SCROLLBAR_ACTION_ANY);
            g_hit_flg = FLG_ON;
            break;
          }
        }
        if (g_hit_flg == FLG_ON) {
          break;
        }
      }
    });
    g_hit_flg = FLG_OFF;
  } else {
    // there is no subroutine to the net edit screen
    g_selected_element_y += dist;
    if (g_selected_element_y < 0) {
      g_selected_element_y = 0;
    }
    if (g_disp_grid_index > g_selected_element_y) {
      g_disp_grid_index = g_selected_element_y;
      scrollBoxPos.start_y = SBHV_POS_E + scrollBoxPos.box_height * g_disp_grid_index;
    } else {
      // there is no screen drawing
    }
    draw_ladder_net_edit_diagram(SCROLLBAR_ACTION_ANY);
  }
}

/*
 =========================================================================
 @function name : net_edit_keyboard_down
 @argument [keyboard_type] : kind of key which pressed hardkey
 @description   : processing in the case of pressed(clicked) lower key of the net edit screen
 @return        : none
 =========================================================================
*/
function net_edit_keyboard_down(keyboard_type) {
  var dist = 0;  // distance
  switch (keyboard_type) {
    case KEYBOARD_DOWN:
      dist = 1;
      break;
    case KEYBOARD_SHIFT_DOWN:
      dist = 5;
      break;
    default:
      break;
  }

  if (g_subroutine_flg == FLG_ON) {
    // there is subroutine to the net edit screen
    grid_List.forEach(function (data, i, level, subnum) {
      for (ly_i = g_selected_element_y + 1; ly_i < data.length; ly_i++) {
        for (lx_i = 0; lx_i < data[ly_i].length; lx_i++) {
          if (grid_List.getDataNum(0 ,iterateArray)[ly_i][lx_i].Address != '') {
            g_selected_element_x = lx_i;
            g_selected_element_y = ly_i;

            if (grid_List.getDataNum(0 ,iterateArray).length <= g_selected_element_y) {
              g_selected_element_y = grid_List.getDataNum(0 ,iterateArray).length - 1;
              break;
            }
            var disp_start_grid = g_selected_element_y - (g_disp_grid_index + VIEW_GRID_COL - 1);
            if (disp_start_grid <= 0) {
              // there is no screen drawing
            } else {
              g_disp_grid_index = g_disp_grid_index + disp_start_grid;
              scrollBoxPos.start_y = SBHV_POS_E + scrollBoxPos.box_height * g_disp_grid_index;
            }

            var disp_start_width = g_selected_element_x - (VIEW_GRID_COL - 1);
            if (disp_start_width >= 0) {
              g_disp_width_index = disp_start_width;
            } else {
              g_disp_width_index = 0;
            }
            scrollBoxPos.start_x = SBHV_POS_E + scrollBoxPos.box_width * g_disp_width_index;

            draw_ladder_net_edit_diagram(SCROLLBAR_ACTION_ANY);
            g_hit_flg = FLG_ON;
            break;
          }
        }
        if (g_hit_flg == FLG_ON) {
          break;
        }
      }
    });
    g_hit_flg = FLG_OFF;
  } else {
    // there is no subroutine to the net edit screen
    g_selected_element_y += dist;
    if (grid_List.getDataNum(0 ,iterateArray).length <= g_selected_element_y) {
      g_selected_element_y = grid_List.getDataNum(0 ,iterateArray).length - 1;
    }
    var disp_start_grid = g_selected_element_y - (g_disp_grid_index + VIEW_GRID_COL - 1);
    if (disp_start_grid <= 0) {
      // there is no screen drawing
    } else {
      g_disp_grid_index = g_disp_grid_index + disp_start_grid;
      scrollBoxPos.start_y = SBHV_POS_E + scrollBoxPos.box_height * g_disp_grid_index;
    }
    draw_ladder_net_edit_diagram(SCROLLBAR_ACTION_ANY);
  }
}

/*
 =========================================================================
 @function name : net_edit_keyboard_left
 @argument [keyboard_type] : kind of key which pressed hardkey
 @description   : processing in the case of pressed(clicked) left key of the net edit screen
 @return        : none
 =========================================================================
*/
function net_edit_keyboard_left(keyboard_type) {
  var dist = 0;  // distance
  switch (keyboard_type) {
    case KEYBOARD_LEFT:
      dist = -1;
      break;
    case KEYBOARD_SHIFT_LEFT:
      dist = -5;
      break;
    default:
      break;
  }

  if (g_subroutine_flg == FLG_ON) {
    // there is subroutine to the net edit screen
    grid_List.forEach(function (data, i, level, subnum) {
      for (ly_i = g_selected_element_y; 0 <= ly_i; ly_i--) {
        for (lx_i = g_selected_element_x - 1; 0 <= lx_i; lx_i--) {
          if (grid_List.getDataNum(0 ,iterateArray)[ly_i][lx_i].Address != '') {
            g_selected_element_x = lx_i;
            g_selected_element_y = ly_i;
            g_search_width_index = lx_i;

            if (g_selected_element_x < 0) {
              g_selected_element_x = 0;
              break;
            }

            if (g_disp_grid_index > g_selected_element_y) {
              g_disp_grid_index = g_selected_element_y;
              scrollBoxPos.start_y = SBHV_POS_E + scrollBoxPos.box_height * g_disp_grid_index;
            }

            var disp_start_grid = g_selected_element_x - (VIEW_GRID_COL - 1);
            if (g_disp_width_index > disp_start_grid) {
              g_disp_width_index = disp_start_grid;
            } else {
              g_disp_width_index = disp_start_grid;
            }
            scrollBoxPos.start_x = SBHV_POS_E + scrollBoxPos.box_width * g_disp_width_index;

            prev_disp_position();
            draw_ladder_net_edit_diagram(SCROLLBAR_ACTION_ANY);
            g_hit_flg = FLG_ON;
            break;
          }
        }
        if (g_hit_flg == FLG_OFF) {
          // zero a serch start position of the next net
          if ((g_selected_element_x == 0) && (g_selected_element_y == 0)) {
            break;
          } else {
            g_selected_element_x = data[ly_i].length;
          }
        } else {
          break;
        }
      }
    });
    g_hit_flg = FLG_OFF;
  } else {
    if (g_selected_element_x === 0) {
      return;
    }
    // there is no subroutine to the net edit screen
    g_selected_element_x += dist;
    if (g_selected_element_x < 0) {
      g_selected_element_x = 0;
    }
    if (g_disp_width_index > g_selected_element_x) {
      g_disp_width_index = g_selected_element_x;
      scrollBoxPos.start_x = SBHV_POS_E + scrollBoxPos.box_width * g_disp_width_index;
    } else {
      // there is no screen drawing
    }
    draw_ladder_net_edit_diagram(SCROLLBAR_ACTION_ANY);
  }
}

/*
 =========================================================================
 @function name : net_edit_keyboard_right
 @argument [keyboard_type] : kind of key which pressed hardkey
 @description   : processing in the case of pressed(clicked) left key of the net edit screen
 @return        : none
 =========================================================================
*/
function net_edit_keyboard_right(keyboard_type) {
  var dist = 0;  // distance
  switch (keyboard_type) {
    case KEYBOARD_RIGHT:
      dist = 1;
      break;
    case KEYBOARD_SHIFT_RIGHT:
      dist = 5;
      break;
    default:
      break;
  }

  if (g_subroutine_flg == FLG_ON) {
    // there is subroutine to the net edit screen
    var wk_selected_element_x = g_selected_element_x;
    grid_List.forEach(function (data, i, level, subnum) {
      for (ly_i = g_selected_element_y; ly_i < data.length; ly_i++) {
        for (lx_i = g_selected_element_x + 1; lx_i < data[ly_i].length; lx_i++) {
          if (grid_List.getDataNum(0 ,iterateArray)[ly_i][lx_i].Address != '') {
            g_selected_element_x = lx_i;
            g_selected_element_y = ly_i;
            g_search_width_index = lx_i;

            if (grid_List.getDataNum(0 ,iterateArray)[0].length <= g_selected_element_x) {
              g_selected_element_x = grid_List.getDataNum(0 ,iterateArray)[0].length - 1;
              break;
            }

            var disp_start_grid = g_selected_element_y - (g_disp_grid_index + VIEW_GRID_COL - 1);
            if (disp_start_grid <= 0) {
              // there is no screen drawing
            } else {
              g_disp_grid_index = g_disp_grid_index + disp_start_grid;
              scrollBoxPos.start_y = SBHV_POS_E + scrollBoxPos.box_height * g_disp_grid_index;
            }

            var disp_start_grid = g_selected_element_x - (VIEW_GRID_COL - 1);
            if (disp_start_grid <= 0) {
              g_disp_width_index = 0;
            } else {
              g_disp_width_index = disp_start_grid;
            }
            scrollBoxPos.start_x = SBHV_POS_E + scrollBoxPos.box_width * g_disp_width_index;

            next_disp_position();
            draw_ladder_net_edit_diagram(SCROLLBAR_ACTION_ANY);
            g_hit_flg = FLG_ON;
            break;
          }
        }
        if (g_hit_flg == FLG_OFF) {
          // zero a serch start position of the next net
          g_selected_element_x = -1;
        } else {
          break;
        }
      }
    });
    g_hit_flg = FLG_OFF;
    if (g_selected_element_x === -1) {
      // reset start position
      g_selected_element_x = wk_selected_element_x;
    }
  } else {
    if (grid_List.getDataNum(0 ,iterateArray)[0].length - 1 === g_selected_element_x) {
      return;
    }
    // there is no subroutine to the net edit screen
    g_selected_element_x += dist;
    if (grid_List.getDataNum(0 ,iterateArray)[0].length <= g_selected_element_x) {
      g_selected_element_x = grid_List.getDataNum(0 ,iterateArray)[0].length - 1;
    }
    var disp_start_grid = g_selected_element_x - (g_disp_width_index + VIEW_GRID_COL - 1);
    if (disp_start_grid <= 0) {
      // there is no screen drawing
    } else {
      g_disp_width_index = g_disp_width_index + disp_start_grid;
      scrollBoxPos.start_x = SBHV_POS_E + scrollBoxPos.box_width * g_disp_width_index;
    }
    draw_ladder_net_edit_diagram(SCROLLBAR_ACTION_ANY);
  }
}

/*
 =========================================================================
 @function name : grid_List_edit_write
 @argument      : none
 @description   : insert list of Ladder Editor Screen in list of the Ladder Editor Screen
 @return        : none
 =========================================================================
*/
function grid_List_edit_write() {

  var net_edit_data = grid_List.getDataNum(0 ,iterateArray);
  var net_edit_tmp_array = net_edit_data;

  // delete line of the blank
  var net_edit_tmp_array_del = delete_blank_col(net_edit_tmp_array);

  net_edit_data = JSON.stringify(net_edit_tmp_array_del);
  if (net_edit_data !== g_prev_edit_data) {
    set_g_array_update_flg(SCREEN_LADDER_NETEDIT);
  }

  grid_List.setData(net_edit_tmp_array, g_disp_net_index);
  g_prev_edit_data = null;
  wk_glist = null;
}

/*
 =========================================================================
 @function name                 : net_creation_error_check
 @argument                      : none
 @description                   : error check at completion net edit
 @return  [true/false]          : no error / error
 =========================================================================
*/
function net_creation_error_check() {

  var net_height = 0;
  var net_height_cnt = 0;
  var net_flg = FLG_OFF;
  var net_num = 0;
  var err_type = 0;
  var blank_cnt = 0;

  var net_edit_data = grid_List.getDataNum(0 ,iterateArray);

  for (ly_i = 0; ly_i < net_edit_data.length; ly_i++) {
    for (lx_i = 0; lx_i < net_edit_data[ly_i].length; lx_i++) {
      // error check is finished if find subroutine
      if (net_edit_data[ly_i][lx_i].SubNo != 0) {
        return true;
      }
      
      // no-input check of the address
      if ((net_edit_data[ly_i][lx_i].FigNo >= IMAGENO1_A_CONTACT) &&
          (net_edit_data[ly_i][lx_i].FigNo <= IMAGENO8_RDNT)){
        if(net_edit_data[ly_i][lx_i].Address == ''){
          // popup indication of the error
          err_type = NET_EDIT_ERROR_ADD_NOT_ENTERED;
          net_edit_update_err_popup(err_type);

          return false;
        }
      }

      // check of the up and down line
      if ((net_edit_data[ly_i][lx_i].NetwriteDown == 1) &&
          (net_edit_data[ly_i + 1][lx_i].NetwriteUp == 0)) {
        // popup indication of the error
        err_type = NET_EDIT_ERROR_NET_INTERRPTED;
        net_edit_update_err_popup(err_type);

        return false;
      }

      if ((net_edit_data[ly_i][lx_i].NetwriteUp == 1) &&
          (net_edit_data[ly_i - 1][lx_i].NetwriteDown == 0)) {
        // popup indication of the error
        err_type = NET_EDIT_ERROR_NET_INTERRPTED;
        net_edit_update_err_popup(err_type);

        return false;
      }

      // calculate net height
      if ((net_edit_data[ly_i][lx_i].NetwriteDown == 1) && (net_flg == FLG_OFF)) {
        net_height_cnt += 1;
        net_flg = FLG_ON;
      }
    }
    net_flg = FLG_OFF;
    net_num = net_height_cnt + 1;
  }

  blank_cnt = count_blank_col(net_edit_data);
  // check the number of nets
  if ((net_edit_data.length - blank_cnt) != net_num) {
    // popup indication of the error
    err_type = NET_EDIT_ERROR_NET_INTERRPTED;
    net_edit_update_err_popup(err_type);

    return false;
  }

  return true;
}
/*
 =========================================================================
 @function name                 : net_creation_error_check2
 @argument                      : none
 @description                   : error check at completion net edit
 @return  [true/false]          : no error / error
 =========================================================================
*/
function net_creation_error_check2() {

  var err_type = 0;

  var net_edit_data = grid_List.getDataNum(0 ,iterateArray);

  for (ly_i = 0; ly_i < net_edit_data.length; ly_i++) {
    for (lx_i = 0; lx_i < net_edit_data[ly_i].length; lx_i++) {
      // check of the up and down line
      if ((net_edit_data[ly_i][lx_i].NetwriteDown == 1) &&
          (net_edit_data[ly_i + 1][lx_i].NetwriteUp == 0)) {
        // popup indication of the error
        err_type = NET_IS_TOO_COMPLICATED;
        net_edit_update_err_popup(err_type);
        return false;
      }
      if ((net_edit_data[ly_i][lx_i].NetwriteUp == 1) &&
          (net_edit_data[ly_i - 1][lx_i].NetwriteDown == 0)) {
        // popup indication of the error
        err_type = NET_IS_TOO_COMPLICATED;
        net_edit_update_err_popup(err_type);
        return false;
      }
    }
  }
  return true;
}

/*
 =========================================================================
 @function name                 : net_auto_formatting
 @argument                      : none
 @description                   : automatic formatting start when the top first bank of net includes a blank
 @return  [true/false]          : none
 =========================================================================
*/
function net_auto_formatting() {

  var ly_0 = 0;
  var ly_start = 0;
  var ly_end = 0;
  var lx_start = null;
  var lx_end = 0;
  var lx_change_add = 0;
  var ly_start_sec = 0;
  var tmp_cnt = 0;
  var write_pattern1_flg = FLG_OFF;
  var noblank_flg = FLG_OFF;

  var net_edit_data = grid_List.getDataNum(0 ,iterateArray);

  // automatic formatting start
    for (lx_i = 0; lx_i < net_edit_data[ly_0].length; lx_i++) {
      
      if (net_edit_data[ly_0][lx_i].FigNo === IMAGENO0_BLANK){
        if(lx_start === null){
          lx_start = lx_i;
        }
        var ly_i = ly_0;
        var ly_set = ly_0;
        while (ly_i < net_edit_data.length) {
          if(net_edit_data[ly_i][lx_i].FigNo != IMAGENO0_BLANK){
            net_edit_data[ly_set][lx_i].FigNo        = net_edit_data[ly_i][lx_i].FigNo;
            net_edit_data[ly_set][lx_i].Address      = net_edit_data[ly_i][lx_i].Address;
            // at the top line
            if(ly_set === 0){
              // at the leftmost time
              if(lx_start != 0){
                net_edit_data[ly_set][lx_i].NetwriteUp   = 0;
                net_edit_data[ly_set][lx_i].NetwriteDown = 0;
                if(IMAGENO1_A_CONTACT <= net_edit_data[ly_set][lx_i].FigNo && net_edit_data[ly_set][lx_i].FigNo <= IMAGENO9_LINE){
                  net_edit_data[ly_set][lx_i].NetwriteDown = net_edit_data[ly_i][lx_i].NetwriteDown;
                }
              // except at the leftmost time
              } else {
                if(net_edit_data[ly_set][lx_i].NetwriteDown === 1 && net_edit_data[ly_set][lx_i + 1].FigNo != IMAGENO0_BLANK){
                  net_edit_data[ly_set][lx_i].NetwriteDown = 1;
                }
                if(net_edit_data[ly_i][lx_i].NetwriteUp === 1){
                  net_edit_data[ly_set][lx_i].NetwriteDown = 1;
                  net_edit_data[ly_set + 1][lx_i].NetwriteUp = 1;
                }
                if(IMAGENO1_A_CONTACT <= net_edit_data[ly_set][lx_i].FigNo && net_edit_data[ly_set][lx_i].FigNo <= IMAGENO9_LINE){
                  net_edit_data[ly_set][lx_i].NetwriteDown = 1;
                }
              }
            // time after the second line
            } else {
              net_edit_data[ly_set][lx_i].NetwriteUp   = net_edit_data[ly_i][lx_i].NetwriteUp;
              net_edit_data[ly_set][lx_i].NetwriteDown = net_edit_data[ly_i][lx_i].NetwriteDown;
              if(net_edit_data[ly_i][lx_i].NetwriteUp === 1){
                net_edit_data[ly_set][lx_i].NetwriteDown = 1;
              }
            }
            if(net_edit_data[ly_i][lx_i].NetwriteDown === 1){
              net_edit_data[ly_set + 1][lx_i].NetwriteUp = 1;
            }
            grid_List.getDataNum(0 ,iterateArray)[ly_i][lx_i] = { FigNo: 0, Address: '', NetwriteUp: net_edit_data[ly_i][lx_i].NetwriteUp, NetwriteDown: net_edit_data[ly_i][lx_i].NetwriteDown, SearchMarker: MARK_NO, GridChkFlag: 0, SubNo: 0, SubParam1: 0, SubParam2: 0, SubParam3: 0, SubParam4: 0, SubParam5: 0, SubParam6: 0 };
            ly_set++;
          }
          if(ly_set >= 1 && lx_i < (net_edit_data[ly_0].length - 1)){
            var i = 1;
            // the right element confirmation
            while ((lx_i + i) < (net_edit_data[ly_0].length - 1) && net_edit_data[0][lx_i + i].FigNo != IMAGENO0_BLANK){
              for(ly_j = 1; ly_j < ly_i; ly_j++){
                if(net_edit_data[ly_j][lx_i + i].FigNo === IMAGENO0_BLANK && (net_edit_data[ly_i][lx_i + i].FigNo != 0 || 
                   (net_edit_data[ly_i][lx_i + i].FigNo === 0 && (net_edit_data[ly_i][lx_i + i].NetwriteUp === 1 || net_edit_data[ly_i][lx_i + i].NetwriteDown === 1)))){
                  net_edit_data[ly_j][lx_i + i].FigNo        = net_edit_data[ly_i][lx_i + i].FigNo;
                  net_edit_data[ly_j][lx_i + i].Address      = net_edit_data[ly_i][lx_i + i].Address;
                  if(net_edit_data[ly_j][lx_i + i].NetwriteUp === 0 || net_edit_data[ly_j][lx_i + i].NetwriteDown === 0){
                    net_edit_data[ly_j][lx_i + i].NetwriteUp   = net_edit_data[ly_i][lx_i + i].NetwriteUp;
                    net_edit_data[ly_j][lx_i + i].NetwriteDown = net_edit_data[ly_i][lx_i + i].NetwriteDown;
                  }
                  
                  net_edit_data[ly_i][lx_i + i].FigNo        = 0;
                  net_edit_data[ly_i][lx_i + i].Address      = '';
                  if(net_edit_data[ly_i][lx_i + i].NetwriteDown === 1){
                    net_edit_data[ly_i][lx_i + i].NetwriteUp = 1;
                    net_edit_data[ly_i][lx_i + i].NetwriteDown = 1;
                  }
                  write_pattern1_flg = FLG_ON;
                  if(lx_change_add < i ){
                    lx_change_add = i;
                  }
                  break;
                }
              }
              i++;
            }
            if(lx_end < lx_i){
              lx_end = lx_i;
            }
          }
          ly_i++;
        }
        if(ly_end < ly_i){
          ly_end = ly_i;
        }
      }
    }
  
  if(write_pattern1_flg === FLG_ON){
    lx_end += lx_change_add;
  }
  if(lx_start === 0){
    lx_end += 1;
    lx_start = 1;
  } else if(lx_start === net_edit_data[ly_0].length - 1 && lx_end === 0){
    lx_end = net_edit_data[ly_0].length - 1;
  }

  // delete the height line    part1
  for (ly_d = ly_start; ly_d < ly_end; ly_d++) {
    for (lx_d = lx_start - 1; lx_d <= lx_end; lx_d++) {
      if(lx_d === net_edit_data[ly_d].length - 1){
        if (net_edit_data[ly_d][lx_d].FigNo === IMAGENO0_BLANK ){
          if(net_edit_data[ly_d][lx_d].NetwriteUp === 1){
            net_edit_data[ly_d][lx_d] = create_grid();
            net_edit_data[ly_d - 1][lx_d].NetwriteDown = 0;
          } else if(net_edit_data[ly_d][lx_d].NetwriteDown === 1) {
            net_edit_data[ly_d][lx_d] = create_grid();
          }
        }
      } else {
        if (net_edit_data[ly_d][lx_d].FigNo === IMAGENO0_BLANK && net_edit_data[ly_d][lx_d + 1].FigNo === IMAGENO0_BLANK && (net_edit_data[ly_d][lx_d + 1].NetwriteUp === 0 || net_edit_data[ly_d][lx_d + 1].NetwriteDown === 0)){
          if(net_edit_data[ly_d][lx_d].NetwriteUp === 1){
            net_edit_data[ly_d][lx_d] = create_grid();
            net_edit_data[ly_d - 1][lx_d].NetwriteDown = 0;
          } else if(net_edit_data[ly_d][lx_d].NetwriteDown === 1) {
            net_edit_data[ly_d][lx_d] = create_grid();
          }
        }
      }
    }
  }

  // delete half up and down lines
  for (ly_i = 0; ly_i < net_edit_data.length; ly_i++) {
    for (lx_i = 0; lx_i < net_edit_data[ly_i].length; lx_i++) {
      if ((net_edit_data[ly_i][lx_i].NetwriteDown == 1) &&
          (net_edit_data[ly_i + 1][lx_i].NetwriteUp == 0)) {
        net_edit_data[ly_i][lx_i].NetwriteDown = 0;
      }
      if ((net_edit_data[ly_i][lx_i].NetwriteUp == 1) &&
          (net_edit_data[ly_i - 1][lx_i].NetwriteDown == 0)) {
        net_edit_data[ly_i][lx_i].NetwriteUp = 0;
      }
    }
  }
  
  // calculation of the height line
  for (ly_i = 0; ly_i < net_edit_data.length; ly_i++) {
    for (lx_i = 0; lx_i < net_edit_data[ly_i].length; lx_i++) {
      if(net_edit_data[ly_i][lx_i].FigNo == 0){
        noblank_flg = FLG_OFF;
      } else {
        noblank_flg = FLG_ON;
        break;
      }
    }
    if (noblank_flg == FLG_ON) {
      ly_start_sec = ly_start_sec + tmp_cnt + 1;
      tmp_cnt = 0;
    } else if(noblank_flg == FLG_OFF){
      tmp_cnt += 1;
    }
  }

  // delete the height line    part2
  for (ly_d = ly_start_sec; ly_d < ly_end; ly_d++) {
    for (lx_d = lx_start - 1; lx_d <= lx_end; lx_d++) {
      if (net_edit_data[ly_d][lx_d].FigNo === IMAGENO0_BLANK && (net_edit_data[ly_d][lx_d].NetwriteUp === 1)){
        net_edit_data[ly_d][lx_d] = create_grid();
        net_edit_data[ly_d - 1][lx_d].NetwriteDown = 0;
      }
      if (net_edit_data[ly_d][lx_d].FigNo === IMAGENO0_BLANK && (net_edit_data[ly_d][lx_d].NetwriteDown === 1)){
        net_edit_data[ly_d][lx_d] = create_grid();
      }
    }
  }

  // delete the height line    part3
  for (ly_d = ly_start; ly_d < ly_end; ly_d++) {
    for (lx_d = lx_start - 1; lx_d <= lx_end; lx_d++) {
      if(lx_d === net_edit_data[ly_d].length - 1){
        if (net_edit_data[ly_d][lx_d].FigNo === IMAGENO0_BLANK ){
          if(net_edit_data[ly_d][lx_d].NetwriteUp === 1){
            net_edit_data[ly_d][lx_d] = create_grid();
            net_edit_data[ly_d - 1][lx_d].NetwriteDown = 0;
          } else if(net_edit_data[ly_d][lx_d].NetwriteDown === 1) {
            net_edit_data[ly_d][lx_d] = create_grid();
          }
        }
      } else {
        if (net_edit_data[ly_d][lx_d].FigNo === IMAGENO0_BLANK && net_edit_data[ly_d][lx_d + 1].FigNo === IMAGENO0_BLANK && (net_edit_data[ly_d][lx_d + 1].NetwriteUp === 0 || net_edit_data[ly_d][lx_d + 1].NetwriteDown === 0)){
          if(net_edit_data[ly_d][lx_d].NetwriteUp === 1){
            net_edit_data[ly_d][lx_d] = create_grid();
            net_edit_data[ly_d - 1][lx_d].NetwriteDown = 0;
          } else if(net_edit_data[ly_d][lx_d].NetwriteDown === 1) {
            net_edit_data[ly_d][lx_d] = create_grid();
          }
        }
      }
    }
  }
}

/*
 =========================================================================
 @function name                 : net_edit_update_err_popup
 @argument [err_type]           : error kind
 @description                   : popup of completion failure of Ladder Net Edit Screen
 @return                        : none
 =========================================================================
*/
function net_edit_update_err_popup(err_type) {
  document.getElementById("popup_no_comfirm_6").style.display="block";
  document.getElementById("poptitle").placeholder = "";
  document.getElementById("popcomment_6_1").style.display="none";
  document.getElementById("popcomment_6_2").style.display = "none";
  document.getElementById("popcomment_6_3").style.display = "block";
  document.getElementById("err_popcomment_6_1").placeholder = "";
  document.getElementById("err_popcomment_6_1").style.display = "none";
  document.getElementById("err_popcomment_6_2").placeholder = "";
  document.getElementById("err_popcomment_6_2").style.display = "none";
  document.getElementById("err_popcomment_6_3").placeholder = "";
  document.getElementById("err_popcomment_6_3").style.display = "none";
  document.getElementById("err_popcomment_6_4").placeholder = "";
  document.getElementById("err_popcomment_6_4").style.display = "none";
  if (err_type == 1) {
    document.getElementById("err_popcomment_6_1").placeholder = error_list[err_type].error_comment;
    document.getElementById("err_popcomment_6_1").style.display = "block";
  } else if (err_type == 2) {
    document.getElementById("err_popcomment_6_2").placeholder = error_list[err_type].error_comment;
    document.getElementById("err_popcomment_6_2").style.display = "block";
  } else if (err_type == 3) {
    document.getElementById("err_popcomment_6_3").placeholder = error_list[err_type].error_comment;
    document.getElementById("err_popcomment_6_3").style.display = "block";
  } else if (err_type == 4) {
    document.getElementById("err_popcomment_6_4").placeholder = error_list[err_type].error_comment;
    document.getElementById("err_popcomment_6_4").style.display = "block";
  }
  document.getElementById("popcomment_6_4").style.display = "none";
  document.getElementById("popbutton6_1").style.display="block";
  document.getElementById("popbutton6_2").style.display="none";
  document.getElementById("popbutton6_3").style.display="none";
  Popupbutton();
  // set focus
  document.getElementById("popbutton6_1").focus();
}

/*
 =========================================================================
 @function name                 : count_blank_col
 @argument [net_edit_data]      : structure of Ladder Net Edit Screen
 @description                   : blank line count
 @return [blank_cnt]            : the number of blanks
 =========================================================================
*/
function count_blank_col(net_edit_data) {

  var blank_flg = FLG_OFF;
  var blank_cnt = 0;

  grid_List.forEach(function (data, i, level, subnum) {
    for (ly_i = 0; ly_i < data.length; ly_i++) {
      for (lx_i = 0; lx_i < data[ly_i].length; lx_i++) {
        if ((net_edit_data[ly_i][lx_i].FigNo == 0) &&
            (net_edit_data[ly_i][lx_i].NetwriteUp == 0) &&
            (net_edit_data[ly_i][lx_i].NetwriteDown == 0) &&
            (net_edit_data[ly_i][lx_i].GridChkFlag == 0) &&
            (net_edit_data[ly_i][lx_i].SubParam1 == 0) &&
            (net_edit_data[ly_i][lx_i].SubParam2 == 0) &&
            (net_edit_data[ly_i][lx_i].SubParam3 == 0) &&
            (net_edit_data[ly_i][lx_i].SubParam4 == 0) &&
            (net_edit_data[ly_i][lx_i].SubParam5 == 0) &&
            (net_edit_data[ly_i][lx_i].SubParam6 == 0) &&
            (net_edit_data[ly_i][lx_i].Address == '')) {
              blank_flg = FLG_ON;
        } else {
          blank_flg = FLG_OFF;
          break;
        }
      }
      if (blank_flg == FLG_ON) {
        blank_cnt += 1;
      }
    }
  });
  return blank_cnt;
}
/*
 =========================================================================
 @function name                        : net_edit_list_restore
 @argument [grid_List_backup] : tructure of just after net edit
 @description                          : restore the list structure of the net edit
 @return [blank_cnt]                   : none
 =========================================================================
*/
function net_edit_list_restore(grid_List_backup) {
  grid_List = new List();
  wk_glist = JSON.parse(JSON.stringify(grid_List_backup.getData(0)));
  grid_List.push(wk_glist,grid_List_backup.getLevel(0),grid_List_backup.getSubNum(0));
  iterateArray = [];
  iterateArray = grid_List.pushIterateArray();
}

/*
 =========================================================================
 @function name                 : delete_blank_col
 @argument [net_edit_tmp_array] : structures edited in Ladder Net Edit Screen
 @description                   : delete blank column in list of Ladder Net Edit Screen
 @return [net_edit_tmp_array]   : structures with blank spots deleted
 =========================================================================
*/
function delete_blank_col(net_edit_tmp_array) {

  var blank_flg = FLG_OFF;
  var delete_cnt = 0;

  grid_List.forEach(function (data, i, level, subnum) {
    for (ly_i = 0; ly_i < data.length; ly_i++) {
      for (lx_i = 0; lx_i < data[ly_i].length; lx_i++) {
        if ((net_edit_tmp_array[ly_i][lx_i].FigNo == 0) &&
            (net_edit_tmp_array[ly_i][lx_i].NetwriteUp == 0) &&
            (net_edit_tmp_array[ly_i][lx_i].NetwriteDown == 0) &&
            (net_edit_tmp_array[ly_i][lx_i].GridChkFlag == 0) &&
            (net_edit_tmp_array[ly_i][lx_i].SubParam1 == 0) &&
            (net_edit_tmp_array[ly_i][lx_i].SubParam2 == 0) &&
            (net_edit_tmp_array[ly_i][lx_i].SubParam3 == 0) &&
            (net_edit_tmp_array[ly_i][lx_i].SubParam4 == 0) &&
            (net_edit_tmp_array[ly_i][lx_i].SubParam5 == 0) &&
            (net_edit_tmp_array[ly_i][lx_i].SubParam6 == 0) &&
            (net_edit_tmp_array[ly_i][lx_i].Address == '')) {
              blank_flg = FLG_ON;
        } else {
          blank_flg = FLG_OFF;
          break;
        }
      }
      if (blank_flg == FLG_ON) {
        net_edit_tmp_array.splice(ly_i,1);
        // delete and draw the front packed amount
        ly_i = ly_i - 1;
        delete_cnt += 1;
        // in the case of subroutine, it ends after deleting the added 8 lines
        if(g_subroutine_flg === FLG_ON && delete_cnt === 8){
          break;
        }
      }
    }
  });
  return net_edit_tmp_array;
}

/*
 =========================================================================
 @function name   : draw_ladder_net_edit
 @argument        : none
 @description     : drawing of the Ladder Net Edit Screen
 @return [false]  : unjust end
 =========================================================================
*/
function draw_ladder_net_edit(){
  // acquire to draw context
  canvas = document.getElementById('canvas_area');

  if(!canvas || !canvas.getContext) {
  return false;
  }
  // enable draw function(acquire 2D context to use a function of the draw)
  ctx = canvas.getContext('2d');

  // canvas setting for scroll
  scrollcanvas = document.getElementById('scroll');
  scrollcanvas_h = document.getElementById('scroll_h');

  if(!scrollcanvas || !scrollcanvas_h || !scrollcanvas.getContext) {
    return false;
    }
  // enable draw function(acquire 2D context to use a function of the draw)
  sctx = scrollcanvas.getContext('2d');

  shctx = scrollcanvas_h.getContext('2d');

  // set the initial value of the variable
  init_ladder_net_edit_var();

  // draw to ladder diagram
  draw_ladder_net_edit_diagram(clicked = SCROLLBAR_ACTION_NO_ACTION);

  // set click event for canvas element
  click_remove_event();
  canvas.addEventListener('click', click_grid, false);
  scrollcanvas.addEventListener('click', click_scroll_net_edit, false);
  scrollcanvas_h.addEventListener('click',click_scroll_grid,false);
  canvas.addEventListener('wheel', wheel_scroll, false);
  // if (g_device === 'smt' && top.tpkeyssheet !== undefined) { // using tabletTP
  //   canvas.addEventListener('touchstart', touchstart_scroll, false);
  //   canvas.addEventListener('touchend', touchend_scroll, false);
  //   scrollcanvas.addEventListener('touchstart', touchstart_scroll, false);
  //   scrollcanvas.addEventListener('touchend', touchend_scroll, false);
  //   scrollcanvas_h.addEventListener('touchstart', touchstart_scroll, false);
  //   scrollcanvas_h.addEventListener('touchend', touchend_scroll, false);
  // }
}

/*
 =========================================================================
 @function name : init_ladder_net_edit_var
 @argument      : none
 @description   : initialization of the variable
 @return        : none
 =========================================================================
*/
function init_ladder_net_edit_var() {
  display_grid_height = 0;
  click_cnt = VIEW_MAX_ROW;
  click_grid_lx = 0;
  click_grid_ly = 0;
  g_selected_element_x = 0;
  g_selected_element_y = 0;
}

/*
 =========================================================================
 @function name      : draw_ladder_net_edit_diagram
 @argument [clicked] : click infirmation
 @description        : draws the ladder diagram set in the display data structure
 @return             : none
 =========================================================================
*/
function draw_ladder_net_edit_diagram(clicked) {

  var lx_i = 0;
  var ly_i = 0;

  var lx_p = 0;
  var ly_p = 0;
  g_row_limit = 0;

  var call_draw_fig = 'FigureImageDraw_';

  screen_id = SCREEN_LADDER_NETEDIT;

  // the acquisition of the canvas drawing domain
  var drawing_area_info = document.getElementById('canvas_area');
  var drawing_area_width = drawing_area_info.attributes.width.nodeValue;
  var drawing_area_height = drawing_area_info.attributes.height.nodeValue;

  // offset to ajust the draw position(line of both ends of the ladder diagram)
  var canvas_x_offset   = 10;
  if (g_scroll_chg_flg == FLG_OFF) { // using iPendant or opboard screen
    var canvas_x_offset_2 = 54;
    var canvas_y_offset = 16;
  } else {
    var canvas_x_offset_2 = 10;
    var canvas_y_offset = 20;
  }

  // calculate size for 1 grid
  var grid_x_size = (drawing_area_width - canvas_x_offset - canvas_x_offset_2)/VIEW_GRID_COL;
  var grid_y_size = (drawing_area_height - canvas_y_offset)/VIEW_GRID_ROW;

  // start draw processing
  ctx.beginPath();  // declaration of the drawing start
  ctx.strokeStyle = COLOR_BLACK;  // filled style
  ctx.fillStyle   = COLOR_BLACK;  // style of the contour line

  // filled rectangle(light gray).
  ctx.fillStyle = COLOR_LIGHT_GRAY;
  ctx.fillRect(0, 0, drawing_area_width, drawing_area_height);

  g_net_edit_flg = FLG_ON;

  if (clicked == SCROLLBAR_ACTION_NO_ACTION) {
    // add the empty sequence for eight
    var net_edit_data = grid_List.getDataNum(0 ,iterateArray);
    var net_edit_tmp_array = net_edit_data;
    var before_net_edit_len = net_edit_data.length;
    net_edit_data.length = net_edit_data.length + 8;
    lengthcount_net_edit = before_net_edit_len + 1;  // used by scroll of the Ladder Net Edit Screen

    for (var i = before_net_edit_len; i < net_edit_data.length; i++) {
      net_edit_tmp_array[i] = [];
      for (var j = 0; j < grid_List.getDataNum(0 ,iterateArray)[0].length; j++) {
        net_edit_tmp_array[i][j] = create_grid();
      }
    }
    grid_List.setData(net_edit_tmp_array);

    lengthcount = net_edit_data.length;

    for (var ly_p = 0; ly_p < lengthcount; ly_p++) {
      for (var lx_p = 0; lx_p < grid_List.getDataNum(0 ,iterateArray)[0].length; lx_p++) {
        // stores grid position(coordinate)
        g_array_grid_pos[ly_p][lx_p].pos_x = canvas_x_offset + lx_p * grid_x_size;
        g_array_grid_pos[ly_p][lx_p].pos_y = 10 + ly_p * grid_y_size;
      }
    }

    // it is judged whether net including subroutine is included
    grid_List.forEach(function (data, i, level, subnum) {
      for (ly_i = 0; ly_i < data.length; ly_i++) {
        for (lx_i = 0; lx_i < data[ly_i].length; lx_i++) {
          if (grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].SubNo != 0) {
            g_subroutine_flg = FLG_ON;
            break;
          }
        }
        if (g_subroutine_flg == FLG_ON) {
          break;
        }
      }
    });
  } else if (clicked == SCROLLBAR_ACTION_RESIZE) {
    for (var ly_p = 0; ly_p < lengthcount; ly_p++) {
      for (var lx_p = 0; lx_p < grid_List.getDataNum(0 ,iterateArray)[0].length; lx_p++) {
        // stores grid position(coordinate)
        g_array_grid_pos[ly_p][lx_p].pos_x = canvas_x_offset + lx_p * grid_x_size;
        g_array_grid_pos[ly_p][lx_p].pos_y = 10 + ly_p * grid_y_size;
      }
    }
  }

  var lx_p = 0;
  var ly_p = 0;

  var net_index = 0;
  var grid_index = g_disp_grid_index;
  var width_index = g_disp_width_index;

  g_sub_param_info = {flg: FLG_OFF, index: 0, pos_info: []};

  // draw ruled lines
  ctx.save();

  //draw_borderLine
  if (g_device == 'smt') {
    draw_grid_border(grid_x_size, grid_y_size, canvas_x_offset, (drawing_area_width - canvas_x_offset - canvas_x_offset_2), (drawing_area_height - canvas_y_offset));
  }
  ctx.restore();
  ctx.beginPath();  // declaration of the drawing start

  grid_List.forEach_row(net_index, grid_index, iterateArray, function(data, i, fixed_grid_index, level, subnum){
    for (ly_i = 0; ly_i < data.length; ly_i++) {
      if (fixed_grid_index > 0) {
        fixed_grid_index = fixed_grid_index - 1;
        continue;
      }
      for (lx_i = width_index; lx_i < data[ly_i].length; lx_i++) {
        // drawing of the figure(image)
        (ArrFig[call_draw_fig + grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo])(ctx, 3, ctx.strokeStyle, g_array_grid_pos[ly_p][lx_p].pos_x, g_array_grid_pos[ly_p][lx_p].pos_y, grid_x_size, grid_y_size);
        
        // drawing of the upper lower part line
        if ((grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].NetwriteUp == 1) || (grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].NetwriteDown == 1)){
          vertical_line_net_edit(i, lx_i, ly_i, lx_p, ly_p, grid_x_size, grid_y_size);
        }

        // drawing of the subroutine
        if (grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].SubNo != 0) {
          diagram_subroutine_net_edit(i, lx_i, ly_i, lx_p, ly_p, grid_x_size, grid_y_size);
        }

        // drawing of the address ,the symbol and the comment
        if ((IMAGENO1_A_CONTACT <= data[ly_i][lx_i].FigNo && data[ly_i][lx_i].FigNo <= IMAGENO8_RDNT)){
          diagram_net_edit_details(i, lx_i, ly_i, lx_p, ly_p, grid_x_size, grid_y_size);
        }

        if (lx_i == 0) {
          // bar of both sides of the ladder diagram(black)
          ctx.fillStyle = COLOR_BLACK;
          ctx.lineWidth = 3;  // line weight
          ctx.strokeStyle = COLOR_BLACK;
          // the left line
          ctx.moveTo(canvas_x_offset, 0);
          ctx.lineTo(canvas_x_offset, drawing_area_height - canvas_y_offset);
        }
        if (lx_i == (g_width_num - 1)){
          // bar of both sides of the ladder diagram(black)
          ctx.fillStyle = COLOR_BLACK;
          ctx.lineWidth = 3;  // line weight
          ctx.strokeStyle = COLOR_BLACK;
          // the right line
          ctx.moveTo(canvas_x_offset + (grid_x_size * (lx_p + 1)), 0);
          ctx.lineTo(canvas_x_offset + (grid_x_size * (lx_p + 1)), drawing_area_height - canvas_y_offset);
        }

        lx_p += 1;
        // finished if display column to display to a screen
        if (lx_p == VIEW_GRID_COL) {
          break;
        }
      }
      // finished if display row to display to a screen
      g_row_limit += 1;
      if(VIEW_GRID_ROW == g_row_limit){
        break;
      }
      lx_p = 0;
      ly_p += 1;
    }
 });

  // drawing of the possible figure
  ctx.stroke();

  // declaration of the draw end
  ctx.closePath();

  // draw a red quadrangle
  if(clicked != SCROLLBAR_ACTION_NO_ACTION){
    draw_red_square(grid_x_size, grid_y_size, clicked);
  }

  // the red quadrangular initial position displays it on the left
  if(clicked == SCROLLBAR_ACTION_NO_ACTION){
    click_pos_tbl.lx = 0;
    click_pos_tbl.ly = 0;
    click_pos_net_edit_tbl.start_pos_lx = 0;
    click_pos_net_edit_tbl.start_pos_ly = 0;

    // for element information(for initial position)
    if ((g_array_grid_detail[grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].Address])) {
      elem_addr_str_old = grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].Address;
      document.getElementById('intbox.inbox.elem.addr').value = grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].Address;
      document.getElementById("elem_edit_pmc_symbol").innerHTML = g_array_grid_detail[grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].Address].Symbol;
      if (get_pmc_option_flg(PMC_OPTION_ES) === FLG_OFF) {
        document.getElementById("elem_edit_pmc_comment").innerHTML = g_array_grid_detail[grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].Address].Comment1;
      } else {
        document.getElementById("elem_edit_pmc_comment").innerHTML = lf_code_change(g_array_grid_detail[grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].Address].Comment1, "<br>");
      }
    }

    // draw a red quadrangle
    draw_red_square(grid_x_size, grid_y_size, clicked);

  }

  // drawing of the scroll bar
  draw_scrollbar();

  // drawing of the scroll bar
  draw_scrollbar_horizontal();

}

/*
 =========================================================================
 @function name  : click_scroll_net_edit
 @argument [evt] : event in the scroll bar clicked
 @description    : scroll processing in the Ladder Net Edit Screen(scroll of the grid unit)
 @return         : none
 =========================================================================
*/
function click_scroll_net_edit(evt) {
  // the scroll movement is invalid during popup indication
  // invalid in the case of symbol option is displayed
  if ((g_popup_flg == FLG_ON) || (g_symbol_flg == FLG_ON)) {
    return;
  }
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }
  var lx;
  var ly;
  var rect = evt.target.getBoundingClientRect();
  // if (g_device === 'smt' && top.tpkeyssheet !== undefined) { // using tabletTP
  //   lx = evt.touches[0].clientX - rect.left;
  //   ly = evt.touches[0].clientY - rect.top;
  // } else {
    lx = evt.clientX - rect.left;
    ly = evt.clientY - rect.top;
  // }

  var draw_area = CANVAS_AREA_LADDER_NETEDIT;

  // calculate the quantity of scroll movement and draw
  if (g_scroll_chg_flg == FLG_OFF) { // using iPendant or opboard screen
    click_scroll_net_edit_move(draw_area, ly, KEYBOARD_NO);
  } else {
    if (lx >= 5) {// 5 is scrollbar width
      return;
    } else {
      click_scroll_net_edit_move(draw_area, ly, KEYBOARD_NO);
    }
}

}

/*
 =========================================================================
 @function name            : click_scroll_net_edit_move
 @argument [draw_area]     : the canvas area to draw
 @argument [ly]            : click position
 @argument [keyboard_type] : kind of key which pressed hardkey
 @description              : draw in scroll of the grid unit
 @return                   : none
 =========================================================================
*/
function click_scroll_net_edit_move(draw_area, ly, keyboard_type) {
  var click_pos_move = 0;
  var scroll_width = 0;
  var scroll_area_click_flg = FLG_OFF;
  var click_info = null;

  if (SBHV_POS_S < ly && ly < SBHV_POS_C) {
    // click shift up area
    scrollbar_tbl.ly = Math.round((scrollBoxPos.start_y - SBHV_POS_E) / scrollBoxPos.box_height);
    if (scrollBoxPos.start_y === SBHV_POS_E) {
      scrollbar_tbl.ly = 0;
    }
    if (scrollbar_tbl.ly == SBHV_POS_S) {
      return;
    }
    click_info = SCROLLBAR_ACTION_SHIFT_UP_BUTTON;
    if ((scrollbar_tbl.ly - 5) < 0) {
      scrollbar_tbl.ly = 0;
      scrollBoxPos.start_y = 0;
      // drawing update
      g_disp_grid_index = 0;
    } else {
      scrollbar_tbl.ly -= 5;
      scrollBoxPos.start_y -= scrollBoxPos.box_height * 5;
      // drawing update
      g_disp_grid_index = g_disp_grid_index - 5;
    }

  } else if ((SBHV_POS_C < ly && ly < SBHV_POS_E) || (keyboard_type == KEYBOARD_UP)) {
    // pressed the upper button
    scrollbar_tbl.ly = Math.round((scrollBoxPos.start_y - SBHV_POS_E) / scrollBoxPos.box_height);
    if (scrollBoxPos.start_y === SBHV_POS_E) {
      scrollbar_tbl.ly = 0;
    }
    if (scrollbar_tbl.ly == SBHV_POS_S) {
      // if (g_flick_flg_tbl.scrolling == FLG_ON) {
      //   stop_flick_scroll();
      // }
      return;
    }
    click_info = SCROLLBAR_ACTION_UP_BUTTON;
    scrollbar_tbl.ly -= 1;
    scrollBoxPos.start_y -= scrollBoxPos.box_height;

    // drawing update
    g_disp_grid_index = g_disp_grid_index - 1;
  }else if(SBHV_POS_E < ly && ly < scrollBoxPos.start_y){
    // pressed the scroll area of the upper part
    scrollbar_tbl.ly = Math.round((scrollBoxPos.start_y - SBHV_POS_E) / scrollBoxPos.box_height);
    if (scrollbar_tbl.ly == SBHV_POS_S) {
      return;
    }
    click_info = SCROLLBAR_ACTION_UP_BUTTON;
    scroll_width = SCROLEBAR_DEFHEIGHT / lengthcount_net_edit;
    click_pos_move = Math.floor((ly - SBHV_POS_E) / scroll_width);
    scrollbar_tbl.ly = click_pos_move;
    scrollBoxPos.start_y = SBHV_POS_E + scrollBoxPos.box_height * click_pos_move;
    scroll_area_click_flg = FLG_ON;
  }else if(scrollBoxPos.start_y < ly && ly < scrollBoxPos.start_y + scrollBoxPos.box_height){
    // pressed the scroll box
  }else if(scrollBoxPos.start_y + scrollBoxPos.box_height < ly && ly < SBV_POS_S){
    // pressed the scroll area of the lower part
    scrollbar_tbl.ly = Math.round((scrollBoxPos.start_y - SBHV_POS_E) / scrollBoxPos.box_height);
    if(scrollbar_tbl.ly + 1 < lengthcount_net_edit){
      click_info = SCROLLBAR_ACTION_DOWN_BUTTON;
      scroll_width = SCROLEBAR_DEFHEIGHT / lengthcount_net_edit;
      click_pos_move = Math.floor((ly - SBHV_POS_E) / scroll_width);
      scrollbar_tbl.ly = click_pos_move;
      scrollBoxPos.start_y = SBHV_POS_E + scrollBoxPos.box_height * click_pos_move;
      scroll_area_click_flg = FLG_ON;
    } else {
      return;
    }
  } else if (SBV_POS_E - SBHV_POS_C < ly && ly < SBV_POS_E) {
    // click shift down area
    scrollbar_tbl.ly = Math.round((scrollBoxPos.start_y - SBHV_POS_E) / scrollBoxPos.box_height);
    if(scrollbar_tbl.ly < lengthcount_net_edit - 1){
      click_info = SCROLLBAR_ACTION_SHIFT_DOWN_BUTTON;
      if ((scrollbar_tbl.ly + 5) > lengthcount_net_edit - 1) {
        scrollbar_tbl.ly = lengthcount_net_edit - 1;
        scrollBoxPos.start_y = (scrollBoxPos.box_height * (lengthcount_net_edit - 1)) + SBHV_POS_E;
        // drawing update
        g_disp_grid_index = lengthcount_net_edit - 1;
      } else {
        scrollbar_tbl.ly += 5;
        scrollBoxPos.start_y += scrollBoxPos.box_height * 5;
        // drawing update
        g_disp_grid_index = g_disp_grid_index + 5;
      }
    } else {
      return;
    }
  } else if ((SBV_POS_S < ly && ly < SBV_POS_E - SBHV_POS_C) || (keyboard_type == KEYBOARD_DOWN)) {
    // pressed the lower button
    scrollbar_tbl.ly = Math.round((scrollBoxPos.start_y - SBHV_POS_E) / scrollBoxPos.box_height);
    if(scrollbar_tbl.ly < lengthcount_net_edit - 1){
      click_info = SCROLLBAR_ACTION_DOWN_BUTTON;
      scrollbar_tbl.ly += 1;
      scrollBoxPos.start_y += scrollBoxPos.box_height;
      // drawing update
      g_disp_grid_index = g_disp_grid_index + 1;
    } else {
      // if (g_flick_flg_tbl.scrolling == FLG_ON) {
      //   stop_flick_scroll();
      // }
      return;
    }
  }else if(keyboard_type == KEYBOARD_RIGHT) {
    // drawing update
    if (g_disp_width_index < g_width_num - 1) {
      if (draw_area == CANVAS_AREA_LADDER_NETEDIT) {
        click_info = SCROLLBAR_ACTION_ANY;
      } else {
        click_info = SCROLLBAR_ACTION_NO_ACTION;
      }
      g_disp_grid_index = g_disp_grid_index;
      g_disp_width_index = g_disp_width_index + 1;
    } else {
      return;
    }
  }else if(keyboard_type == KEYBOARD_LEFT) {
    // drawing update
    if (g_disp_width_index == 0) {
      return;
    } else {
      if (draw_area == CANVAS_AREA_LADDER_NETEDIT) {
        click_info = SCROLLBAR_ACTION_ANY;
      } else {
        click_info = SCROLLBAR_ACTION_NO_ACTION;
      }
      g_disp_grid_index = g_disp_grid_index;
      g_disp_width_index = g_disp_width_index - 1;
    }
  } else {
    return;
  }

  // drawing at the time of the pressing calculates scroll area
  if (scroll_area_click_flg == FLG_ON) {
    var tmp_index = 0;
    var check_flg = FLG_OFF;
    var offset_len = 0;
    for (var net_cnt = 0; net_cnt < lengthcount_net_edit; net_cnt++) {
      for (var net_cnt_i = 0; net_cnt_i < grid_List.getDataNum(net_cnt ,iterateArray).length; net_cnt_i++) {
        if (tmp_index == click_pos_move) {
          g_disp_grid_index = tmp_index - offset_len;
          check_flg = FLG_ON;
          break;
        }
        tmp_index += 1;
      }
      if (check_flg == FLG_ON) {
        break;
      }
      offset_len += grid_List.getDataNum(net_cnt ,iterateArray).length;
    }
  }

  // guard of the minimum of the scroll movement
  if(scrollbar_tbl.ly < 0){
    scrollbar_tbl.ly = 0;
  }else if(scrollbar_tbl.lx < 0){
    scrollbar_tbl.lx = 0;
  }

  // guard of the maximum of the scroll movement
  if(lengthcount_net_edit <= scrollbar_tbl.ly){
    scrollbar_tbl.ly = lengthcount_net_edit - 1;
  }else if(VIEW_MAX_COL <= scrollbar_tbl.lx){
    scrollbar_tbl.lx = VIEW_MAX_COL;
  }

  draw_ladder_net_edit_diagram(click_info);

}

/*
 =========================================================================
 @function name  : click_grid
 @argument [evt] : event in the case of draw range is clicked
 @description    : surround the clicked a grid with a red frame
 @return         : none
 =========================================================================
*/
function click_grid(evt) {
  if ((g_popup_flg == FLG_ON) || (g_symbol_flg == FLG_ON)) {
    return;
  }
  if (g_slide_scroll_flg == FLG_ON) {
    g_slide_scroll_flg = FLG_OFF;
    return;
  }
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }

  var lx_p = 0;
  var ly_p = 0;

  var lx = 0;
  var ly = 0;
  var rect = evt.target.getBoundingClientRect();

  lx = evt.clientX - rect.left;
  ly = evt.clientY - rect.top;
  if (lx > SBH_POS_TOUCH_E - 60) {
    return;
  }

  // the acquisition of the canvas drawing domain
  var drawing_area_info = document.getElementById('canvas_area');
  var drawing_area_width = drawing_area_info.attributes.width.nodeValue;
  var drawing_area_height = drawing_area_info.attributes.height.nodeValue;

  // offset to ajust the draw position(line of both ends of the ladder diagram)
  var canvas_x_offset = 10;
  if (g_scroll_chg_flg == FLG_OFF) { // using iPendant or opboard screen
    var canvas_x_offset_2 = 54;
    var canvas_y_offset = 16;
  } else {
    var canvas_x_offset_2 = 10;
    var canvas_y_offset = 20;
  }

  // calculate size for 1 grid
  var grid_x_size = (drawing_area_width - canvas_x_offset - canvas_x_offset_2 - 10) / VIEW_GRID_COL;
  var grid_y_size = (drawing_area_height - canvas_y_offset) / VIEW_GRID_ROW;

  // stores touched the grid
  g_selected_element_x_before = g_selected_element_x;
  g_selected_element_y_before = g_selected_element_y;

  g_selected_element_x = Math.floor((lx - canvas_x_offset) / grid_x_size);
  g_selected_element_y = Math.floor(ly / grid_y_size);
  g_selected_element_x = g_selected_element_x + g_disp_width_index;
  g_selected_element_y = g_selected_element_y + g_disp_grid_index;


  // immovable in the Ladder Net Edit Screen in a grid without address information
  if (g_subroutine_flg == FLG_ON) {
    // click TMRB, TMRBF and CTRB parameter
    if (g_sub_param_info.flg === FLG_ON) {
      for (var i = 0; i < g_sub_param_info.pos_info.length; i++) {
        var wk_array = g_sub_param_info.pos_info[i];
        if ((wk_array.start_x < lx && lx < wk_array.end_x) && (wk_array.start_y < ly && ly < (wk_array.end_y))) {
          display_sub_param_popup(grid_List.getDataNum(0, iterateArray)[wk_array.grid_y][wk_array.grid_x], wk_array.order);
          g_sub_param_info.index = i;
        }
      }
    }
    if (grid_List.getDataNum(0, iterateArray)[g_selected_element_y][g_selected_element_x].Address == '') {
      g_selected_element_x = g_selected_element_x_before;
      g_selected_element_y = g_selected_element_y_before;
      return;
    }
  }

  for (var ly_p = 0; ly_p < grid_List.getDataNum(0, iterateArray).length; ly_p++) {
    if ((g_array_grid_pos[ly_p][lx_p].pos_y < ly) && (ly < g_array_grid_pos[ly_p][lx_p].pos_y + grid_y_size)) {
      click_pos_tbl.ly = ly_p;
      click_pos_net_edit_tbl.start_pos_ly = ly_p;
      for (var lx_p = 0; lx_p < grid_List.getDataNum(0, iterateArray)[0].length; lx_p++) {
        // confirm the grid position
        if ((g_array_grid_pos[ly_p][lx_p].pos_x < lx) && (lx < g_array_grid_pos[ly_p][lx_p].pos_x + grid_x_size)) {
          click_pos_tbl.lx = lx_p;
          click_pos_net_edit_tbl.start_pos_lx = lx_p;
          break;
        }
      }
      break;
    }
  }
  // detect structure number of clicked a grid
  click_grid_lx = click_pos_tbl.lx;
  click_grid_ly = click_cnt - VIEW_MAX_ROW + click_pos_tbl.ly;

  g_selected_element_x = click_grid_lx + g_disp_width_index;
  g_selected_element_y = click_grid_ly + g_disp_grid_index;

  if (screen_id === SCREEN_LADDER_NETEDIT) {
    if ((g_selected_element_x == g_selected_element_x_before) && (g_selected_element_y == g_selected_element_y_before)) {
      // display the element information
      ladder_netedit_click_f2_button();
    } else {
      // redraw to eliminate rectangle
      var clicked = SCROLLBAR_ACTION_ANY;
      draw_ladder_net_edit_diagram(clicked);
    }
  }

}

/*
 =========================================================================
 @function name           : draw_grid_border
 @argument [grid_x_size]  : width of the grid
 @argument [grid_y_size]  : height of the grid
 @argument [start_offset] : drawing start position offset
 @argument [width]        : drawing end position for X coordinate
 @argument [height]       : drawing end position for Y coordinate
 @description             : drawing of the ruled lines
 @return                  : none
 =========================================================================
*/
function draw_grid_border(grid_x_size, grid_y_size, start_offset, width, height){
  ctx.lineWidth = 0.5;
  // appoint transparency
  ctx.globalAlpha = 0.5;
  // set line and blank length
  ctx.setLineDash([6, 6]);
  for (var i = 0; i < VIEW_GRID_ROW; i++) {
    ctx.beginPath();  // declaration of the drawing start
    // draw vertical line
    ctx.moveTo((start_offset + (grid_x_size * (i + 1))), start_offset);
    ctx.lineTo((start_offset + (grid_x_size * (i + 1))), height);
    // draw horizon line
    ctx.moveTo(start_offset, (start_offset + (grid_y_size * (i + 1))));
    ctx.lineTo(width, (start_offset + (grid_y_size * (i + 1))));
    ctx.stroke();
  }
}

/*
 =========================================================================
 @function name          : draw_red_square
 @argument [grid_x_size] : width of the grid
 @argument [grid_y_size] : height of the grid
 @argument [clicked]     : click information
 @description            : drawing of the red frame
 @return                 : none
 =========================================================================
*/
function draw_red_square(grid_x_size, grid_y_size, clicked){

  if (clicked == SCROLLBAR_ACTION_NO_ACTION) {
    select_x = 0;
    select_y = 0;
    g_selected_element_x = g_disp_width_index;
    g_selected_element_y = g_disp_grid_index;
  } else {
    select_x = g_selected_element_x - g_disp_width_index;
    select_y = g_selected_element_y - g_disp_grid_index;
  }

  if ((select_x < 0) || (select_y < 0)) {
    return;
  }

  // drawing process start
  ctx.beginPath();  // declaration of the drawing start

  // quadrangle(red)
  ctx.strokeStyle = COLOR_RED;  // filled style
  ctx.strokeRect(g_array_grid_pos[select_y][select_x].pos_x, g_array_grid_pos[select_y][select_x].pos_y, grid_x_size, grid_y_size);
  // appoint transparency
  ctx.globalAlpha = 0.1;

  // filled rectangle(red) of the permeation
  ctx.fillStyle = COLOR_RED;
  ctx.fillRect(g_array_grid_pos[select_y][select_x].pos_x, g_array_grid_pos[select_y][select_x].pos_y, grid_x_size, grid_y_size);
  // return transparency to a standard
  ctx.globalAlpha = 1.0;

  // drawing of the possible figure
  ctx.stroke();

  // declaration of the draw end
  ctx.closePath();

  // stored element information
  store_element_info();

}

/*
 =========================================================================
 @function name : store_element_info
 @argument      : none
 @description   : stored element information
 @return        : none
 =========================================================================
*/
function store_element_info() {
  if (!(g_array_grid_detail[grid_List.getDataNum(0, iterateArray)[g_selected_element_y][g_selected_element_x].Address])) {
    // in the case of choice grid information is empty
    elem_addr_str_old = "";
    document.getElementById('intbox.inbox.elem.addr').value = "";
    document.getElementById("elem_edit_pmc_symbol").innerHTML = "";
    document.getElementById("elem_edit_pmc_comment").innerHTML = "";
  } else {
    // for element information editing(stored element information for red quadrangle)
    elem_addr_str_old = grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].Address;
    document.getElementById('intbox.inbox.elem.addr').value = grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].Address;
    document.getElementById("elem_edit_pmc_symbol").innerHTML = g_array_grid_detail[grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].Address].Symbol;
    if (get_pmc_option_flg(PMC_OPTION_ES) === FLG_OFF) {
      document.getElementById("elem_edit_pmc_comment").innerHTML = g_array_grid_detail[grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].Address].Comment1;
    } else {
      document.getElementById("elem_edit_pmc_comment").innerHTML = lf_code_change(g_array_grid_detail[grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].Address].Comment1, "<br>");
    }
    element_info_flg = FLG_ON;
  }
}

/*
 =========================================================================
 @function name : init_net_info_copy_array
 @argument      : none
 @description   : initialize sequence for copy storage
 @return        : none
 =========================================================================
*/
function init_net_info_copy_array() {
  g_net_info_copy_array[0] = create_grid();
}

/*
 =========================================================================
 @function name : copy_ladder_grid
 @argument      : none
 @description   : copy information of the choice grid
 @return        : none
 =========================================================================
*/
function copy_ladder_grid(){

  var net_edit_data = grid_List.getDataNum(0 ,iterateArray);

  init_net_info_copy_array();

  g_net_info_copy_array[0].FigNo        = net_edit_data[g_selected_element_y][g_selected_element_x].FigNo;
  g_net_info_copy_array[0].Address      = net_edit_data[g_selected_element_y][g_selected_element_x].Address;
  g_net_info_copy_array[0].NetwriteUp   = 0;
  g_net_info_copy_array[0].NetwriteDown = 0;

}

/*
 =========================================================================
 @function name : paste_ladder_grid
 @argument      : none
 @description   : paste copy information
 @return        : none
 =========================================================================
*/
function paste_ladder_grid(){

  var net_edit_data = grid_List.getDataNum(0 ,iterateArray);
  var net_edit_tmp_array = net_edit_data;

  screen_id = SCREEN_LADDER_NETEDIT;
  switch(g_net_info_copy_array[0].FigNo){
    case IMAGENO3_COILE:
    case IMAGENO4_NOTCOILE:
    case IMAGENO5_SET:
    case IMAGENO6_RESET:
      // allow drawing only in the case of pasting COILE/NOTCOILE/SETCOILE/RESETCOILE to the right edge(maximum width)
      if(g_selected_element_x == (g_width_num - 1)){
        net_edit_tmp_array[g_selected_element_y][g_selected_element_x].FigNo        = g_net_info_copy_array[0].FigNo;
        net_edit_tmp_array[g_selected_element_y][g_selected_element_x].Address      = g_net_info_copy_array[0].Address;
        net_edit_tmp_array[g_selected_element_y][g_selected_element_x].NetwriteUp   = g_net_info_copy_array[0].NetwriteUp;
        net_edit_tmp_array[g_selected_element_y][g_selected_element_x].NetwriteDown = g_net_info_copy_array[0].NetwriteDown;
        net_edit_record.array_add(net_edit_tmp_array);

        draw_ladder_net_edit_diagram(clicked = SCROLLBAR_ACTION_ANY);
      }else{
        // popup indication of the error
        net_edit_err_popup2();
      }
      break;
    case IMAGENO1_A_CONTACT:
    case IMAGENO2_B_CONTACT:
    case IMAGENO7_RDPT:
    case IMAGENO8_RDNT:
    case IMAGENO9_LINE:
      // allow drawing only when pasting A_CONTACT/B_CONTACT/LINE to other than the right end(maximum width)
      if(g_selected_element_x != (g_width_num - 1) && (g_subroutine_flg === FLG_OFF || (g_subroutine_flg === FLG_ON && 
         net_edit_tmp_array[g_selected_element_y][g_selected_element_x].FigNo != IMAGENO0_BLANK && net_edit_tmp_array[g_selected_element_y][g_selected_element_x].FigNo != IMAGENO9_LINE &&
         g_net_info_copy_array[0].FigNo !== IMAGENO9_LINE))) {
        net_edit_tmp_array[g_selected_element_y][g_selected_element_x].FigNo        = g_net_info_copy_array[0].FigNo;
        net_edit_tmp_array[g_selected_element_y][g_selected_element_x].Address      = g_net_info_copy_array[0].Address;
        net_edit_tmp_array[g_selected_element_y][g_selected_element_x].NetwriteUp   = g_net_info_copy_array[0].NetwriteUp;
        net_edit_tmp_array[g_selected_element_y][g_selected_element_x].NetwriteDown = g_net_info_copy_array[0].NetwriteDown;
        net_edit_record.array_add(net_edit_tmp_array);

        draw_ladder_net_edit_diagram(clicked = SCROLLBAR_ACTION_ANY);
      }else{
        // popup indication of the error
        net_edit_err_popup2();
      }
      break;
    default:
      // popup indication of the error
      net_edit_err_popup2();
      break;
 }
}

/*
 =========================================================================
 @function name : click_a_contact
 @argument      : none
 @description   : processing in the case of editing button is selected for A contact
 @return        : none
 =========================================================================
*/
function click_a_contact(){
  if ((g_popup_flg == FLG_ON) || (g_symbol_flg == FLG_ON)) {
    return;
  }
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }

  if ((g_subroutine_flg == FLG_ON) && (grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].Address == '')) {
    return;
  } else {
    screen_id = SCREEN_LADDER_NETEDIT;
    if (g_selected_element_x != (g_width_num - 1)) {
      if (g_subroutine_flg == FLG_ON) {
        grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].FigNo = IMAGENO1_A_CONTACT;
      }else{
        grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].FigNo = IMAGENO1_A_CONTACT;

        net_edit_record.array_add(grid_List.getDataNum(0 ,iterateArray));

      }  

      draw_ladder_net_edit_diagram(clicked = SCROLLBAR_ACTION_ANY);
    } else {
      // popup indication of the error
      net_edit_err_popup1();
    }
  }

}

/*
 =========================================================================
 @function name : click_b_contact
 @argument      : none
 @description   : processing in the case of editing button is selected for B contact
 @return        : none
 =========================================================================
*/
function click_b_contact(){
  if ((g_popup_flg == FLG_ON) || (g_symbol_flg == FLG_ON)) {
    return;
  }
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }

  if ((g_subroutine_flg == FLG_ON) && (grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].Address == '')) {
    return;
  } else {
    screen_id = SCREEN_LADDER_NETEDIT;
    if (g_selected_element_x != (g_width_num - 1)) {
      if (g_subroutine_flg == FLG_ON) {
        grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].FigNo = IMAGENO2_B_CONTACT;
      } else {
        grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].FigNo = IMAGENO2_B_CONTACT;

        net_edit_record.array_add(grid_List.getDataNum(0 ,iterateArray));
      }

      draw_ladder_net_edit_diagram(clicked = SCROLLBAR_ACTION_ANY);
    } else {
      // popup indication of the error
      net_edit_err_popup1();
    }
  }

}

/*
 =========================================================================
 @function name : click_coil
 @argument      : none
 @description   : processing in the case of editing button is selected for coil
 @return        : none
 =========================================================================
*/
function click_coil(){
  if ((g_popup_flg == FLG_ON) || (g_symbol_flg == FLG_ON)) {
    return;
  }
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }

  if ((g_subroutine_flg == FLG_ON) && (grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].Address == '')) {
    return;
  } else {
    screen_id = SCREEN_LADDER_NETEDIT;
    if (g_selected_element_x == (g_width_num - 1)) {
      if (g_subroutine_flg == FLG_ON) {
        grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].FigNo = IMAGENO3_COILE;
      } else {
        grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].FigNo = IMAGENO3_COILE;
        net_edit_record.array_add(grid_List.getDataNum(0 ,iterateArray));

      }
  
      draw_ladder_net_edit_diagram(clicked = SCROLLBAR_ACTION_ANY);
    } else {
      // popup indication of the error
      net_edit_err_popup1();
    }
  }

}

/*
 =========================================================================
 @function name : click_not_coil
 @argument      : none
 @description   : processing in the case of editing button is selected for not coil
 @return        : none
 =========================================================================
*/
function click_not_coil(){
  if ((g_popup_flg == FLG_ON) || (g_symbol_flg == FLG_ON)) {
    return;
  }
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }

  if ((g_subroutine_flg == FLG_ON) && (grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].Address == '')) {
    return;
  } else {
    screen_id = SCREEN_LADDER_NETEDIT;
    if (g_selected_element_x == (g_width_num - 1)) {
      if (g_subroutine_flg == FLG_ON) {
        grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].FigNo = IMAGENO4_NOTCOILE;
      } else {
        grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].FigNo = IMAGENO4_NOTCOILE;

        net_edit_record.array_add(grid_List.getDataNum(0 ,iterateArray));

      }

      draw_ladder_net_edit_diagram(clicked = SCROLLBAR_ACTION_ANY);
    } else {
      // popup indication of the error
      net_edit_err_popup1();
    }
  }

}

/*
 =========================================================================
 @function name : click_horizontal_line
 @argument      : none
 @description   : processing in the case of editing button is selected for horizontal line
 @return        : none
 =========================================================================
*/
function click_horizontal_line(){
  if ((g_popup_flg == FLG_ON) || (g_symbol_flg == FLG_ON)) {
    return;
  }
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }

  if ((g_subroutine_flg == FLG_ON) && (grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].Address == '')) {
    return;
  } else {
    screen_id = SCREEN_LADDER_NETEDIT;
    if (g_selected_element_x != (g_width_num - 1)) {
      grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x] = create_grid();

      grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].FigNo = IMAGENO9_LINE;

      net_edit_record.array_add(grid_List.getDataNum(0 ,iterateArray));

      draw_ladder_net_edit_diagram(clicked = SCROLLBAR_ACTION_ANY);
    } else {
      // popup indication of the error
      net_edit_err_popup1();
    }
  }

}

/*
 =========================================================================
 @function name : click_vertical_line
 @argument      : none
 @description   : processing in the case of editing button is selected for vertical line
 @return        : none
 =========================================================================
*/
function click_vertical_line(){
  if ((g_popup_flg == FLG_ON) || (g_symbol_flg == FLG_ON)) {
    return;
  }
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }

  if ((g_subroutine_flg == FLG_ON) && (grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].Address == '')) {
    return;
  } else {
    var net_edit_data = grid_List.getDataNum(0 ,iterateArray);
    var net_edit_tmp_array = net_edit_data;

    screen_id = SCREEN_LADDER_NETEDIT;
    if (g_selected_element_x != (g_width_num - 1)) {
      if (g_selected_element_y != 0) {
        net_edit_tmp_array[g_selected_element_y][g_selected_element_x].NetwriteUp = 1;
        net_edit_tmp_array[g_selected_element_y - 1][g_selected_element_x].NetwriteDown = 1;
        grid_List.setData(net_edit_tmp_array);

        net_edit_record.array_add(grid_List.getDataNum(0 ,iterateArray));

      }
      draw_ladder_net_edit_diagram(clicked = SCROLLBAR_ACTION_ANY);
    } else {
      // popup indication of the error
      net_edit_err_popup1();
    }
  }

}

/*
 =========================================================================
 @function name : click_set_coil
 @argument      : none
 @description   : processing in the case of editing button is selected for set coil
 @return        : none
 =========================================================================
*/
function click_set_coil(){
  if ((g_popup_flg == FLG_ON) || (g_symbol_flg == FLG_ON)) {
    return;
  }
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }

  if ((g_subroutine_flg == FLG_ON) && (grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].Address == '')) {
    return;
  } else {
    screen_id = SCREEN_LADDER_NETEDIT;
    if (g_selected_element_x == (g_width_num - 1)) {
      grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].FigNo = IMAGENO5_SET;

      net_edit_record.array_add(grid_List.getDataNum(0 ,iterateArray));

      draw_ladder_net_edit_diagram(clicked = SCROLLBAR_ACTION_ANY);
    } else {
      // popup indication of the error
      net_edit_err_popup1();
    }
  }

}

/*
 =========================================================================
 @function name : click_reset_coil
 @argument      : none
 @description   : processing in the case of editing button is selected for reset coil
 @return        : none
 =========================================================================
*/
function click_reset_coil(){
  if ((g_popup_flg == FLG_ON) || (g_symbol_flg == FLG_ON)) {
    return;
  }
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }

  if ((g_subroutine_flg == FLG_ON) && (grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].Address == '')) {
    return;
  } else {
    screen_id = SCREEN_LADDER_NETEDIT;
    if (g_selected_element_x == (g_width_num - 1)) {
      grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].FigNo = IMAGENO6_RESET;

      net_edit_record.array_add(grid_List.getDataNum(0 ,iterateArray));

      draw_ladder_net_edit_diagram(clicked = SCROLLBAR_ACTION_ANY);
    } else {
      // popup indication of the error
      net_edit_err_popup1();
    }
  }

}

/*
 =========================================================================
 @function name : click_reset_button
 @argument      : none
 @description   : processing in the case of editing button is selected for reset button
 @return        : none
 =========================================================================
*/
function click_reset_button(){
  if ((g_popup_flg == FLG_ON) || (g_symbol_flg == FLG_ON)) {
    return;
  }
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }

  if ((g_subroutine_flg == FLG_ON) && (grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x].Address == '')) {
    return;
  } else {
    var net_edit_data = grid_List.getDataNum(0 ,iterateArray);
    var net_edit_tmp_array = net_edit_data;

    grid_List.getDataNum(0 ,iterateArray)[g_selected_element_y][g_selected_element_x] = create_grid();

    net_edit_tmp_array[g_selected_element_y][g_selected_element_x].NetwriteUp = 0;
    if (g_selected_element_y != 0) {
      net_edit_tmp_array[g_selected_element_y - 1][g_selected_element_x].NetwriteDown = 0;
    }
    grid_List.setData(net_edit_tmp_array);

    net_edit_record.array_add(grid_List.getDataNum(0 ,iterateArray));

    draw_ladder_net_edit_diagram(clicked = SCROLLBAR_ACTION_ANY);
  }

}

/*
 =========================================================================
 @function name : click_undo
 @argument      : none
 @description   : processing in the case of editing button is selected for undo button
 @return        : none
 =========================================================================
*/
function click_undo() {
  if ((g_popup_flg == FLG_ON) || (g_symbol_flg == FLG_ON)) {
    return;
  }
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }

  var index = net_edit_record.get_array_index();
  var array = net_edit_record.get_array();
  if (index < (array.length -1) && array.length > 1) {
    index = net_edit_record.array_index_increment();
    if (grid_List.getDataNum(0, iterateArray).length !== array[index].length) {
      lengthcount_net_edit--;
    }
    grid_List.setData((JSON.parse(JSON.stringify(array[index]))),0);
    draw_ladder_net_edit_diagram(clicked = SCROLLBAR_ACTION_ANY);
  }
}

/*
 =========================================================================
 @function name : click_redo
 @argument      : none
 @description   : processing in the case of editing button is selected for redo button
 @return        : none
 =========================================================================
*/
function click_redo() {
  if ((g_popup_flg == FLG_ON) || (g_symbol_flg == FLG_ON)) {
    return;
  }
  // if (g_flick_flg_tbl.scrolling == FLG_ON) {
  //   stop_flick_scroll();
  //   return;
  // }

  var index = net_edit_record.get_array_index();
  var array = net_edit_record.get_array();
  if (index >= array.length) {
    index = (array.length -1);
  }
  if (index > 0) {
    index = net_edit_record.array_index_decrement();
    if (grid_List.getDataNum(0, iterateArray).length !== array[index].length) {
      lengthcount_net_edit++;
    }
    grid_List.setData((JSON.parse(JSON.stringify(array[index]))),0);
    draw_ladder_net_edit_diagram(clicked = SCROLLBAR_ACTION_ANY);
  }
}

/*
 =========================================================================
 @function name                 : net_edit_err_popup1
 @argument [err_type]           : none
 @description                   : popup of the element additional failure of the Ladder Net Edit Screen
 @return                        : none
 =========================================================================
*/
function net_edit_err_popup1() {
  document.getElementById("popup_no_comfirm_6").style.display = "block";
  document.getElementById("poptitle").placeholder = "";
  document.getElementById("popcomment_6_1").style.display = "block";
  document.getElementById("popcomment_6_2").style.display = "none";
  document.getElementById("popcomment_6_3").style.display = "none";
  document.getElementById("err_popcomment_6_1").style.display = "none";
  document.getElementById("err_popcomment_6_2").style.display = "none";
  document.getElementById("err_popcomment_6_3").style.display = "none";
  document.getElementById("err_popcomment_6_4").style.display = "none";
  document.getElementById("popcomment_6_4").style.display = "none";
  document.getElementById("popbutton6_1").style.display="none";
  document.getElementById("popbutton6_2").style.display="none";
  document.getElementById("popbutton6_3").style.display="none";
  Popupbutton();
}

/*
 =========================================================================
 @function name                 : net_edit_err_popup2
 @argument [err_type]           : none
 @description                   : popup of the paste failure of the Ladder Net Edit Screen
 @return                        : none
 =========================================================================
*/
function net_edit_err_popup2() {
  document.getElementById("popup_no_comfirm_6").style.display = "block";
  document.getElementById("poptitle").placeholder = "";
  document.getElementById("popcomment_6_1").style.display = "none";
  document.getElementById("popcomment_6_2").style.display = "block";
  document.getElementById("popcomment_6_3").style.display = "none";
  document.getElementById("err_popcomment_6_1").style.display = "none";
  document.getElementById("err_popcomment_6_2").style.display = "none";
  document.getElementById("err_popcomment_6_3").style.display = "none";
  document.getElementById("err_popcomment_6_4").style.display = "none";
  document.getElementById("popcomment_6_4").style.display = "none";
  document.getElementById("popbutton6_1").style.display="none";
  document.getElementById("popbutton6_2").style.display="none";
  document.getElementById("popbutton6_3").style.display="none";
  Popupbutton();
}

/*
 =========================================================================
 @function name                 : net_edit_paste_popup1
 @argument [err_type]           : none
 @description                   : popup of the paste method choice of the Ladder Net Edit Screen
 @return                        : none
 =========================================================================
*/
function net_edit_paste_popup1() {
  document.getElementById("popup_no_comfirm_6").style.display = "block";
  document.getElementById("poptitle").placeholder = "";
  document.getElementById("popcomment_6_1").style.display = "none";
  document.getElementById("popcomment_6_2").style.display = "none";
  document.getElementById("popcomment_6_3").style.display = "none";
  document.getElementById("err_popcomment_6_1").style.display = "none";
  document.getElementById("err_popcomment_6_2").style.display = "none";
  document.getElementById("err_popcomment_6_3").style.display = "none";
  document.getElementById("err_popcomment_6_4").style.display = "none";
  document.getElementById("popcomment_6_4").style.display = "block";
  document.getElementById("popbutton6_1").style.display="none";
  document.getElementById("popbutton6_2").style.display="block";
  document.getElementById("popbutton6_3").style.display="block";
  Popupbutton();
}

/*
 =========================================================================
 @function name          : diagram_net_edit_details
 @argument [i]           : net number
 @argument [lx_i]        : element of the grid_List(row)
 @argument [ly_i]        : element of the grid_List(column)
 @argument [lx_p]        : element of the g_array_grid_pos(row)
 @argument [ly_p]        : element of the g_array_grid_pos(column)
 @argument [grid_x_size] : width of the grid
 @description            : drawing of the address ,the symbol and the comment
 @return                 : none
 =========================================================================
*/
function diagram_net_edit_details(i, lx_i, ly_i, lx_p, ly_p, grid_x_size, grid_y_size) {

  // in the case of there is not address in g_array_grid_detail, do return
  if (!(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address])) {
    return;
  }
  
  ctx.font    = "20px 'meiryo'";
  ctx.textAlign = "left";

  switch (select_symbol_button) {
  case 1:  // address
    ctx.fillStyle = COLOR_BLUE;
    character_limit(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
    if((IMAGENO3_COILE <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= IMAGENO6_RESET)){
      ctx.fillStyle = COLOR_PINK;
      ctx.fillText(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, 10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, 38 + g_array_grid_pos[ly_p][lx_p].pos_y);
    }
    break;
  case 2:  // symbols
    ctx.fillStyle = COLOR_GREEN;
    character_limit(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Symbol, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
    if((IMAGENO3_COILE <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= IMAGENO6_RESET)){
      ctx.fillStyle = COLOR_PINK;
      ctx.fillText(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, 10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, 38 + g_array_grid_pos[ly_p][lx_p].pos_y);
    }
    // in the case of there is not the symbol, display the address
    if (g_array_grid_detail[grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].Address].Symbol == ""){
      ctx.fillStyle = COLOR_BLUE;
      character_limit(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].Address, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
    } else {}
    break;
  case 3:  // address & symbols
    ctx.fillStyle = COLOR_BLUE;
    character_limit(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
    ctx.fillStyle = COLOR_GREEN;
    character_limit(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Symbol, CHAR_LOWER, ly_p, lx_p, grid_x_size, grid_y_size);
    if((IMAGENO3_COILE <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= IMAGENO6_RESET)){
      ctx.fillStyle = COLOR_PINK;
      ctx.fillText(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, 10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, 38 + g_array_grid_pos[ly_p][lx_p].pos_y);
    }
    break;
  case 4:  // comment
    if((IMAGENO3_COILE <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= IMAGENO6_RESET)){
      ctx.fillStyle = COLOR_PINK;
      ctx.fillText(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, 10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, 38 + g_array_grid_pos[ly_p][lx_p].pos_y);
      ctx.fillStyle = COLOR_BLUE;
      character_limit(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
    } else {
      ctx.fillStyle = COLOR_PINK;
      character_limit(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
    }
    // in the case of there is not the comment, display the address
    if (g_array_grid_detail[grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].Address].Comment1 == ""){
      ctx.fillStyle = COLOR_BLUE;
      character_limit(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].Address, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
    } else {}
    break;
  case 5:  // address & comment
    ctx.fillStyle = COLOR_BLUE;
    character_limit(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
    if((IMAGENO3_COILE <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= IMAGENO6_RESET)){
      ctx.fillStyle = COLOR_PINK;
      ctx.fillText(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, 10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, 38 + g_array_grid_pos[ly_p][lx_p].pos_y);
    } else {
      ctx.fillStyle = COLOR_PINK;
      character_limit(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, CHAR_LOWER, ly_p, lx_p, grid_x_size, grid_y_size);
    }
    break;
  case 6:  // symbols & comment
    ctx.fillStyle = COLOR_GREEN;
    character_limit(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Symbol, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
    if((IMAGENO3_COILE <= grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo && grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].FigNo <= IMAGENO6_RESET)){
      ctx.fillStyle = COLOR_PINK;
      ctx.fillText(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, 10 + grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x, 38 + g_array_grid_pos[ly_p][lx_p].pos_y);
    } else {
      ctx.fillStyle = COLOR_PINK;
      character_limit(g_array_grid_detail[grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].Address].Comment1, CHAR_LOWER, ly_p, lx_p, grid_x_size, grid_y_size);
    }
    // in the case of there is not the symbol, display the address
    if (g_array_grid_detail[grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].Address].Symbol == ""){
      ctx.fillStyle = COLOR_BLUE;
      character_limit(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].Address, CHAR_UPPER, ly_p, lx_p, grid_x_size, grid_y_size);
    } else {}
    break;
  default:
    return;
  }

}

/*
 =========================================================================
 @function name          : diagram_subroutine_net_edit
 @argument [i]           : net number
 @argument [lx_i]        : element of the grid_List(row)
 @argument [ly_i]        : element of the grid_List(column)
 @argument [lx_p]        : element of the g_array_grid_pos(row)
 @argument [ly_p]        : element of the g_array_grid_pos(column)
 @argument [grid_x_size] : width of the grid
 @argument [grid_y_size] : height of the grid
 @description            : drawing of the subroutine of the ladder diagram
 @return                 : none
 =========================================================================
*/
function diagram_subroutine_net_edit(i, lx_i, ly_i, lx_p, ly_p, grid_x_size, grid_y_size) {

  var num = 0;
  for (num = 0; num < subroutine_tbl.length; num++) {
    if (grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].SubNo == subroutine_tbl[num].sub_num) {
      var context = canvas.getContext('2d');
      context.strokeStyle = COLOR_BLACK;  // black

      // drawing of the quadrangle
      var rectangle_x = grid_x_size * subroutine_tbl[num].sub_width;
      var rectangle_y = grid_y_size * subroutine_tbl[num].sub_height;
      context.rect(g_array_grid_pos[ly_p][lx_p].pos_x, g_array_grid_pos[ly_p][lx_p].pos_y, rectangle_x, rectangle_y);

      // drawing of the line
      var line_pos_x = grid_x_size + g_array_grid_pos[ly_p][lx_p].pos_x;
      var line_pos_start_y = g_array_grid_pos[ly_p][lx_p].pos_y;
      var line_pos_end_y = line_pos_start_y + (grid_y_size * subroutine_tbl[num].sub_height);
      context.moveTo(line_pos_x, line_pos_start_y);
      context.lineTo(line_pos_x, line_pos_end_y);

      // drawing of the character
      ctx.fillStyle = COLOR_BLACK;
      ctx.font = "18px 'meiryo'";

      var param_offset = grid_x_size + 10;
      // drawing of the parameter of the subroutine
      if (grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].SubParam1 != undefined) {
        // subroutine parameter 1
        ctx.fillText(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].SubParam1, g_array_grid_pos[ly_p][lx_p].pos_x + param_offset, g_array_grid_pos[ly_p][lx_p].pos_y + 20);
        if (grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].SubParam2 != undefined) {
          // subroutine parameter 2
          ctx.fillText(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].SubParam2, g_array_grid_pos[ly_p][lx_p].pos_x + param_offset, g_array_grid_pos[ly_p][lx_p].pos_y + 40);
          if (grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].SubParam3 != undefined) {
            // subroutine parameter 3
            ctx.fillText(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].SubParam3, g_array_grid_pos[ly_p][lx_p].pos_x + param_offset, g_array_grid_pos[ly_p][lx_p].pos_y + 60);
            if (grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].SubParam4 != undefined) {
              // subroutine parameter 4
              ctx.fillText(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].SubParam4, g_array_grid_pos[ly_p][lx_p].pos_x + param_offset, g_array_grid_pos[ly_p][lx_p].pos_y + 80);
              if (grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].SubParam5 != undefined) {
                // subroutine parameter 5
                ctx.fillText(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].SubParam5, g_array_grid_pos[ly_p][lx_p].pos_x + param_offset, g_array_grid_pos[ly_p][lx_p].pos_y + 100);
                if (grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].SubParam6 != undefined) {
                  // subroutine parameter 6
                  ctx.fillText(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].SubParam6, g_array_grid_pos[ly_p][lx_p].pos_x + param_offset, g_array_grid_pos[ly_p][lx_p].pos_y + 120);
                }
              }
            }
          }
        }
      }
      // save timer position information
      switch (subroutine_tbl[num].sub_num) {
        case DEF_SUBROUTINE_CTRB.NUM:
        case DEF_SUBROUTINE_TMRB.NUM:
        case DEF_SUBROUTINE_TMRBF.NUM:
          g_sub_param_info.pos_info.push({
            order: subroutine_tbl[num].order, grid_y: ly_i, grid_x: lx_i,
            start_x: (g_array_grid_pos[ly_p][lx_p].pos_x + 125), start_y: (g_array_grid_pos[ly_p][lx_p].pos_y),
            end_x: (g_array_grid_pos[ly_p][lx_p].pos_x + rectangle_x), end_y: (g_array_grid_pos[ly_p][lx_p].pos_y + rectangle_y)
          });
          g_sub_param_info.flg = FLG_ON;
          break;
        default:
          break;
      }
      // subroutine number
      ctx.fillText("SUB " + subroutine_tbl[num].sub_num, g_array_grid_pos[ly_p][lx_p].pos_x + 10, g_array_grid_pos[ly_p][lx_p].pos_y + 25);
      // oerder name
      ctx.fillText(subroutine_tbl[num].order, g_array_grid_pos[ly_p][lx_p].pos_x + 10, g_array_grid_pos[ly_p][lx_p].pos_y + 50);
      var ctl_offset_x = Math.floor(grid_x_size / 4) * 3;
      var ctl_offset_y = Math.floor(grid_y_size / 3);
      if (subroutine_tbl[num].ctl_condition_1 != null) {
        // control requirement 1
        ctx.fillText(subroutine_tbl[num].ctl_condition_1, g_array_grid_pos[ly_p][lx_p].pos_x - ctl_offset_x, g_array_grid_pos[ly_p][lx_p].pos_y + ctl_offset_y);
        if (subroutine_tbl[num].ctl_condition_2 != null) {
          // control requirement 2
          ctx.fillText(subroutine_tbl[num].ctl_condition_2, g_array_grid_pos[ly_p][lx_p].pos_x - ctl_offset_x, g_array_grid_pos[ly_p][lx_p].pos_y + ctl_offset_y + grid_y_size);
          if (subroutine_tbl[num].ctl_condition_3 != null) {
            // control requirement 3
            ctx.fillText(subroutine_tbl[num].ctl_condition_3, g_array_grid_pos[ly_p][lx_p].pos_x - ctl_offset_x, g_array_grid_pos[ly_p][lx_p].pos_y + ctl_offset_y + (grid_y_size * 2));
            if (subroutine_tbl[num].ctl_condition_4 != null) {
              // control requirement 4
              ctx.fillText(subroutine_tbl[num].ctl_condition_4, g_array_grid_pos[ly_p][lx_p].pos_x - ctl_offset_x, g_array_grid_pos[ly_p][lx_p].pos_y + ctl_offset_y + (grid_y_size * 3));
              if (subroutine_tbl[num].ctl_condition_5 != null) {
                // control requirement 5
                ctx.fillText(subroutine_tbl[num].ctl_condition_5, g_array_grid_pos[ly_p][lx_p].pos_x - ctl_offset_x, g_array_grid_pos[ly_p][lx_p].pos_y + ctl_offset_y + (grid_y_size * 4));
                if (subroutine_tbl[num].ctl_condition_6 != null) {
                  // control requirement 6
                  ctx.fillText(subroutine_tbl[num].ctl_condition_6, g_array_grid_pos[ly_p][lx_p].pos_x - ctl_offset_x, g_array_grid_pos[ly_p][lx_p].pos_y + ctl_offset_y + (grid_y_size * 5));
                }
              }
            }
          }
        }
      }
      break;
    }
  }
}

/*
 =========================================================================
 @function name          : vertical_line_net_edit
 @argument [i]           : net number
 @argument [lx_i]        : element of the grid_List(row)
 @argument [ly_i]        : element of the grid_List(column)
 @argument [lx_p]        : element of the g_array_grid_pos(row)
 @argument [ly_p]        : element of the g_array_grid_pos(column)
 @argument [grid_x_size] : width of the grid
 @argument [grid_y_size] : height of the grid
 @description            : drawing of the up and down line
 @return                 : none
 =========================================================================
*/
function vertical_line_net_edit(i, lx_i, ly_i, lx_p, ly_p, grid_x_size, grid_y_size){

  var context = canvas.getContext('2d');
  context.strokeStyle = COLOR_BLACK;  // black

  var line_updown_pos_x = 0;
  var line_updown_pos_y = 0;

  // drawing of the up and down line
  line_updown_pos_x = g_array_grid_pos[ly_p][lx_p].pos_x + grid_x_size;
  line_updown_pos_y = grid_y_size / 2;

  if(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].NetwriteUp == 1){
    context.moveTo(line_updown_pos_x, g_array_grid_pos[ly_p][lx_p].pos_y);
    context.lineTo(line_updown_pos_x, g_array_grid_pos[ly_p][lx_p].pos_y + line_updown_pos_y);
  }else{}
  
  if(grid_List.getDataNum(i ,iterateArray)[ly_i][lx_i].NetwriteDown == 1){
    context.moveTo(line_updown_pos_x, g_array_grid_pos[ly_p][lx_p].pos_y + line_updown_pos_y);
    context.lineTo(line_updown_pos_x, g_array_grid_pos[ly_p][lx_p].pos_y + line_updown_pos_y * 2);
  }else{}

}

/*
 =========================================================================
 @function name : ladder_netedit_insert_row_button
 @argument      : none
 @description   : insert row processing
 @return        : none
 =========================================================================
*/
function ladder_netedit_insert_row_button() {
  var net_edit_data = grid_List.getDataNum(0 ,iterateArray);
  screen_id = SCREEN_LADDER_NETEDIT;

  if (g_selected_element_y === 0 || net_edit_data[g_selected_element_y][g_selected_element_x].FigNo === IMAGENO0_BLANK || g_subroutine_flg === FLG_ON) {
    return;
  } else {
    // insert row
    net_edit_data.splice(g_selected_element_y, 0, []);
    lengthcount_net_edit++;

    for (var j = 0; j < grid_List.getDataNum(0, iterateArray)[0].length; j++) {
      net_edit_data[g_selected_element_y][j] = create_grid();
      if (net_edit_data[g_selected_element_y + 1][j].NetwriteUp === 1) {
        net_edit_data[g_selected_element_y][j].NetwriteUp = 1;
        net_edit_data[g_selected_element_y][j].NetwriteDown = 1;
      }
    }

    // the acquisition of the canvas drawing domain
    var drawing_area_info = document.getElementById('canvas_area');
    var drawing_area_width = drawing_area_info.attributes.width.nodeValue;
    var drawing_area_height = drawing_area_info.attributes.height.nodeValue;

    // offset to ajust the draw position(line of both ends of the ladder diagram)
    var canvas_x_offset   = 10;
    if (g_scroll_chg_flg == FLG_OFF) { // using iPendant or opboard screen
      var canvas_x_offset_2 = 54;
      var canvas_y_offset = 16;
    } else {
      var canvas_x_offset_2 = 10;
      var canvas_y_offset = 20;
    }    
    // calculate size for 1 grid
    var grid_x_size = (drawing_area_width - canvas_x_offset - canvas_x_offset_2 - 10)/VIEW_GRID_COL;
    var grid_y_size = (drawing_area_height - canvas_y_offset)/VIEW_GRID_ROW;

    lengthcount = net_edit_data.length;

    for (var ly_p = 0; ly_p < lengthcount; ly_p++) {
      for (var lx_p = 0; lx_p < grid_List.getDataNum(0 ,iterateArray)[0].length; lx_p++) {
        // stores grid position(coordinate)
        g_array_grid_pos[ly_p][lx_p].pos_x = canvas_x_offset + lx_p * grid_x_size;
        g_array_grid_pos[ly_p][lx_p].pos_y = 10 + ly_p * grid_y_size;
      }
    }
    net_edit_record.array_add(net_edit_data);
    draw_ladder_net_edit_diagram(clicked = SCROLLBAR_ACTION_ANY);
  }
}

/*
 =========================================================================
 @function name        : ladder_netedit_insert_column
 @argument [position]  : insert column position
 @description          : insert back column processing
 @return               : delete column position / false
 =========================================================================
*/
function ladder_netedit_insert_column(position) {
  var net_edit_data = grid_List.getDataNum(0 ,iterateArray);
  screen_id = SCREEN_LADDER_NETEDIT;
  var lx_del = null;
  var front_offset = 0;
  var back_offset = 0;
  
  if (position === "front"){
    front_offset = 1;
    back_offset = 0;
  } else if (position === "back"){
    front_offset = 0;
    back_offset = 1;
  } else {
    return false;
  }

  if (net_edit_data[g_selected_element_y][g_selected_element_x].FigNo === IMAGENO0_BLANK || g_subroutine_flg === FLG_ON) {
    return false;
  } else if (position === "back" && g_selected_element_x === (net_edit_data[g_selected_element_y].length - 1)) {
    return false;
  } else {
    lx_del = delete_column_check(net_edit_data, position);

    if (lx_del === null) {
      return false;
    } else {
      // insert column
      for (ly_i = 0; ly_i < net_edit_data.length; ly_i++) {
        net_edit_data[ly_i].splice(g_selected_element_x + back_offset, 0, []);
        net_edit_data[ly_i][g_selected_element_x + back_offset] = create_grid();
        if (net_edit_data[ly_i][g_selected_element_x + front_offset].FigNo != IMAGENO0_BLANK) {
          net_edit_data[ly_i][g_selected_element_x + back_offset].FigNo = IMAGENO9_LINE;
        }
        if (position === "back"){
          // move to up and down line
          net_edit_data[ly_i][g_selected_element_x + back_offset].NetwriteUp = net_edit_data[ly_i][g_selected_element_x].NetwriteUp;
          net_edit_data[ly_i][g_selected_element_x + back_offset].NetwriteDown = net_edit_data[ly_i][g_selected_element_x].NetwriteDown;
          net_edit_data[ly_i][g_selected_element_x].NetwriteUp = 0;
          net_edit_data[ly_i][g_selected_element_x].NetwriteDown = 0;
        }
        // delete column
        net_edit_data[ly_i].splice(lx_del, 1);
      }
    }
    if (g_paste_insert_flg === FLG_OFF) {
      net_edit_record.array_add(net_edit_data);
    }
    draw_ladder_net_edit_diagram(clicked = SCROLLBAR_ACTION_ANY);
    return lx_del;
  }
}

/*
 =========================================================================
 @function name            : delete_column_check
 @argument [net_edit_data] : net edit list data
 @argument [position]      : insert column position
 @description              : delete column check processing
 @return [lx_del]          : delete column position
 =========================================================================
*/
function delete_column_check(net_edit_data, position) {
  var not_delete_flg = FLG_OFF;
  var lx_del = null;

  for (lx_i = 0; lx_i < net_edit_data[g_selected_element_y].length; lx_i++) {
    for (ly_i = 0; ly_i < net_edit_data.length; ly_i++) {
      if ((net_edit_data[ly_i][lx_i].FigNo >= IMAGENO1_A_CONTACT && net_edit_data[ly_i][lx_i].FigNo <= IMAGENO8_RDNT) ||
         ((net_edit_data[ly_i][lx_i].FigNo === IMAGENO0_BLANK || net_edit_data[ly_i][lx_i].FigNo === IMAGENO9_LINE) &&
          (net_edit_data[ly_i][lx_i].NetwriteUp === 1 || net_edit_data[ly_i][lx_i].NetwriteDown === 1))) {
        not_delete_flg = FLG_ON;
      }
    }
    if (not_delete_flg === FLG_OFF) {
      lx_del = lx_i;
      if (g_selected_element_x < lx_del && position === "front") {
        lx_del++;
      } else if (g_selected_element_x + 1 <= lx_del && position === "back") {
        lx_del++;
      } else { }
      break;
    } else {
      not_delete_flg = FLG_OFF;
    }
  }
  return lx_del;
}

/*
 =========================================================================
 @function name : net_edit_paste_check
 @argument      : none
 @description   : check the popup display at the time of the paste
 @return        : none
 =========================================================================
*/
function net_edit_paste_check() {
  var net_edit_data = grid_List.getDataNum(0 ,iterateArray);
  screen_id = SCREEN_LADDER_NETEDIT;
  switch(g_net_info_copy_array[0].FigNo){
    case IMAGENO3_COILE:
    case IMAGENO4_NOTCOILE:
    case IMAGENO5_SET:
    case IMAGENO6_RESET:
    case IMAGENO1_A_CONTACT:
    case IMAGENO2_B_CONTACT:
    case IMAGENO7_RDPT:
    case IMAGENO8_RDNT:
    case IMAGENO9_LINE:
      break;
    default:
      // popup indication of the error
      net_edit_err_popup2();
      return;
  }
  
  if (net_edit_data[g_selected_element_y][g_selected_element_x].FigNo === IMAGENO0_BLANK || net_edit_data[g_selected_element_y][g_selected_element_x].FigNo === IMAGENO9_LINE) {
    paste_ladder_grid();
  } else {
    g_paste_insert_flg = FLG_OFF;
    net_edit_paste_popup1();
    document.getElementById('popbutton6_2').focus();
    document.onkeydown = ladder_netedit_paste_popup_keydown;
  }
}

/*
 =========================================================================
 @function name        : net_edit_paste_popup_click
 @argument [option_no] : none
 @description          : action of the paste method choice
 @return               : none
 =========================================================================
*/
function net_edit_paste_popup_click(option_no) {
  closeDialog();
  switch (option_no) {
  case NETEDIT_PASTE_OPTION_INS:
    switch(g_net_info_copy_array[0].FigNo){
      case IMAGENO3_COILE:
      case IMAGENO4_NOTCOILE:
      case IMAGENO5_SET:
      case IMAGENO6_RESET:
        net_edit_err_popup2();
        return;
      default:
        break;
    }
    g_paste_insert_flg = FLG_ON;
    var insert_ret = ladder_netedit_insert_column("front");
    g_paste_insert_flg = FLG_OFF;
    if (insert_ret === false) {
      return;
    } else {
      if (g_selected_element_x >= insert_ret) {
        g_selected_element_x--;
        if (g_selected_element_x < 0) {
          g_selected_element_x = 0;
        }
      }
    }
    break;
  default:
    break;
  }
  paste_ladder_grid();
}

/*
 =========================================================================
 @function name : ladder_netedit_paste_popup_keydown
 @argument      : none
 @description   : processing at the time of the hard key pressing
                  (among the popup screen display at the time of the paste)
 @return        : none
 =========================================================================
*/
function ladder_netedit_paste_popup_keydown(event) {
  var key_code = event.keyCode;
  var key_ctrl = event.ctrlKey;
  // notify a browser to invalidity of the key
  invalidate_notification_key(event);

  switch (key_code) {
  case 13:  // enter key
    if(focus_overwrite_flg === FLG_ON){
      net_edit_paste_popup_click(NETEDIT_PASTE_OPTION_OWT);
    } else if(focus_overwrite_flg === FLG_OFF) {
      net_edit_paste_popup_click(NETEDIT_PASTE_OPTION_INS);
    } else { }
    break;
  case 37:  // keyboard left
    document.getElementById('popbutton6_2').focus();
    break;
  case 39:  // keyboard right
    document.getElementById('popbutton6_3').focus();
    break;
  case 52:  // function4 key(TP environment)
    if (key_ctrl == true) {
      closeDialog();
    }
    break;
  case 115:  // function4 key
    closeDialog();
    break;
  default:
    break;
  }
}

/*
 =========================================================================
 @function name : onfocus_overwrite_button
 @argument      : none
 @description   : overwrite button onfocus processing
                 (among the popup screen display at the time of the paste)
 @return        : none
 =========================================================================
*/
function onfocus_overwrite_button() {
  focus_overwrite_flg = FLG_ON;
}

/*
 =========================================================================
 @function name : onfocus_insert_button
 @argument      : none
 @description   : insert button onfocus processing
                 (among the popup screen display at the time of the paste)
 @return        : none
 =========================================================================
*/
function onfocus_insert_button() {
  focus_overwrite_flg = FLG_OFF;
}

/*
 =========================================================================
 @function name : outfocus_overwrite_button
 @argument      : none
 @description   : button outfocus processing
                 (among the popup screen display at the time of the paste)
 @return        : none
 =========================================================================
*/
function outfocus_overwrite_button() {
  focus_overwrite_flg = null;
}

/*
 =========================================================================
 @function name       : display_sub_param_popup
 @argument [sub_elem] : target subroutine object
 @argument [order]    : subroutine order name
 @description         : popup of subroutine parameter edit
 @return              : none
 =========================================================================
*/
function display_sub_param_popup(sub_elem, order) {
  document.getElementById("popup_no_comfirm_6").style.display = "block";
  document.getElementById("poptitle").placeholder = "";
  document.getElementById("popcomment_6_1").style.display = "none";
  document.getElementById("popcomment_6_2").style.display = "none";
  document.getElementById("popcomment_6_3").style.display = "none";
  document.getElementById("err_popcomment_6_1").placeholder = "";
  document.getElementById("err_popcomment_6_1").style.display = "none";
  document.getElementById("err_popcomment_6_2").placeholder = "";
  document.getElementById("err_popcomment_6_2").style.display = "none";
  document.getElementById("err_popcomment_6_3").placeholder = "";
  document.getElementById("err_popcomment_6_3").style.display = "none";
  document.getElementById("err_popcomment_6_4").placeholder = "";
  document.getElementById("err_popcomment_6_4").style.display = "none";
  document.getElementById("popcomment_6_4").style.display = "none";
  document.getElementById("popbutton6_1").style.display = "none";
  document.getElementById("popbutton6_2").style.display = "none";
  document.getElementById("popbutton6_3").style.display = "none";
  document.getElementById("sub_param_area").style.display = "block";
  // clear textbox and error comment
  document.getElementById('err_comment_param2').innerText = "";
  var param_cnt = 0;
  switch (order) {
    // not supported
    // case DEF_SUBROUTINE_TMRST.ORDER:
    // case DEF_SUBROUTINE_TMRSS.ORDER:
    //   param_cnt = sub_elem.SubParamRawData.length - 1;
    //   break;
    default:
      param_cnt = sub_elem.SubParamRawData.length;
      break;
  }
  // set parameters in the text box
  for (var i = 0; i < param_cnt; i++) {
    if (i === 0) {
      document.getElementById('sub_param' + (i + 1)).innerText = sub_elem["SubParam" + (i + 1)];
    } else {
      document.getElementById('intbox.inbox.param' + (i + 1)).value = sub_elem["SubParam" + (i + 1)];
    }
    if (sub_elem.SubNo === DEF_SUBROUTINE_CTRB.NUM) {
      document.getElementById('id_net_editor_param' + (i + 1)).innerText = sub_param_msg_list.CTR[i];
    } else {
      document.getElementById('id_net_editor_param' + (i + 1)).innerText = sub_param_msg_list.TMR[i];
    }
  }
  // set title target subroutine
  document.getElementById("sub_edit_info").innerText = "SUB " + sub_elem.SubNo + " " + order;
  Popupbutton();
}

/*
 =========================================================================
 @function name : check_sub_edit_param
 @argument      : none
 @description   : input check of parameters
 @return        : none
 =========================================================================
*/
function check_sub_edit_param() {
  var target_info = g_sub_param_info.pos_info[g_sub_param_info.index];
  var target = grid_List.getDataNum(0, iterateArray)[target_info.grid_y][target_info.grid_x];
  var chk_obj;
  switch (target.SubNo) {
    case DEF_SUBROUTINE_CTRB.NUM:
      chk_obj = check_numerical_param({ start: DEF_SUBROUTINE_CTRB.PRESET_MIN, end: DEF_SUBROUTINE_CTRB.PRESET_MAX });
      break;
    case DEF_SUBROUTINE_TMRB.NUM:
    case DEF_SUBROUTINE_TMRBF.NUM:
      // The set time value of TMRB and the set time value of TMRBF are the same
      chk_obj = check_numerical_param({ start: DEF_SUBROUTINE_TMRB.TIME_MIN, end: DEF_SUBROUTINE_TMRB.TIME_MAX });
      break;
    default:
      return;
  }
  
  if (chk_obj.result) {
    set_sub_param_val(target, chk_obj.update_data);
  }
}

/*
 =========================================================================
 @function name    : check_numerical_param
 @argument [range] : numerical value for range check
 @description      : numerical input check of parameters
 @return           : result and int value
 =========================================================================
*/
function check_numerical_param(range) {
  var chk_obj = { result: false, update_data: 0 };
  var val = document.getElementById('intbox.inbox.param2').value.trim();
  if (val.length > 0) {
    if (is_integer(val)) {
      if (check_param_range(range.start, range.end, val)) {
        chk_obj.result = true;
        chk_obj.update_data = parseInt(val, 10);
      } else {
        document.getElementById('err_comment_param2').innerText = sub_param_msg_list.err[SUB_PARAM_ERROR_OUT_RANGE] + "( " + range.start + " - " + range.end + " )";
      }
    } else {
      document.getElementById('err_comment_param2').innerText = sub_param_msg_list.err[SUB_PARAM_ERROR_INVALID_STRING];
    }
  } else {
    document.getElementById('err_comment_param2').innerText = sub_param_msg_list.err[SUB_PARAM_ERROR_NO_INPUT];
  }
  return chk_obj;
}

/*
 =========================================================================
 @function name     : set_sub_param_val
 @argument [target] : target grid_list structure
 @argument [data]   : update parameter value
 @description       : update grid_list structure and redraw ladder
 @return            : none
 =========================================================================
*/
function set_sub_param_val(target, data) {
  // update glid_list data
  target.SubParam2 = data;
  target.SubParamRawData[1] = data;
  closeDialog();
  // redraw ladder
  draw_ladder_net_edit_diagram(SCROLLBAR_ACTION_ANY);
}

/*
 =========================================================================
 @function name   : is_integer
 @argument [val]  : input value
 @description     : check that the input value is an integer
 @return          : true / false
 =========================================================================
*/
function is_integer(val){
  // check condition pattern
  var pattern = /^\d*$/;
  return pattern.test(val);
}

/*
 =========================================================================
 @function name     : check_param_range
 @argument [start]  : start range value
 @argument [end]    : end range value
 @argument [val]    : input value
 @description       : input value range check
 @return            : true / false
 =========================================================================
*/
function check_param_range(start, end, val) {
  if (start <= val && val <= end) {
    return true;
  } else {
    return false;
  }
}

// end of file
                                                                                                                                                                                                                         /*
 * @fileoverview : PMC Ladder iHMI ladder program replace script
 * @char-code    : SJIS
 * @NewLineCode  : LF
 */

/**
  Constant definition
**/
var HEADER_ID_LADDER_REPLACE = "headert_7";

/**
  Global(Only this file)
**/
var g_replace_range = "";
var g_replace_list_node_no = null;

/*
 =========================================================================
 @function name    : ladder_search_callback
 @argument [id]    : element ID
 @argument [type]  : element Type
 @argument [props] : select element value
 @description      : select box callback function
 @return           : none
 =========================================================================
*/
function ladder_replace_range_callback(id, type, value) {
  g_replace_range = value;
}

/*
 =========================================================================
 @function name : get_ladder_tree_level
 @argument      : none
 @description   : acquire ladder tree level choosing
 @return        : ladder tree level choosing
 =========================================================================
*/
function get_ladder_replace_range() {
  var replace_level = g_replace_range;
  return replace_level;
}

/*
 =========================================================================
 @function name           : set_ladder_tree_level
 @argument[replace_level] : none
 @description             : acquire ladder tree level setting
 @return                  : set ladder tree level
 =========================================================================
*/
function set_ladder_replace_range(replace_level) {
  g_replace_range = replace_level;
}

/*
 =========================================================================
 @function name : ladder_replace_click_f1_button
 @argument      : none
 @description   : F1 key click processing
 @return        : none
 =========================================================================
*/
function ladder_replace_click_f1_button() {
  if (document.getElementById('iSelect4').className === "select message-box-contents-right opened") {
    document.getElementById('iSelect4.label').click();
  }
  move_to_ladder_editor('screen_ladder_replace');
}

/*
 =========================================================================
 @function name : move_to_ladder_replace
 @argument [id] : the element id of the origin of transition
 @description   : ladder replace transition API
 @return        : none
 =========================================================================
*/
function move_to_ladder_replace(id) {
  // add words to header character string(running or stopped)
  var headert_elem = document.getElementById(HEADER_ID_LADDER_REPLACE);
  getPmcRunStatus(g_pmc_no, function (pmc_num, status) {
    if (g_pmc_no == PMC_MEMORY_TYPE_DCS) {
      headert_elem.innerHTML = (status == PMC_RUNNING) ? headert + safety + pmc_lang_table['LadderReplace'].headert_7 + pmc_status_run : headert + safety + pmc_lang_table['LadderReplace'].headert_7 + pmc_status_stop;
    } else {
      headert_elem.innerHTML = (status == PMC_RUNNING) ? headert + g_pmc_no + pmc_lang_table['LadderReplace'].headert_7 + pmc_status_run : headert + g_pmc_no + pmc_lang_table['LadderReplace'].headert_7 + pmc_status_stop;
    }
  });

  // set the pulldown list of replace range
  var tree_edit_level = get_ladder_tree_edit_level();
  set_ladder_replace_range(tree_edit_level);
  document.getElementById("iSelect4").refresh([], parseInt(tree_edit_level, 10), null, false, "header changed");

  document.activeElement.blur();
  document.getElementById('screen_ladder_replace').style.display = 'block';
  document.getElementById('worldDiv').style.display = 'none';
  document.getElementById(id).style.display = 'none';
  document.onkeydown = ladder_replace_keydown;
  get_pmc_data_from_server(PMC_DATA_LOAD_KIND.PMC_DATA_COMPARE);
}

/*
 =========================================================================
 @function name : ladder_replace_keydown
 @argument      : none
 @description   : processing at the time of the hard key pressing
 @return        : none
 =========================================================================
*/
function ladder_replace_keydown(event) {
  var key_code = event.keyCode;
  var key_ctrl = event.ctrlKey;
  var key_shift = event.shiftKey;
  // notify a browser to invalidity of the key
  invalidate_notification_key(event);

  // during popup is only close button valid
  if (g_popup_flg === FLG_ON) {
    switch (key_code) {
      case 52:  // function4 key(TP environment)
        if (key_ctrl == true) {
          closeDialog();
        }
        break;
      case 115:  // function4 key
        closeDialog();
        break;
      default:
        break;
    }
    return;
  }

  switch (key_code) {
    case 49:  // function1 key(TP environment)
      if (key_ctrl == true) {
        ladder_replace_click_f1_button();
      }
      break;
    case 27:  // prev button(TP environment)
    case 112:  // function1 key
      ladder_replace_click_f1_button();
      break;
    case 50:  // function2 key(TP environment)
      if (key_ctrl == true) {
        ladder_replace_click_f2_button();
      }
      break;
    case 113:  // function2 key
      ladder_replace_click_f2_button();
      break;
    case 51:  // function3 key(TP environment)
      if (key_ctrl == true) {
        ladder_replace_click_f3_button();
      }
      break;
    case 114:  // function3 key
      ladder_replace_click_f3_button();
      break;
    case 13:  // enter key
      if(g_device === "smt") document.activeElement.blur();
      break;
    default:
      break;
  }
}

/*
 =========================================================================
 @function name : ladder_replace_click_f2_button
 @argument      : none
 @description   : F2 key click processing
 @return        : none
 =========================================================================
*/
function ladder_replace_click_f2_button() {
  screen_id = SCREEN_LADDER_REPLACE;
  var result_cnt = 0;
  var ly_i = 0;
  var lx_i = 0;
  var net_index = 0;
  var grid_index = 0;
  var width_index = 0;
  var addr_ch_flg = 0;
  var num_digits = 0;
  var num_width = 0;
  var replace_level = get_ladder_replace_range();
  var tree_edit_level = get_ladder_tree_edit_level();
  var search_start_pos;
  var search_end_pos;
  var mnemo_address;
  // replace character string input check
  var replace_bef_str = document.getElementById('intbox.inbox.replace.before').value;
  var replace_aft_str = document.getElementById('intbox.inbox.replace.after').value;
  if (replace_bef_str.match(/[A-Za-z]{1}[0-9]{1,3}$/)) {
    var char_kind = replace_bef_str.substr(0, 1);
    var addr_num = replace_bef_str.substr(1);
    var addr_num4 = ('0000' + addr_num).slice(-4);
    replace_bef_str = char_kind + addr_num4;
  } else if (replace_bef_str.match(/[A-Za-z]{1}[0-9]{1,3}\.$/)) {
    var char_kind = replace_bef_str.substr(0, 1);
    var addr_num = replace_bef_str.substr(1);
    var addr_num4 = ('0000' + addr_num).slice(-5);
    replace_bef_str = char_kind + addr_num4;
  } else if (replace_bef_str.match(/[A-Za-z]{1}[0-9]{0,3}\.[0-9]{1}$/)) {
    var char_kind = replace_bef_str.substr(0, 1);
    var addr_num = replace_bef_str.substr(1);
    var addr_num4 = ('0000' + addr_num).slice(-6);
    replace_bef_str = char_kind + addr_num4;
  }
  if(replace_bef_str.trim().length > 0 && replace_aft_str.trim().length > 0){
    // character count check
    if(replace_bef_str.trim().length < 9 && replace_aft_str.trim().length < 9){
      // character string check
      if(replace_bef_str.match(/[^A-TX-Za-tx-z0-9\.]/g)){
        popup7_display_none();
        document.getElementById("popcomment_7_4").style.display="block";
        Popupbutton();
      } else if(replace_aft_str.match(/[^A-TX-Za-tx-z0-9\.]/g)){
        popup7_display_none();
        document.getElementById("popcomment_7_4").style.display="block";
        Popupbutton();
      } else {
        if(replace_aft_str.match(/[A-TX-Za-tx-z]{1}[0-9]{5}\.[0-9]{1}$/)){
          if(replace_aft_str.substr(1,1) === '0'){
            popup7_display_none();
            document.getElementById("popcomment_7_5").style.display="block";
            Popupbutton();
            return;
          }
        }
        var replace_aft_str_table = elem_addr_addition(replace_aft_str);
        addr_ch_flg = replace_address_check(replace_aft_str_table);
        if (addr_ch_flg === FLG_ON) {
          if (replace_level <= 3) {
            if (replace_level == 1) {
              search_end_pos = g_edit_lv_cnt_tbl[1].mnemo_pos - 1;
              search_start_pos = 0;
            } else {
              search_start_pos = g_edit_lv_cnt_tbl[Number(replace_level) - 1].mnemo_pos;
              if (g_edit_lv_cnt_tbl[Number(replace_level)] !== undefined) {
                search_end_pos = g_edit_lv_cnt_tbl[Number(replace_level)].mnemo_pos - 1;
              } else if(g_edit_sub_pg_tbl.length > 0){
                search_end_pos = g_edit_sub_pg_tbl[0].mnemo_pos - 1;
              } else {
                search_end_pos = mnemo_write_array.length;
              }
            }
          } else if (replace_level >= 4) {
            search_start_pos = g_edit_sub_pg_tbl[Number(replace_level) - 4].mnemo_pos;
            if (g_edit_sub_pg_tbl[Number(replace_level) - 3] !== undefined) {
              search_end_pos = g_edit_sub_pg_tbl[Number(replace_level) - 3].mnemo_pos - 1;
            } else {
              search_end_pos = mnemo_write_array.length;
            }
          }
          for (var mnemo_search_cnt = search_start_pos; mnemo_search_cnt < search_end_pos; mnemo_search_cnt++) {
            if (String(mnemo_write_array[mnemo_search_cnt].address).indexOf("V") !== -1 || String(mnemo_write_array[mnemo_search_cnt].address).indexOf("U") !== -1 || String(mnemo_write_array[mnemo_search_cnt].address).indexOf("W") !== -1) {
              mnemo_address = search_conversion_address(mnemo_write_array[mnemo_search_cnt].address);
            } else {
              mnemo_address = String(mnemo_write_array[mnemo_search_cnt].address);
            }
            if (mnemo_address == replace_bef_str) {
              if ((replace_level == 2 || replace_level >= 4) && replace_aft_str_table.length == 2) {
                mnemo_write_array[mnemo_search_cnt].address = replace_aft_str_table[1];
                mnemo_write_array[mnemo_search_cnt].VirtualAddress = g_array_grid_detail[replace_aft_str_table[1]].VirtualAddress;
              } else {
                mnemo_write_array[mnemo_search_cnt].address = replace_aft_str;
                mnemo_write_array[mnemo_search_cnt].VirtualAddress = g_array_grid_detail[replace_aft_str].VirtualAddress;
              }
              result_cnt += 1;
            } else {
              continue;
            }
          }
          if (replace_level !== tree_edit_level) {
            if (replace_level <= 3) {
              if (replace_level == 1) {
                search_end_pos = g_lv_cnt_tbl[1].mnemo_pos - 1;
                search_start_pos = 0;
              } else {
                search_start_pos = g_lv_cnt_tbl[Number(replace_level) - 1].mnemo_pos;
                if (g_lv_cnt_tbl[Number(replace_level)] !== undefined) {
                  search_end_pos = g_lv_cnt_tbl[Number(replace_level)].mnemo_pos - 1;
                } else if(g_sub_pg_tbl.length > 0){
                  search_end_pos = g_sub_pg_tbl[0].mnemo_pos - 1;
                } else {
                  search_end_pos = mnemonic_array.length;
                }
              }
            } else if (replace_level >= 4) {
              search_start_pos = g_sub_pg_tbl[Number(replace_level) - 4].mnemo_pos;
              if (g_sub_pg_tbl[Number(replace_level) - 3] !== undefined) {
                search_end_pos = g_sub_pg_tbl[Number(replace_level) - 3].mnemo_pos - 1;
              } else {
                search_end_pos = mnemonic_array.length;
              }
            }
            for (var mnemo_search_cnt = search_start_pos; mnemo_search_cnt < search_end_pos; mnemo_search_cnt++) {
              if (String(mnemonic_array[mnemo_search_cnt].address).indexOf("V") !== -1 || String(mnemonic_array[mnemo_search_cnt].address).indexOf("U") !== -1 || String(mnemonic_array[mnemo_search_cnt].address).indexOf("W") !== -1) {
                mnemo_address = search_conversion_address(mnemonic_array[mnemo_search_cnt].address);
              } else {
                mnemo_address = String(mnemonic_array[mnemo_search_cnt].address);
              }  
              if (mnemo_address == replace_bef_str) {
                if ((replace_level == 2 || replace_level >= 4) && replace_aft_str_table.length == 2) {
                  mnemonic_array[mnemo_search_cnt].address = replace_aft_str_table[1];
                  mnemonic_array[mnemo_search_cnt].VirtualAddress = g_array_grid_detail[replace_aft_str_table[1]].VirtualAddress;
                } else {
                  mnemonic_array[mnemo_search_cnt].address = replace_aft_str;
                  mnemonic_array[mnemo_search_cnt].VirtualAddress = g_array_grid_detail[replace_aft_str].VirtualAddress;
                }
              } else {
                continue;
              }
            }
          }
          // when replace before string do not exist
          if(result_cnt === 0){
            popup7_display_none();
            document.getElementById("popcomment_7_2").style.display="block";
            Popupbutton();
          // when replace before string do exist
          } else {
            popup7_display_none();
            document.getElementById("cnt_popcomment_7_1").placeholder = result_cnt;
            // calculate width to display the number
            num_digits = String(result_cnt).length;
            num_width = 12 + ((num_digits - 1) * 14);
            document.getElementById("cnt_popcomment_7_1").style.width = num_width + "px";
            document.getElementById("cnt_popcomment_7_1").style.display = "block";
            if (result_cnt > 1) {
              document.getElementById("msg_popcomment_7_1").style.display="block";
            } else {
              document.getElementById("msg_popcomment_7_2").style.display="block";
            }
            document.getElementById("popcomment_7_1").style.display="block";
            Popupbutton();
            if (replace_level === tree_edit_level) {
              set_g_array_update_flg(SCREEN_LADDER_REPLACE);
            } else {
              set_g_array_update_flg(SCREEN_LADDER_TREE_EDIT);
            }
          }
        } else {
          popup7_display_none();
          document.getElementById("popcomment_7_5").style.display = "block";
          Popupbutton();
        }
      }
    } else {
      popup7_display_none();
      document.getElementById("popcomment_7_4").style.display="block";
      Popupbutton();
    }
  } else {
    // when replace character string non-input popup
    popup7_display_none();
    document.getElementById("popcomment_7_3").style.display="block";
    Popupbutton();
  }
  // text inputting is invalid at the time of the popup indication
  if (g_popup_flg === FLG_ON) {
    document.getElementById('intbox.inbox.replace.before').disabled = "true";
    document.getElementById('intbox.inbox.replace.after').disabled = "true";
  } else {
    document.getElementById('intbox.inbox.replace.before').disabled = "";
    document.getElementById('intbox.inbox.replace.after').disabled = "";
  }
}

/*
 =========================================================================
 @function name                       : replace_address_check
 @argument [replace_aft_str_table]    : check address table
 @description                         : replace address check 
 @return                              : FLG_ON , FLG_OFF
 =========================================================================
*/
function replace_address_check(replace_aft_str_table) {
  for (var i = 0; i < replace_aft_str_table.length; i++) {
    // input check OK
    // confirm whether there exist replace after string in g_array_grid_detail
    if ((g_array_grid_detail[replace_aft_str_table[i]])) {
      continue;
    }
    // when replace after string do not exist
    // unjust address check
    // unjust address check start
    // character string at the age of seven characters
    if (replace_aft_str_table[i].trim().length === 7) {
      // top letter extraction
      var char_kind = replace_aft_str_table[i].substr(0, 1);
      // second character - fifth character to convert a decimal number to a hexadecimal number
      var addr_num_16 = parseInt(parseInt(replace_aft_str_table[i].substr(1, 4), 10).toString(16), 16);
      // character string at the age of eight characters
    } else if (replace_aft_str_table[i].trim().length === 8) {
      // top letter extraction
      var char_kind = replace_aft_str_table[i].substr(0, 1);
      // second character - sixth character to convert a decimal number to a hexadecimal number
      var addr_num_16 = parseInt(parseInt(replace_aft_str_table[i].substr(1, 5), 10).toString(16), 16);
    }
  
    // initialize DataView class to be able to do the reading of data for a buffer
    var dataview = new DataView(buffer);
    // address check start
    if (elem_addr_check(dataview, char_kind, addr_num_16) === 0) {
      // character string at the age of seven characters
      if (replace_aft_str_table[i].trim().length === 7) {
        // bit check start
        if (replace_aft_str_table[i].substr(5, 1).match(/\./) && replace_aft_str_table[i].substr(6, 1).match(/[0-7]/)) {
          // check OK
          // virtual address calculation
          new_vaddress = parseInt((parseInt(new_vaddress_nobit, 10) * 16 + parseInt(replace_aft_str_table[i].substr(6, 1), 10)).toString(16), 16);
          // add g_array_grid_detail
          g_array_grid_detail[replace_aft_str_table[i]] = ({ VirtualAddress: new_vaddress, Address: replace_aft_str_table[i], Symbol: '', Comment1: '', Comment2: '' });
          // bit check NG
        } else {
          return FLG_OFF;
        }
        // character string at the age of eight characters
      } else if (replace_aft_str_table[i].trim().length === 8) {
        // bit check start
        if (replace_aft_str_table[i].substr(6, 1).match(/\./) && replace_aft_str_table[i].substr(7, 1).match(/[0-7]/)) {
          // check OK
          // virtual address calculation
          new_vaddress = parseInt((parseInt(new_vaddress_nobit, 10) * 16 + parseInt(replace_aft_str_table[i].substr(7, 1), 10)).toString(16), 16);
          // add g_array_grid_detail
          g_array_grid_detail[replace_aft_str_table[i]] = ({ VirtualAddress: new_vaddress, Address: replace_aft_str_table[i], Symbol: '', Comment1: '', Comment2: '' });
          // bit check NG
        } else {
          return FLG_OFF;
        }
      }
      // address check NG
    } else {
      return FLG_OFF;
    }
  }
  return FLG_ON;
}


/*
 =========================================================================
 @function name : ladder_replace_click_f3_button
 @argument      : none
 @description   : F3 key click processing
 @return        : none
 =========================================================================
*/
function ladder_replace_click_f3_button() {

  if (document.getElementById('iSelect4').className === "select message-box-contents-right opened") {
    document.getElementById('iSelect4.label').click();
  }
  g_processing_flg = FLG_ON;

  old_screen_id = SCREEN_LADDER_REPLACE;
  if (false == search_replace_rep_err_chk()) {
    g_processing_flg = FLG_OFF;
    return;
  } else {
    ladder_search_processing_func(null, null, FLG_ON);
  }
  setTimeout(function () {
    g_processing_flg = FLG_OFF;
  }, 10);
}

/*
 =========================================================================
 @function name : popup7_display_none
 @argument      : none
 @description   : processing to none display a ladder replace popup screen
 @return        : none
 =========================================================================
*/
function popup7_display_none() {
  document.getElementById("popup_no_comfirm_7").style.display = "block";
  // only R-30iB Plus
  if (g_device == "pc" && top.tpkeyssheet == undefined){
    document.querySelectorAll('.select div')[2].style.backgroundColor = "#b0b0b0";
  } else {
    document.querySelectorAll('.select div')[2].style.backgroundColor = "transparent";
  }
  document.getElementById("cnt_popcomment_7_1").style.display="none";
  document.getElementById("msg_popcomment_7_1").style.display="none";
  document.getElementById("msg_popcomment_7_2").style.display="none";
  document.getElementById("popcomment_7_1").style.display="none";
  document.getElementById("popcomment_7_2").style.display="none";
  document.getElementById("popcomment_7_3").style.display="none";
  document.getElementById("popcomment_7_4").style.display="none";
  document.getElementById("popcomment_7_5").style.display="none";
  
  document.getElementById("popbutton_close_7").style.display="block";
}

// end of file
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    /*
 * @fileoverview : PMC Ladder iHMI ladder program search script
 * @char-code    : SJIS
 * @NewLineCode  : LF
 */

/**
  Constant definition
**/
var HEADER_ID_LADDER_SEARCH = "headert_3";

/**
  Global(Only this file)
**/
var iHMIReqParams = {
  path: "/KARELCMD/ihmicomponentkl"  // dummy server
};
var g_search_width_index = 0;
var g_array_search_result_netnum;
var g_array_search_result_index;
var g_search_range = "";
var g_search_range_target_screen = 0;
var g_wk_disp_index_diff_level = null;
var g_search_category_list;
var result_cnt = 0;
var g_search_result_list_net_num = [];
var g_search_result_list_grid_num = [];
var g_search_str = "";
var g_search_num_flg = FLG_OFF;
var g_hit_func_subno_tbl = [];
var g_perfect_match_flg = FLG_OFF;
var g_end_order_hit_flg = FLG_OFF;
var g_from_search_flg = FLG_OFF;
/*
 =========================================================================
 @function name    : ladder_search_callback
 @argument [id]    : element ID
 @argument [type]  : element Type
 @argument [props] : select element value
 @description      : select box callback function
 @return           : none
 =========================================================================
*/
function ladder_search_callback(id, type, value) {
  search_kind = value;
}

/*
 =========================================================================
 @function name    : ladder_search_callback
 @argument [id]    : element ID
 @argument [type]  : element Type
 @argument [props] : select element value
 @description      : select box callback function
 @return           : none
 =========================================================================
*/
function ladder_search_range_callback(id, type, value) {
  g_search_range = value;
}

/*
 =========================================================================
 @function name : move_to_ladder_search
 @argument [id] : the element id of the origin of transition
 @description   : ladder search screen transition API
 @return        : none
 =========================================================================
*/
function move_to_ladder_search(id) {
  // add words to header character string(running or stopped)
  var headert_elem = document.getElementById(HEADER_ID_LADDER_SEARCH);
  init_copy_net();
  getPmcRunStatus(g_pmc_no, function (pmc_num, status) {
    if (g_pmc_no == PMC_MEMORY_TYPE_DCS) {
      headert_elem.innerHTML = (status == PMC_RUNNING) ? headert + safety + pmc_lang_table['LadderSearch'].headert_3 + pmc_status_run : headert + safety + pmc_lang_table['LadderSearch'].headert_3 + pmc_status_stop;
    } else {
      headert_elem.innerHTML = (status == PMC_RUNNING) ? headert + g_pmc_no + pmc_lang_table['LadderSearch'].headert_3 + pmc_status_run : headert + g_pmc_no + pmc_lang_table['LadderSearch'].headert_3 + pmc_status_stop;
    }
  });
  take_focus_radio_button();
  if (old_screen_id !== g_search_range_target_screen) {
    var search_range_child = document.getElementById("iSelect1.options");
    while (search_range_child.childNodes.length > 0) {
      search_range_child.removeChild(search_range_child.firstChild);
    }
    create_range_list("iSelect1");
    init(doc, 'select', 'iSelect1', { 'width': '300px' });
    document.getElementById("iSelect1").setCallback(ladder_search_range_callback);
    g_search_range_target_screen = old_screen_id;
  }
  switch (old_screen_id) {
    case SCREEN_LADDER_DISPLAY:
      var tree_level = get_ladder_tree_level();
      set_ladder_search_range(tree_level);
      break;
    case SCREEN_LADDER_EDITOR:
      var tree_level = get_ladder_tree_edit_level();
      set_ladder_search_range(tree_level);
      break;
    default:
      break;
  }
  document.getElementById("iSelect1").refresh([], parseInt(tree_level, 10), null, false, "header changed");

  document.activeElement.blur();
  document.getElementById('screen_ladder_search').style.display = 'block';
  document.getElementById('worldDiv').style.display = 'none';
  document.getElementById(id).style.display = 'none';
  document.onkeydown = ladder_search_keydown;

  get_pmc_data_from_server(PMC_DATA_LOAD_KIND.PMC_DATA_COMPARE);
}

/*
 =========================================================================
 @function name : ladder_search_keydown
 @argument      : none
 @description   : processing at the time of the hard key pressing
 @return        : none
 =========================================================================
*/
function ladder_search_keydown(event) {
  var key_code = event.keyCode;
  var key_ctrl = event.ctrlKey;
  var key_shift = event.shiftKey;
  // notify a browser to invalidity of the key
  invalidate_notification_key(event);

  // during popup is only close button valid
  if (g_popup_flg === FLG_ON) {
    switch (key_code) {
      case 52:  // function4 key(TP environment)
      case 115:  // function4 key
        closeDialog();
        break;
      default:
        return;
    }
  } else {
    switch (key_code) {
      case 50:  // function2 key(TP environment)
        if (key_ctrl == true) {
          ladder_search_click_f2_button();
        }
        break;
      case 113:  // function2 key
        ladder_search_click_f2_button();
        break;
      case 53:  // function5 key(TP environment)
        if (key_ctrl == true) {
          ladder_search_click_f5_button();
        }
        break;
      case 27:  // prev button(TP environment)
      case 116:  // function5 key
        ladder_search_click_f5_button();
        break;
      case 13:  // enter key
        if (document.activeElement.parentNode.id == "checkbox1" ||
          document.activeElement.parentNode.id == "checkbox2" ||
          document.activeElement.parentNode.id == "checkbox3") {
          document.activeElement.click();
          break;
        }
        if (g_device === "smt") document.activeElement.blur();
        if (document.getElementById('partial_none_check_focus').style.display == "block") {
          document.getElementById('partial_checked_focus').style.display = "block";
          document.getElementById('partial_none_check_focus').style.display = "none";
          document.getElementById('perfect_checked').style.display = "none";
          document.getElementById('perfect_none_check').style.display = "block";
        } else if(document.getElementById('perfect_none_check_focus').style.display == "block"){
          document.getElementById('perfect_checked_focus').style.display = "block";
          document.getElementById('perfect_none_check_focus').style.display = "none";
          document.getElementById('partial_checked').style.display = "none";
          document.getElementById('partial_none_check').style.display = "block";
        }
        break;
      case 9:  
        if (key_shift == false) { // Tab key
          if (document.activeElement == document.getElementById('intbox.inbox.search')) { // when a focus is the  "Text box of the search string"
            document.getElementById('checkbox1').children[1].focus();
          } else if (document.activeElement.parentNode.id == "checkbox1") { // when a focus is the  "resultList checkBox"
            document.getElementById('checkbox2').children[1].focus();
          } else if (document.activeElement.parentNode.id == "checkbox2") { // when a focus is the  "search categoly contact"
            document.getElementById('checkbox3').children[1].focus();
          } else if (document.activeElement.parentNode.id == "checkbox3") { // when a focus is the  "search categoly coil"
            document.getElementById('checkbox3').children[1].blur();
            if (document.getElementById('partial_checked').style.display == "block") {
              document.getElementById('partial_checked_focus').style.display = "block";
              document.getElementById('partial_checked').style.display = "none";
            } else if (document.getElementById('partial_none_check').style.display == "block") {
              document.getElementById('partial_none_check').style.display = "none";
              document.getElementById('partial_none_check_focus').style.display = "block";
            }
          } else if (document.getElementById('partial_checked_focus').style.display == "block"
            || document.getElementById('partial_none_check_focus').style.display == "block") { // when a focus is the  "partial radio button"
            if (document.getElementById('partial_checked_focus').style.display == "block") {
              document.getElementById('partial_checked_focus').style.display = "none";
              document.getElementById('partial_checked').style.display = "block";
            } else if (document.getElementById('partial_none_check_focus').style.display == "block") {
              document.getElementById('partial_none_check').style.display = "block";
              document.getElementById('partial_none_check_focus').style.display = "none";
            }
            if (document.getElementById('perfect_checked').style.display == "block") {
              document.getElementById('perfect_checked_focus').style.display = "block";
              document.getElementById('perfect_checked').style.display = "none";
            } else if (document.getElementById('perfect_none_check').style.display == "block") {
              document.getElementById('perfect_none_check').style.display = "none";
              document.getElementById('perfect_none_check_focus').style.display = "block";
            }
          } else if (document.getElementById('perfect_checked_focus').style.display == "block"
            || document.getElementById('perfect_none_check_focus').style.display == "block") { // when a focus is the  "perfect radio button"
            if (document.getElementById('perfect_checked_focus').style.display == "block") {
              document.getElementById('perfect_checked_focus').style.display = "none";
              document.getElementById('perfect_checked').style.display = "block";
            } else if (document.getElementById('perfect_none_check_focus').style.display == "block") {
              document.getElementById('perfect_none_check').style.display = "block";
              document.getElementById('perfect_none_check_focus').style.display = "none";
            }
            document.getElementById('intbox.inbox.search').focus();
          }
        } else { // shift + Tab key
          if (document.activeElement == document.getElementById('intbox.inbox.search')) { // when a focus is the  "Text box of the search string"
            if (document.getElementById('perfect_checked').style.display == "block") {
              document.getElementById('perfect_checked_focus').style.display = "block";
              document.getElementById('perfect_checked').style.display = "none";
            } else if (document.getElementById('perfect_none_check').style.display == "block") {
              document.getElementById('perfect_none_check').style.display = "none";
              document.getElementById('perfect_none_check_focus').style.display = "block";
            }
            document.getElementById('intbox.inbox.search').blur();
          } else if (document.activeElement.parentNode.id == "checkbox1") { // when a focus is the  "resultList checkBox"
            document.getElementById('intbox.inbox.search').focus();
          } else if (document.activeElement.parentNode.id == "checkbox2") { // when a focus is the  "search categoly contact"
            document.getElementById('checkbox1').children[1].focus();
          } else if (document.activeElement.parentNode.id == "checkbox3") { // when a focus is the  "search categoly coil"
            document.getElementById('checkbox2').children[1].focus();
          } else if (document.getElementById('partial_checked_focus').style.display == "block"
            || document.getElementById('partial_none_check_focus').style.display == "block") { // when a focus is the  "partial radio button"
              if (document.getElementById('partial_checked_focus').style.display == "block") {
                document.getElementById('partial_checked_focus').style.display = "none";
                document.getElementById('partial_checked').style.display = "block";
              } else if (document.getElementById('partial_none_check_focus').style.display == "block") {
                document.getElementById('partial_none_check').style.display = "block";
                document.getElementById('partial_none_check_focus').style.display = "none";
              }
              document.getElementById('checkbox3').children[1].focus();
          } else if (document.getElementById('perfect_checked_focus').style.display == "block"
            || document.getElementById('perfect_none_check_focus').style.display == "block") { // when a focus is the  "perfect radio button"
              if (document.getElementById('perfect_checked_focus').style.display == "block") {
                document.getElementById('perfect_checked_focus').style.display = "none";
                document.getElementById('perfect_checked').style.display = "block";
              } else if (document.getElementById('perfect_none_check_focus').style.display == "block") {
                document.getElementById('perfect_none_check').style.display = "block";
                document.getElementById('perfect_none_check_focus').style.display = "none";
              }
              if (document.getElementById('partial_checked').style.display == "block") {
                document.getElementById('partial_checked_focus').style.display = "block";
                document.getElementById('partial_checked').style.display = "none";
              } else if (document.getElementById('partial_none_check').style.display == "block") {
                document.getElementById('partial_none_check').style.display = "none";
                document.getElementById('partial_none_check_focus').style.display = "block";
              }  
          }
        }
        break;
      default:
        break;
    }
  }
}

/*
 =========================================================================
 @function name          : search_hit_square
 @argument [ctx]         : context
 @argument [grid_x_size] : width of the grid
 @argument [grid_y_size] : height of the grid
 @argument [lx_p]        : element of the g_array_grid_pos(row)
 @argument [ly_p]        : element of the g_array_grid_pos(column)
 @focus_repaint_flg      : When draw red focus, do not stroke paint redraw
 @description            : surround the grid which corresponded to a search
 @return                 : none
 =========================================================================
*/
function search_hit_square(ctx, grid_x_size, grid_y_size, lx_p, ly_p, focus_repaint_flg) {

  if ((lx_p < 0) || (ly_p < 0)) {
    return;
  }

  // quadrangle(blue)
  ctx.strokeStyle = COLOR_BULE_SD;  // filled style
  ctx.strokeRect(g_array_grid_pos[ly_p][lx_p].pos_x, g_array_grid_pos[ly_p][lx_p].pos_y, grid_x_size, grid_y_size);
  // appoint transparency
  ctx.globalAlpha = 0.1;

  // filled rectangle(blue) of the permeation
  ctx.fillStyle = COLOR_BULE_SD;
  ctx.fillRect(g_array_grid_pos[ly_p][lx_p].pos_x, g_array_grid_pos[ly_p][lx_p].pos_y, grid_x_size, grid_y_size);
  // return transparency to a standard
  ctx.globalAlpha = 1.0;

  if (!focus_repaint_flg) { //red focus repaint
    // drawing of the possible figure
    ctx.stroke();
  }

  ctx.strokeStyle = COLOR_BLACK;
  ctx.fillStyle = COLOR_BLACK;

}

/*
 =========================================================================
 @function name : ladder_search_click_f2_button
 @argument      : none
 @description   : F2 key click processing
 @return        : none
 =========================================================================
*/
function ladder_search_click_f2_button() {
  g_processing_flg = FLG_ON;
  g_from_search_flg = FLG_ON;
  var search_level = get_ladder_search_range();

  if (document.getElementById('iSelect1').className === "select message-box-contents-right opened") {
    document.getElementById('iSelect1.label').click();
  } else if (document.getElementById('iSelect2').className === "select message-box-contents-right opened") {
    document.getElementById('iSelect2.label').click();
  }

  switch (old_screen_id) {
    case SCREEN_LADDER_DISPLAY:
      var tree_level = get_ladder_tree_level();
      if (search_level !== tree_level) {
        g_wk_disp_index_diff_level = back_up_disp_index();
        g_click_pos_disp_tbl = [
          { pos_ly: -1, pos_lx: -1, net_index: -1, search_result: -1 }
        ];
      }
      break;
    case SCREEN_LADDER_EDITOR:
      var tree_edit_level = get_ladder_tree_edit_level();
      if (search_level !== tree_edit_level) {
        g_wk_disp_index_diff_level = back_up_disp_index();
      }
      break;
    default:
      g_processing_flg = FLG_OFF;
      g_from_search_flg = FLG_OFF;
      return;
  }

  // search processing function
  ladder_search_processing_func(null, null, FLG_ON);
  g_from_search_flg = FLG_OFF;
  setTimeout(function () {
    g_processing_flg = FLG_OFF;
  }, 10);
}

/*
 =========================================================================
 @function name            : ladder_search_processing_func
 @argument[search_address] : popup search address
 @argument[search_category]: popup search category
 @description              : search processing
 @return                   : none
 =========================================================================
*/
function ladder_search_processing_func(search_address, search_category, from_search_flg) {

  var result = "";
  var ly_i = 0;
  var lx_i = 0;
  var ly_p = 0;
  var lx_p = 0;
  var length_cnt = 0;
  var net_index = 0;
  var grid_index = 0;
  var width_index = 0;
  var search_hit_flg = FLG_OFF;
  var bk_search_kind = null;
  var search_list_kind = null;
  var popup_search_flg = FLG_OFF;
  var wk_srch_category = search_category;
  var search_category_list;
  g_array_search_result_netnum = [];
  g_array_search_result_index = [];
  g_search_result_list_net_num = [];
  g_search_result_list_grid_num = [];
  var hit_net_num = 0;
  var result_list_hit_net_num = 0;
  var net_index = 0;
  var mnemo_search_hit_flg = FLG_OFF;
  var select_tree_level = get_ladder_tree_level();
  var search_start_pos;
  var search_end_pos;
  var mnemo_address;
  var different_search_lv_flg = FLG_OFF;
  var search_subroutine_address = [];
  var search_subroutine_address_flg = FLG_OFF;
  result_cnt = 0;
  g_net_cnt_before_tree = 0;
  g_end_order_hit_flg = FLG_OFF;
  switch (old_screen_id) {
    case SCREEN_LADDER_DISPLAY:
    case SCREEN_LADDER_EDITOR:
      screen_id = SCREEN_LADDER_SEARCH;
      var search_str = document.getElementById('intbox.inbox.search').value;
      break;
    case SCREEN_LADDER_REPLACE:
      screen_id = SCREEN_LADDER_REPLACE;
      var search_str = document.getElementById('intbox.inbox.replace.before').value;
      bk_search_kind = search_kind;
      search_kind = "0";  // Address
      break;
    default:
      old_screen_id = SCREEN_LADDER_DISPLAY;
      var search_str = search_address;
      break;
  }
  var use_mnemo_array = [];
  if (old_screen_id == SCREEN_LADDER_DISPLAY) {
    var use_mnemo_array = JSON.parse(JSON.stringify(mnemonic_array));
    var use_lv_cnt_tbl = JSON.parse(JSON.stringify(g_lv_cnt_tbl));
    var use_sub_pg_tbl = JSON.parse(JSON.stringify(g_sub_pg_tbl));
    var use_grid_num_tbl = JSON.parse(JSON.stringify(g_grid_num_tbl));
  } else if (old_screen_id == SCREEN_LADDER_EDITOR || old_screen_id == SCREEN_LADDER_REPLACE) {
    var use_mnemo_array = JSON.parse(JSON.stringify(mnemo_write_array));
    var use_lv_cnt_tbl = JSON.parse(JSON.stringify(g_edit_lv_cnt_tbl));
    var use_sub_pg_tbl = JSON.parse(JSON.stringify(g_edit_sub_pg_tbl));
    var use_grid_num_tbl = JSON.parse(JSON.stringify(g_grid_edit_num_tbl));
  }

  g_search_str = search_str;
  if (search_category !== null) {
    var popup_search_flg = FLG_ON;
    search_kind = "0";  // Address
  } else {
    var popup_search_flg = FLG_OFF;
  }

  if (screen_id === SCREEN_LADDER_SEARCH) {
    var contact_checkbox = document.getElementById('checkbox2.input').checked;
    var coil_checkbox = document.getElementById('checkbox3.input').checked;
    if (search_kind == "0") {
      var subroutine_checkbox = document.getElementById('checkbox4.input').checked;
    } else {
      var subroutine_checkbox = false;
    }
    if (search_kind == "3" || search_kind == "4") {
      wk_srch_category = SEARCH_CATEGORY_NONE;
      g_search_category = SEARCH_CATEGORY_NONE;
    } else if (contact_checkbox === true && coil_checkbox === false && subroutine_checkbox === false) {
      wk_srch_category = SEARCH_CATEGORY_CONTACT;
      g_search_category = SEARCH_CATEGORY_CONTACT;
    } else if (contact_checkbox === false && coil_checkbox === true && subroutine_checkbox === false) {
      wk_srch_category = SEARCH_CATEGORY_COIL;
      g_search_category = SEARCH_CATEGORY_COIL;
    } else if (contact_checkbox === false && coil_checkbox === false && subroutine_checkbox === true) {
      wk_srch_category = SEARCH_CATEGORY_FUNC;
      g_search_category = SEARCH_CATEGORY_FUNC;
    } else if (contact_checkbox === true && coil_checkbox === false && subroutine_checkbox === true) {
      wk_srch_category = SEARCH_CATEGORY_CONTACT_FUNC;
      g_search_category = SEARCH_CATEGORY_CONTACT_FUNC;
    } else if (contact_checkbox === false && coil_checkbox === true && subroutine_checkbox === true) {
      wk_srch_category = SEARCH_CATEGORY_COIL_FUNC;
      g_search_category = SEARCH_CATEGORY_COIL_FUNC;
    } else if (contact_checkbox === true && coil_checkbox === true && subroutine_checkbox === false) {
      wk_srch_category = SEARCH_CATEGORY_CONTACT_COIL;
      g_search_category = SEARCH_CATEGORY_CONTACT_COIL;
    } else if (contact_checkbox === true && coil_checkbox === true && subroutine_checkbox === true) {
      wk_srch_category = SEARCH_CATEGORY_ALL;
      g_search_category = SEARCH_CATEGORY_ALL;
    } else {
      wk_srch_category = null;
    }
    if (document.getElementById('perfect_checked_focus').style.display == "block" || document.getElementById('perfect_checked').style.display == "block") {
      g_perfect_match_flg = FLG_ON;
    } else if (document.getElementById('partial_checked_focus').style.display == "block" || document.getElementById('partial_checked').style.display == "block"){
      g_perfect_match_flg = FLG_OFF;
    }
  } else if (screen_id === SCREEN_LADDER_REPLACE) {
    wk_srch_category = SEARCH_CATEGORY_ALL;
    g_search_category = SEARCH_CATEGORY_ALL;
  }
  if (wk_srch_category === SEARCH_CATEGORY_CONTACT) {
    g_search_category_list = [IMAGENO1_A_CONTACT, IMAGENO2_B_CONTACT, IMAGENO7_RDPT, IMAGENO8_RDNT];
    search_category_list = [IMAGENO1_A_CONTACT, IMAGENO2_B_CONTACT, IMAGENO7_RDPT, IMAGENO8_RDNT];
  } else if (wk_srch_category === SEARCH_CATEGORY_COIL) {
    g_search_category_list = [IMAGENO3_COILE, IMAGENO4_NOTCOILE, IMAGENO5_SET, IMAGENO6_RESET];
    search_category_list = [IMAGENO3_COILE, IMAGENO4_NOTCOILE, IMAGENO5_SET, IMAGENO6_RESET];
  } else if (wk_srch_category === SEARCH_CATEGORY_CONTACT_COIL) {
    g_search_category_list = [IMAGENO1_A_CONTACT, IMAGENO2_B_CONTACT, IMAGENO3_COILE, IMAGENO4_NOTCOILE, IMAGENO5_SET, IMAGENO6_RESET, IMAGENO7_RDPT, IMAGENO8_RDNT];
    search_category_list = [IMAGENO1_A_CONTACT, IMAGENO2_B_CONTACT, IMAGENO3_COILE, IMAGENO4_NOTCOILE, IMAGENO5_SET, IMAGENO6_RESET, IMAGENO7_RDPT, IMAGENO8_RDNT];
  } else if (wk_srch_category === SEARCH_CATEGORY_FUNC) {
    g_search_category_list = [IMAGENO10_FUNCTION];
    search_category_list = [IMAGENO10_FUNCTION];
  } else if (wk_srch_category === SEARCH_CATEGORY_CONTACT_FUNC) {
    g_search_category_list = [IMAGENO1_A_CONTACT, IMAGENO2_B_CONTACT, IMAGENO7_RDPT, IMAGENO8_RDNT, IMAGENO10_FUNCTION];
    search_category_list = [IMAGENO1_A_CONTACT, IMAGENO2_B_CONTACT, IMAGENO7_RDPT, IMAGENO8_RDNT, IMAGENO10_FUNCTION];
  } else if (wk_srch_category === SEARCH_CATEGORY_COIL_FUNC) {
    g_search_category_list = [IMAGENO3_COILE, IMAGENO4_NOTCOILE, IMAGENO5_SET, IMAGENO6_RESET, IMAGENO10_FUNCTION];
    search_category_list = [IMAGENO3_COILE, IMAGENO4_NOTCOILE, IMAGENO5_SET, IMAGENO6_RESET, IMAGENO10_FUNCTION];
  } else if (wk_srch_category === SEARCH_CATEGORY_ALL) {
    g_search_category_list = [IMAGENO1_A_CONTACT, IMAGENO2_B_CONTACT, IMAGENO3_COILE, IMAGENO4_NOTCOILE, IMAGENO5_SET, IMAGENO6_RESET, IMAGENO7_RDPT, IMAGENO8_RDNT, IMAGENO10_FUNCTION];
    search_category_list = [IMAGENO1_A_CONTACT, IMAGENO2_B_CONTACT, IMAGENO3_COILE, IMAGENO4_NOTCOILE, IMAGENO5_SET, IMAGENO6_RESET, IMAGENO7_RDPT, IMAGENO8_RDNT, IMAGENO10_FUNCTION];
  } else if (wk_srch_category == SEARCH_CATEGORY_NONE) {
    g_search_category_list = [IMAGENO10_FUNCTION];
    search_category_list = [IMAGENO10_FUNCTION];
  }
  if (screen_id !== SCREEN_LADDER_REPLACE) {
    var search_level = get_ladder_search_range();
  } else {
    var search_level = get_ladder_replace_range();
  }
  switch (old_screen_id) {
    case SCREEN_LADDER_DISPLAY:
      var tree_level = get_ladder_tree_level();
      if (search_level !== tree_level) {
        different_search_lv_flg = FLG_ON;
      }
      iterateArray = [];
      iterateArray = grid_List.pushIterateArray();
      break;
    case SCREEN_LADDER_EDITOR:
      var tree_edit_level = get_ladder_tree_edit_level();
      if (search_level !== tree_edit_level) {
        different_search_lv_flg = FLG_ON;
      } else {
      }
      iterateArray = [];
      iterateArray = grid_List.pushIterateArray();
      break;
    case SCREEN_LADDER_REPLACE:
      var replace_level = get_ladder_replace_range();
      var tree_edit_level = get_ladder_tree_edit_level();
      if (replace_level !== tree_edit_level) {
        g_wk_disp_index_diff_level = back_up_disp_index();
      }
      break;
    default:
      var tree_level = get_ladder_tree_level();
      iterateArray = [];
      iterateArray = grid_List.pushIterateArray();
      break;
  }

  // search character string input check
  if (search_str.trim().length > 0) {
    if (wk_srch_category) {
      switch (search_kind) {
        // search kind : address
        case "0":
          // character count check
          if (search_str.trim().length < 256) {
            // character string check
            if (search_str.match(/[^A-Za-z0-9\.]/g)) {
              search_err_popup3();
            } else {
              // input check OK
              // character string correction
              if (search_str.match(/[0-9]$/) && search_str.indexOf(".") !== -1) {
                if (search_str.match(/[A-Za-z]{1}[0-9]{1,3}$/)) {
                  var char_kind = search_str.substr(0, 1);
                  var addr_num = search_str.substr(1);
                  var addr_num4 = ('0000' + addr_num).slice(-4);
                  search_str = char_kind + addr_num4;
                } else if (search_str.match(/[A-Za-z]{1}[0-9]{1,3}\.$/)) {
                  var char_kind = search_str.substr(0, 1);
                  var addr_num = search_str.substr(1);
                  var addr_num4 = ('0000' + addr_num).slice(-5);
                  search_str = char_kind + addr_num4;
                } else if (search_str.match(/[A-Za-z]{1}[0-9]{0,3}\.[0-9]{1}$/)) {
                  var char_kind = search_str.substr(0, 1);
                  var addr_num = search_str.substr(1);
                  var addr_num4 = ('0000' + addr_num).slice(-6);
                  search_str = char_kind + addr_num4;
                }
                g_search_str = search_str;
              }
              if (search_level == 0) {
                make_sub_pg_flg = FLG_OFF;
              } else {
                make_sub_pg_flg = FLG_ON;
              }
              if (search_level <= 3) {
                if (search_level == 0 || search_level == 1) {
                  if (search_level == 0) {
                    search_end_pos = use_mnemo_array.length - 1;
                  } else {
                    search_end_pos = use_lv_cnt_tbl[1].mnemo_pos - 1;
                  }
                  search_start_pos = 0;
                  g_net_cnt_before_tree = 0;
                } else {
                  search_start_pos = use_lv_cnt_tbl[Number(search_level) - 1].mnemo_pos;
                  if (use_lv_cnt_tbl[Number(search_level)] !== undefined) {
                    search_end_pos = use_lv_cnt_tbl[Number(search_level)].mnemo_pos - 1;
                  } else if (use_sub_pg_tbl.length > 0) {
                    search_end_pos = use_sub_pg_tbl[0].mnemo_pos - 1;
                  } else {
                    search_end_pos = use_mnemo_array.length - 1;
                  }
                }
                if (search_level == 1) {
                  g_net_cnt_before_tree = 0;
                } else if (search_level == 2) {
                  g_net_cnt_before_tree = use_lv_cnt_tbl[0].net_cnt;
                } else if (search_level == 3) {
                  g_net_cnt_before_tree = use_lv_cnt_tbl[0].net_cnt + use_lv_cnt_tbl[1].net_cnt;
                }
              } else if (search_level >= 4) {
                search_start_pos = use_sub_pg_tbl[Number(search_level) - 4].mnemo_pos;
                if (use_sub_pg_tbl[Number(search_level) - 3] !== undefined) {
                  search_end_pos = use_sub_pg_tbl[Number(search_level) - 3].mnemo_pos - 1;
                } else {
                  search_end_pos = use_mnemo_array.length - 1;
                }
                for (var k = 0; k < use_lv_cnt_tbl.length; k++) {
                  g_net_cnt_before_tree = g_net_cnt_before_tree + use_lv_cnt_tbl[k].net_cnt;
                }
                for (var l = 0; l < search_level - 4; l++) {
                  g_net_cnt_before_tree = g_net_cnt_before_tree + use_sub_pg_tbl[l].net_cnt;
                }
              }
              for (var mnemo_search_cnt = search_start_pos; mnemo_search_cnt <= search_end_pos; mnemo_search_cnt++) {
                if (use_mnemo_array[mnemo_search_cnt].address !== undefined) {
                  if (String(use_mnemo_array[mnemo_search_cnt].address).indexOf("V") !== -1 || String(use_mnemo_array[mnemo_search_cnt].address).indexOf("U") !== -1 || String(use_mnemo_array[mnemo_search_cnt].address).indexOf("W") !== -1) {
                    mnemo_address = search_conversion_address(use_mnemo_array[mnemo_search_cnt].address);
                  } else {
                    mnemo_address = String(use_mnemo_array[mnemo_search_cnt].address);
                  }
                } else if (use_mnemo_array[mnemo_search_cnt].SubNo !== undefined) {
                  mnemo_address = null;
                  search_subroutine_address = [];
                  search_subroutine_address_flg = FLG_ON;
                  if (use_mnemo_array[mnemo_search_cnt].virtual_adr_1 !== undefined) {
                    search_subroutine_address.push(use_mnemo_array[mnemo_search_cnt].SubParam1);
                  }
                  if (use_mnemo_array[mnemo_search_cnt].virtual_adr_2 !== undefined) {
                    search_subroutine_address.push(use_mnemo_array[mnemo_search_cnt].SubParam2);
                  }
                  if (use_mnemo_array[mnemo_search_cnt].virtual_adr_3 !== undefined) {
                    search_subroutine_address.push(use_mnemo_array[mnemo_search_cnt].SubParam3);
                  }
                  if (use_mnemo_array[mnemo_search_cnt].virtual_adr_4 !== undefined) {
                    search_subroutine_address.push(use_mnemo_array[mnemo_search_cnt].SubParam4);
                  }
                  if (use_mnemo_array[mnemo_search_cnt].virtual_adr_5 !== undefined) {
                    search_subroutine_address.push(use_mnemo_array[mnemo_search_cnt].SubParam5);
                  }
                  if (use_mnemo_array[mnemo_search_cnt].virtual_adr_6 !== undefined) {
                    search_subroutine_address.push(use_mnemo_array[mnemo_search_cnt].SubParam6);
                  }
                } else {
                  mnemo_address = "";
                  search_subroutine_address = [];
                  search_subroutine_address_flg = FLG_OFF;
                }
                if (use_mnemo_array[mnemo_search_cnt].net_num !== undefined) {
                  hit_net_num = hit_net_num + 1;
                  result_list_hit_net_num = use_mnemo_array[mnemo_search_cnt].net_num;
                }
                if (wk_srch_category === SEARCH_CATEGORY_CONTACT) {
                  if (use_mnemo_array[mnemo_search_cnt].Order !== "WRT" && use_mnemo_array[mnemo_search_cnt].Order !== "WRT.NOT" &&
                    use_mnemo_array[mnemo_search_cnt].Order !== "RST" && use_mnemo_array[mnemo_search_cnt].Order !== "SET" &&
                    use_mnemo_array[mnemo_search_cnt].Order !== "POP" && use_mnemo_array[mnemo_search_cnt].Order !== "PUSH" && use_mnemo_array[mnemo_search_cnt].SubParamRawData === undefined) {
                    if (g_perfect_match_flg == FLG_OFF) {
                      //Partial Match processing
                      if (mnemo_address.toLowerCase().indexOf(String(search_str).toLowerCase()) !== -1) {
                        if (mnemo_search_hit_flg === FLG_OFF) {
                          g_disp_net_index = hit_net_num - 1;
                          mnemo_search_hit_flg = FLG_ON;
                          net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                        }
                        g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                        if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                          g_search_result_list_net_num.push(result_list_hit_net_num);
                          g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                        }
                      }
                    } else if (g_perfect_match_flg == FLG_ON) {
                      //Perfect Match processing
                      if (mnemo_address.toLowerCase() === search_str.toLowerCase()) {
                        if (mnemo_search_hit_flg === FLG_OFF) {
                          g_disp_net_index = hit_net_num - 1;
                          mnemo_search_hit_flg = FLG_ON;
                          net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                        }
                        g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                        if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                          g_search_result_list_net_num.push(result_list_hit_net_num);
                          g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                        }
                      }
                    } else {
                      continue;
                    }
                  }
                } else if (wk_srch_category === SEARCH_CATEGORY_COIL) {
                  if (use_mnemo_array[mnemo_search_cnt].Order == "WRT" || use_mnemo_array[mnemo_search_cnt].Order == "WRT.NOT" ||
                    use_mnemo_array[mnemo_search_cnt].Order == "RST" || use_mnemo_array[mnemo_search_cnt].Order == "SET") {
                    if (g_perfect_match_flg == FLG_OFF) {
                      //Partial Match processing
                      if (mnemo_address.toLowerCase().indexOf(String(search_str).toLowerCase()) !== -1) {
                        if (mnemo_search_hit_flg === FLG_OFF) {
                          g_disp_net_index = hit_net_num - 1;
                          mnemo_search_hit_flg = FLG_ON;
                          net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                        }
                        g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                        if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                          g_search_result_list_net_num.push(result_list_hit_net_num);
                          g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                        }
                      }
                    } else if (g_perfect_match_flg == FLG_ON) {
                      //Perfect Match processing
                      if (mnemo_address.toLowerCase() === search_str.toLowerCase()) {
                        if (mnemo_search_hit_flg === FLG_OFF) {
                          g_disp_net_index = hit_net_num - 1;
                          mnemo_search_hit_flg = FLG_ON;
                          net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                        }
                        g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                        if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                          g_search_result_list_net_num.push(result_list_hit_net_num);
                          g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                        }
                      }
                    } else {
                      continue;
                    }
                  }
                } else if (wk_srch_category === SEARCH_CATEGORY_CONTACT_COIL) {
                  if (use_mnemo_array[mnemo_search_cnt].Order !== "POP" && use_mnemo_array[mnemo_search_cnt].Order !== "PUSH" && use_mnemo_array[mnemo_search_cnt].SubParamRawData === undefined) {
                    if (g_perfect_match_flg == FLG_OFF) {
                      //Partial Match processing
                      if (mnemo_address.toLowerCase().indexOf(String(search_str).toLowerCase()) !== -1) {
                        if (mnemo_search_hit_flg === FLG_OFF) {
                          g_disp_net_index = hit_net_num - 1;
                          mnemo_search_hit_flg = FLG_ON;
                          net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                        }
                        g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                        if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                          g_search_result_list_net_num.push(result_list_hit_net_num);
                          g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                        }
                      }
                    } else if (g_perfect_match_flg == FLG_ON) {
                      //Perfect Match processing
                      if (mnemo_address.toLowerCase() === search_str.toLowerCase()) {
                        if (mnemo_search_hit_flg === FLG_OFF) {
                          g_disp_net_index = hit_net_num - 1;
                          mnemo_search_hit_flg = FLG_ON;
                          net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                        }
                        g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                        if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                          g_search_result_list_net_num.push(result_list_hit_net_num);
                          g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                        }
                      }
                    } else {
                      continue;
                    }
                  }
                } else if (wk_srch_category === SEARCH_CATEGORY_FUNC) {
                  if (use_mnemo_array[mnemo_search_cnt].SubNo !== undefined) {
                    if (g_perfect_match_flg == FLG_OFF) {
                      //Partial Match processing
                      if (search_subroutine_address_flg === FLG_ON) {
                        for (var i = 0; i < search_subroutine_address.length; i++) {
                          if (search_subroutine_address[i].toLowerCase().indexOf(String(search_str).toLowerCase()) !== -1 && use_mnemo_array[mnemo_search_cnt].SubNo !== 64) {
                            if (mnemo_search_hit_flg === FLG_OFF) {
                              g_disp_net_index = hit_net_num - 1;
                              mnemo_search_hit_flg = FLG_ON;
                              net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                            }
                            if (use_mnemo_array[mnemo_search_cnt].Order === "SP") {
                              g_end_order_hit_flg = FLG_ON;
                            }
                            g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                            if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                              g_search_result_list_net_num.push(result_list_hit_net_num);
                              g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                            }
                            break;
                          }
                        }
                        search_subroutine_address_flg = FLG_OFF;
                      }
                    } else if (g_perfect_match_flg == FLG_ON) {
                      //Perfect Match processing
                      if (search_subroutine_address_flg === FLG_ON) {
                        for (var i = 0; i < search_subroutine_address.length; i++) {
                          if (search_subroutine_address[i].toLowerCase() === search_str.toLowerCase() && use_mnemo_array[mnemo_search_cnt].SubNo !== 64) {
                            if (mnemo_search_hit_flg === FLG_OFF) {
                              g_disp_net_index = hit_net_num - 1;
                              mnemo_search_hit_flg = FLG_ON;
                              net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                            }
                            if (use_mnemo_array[mnemo_search_cnt].Order === "SP") {
                              g_end_order_hit_flg = FLG_ON;
                            }
                            g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                            if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                              g_search_result_list_net_num.push(result_list_hit_net_num);
                              g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                            }
                            break;
                          }
                        }
                        search_subroutine_address_flg = FLG_OFF;
                      }
                    } else {
                      continue;
                    }
                  }
                } else if (wk_srch_category === SEARCH_CATEGORY_CONTACT_FUNC) {
                  if (use_mnemo_array[mnemo_search_cnt].Order !== "WRT" && use_mnemo_array[mnemo_search_cnt].Order !== "WRT.NOT" &&
                    use_mnemo_array[mnemo_search_cnt].Order !== "RST" && use_mnemo_array[mnemo_search_cnt].Order !== "SET" &&
                    use_mnemo_array[mnemo_search_cnt].Order !== "POP" && use_mnemo_array[mnemo_search_cnt].Order !== "PUSH") {
                    if (g_perfect_match_flg == FLG_OFF) {
                      //Partial Match processing
                      if (search_subroutine_address_flg === FLG_ON) {
                        for (var i = 0; i < search_subroutine_address.length; i++) {
                          if (search_subroutine_address[i].toLowerCase().indexOf(String(search_str).toLowerCase()) !== -1 && use_mnemo_array[mnemo_search_cnt].SubNo !== 64) {
                            if (mnemo_search_hit_flg === FLG_OFF) {
                              g_disp_net_index = hit_net_num - 1;
                              mnemo_search_hit_flg = FLG_ON;
                              net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                            }
                            if (use_mnemo_array[mnemo_search_cnt].Order === "SP") {
                              g_end_order_hit_flg = FLG_ON;
                            }
                            g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                            if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                              g_search_result_list_net_num.push(result_list_hit_net_num);
                              g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                            }
                            break;
                          }
                        }
                        search_subroutine_address_flg = FLG_OFF;
                      } else {
                        if (mnemo_address.toLowerCase().indexOf(String(search_str).toLowerCase()) !== -1) {
                          if (mnemo_search_hit_flg === FLG_OFF) {
                            g_disp_net_index = hit_net_num - 1;
                            mnemo_search_hit_flg = FLG_ON;
                            net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                          }
                          g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                          if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                            g_search_result_list_net_num.push(result_list_hit_net_num);
                            g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                          }
                        }
                      }
                    } else if (g_perfect_match_flg == FLG_ON) {
                      //Perfect Match processing
                      if (search_subroutine_address_flg === FLG_ON) {
                        for (var i = 0; i < search_subroutine_address.length; i++) {
                          if (search_subroutine_address[i].toLowerCase() === search_str.toLowerCase() && use_mnemo_array[mnemo_search_cnt].SubNo !== 64) {
                            if (mnemo_search_hit_flg === FLG_OFF) {
                              g_disp_net_index = hit_net_num - 1;
                              mnemo_search_hit_flg = FLG_ON;
                              net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                            }
                            if (use_mnemo_array[mnemo_search_cnt].Order === "SP") {
                              g_end_order_hit_flg = FLG_ON;
                            }
                            g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                            if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                              g_search_result_list_net_num.push(result_list_hit_net_num);
                              g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                            }
                            break;
                          }
                        }
                        search_subroutine_address_flg = FLG_OFF;
                      } else {
                        if (mnemo_address.toLowerCase() === search_str.toLowerCase()) {
                          if (mnemo_search_hit_flg === FLG_OFF) {
                            g_disp_net_index = hit_net_num - 1;
                            mnemo_search_hit_flg = FLG_ON;
                            net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                          }
                          g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                          if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                            g_search_result_list_net_num.push(result_list_hit_net_num);
                            g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                          }
                        }
                      }
                    } else {
                      continue;
                    }
                  }
                } else if (wk_srch_category === SEARCH_CATEGORY_COIL_FUNC) {
                  if (use_mnemo_array[mnemo_search_cnt].Order == "WRT" || use_mnemo_array[mnemo_search_cnt].Order == "WRT.NOT" ||
                    use_mnemo_array[mnemo_search_cnt].Order == "RST" || use_mnemo_array[mnemo_search_cnt].Order == "SET" || use_mnemo_array[mnemo_search_cnt].SubNo !== undefined) {
                    if (g_perfect_match_flg == FLG_OFF) {
                      //Partial Match processing
                      if (search_subroutine_address_flg === FLG_ON) {
                        for (var i = 0; i < search_subroutine_address.length; i++) {
                          if (search_subroutine_address[i].toLowerCase().indexOf(String(search_str).toLowerCase()) !== -1 && use_mnemo_array[mnemo_search_cnt].SubNo !== 64) {
                            if (mnemo_search_hit_flg === FLG_OFF) {
                              g_disp_net_index = hit_net_num - 1;
                              mnemo_search_hit_flg = FLG_ON;
                              net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                            }
                            if (use_mnemo_array[mnemo_search_cnt].Order === "SP") {
                              g_end_order_hit_flg = FLG_ON;
                            }
                            g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                            if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                              g_search_result_list_net_num.push(result_list_hit_net_num);
                              g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                            }
                            break;
                          }
                        }
                        search_subroutine_address_flg = FLG_OFF;
                      } else {
                        if (mnemo_address.toLowerCase().indexOf(String(search_str).toLowerCase()) !== -1) {
                          if (mnemo_search_hit_flg === FLG_OFF) {
                            g_disp_net_index = hit_net_num - 1;
                            mnemo_search_hit_flg = FLG_ON;
                            net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                          }
                          g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                          if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                            g_search_result_list_net_num.push(result_list_hit_net_num);
                            g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                          }
                        }
                      }
                    } else if (g_perfect_match_flg == FLG_ON) {
                      //Perfect Match processing
                      if (search_subroutine_address_flg === FLG_ON) {
                        for (var i = 0; i < search_subroutine_address.length; i++) {
                          if (search_subroutine_address[i].toLowerCase() === search_str.toLowerCase() && use_mnemo_array[mnemo_search_cnt].SubNo !== 64) {
                            if (mnemo_search_hit_flg === FLG_OFF) {
                              g_disp_net_index = hit_net_num - 1;
                              mnemo_search_hit_flg = FLG_ON;
                              net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                            }
                            if (use_mnemo_array[mnemo_search_cnt].Order === "SP") {
                              g_end_order_hit_flg = FLG_ON;
                            }
                            g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                            if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                              g_search_result_list_net_num.push(result_list_hit_net_num);
                              g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                            }
                            break;
                          }
                        }
                        search_subroutine_address_flg = FLG_OFF;
                      } else {
                        if (mnemo_address.toLowerCase() === search_str.toLowerCase()) {
                          if (mnemo_search_hit_flg === FLG_OFF) {
                            g_disp_net_index = hit_net_num - 1;
                            mnemo_search_hit_flg = FLG_ON;
                            net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                          }
                          g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                          if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                            g_search_result_list_net_num.push(result_list_hit_net_num);
                            g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                          }
                        }
                      }
                    } else {
                      continue;
                    }
                  }
                } else if (wk_srch_category === SEARCH_CATEGORY_ALL) {
                  if (use_mnemo_array[mnemo_search_cnt].Order !== "POP" && use_mnemo_array[mnemo_search_cnt].Order !== "PUSH") {
                    if (g_perfect_match_flg == FLG_OFF) {
                      //Partial Match processing
                      if (search_subroutine_address_flg === FLG_ON) {
                        for (var i = 0; i < search_subroutine_address.length; i++) {
                          if (search_subroutine_address[i].toLowerCase().indexOf(String(search_str).toLowerCase()) !== -1 && use_mnemo_array[mnemo_search_cnt].SubNo !== 64) {
                            if (mnemo_search_hit_flg === FLG_OFF) {
                              g_disp_net_index = hit_net_num - 1;
                              mnemo_search_hit_flg = FLG_ON;
                              net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                            }
                            if (use_mnemo_array[mnemo_search_cnt].Order === "SP") {
                              g_end_order_hit_flg = FLG_ON;
                            }
                            g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                            if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                              g_search_result_list_net_num.push(result_list_hit_net_num);
                              g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                            }
                            break;
                          }
                        }
                        search_subroutine_address_flg = FLG_OFF;
                      } else {
                        if (mnemo_address.toLowerCase().indexOf(String(search_str).toLowerCase()) !== -1) {
                          if (mnemo_search_hit_flg === FLG_OFF) {
                            g_disp_net_index = hit_net_num - 1;
                            mnemo_search_hit_flg = FLG_ON;
                            net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                          }
                          g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                          if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                            g_search_result_list_net_num.push(result_list_hit_net_num);
                            g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                          }
                        }
                      }
                    } else if (g_perfect_match_flg == FLG_ON) {
                      //Perfect Match processing
                      if (search_subroutine_address_flg === FLG_ON) {
                        for (var i = 0; i < search_subroutine_address.length; i++) {
                          if (search_subroutine_address[i].toLowerCase() === search_str.toLowerCase() && use_mnemo_array[mnemo_search_cnt].SubNo !== 64) {
                            if (mnemo_search_hit_flg === FLG_OFF) {
                              g_disp_net_index = hit_net_num - 1;
                              mnemo_search_hit_flg = FLG_ON;
                              net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                            }
                            if (use_mnemo_array[mnemo_search_cnt].Order === "SP") {
                              g_end_order_hit_flg = FLG_ON;
                            }
                            g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                            if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                              g_search_result_list_net_num.push(result_list_hit_net_num);
                              g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                            }
                            break;
                          }
                        }
                        search_subroutine_address_flg = FLG_OFF;
                      } else {
                        if (mnemo_address.toLowerCase() === search_str.toLowerCase()) {
                          if (mnemo_search_hit_flg === FLG_OFF) {
                            g_disp_net_index = hit_net_num - 1;
                            mnemo_search_hit_flg = FLG_ON;
                            net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                          }
                          g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                          if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                            g_search_result_list_net_num.push(result_list_hit_net_num);
                            g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                          }
                        }
                      }
                    } else {
                      continue;
                    }
                  }
                }
              
              }
              if ((mnemo_search_hit_flg === FLG_ON && net_index == -1) || (mnemo_search_hit_flg === FLG_ON && different_search_lv_flg === FLG_ON)) {
                if (search_level == 2 || search_level >= 4) {
                  read_address_conversion_flg = FLG_ON;
                }
                var bk_VIEW_MAX_COL;
                bk_VIEW_MAX_COL = VIEW_MAX_COL;
                g_net_num_tbl = [];
                g_result_list_net_num_tbl = [];
                VIEW_MAX_COL = g_width_num;
                net_index = update_list_jump();
                VIEW_MAX_COL = bk_VIEW_MAX_COL;
                read_address_conversion_flg = FLG_OFF;
              }

              if ((old_screen_id == SCREEN_LADDER_DISPLAY || old_screen_id == SCREEN_LADDER_EDITOR || wk_srch_category) && old_screen_id !== SCREEN_LADDER_REPLACE && mnemo_search_hit_flg === FLG_ON) {
                var first_hit_flg = FLG_OFF;
                search_subroutine_address_flg = FLG_OFF;
                grid_List.forEach_hs(0, grid_index, iterateArray, function (data, i, fixed_grid_index, level, subnum) {
                  for (ly_i = 0; ly_i < data.length; ly_i++) {
                    if (fixed_grid_index > 0) {
                      fixed_grid_index = fixed_grid_index - 1;
                      continue;
                    }
                    for (lx_i = 0; lx_i < data[ly_i].length; lx_i++) {
                      // character string search
                      if (grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].FigNo >= IMAGE_MARKER_TOP && screen_id === SCREEN_LADDER_SEARCH_RESULT && wk_srch_category) {
                        grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].FigNo = grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].FigNo - IMAGE_MARKER_TOP;
                      }
                      if ((search_category_list.indexOf(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].FigNo) !== -1 ) || (grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubNo !== undefined && grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubNo !== 0 && search_category_list.indexOf(IMAGENO10_FUNCTION) !== -1)) {
                        if (g_perfect_match_flg == FLG_OFF) {
                          //Partial Match processing
                          if (grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].Address !== "") {
                            result = grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].Address.toLowerCase().indexOf(search_str.toLowerCase());
                          } else if (grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubNo !== 0) {
                            search_subroutine_address_flg = FLG_ON;
                            search_subroutine_address = list_search_subroutine_param_address(i, ly_i, lx_i);
                            if (search_subroutine_address.length > 0) {
                              for (var subroutine_cnt = 0; subroutine_cnt < search_subroutine_address.length; subroutine_cnt++) {
                                result = search_subroutine_address[subroutine_cnt].toLowerCase().indexOf(search_str.toLowerCase());
                                if (result !== -1) {
                                  break;
                                }
                              }
                            } else {
                              result = -1;
                            }
                          }
                        } else {
                          if (grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].Address !== "") {
                            if (grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].Address.toLowerCase() === search_str.toLowerCase()) {
                              result = 0;
                            } else {
                              result = -1;
                            }
                          } else if (grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubNo !== 0) {
                            search_subroutine_address_flg = FLG_ON;
                            search_subroutine_address = list_search_subroutine_param_address(i, ly_i, lx_i);
                            if (search_subroutine_address.length > 0) {
                              for (var subroutine_cnt = 0; subroutine_cnt < search_subroutine_address.length; subroutine_cnt++) {
                                if (search_subroutine_address[subroutine_cnt].toLowerCase() === search_str.toLowerCase()) {
                                  result = 0;
                                  break;
                                } else {
                                  result = -1;
                                }
                              }
                            } else {
                              result = -1;
                            }
                          }
                        }
                        if (result !== -1) {
                          if (search_subroutine_address_flg === FLG_ON) {
                            var search_hit_info = search_hit_structure_info(result_cnt, search_hit_flg, first_hit_flg, i, lx_i, ly_i, grid_List, MARKFLG_ELFN, from_search_flg, search_subroutine_address_flg);
                            search_subroutine_address_flg = FLG_OFF;
                          } else {
                            var search_hit_info = search_hit_structure_info(result_cnt, search_hit_flg, first_hit_flg, i, lx_i, ly_i, grid_List, MARKFLG_ELAD, from_search_flg, FLG_OFF);
                          }
                          result_cnt = search_hit_info[0];
                          search_hit_flg = search_hit_info[1];
                          first_hit_flg = search_hit_info[2];
                        }
                        search_subroutine_address_flg = FLG_OFF;
                      }
                    }
                  }
                });
                first_hit_flg = FLG_OFF;
              } else if (old_screen_id == SCREEN_LADDER_REPLACE && mnemo_search_hit_flg === FLG_ON) {
                search_kind = bk_search_kind;
                iterateArray = [];
                iterateArray = grid_List.pushIterateArray();
                var first_hit_flg = FLG_OFF;
                grid_List.forEach_hs(0, grid_index, iterateArray, function (data, i, fixed_grid_index, level, subnum) {
                  for (ly_i = 0; ly_i < data.length; ly_i++) {
                    if (fixed_grid_index > 0) {
                      fixed_grid_index = fixed_grid_index - 1;
                      continue;
                    }
                    for (lx_i = 0; lx_i < data[ly_i].length; lx_i++) {
                      // character string search
                      if (grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].Address === search_str) {
                        g_array_search_result_index[result_cnt] = ({ net_index: g_net_num_tbl[i], grid_index: ly_i, width_index: lx_i });
                        result_cnt += 1;
                        search_result_reflection(grid_List, MARKFLG_ELAD, i, iterateArray, lx_i, ly_i);
                        search_hit_flg = FLG_ON;
                        // decide an search result indication point
                        if (first_hit_flg == FLG_OFF) {
                          first_hit_flg = FLG_ON;
                          search_result_first_positon_edit(i, lx_i, ly_i);
                        }
                      }
                    }
                  }
                });
                first_hit_flg = FLG_OFF;
              } else { }

              if (result_cnt === 0) {
                g_click_pos_disp_tbl.search_result = result_cnt;
                if (old_screen_id == SCREEN_LADDER_REPLACE) {
                  popup7_display_none();
                  document.getElementById("popcomment_7_2").style.display = "block";
                  Popupbutton();
                } else if (popup_search_flg === FLG_ON) {
                  return false;
                } else {
                  search_err_popup2();
                }
              } else {
                g_click_pos_disp_tbl.search_result = result_cnt;
                switch (old_screen_id) {
                  case SCREEN_LADDER_DISPLAY:
                  case SCREEN_LADDER_EDITOR:
                    move_to_search_screen_check(popup_search_flg);
                    break;
                  case SCREEN_LADDER_REPLACE:
                    move_to_ladder_search_replace('screen_ladder_replace');
                    break;
                  default:
                    move_to_search_screen_check(popup_search_flg);
                    break;
                }
              }
            }
          } else {
            search_err_popup4();
          }
          break;
        // search kind : symbol
        case "1":
          // character count check
          if (search_str.trim().length < 256) {
            // character string check
            if (search_str.match(/[^A-Za-z0-9\!\"\#\$\_\%\&\'\(\)\*\+\,\.\-\<\=\>\?\@\[\/\]\^\`\{\|\}\~\;\: ]/g)) {
              search_err_popup3();
            } else {
              // input check OK
              if (search_level == 0) {
                make_sub_pg_flg = FLG_OFF;
              } else {
                make_sub_pg_flg = FLG_ON;
              }
              if (search_level <= 3) {
                if (search_level == 0 || search_level == 1) {
                  if (search_level == 0) {
                    search_end_pos = use_mnemo_array.length - 1;
                  } else {
                    search_end_pos = use_lv_cnt_tbl[1].mnemo_pos - 1;
                  }
                  search_start_pos = 0;
                  g_net_cnt_before_tree = 0;
                } else {
                  search_start_pos = use_lv_cnt_tbl[Number(search_level) - 1].mnemo_pos;
                  if (use_lv_cnt_tbl[Number(search_level)] !== undefined) {
                    search_end_pos = use_lv_cnt_tbl[Number(search_level)].mnemo_pos - 1;
                  } else if (use_sub_pg_tbl.length > 0) {
                    search_end_pos = use_sub_pg_tbl[0].mnemo_pos - 1;
                  } else {
                    search_end_pos = use_mnemo_array.length - 1;
                  }
                }
                if (search_level == 1) {
                  g_net_cnt_before_tree = 0;
                } else if (search_level == 2) {
                  g_net_cnt_before_tree = use_lv_cnt_tbl[0].net_cnt;
                } else if (search_level == 3) {
                  g_net_cnt_before_tree = use_lv_cnt_tbl[0].net_cnt + use_lv_cnt_tbl[1].net_cnt;
                }
              } else if (search_level >= 4) {
                search_start_pos = use_sub_pg_tbl[Number(search_level) - 4].mnemo_pos;
                if (use_sub_pg_tbl[Number(search_level) - 3] !== undefined) {
                  search_end_pos = use_sub_pg_tbl[Number(search_level) - 3].mnemo_pos - 1;
                } else {
                  search_end_pos = use_mnemo_array.length - 1;
                }
                for (var k = 0; k < use_lv_cnt_tbl.length; k++) {
                  g_net_cnt_before_tree = g_net_cnt_before_tree + use_lv_cnt_tbl[k].net_cnt;
                }
                for (var l = 0; l < search_level - 4; l++) {
                  g_net_cnt_before_tree = g_net_cnt_before_tree + use_sub_pg_tbl[l].net_cnt;
                }
              }
              for (var mnemo_search_cnt = search_start_pos; mnemo_search_cnt <= search_end_pos; mnemo_search_cnt++) {
                if (String(use_mnemo_array[mnemo_search_cnt].address).indexOf("V") !== -1 || String(use_mnemo_array[mnemo_search_cnt].address).indexOf("U") !== -1 || String(use_mnemo_array[mnemo_search_cnt].address).indexOf("W") !== -1) {
                  mnemo_address = search_conversion_address(use_mnemo_array[mnemo_search_cnt].address);
                } else {
                  mnemo_address = String(use_mnemo_array[mnemo_search_cnt].address);
                }
                if (use_mnemo_array[mnemo_search_cnt].net_num !== undefined) {
                  hit_net_num = hit_net_num + 1;
                  result_list_hit_net_num = use_mnemo_array[mnemo_search_cnt].net_num;
                }
                if (wk_srch_category === SEARCH_CATEGORY_CONTACT) {
                  if (use_mnemo_array[mnemo_search_cnt].Order !== "WRT" && use_mnemo_array[mnemo_search_cnt].Order !== "WRT.NOT" &&
                    use_mnemo_array[mnemo_search_cnt].Order !== "RST" && use_mnemo_array[mnemo_search_cnt].Order !== "SET" &&
                    use_mnemo_array[mnemo_search_cnt].Order !== "OR.STK" && use_mnemo_array[mnemo_search_cnt].Order !== "AND.STK" &&
                    use_mnemo_array[mnemo_search_cnt].Order !== "POP" && use_mnemo_array[mnemo_search_cnt].Order !== "PUSH" && use_mnemo_array[mnemo_search_cnt].SubParamRawData === undefined) {
                    if (g_perfect_match_flg == FLG_OFF) {
                      //Partial Match processing
                      if (String(g_array_grid_detail[mnemo_address].Symbol).toLowerCase().indexOf(String(search_str).toLowerCase()) !== -1) {
                        if (mnemo_search_hit_flg === FLG_OFF) {
                          g_disp_net_index = hit_net_num - 1;
                          mnemo_search_hit_flg = FLG_ON;
                          net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                        }
                        g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                        if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                          g_search_result_list_net_num.push(result_list_hit_net_num);
                          g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                        }
                      }
                    } else if (g_perfect_match_flg == FLG_ON) {
                      //Perfect Match processing
                      if (g_array_grid_detail[mnemo_address].Symbol.toLowerCase() === search_str.toLowerCase()) {
                        if (mnemo_search_hit_flg === FLG_OFF) {
                          g_disp_net_index = hit_net_num - 1;
                          mnemo_search_hit_flg = FLG_ON;
                          net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                        }
                        g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                        if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                          g_search_result_list_net_num.push(result_list_hit_net_num);
                          g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                        }
                      }
                    } else {
                      continue;
                    }
                  }
                } else if (wk_srch_category === SEARCH_CATEGORY_COIL) {
                  if ((use_mnemo_array[mnemo_search_cnt].Order == "WRT" || use_mnemo_array[mnemo_search_cnt].Order == "WRT.NOT" ||
                    use_mnemo_array[mnemo_search_cnt].Order == "RST" || use_mnemo_array[mnemo_search_cnt].Order == "SET") &&
                    use_mnemo_array[mnemo_search_cnt].Order !== "OR.STK" && use_mnemo_array[mnemo_search_cnt].Order !== "AND.STK" &&
                    use_mnemo_array[mnemo_search_cnt].Order !== "POP" && use_mnemo_array[mnemo_search_cnt].Order !== "PUSH" && use_mnemo_array[mnemo_search_cnt].SubParamRawData === undefined) {
                    if (g_perfect_match_flg == FLG_OFF) {
                      //Partial Match processing
                      if (String(g_array_grid_detail[mnemo_address].Symbol).toLowerCase().indexOf(String(search_str).toLowerCase()) !== -1) {
                        if (mnemo_search_hit_flg === FLG_OFF) {
                          g_disp_net_index = hit_net_num - 1;
                          mnemo_search_hit_flg = FLG_ON;
                          net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                        }
                        g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                        if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                          g_search_result_list_net_num.push(result_list_hit_net_num);
                          g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                        }
                      }
                    } else if (g_perfect_match_flg == FLG_ON) {
                      //Perfect Match processing
                      if (g_array_grid_detail[mnemo_address].Symbol.toLowerCase() === search_str.toLowerCase()) {
                        if (mnemo_search_hit_flg === FLG_OFF) {
                          g_disp_net_index = hit_net_num - 1;
                          mnemo_search_hit_flg = FLG_ON;
                          net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                        }
                        g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                        if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                          g_search_result_list_net_num.push(result_list_hit_net_num);
                          g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                        }
                      }
                    } else {
                      continue;
                    }
                  }
                } else if (wk_srch_category === SEARCH_CATEGORY_CONTACT_COIL) {
                  if (use_mnemo_array[mnemo_search_cnt].address == undefined) {
                    continue;
                  }
                  if (g_perfect_match_flg == FLG_OFF) {
                    //Partial Match processing
                    if (String(g_array_grid_detail[mnemo_address].Symbol).toLowerCase().indexOf(String(search_str).toLowerCase()) !== -1) {
                      if (mnemo_search_hit_flg === FLG_OFF) {
                        g_disp_net_index = hit_net_num - 1;
                        mnemo_search_hit_flg = FLG_ON;
                        net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                      }
                      g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                      if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                        g_search_result_list_net_num.push(result_list_hit_net_num);
                        g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                      }
                    }
                  } else if (g_perfect_match_flg == FLG_ON) {
                    //Perfect Match processing
                    if (g_array_grid_detail[mnemo_address].Symbol.toLowerCase() === search_str.toLowerCase()) {
                      if (mnemo_search_hit_flg === FLG_OFF) {
                        g_disp_net_index = hit_net_num - 1;
                        mnemo_search_hit_flg = FLG_ON;
                        net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                      }
                      g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                      if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                        g_search_result_list_net_num.push(result_list_hit_net_num);
                        g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                      }
                    }
                  } else {
                    continue;
                  }
                }
              
              }
              if ((mnemo_search_hit_flg === FLG_ON && net_index == -1) || (mnemo_search_hit_flg === FLG_ON && different_search_lv_flg === FLG_ON)) {
                if (search_level == 2 || search_level >= 4) {
                  read_address_conversion_flg = FLG_ON;
                }
                var bk_VIEW_MAX_COL;
                bk_VIEW_MAX_COL = VIEW_MAX_COL;
                g_net_num_tbl = [];
                g_result_list_net_num_tbl = [];
                VIEW_MAX_COL = g_width_num;
                net_index = update_list_jump();
                VIEW_MAX_COL = bk_VIEW_MAX_COL;
                read_address_conversion_flg = FLG_OFF;
              }

              if ((old_screen_id == SCREEN_LADDER_DISPLAY || old_screen_id == SCREEN_LADDER_EDITOR || wk_srch_category) && mnemo_search_hit_flg === FLG_ON) {
                var first_hit_flg = FLG_OFF;
                grid_List.forEach_hs(0, grid_index, iterateArray, function (data, i, fixed_grid_index, level, subnum) {
                  for (ly_i = 0; ly_i < data.length; ly_i++) {
                    if (fixed_grid_index > 0) {
                      fixed_grid_index = fixed_grid_index - 1;
                      continue;
                    }

                    for (lx_i = 0; lx_i < data[ly_i].length; lx_i++) {
                      if ((g_array_grid_detail[grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].Address])) {
                        // character string search
                        if (search_category_list.indexOf(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].FigNo) !== -1) {
                          if (g_perfect_match_flg == FLG_OFF) {
                            //Partial Match processing
                            result = String(g_array_grid_detail[grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].Address].Symbol).toLowerCase().indexOf(String(search_str).toLowerCase());
                          } else {
                            if (g_array_grid_detail[grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].Address].Symbol.toLowerCase() === search_str.toLowerCase()) {
                              result = 0;
                            } else {
                              result = -1;
                            }
                          }
                        
                          if (result !== -1) {
                            var search_hit_info = search_hit_structure_info(result_cnt, search_hit_flg, first_hit_flg, i, lx_i, ly_i, grid_List, MARKFLG_ELSY, from_search_flg, FLG_OFF);
                            result_cnt = search_hit_info[0];
                            search_hit_flg = search_hit_info[1];
                            first_hit_flg = search_hit_info[2];
                          }
                        }
                      }
                    }
                  }
                });
                first_hit_flg = FLG_OFF;
              }
              if (result_cnt === 0) {
                g_click_pos_disp_tbl.search_result = result_cnt;
                search_err_popup2();
              } else {
                g_click_pos_disp_tbl.search_result = result_cnt;
                move_to_search_screen_check(popup_search_flg);
              }
            }
          } else {
            search_err_popup4();
          }
          break;
        // search kind : comment
        case "2":
          // character count check
          if (search_str.trim().length < 256) {
            // character string check
            //Unicode Type
            //\uFF66-\uFF9F:half-width katakana
            //\u2190-\u2193:arrow
            //\u3005-\u3007:Special kanji
            //\u3040-\u30FF:hiragana,katakana
            //\u3400-\u9FFF:kanji
            if (search_str.match(/[^A-Za-z0-9\uFF66-\uFF9F\u2190-\u2193\u3005-\u3007\u3040-\u30FF\u3400-\u9FFF\!\"\#\$\_\%\&\'\(\)\*\+\,\.\-\<\=\>\?\@\[\/\]\^\`\{\|\}\~\;\: ]/g)) {
              search_err_popup3();
            } else {
              // input check OK
              if (search_level == 0) {
                make_sub_pg_flg = FLG_OFF;
              } else {
                make_sub_pg_flg = FLG_ON;
              }
              if (search_level <= 3) {
                if (search_level == 0 || search_level == 1) {
                  if (search_level == 0) {
                    search_end_pos = use_mnemo_array.length - 1;
                  } else {
                    search_end_pos = use_lv_cnt_tbl[1].mnemo_pos - 1;
                  }
                  search_start_pos = 0;
                  g_net_cnt_before_tree = 0;
                } else {
                  search_start_pos = use_lv_cnt_tbl[Number(search_level) - 1].mnemo_pos;
                  if (use_lv_cnt_tbl[Number(search_level)] !== undefined) {
                    search_end_pos = use_lv_cnt_tbl[Number(search_level)].mnemo_pos - 1;
                  } else if (use_sub_pg_tbl.length > 0) {
                    search_end_pos = use_sub_pg_tbl[0].mnemo_pos - 1;
                  } else {
                    search_end_pos = use_mnemo_array.length - 1;
                  }
                }
                if (search_level == 1) {
                  g_net_cnt_before_tree = 0;
                } else if (search_level == 2) {
                  g_net_cnt_before_tree = use_lv_cnt_tbl[0].net_cnt;
                } else if (search_level == 3) {
                  g_net_cnt_before_tree = use_lv_cnt_tbl[0].net_cnt + use_lv_cnt_tbl[1].net_cnt;
                }
              } else if (search_level >= 4) {
                search_start_pos = use_sub_pg_tbl[Number(search_level) - 4].mnemo_pos;
                if (use_sub_pg_tbl[Number(search_level) - 3] !== undefined) {
                  search_end_pos = use_sub_pg_tbl[Number(search_level) - 3].mnemo_pos - 1;
                } else {
                  search_end_pos = use_mnemo_array.length - 1;
                }
                for (var k = 0; k < use_lv_cnt_tbl.length; k++) {
                  g_net_cnt_before_tree = g_net_cnt_before_tree + use_lv_cnt_tbl[k].net_cnt;
                }
                for (var l = 0; l < search_level - 4; l++) {
                  g_net_cnt_before_tree = g_net_cnt_before_tree + use_sub_pg_tbl[l].net_cnt;
                }
              }
              for (var mnemo_search_cnt = search_start_pos; mnemo_search_cnt <= search_end_pos; mnemo_search_cnt++) {
                if (String(use_mnemo_array[mnemo_search_cnt].address).indexOf("V") !== -1 || String(use_mnemo_array[mnemo_search_cnt].address).indexOf("U") !== -1 || String(use_mnemo_array[mnemo_search_cnt].address).indexOf("W") !== -1) {
                  mnemo_address = search_conversion_address(use_mnemo_array[mnemo_search_cnt].address);
                } else {
                  mnemo_address = String(use_mnemo_array[mnemo_search_cnt].address);
                }
                if (use_mnemo_array[mnemo_search_cnt].net_num !== undefined) {
                  hit_net_num = hit_net_num + 1;
                  result_list_hit_net_num = use_mnemo_array[mnemo_search_cnt].net_num;
                }
                if (wk_srch_category === SEARCH_CATEGORY_CONTACT) {
                  if (use_mnemo_array[mnemo_search_cnt].Order !== "WRT" && use_mnemo_array[mnemo_search_cnt].Order !== "WRT.NOT" &&
                    use_mnemo_array[mnemo_search_cnt].Order !== "RST" && use_mnemo_array[mnemo_search_cnt].Order !== "SET" &&
                    use_mnemo_array[mnemo_search_cnt].Order !== "OR.STK" && use_mnemo_array[mnemo_search_cnt].Order !== "AND.STK" &&
                    use_mnemo_array[mnemo_search_cnt].Order !== "POP" && use_mnemo_array[mnemo_search_cnt].Order !== "PUSH" && use_mnemo_array[mnemo_search_cnt].SubParamRawData === undefined) {
                    if (g_perfect_match_flg == FLG_OFF) {
                      //Partial Match processing
                      if (String(g_array_grid_detail[mnemo_address].Comment1).toLowerCase().indexOf(String(search_str).toLowerCase()) !== -1) {
                        if (mnemo_search_hit_flg === FLG_OFF) {
                          g_disp_net_index = hit_net_num - 1;
                          mnemo_search_hit_flg = FLG_ON;
                          net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                        }
                        g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                        if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                          g_search_result_list_net_num.push(result_list_hit_net_num);
                          g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                        }
                      }
                    } else if (g_perfect_match_flg == FLG_ON) {
                      //Perfect Match processing
                      if (g_array_grid_detail[mnemo_address].Comment1.toLowerCase() === search_str.toLowerCase()) {
                        if (mnemo_search_hit_flg === FLG_OFF) {
                          g_disp_net_index = hit_net_num - 1;
                          mnemo_search_hit_flg = FLG_ON;
                          net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                        }
                        g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                        if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                          g_search_result_list_net_num.push(result_list_hit_net_num);
                          g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                        }
                      }
                    } else {
                      continue;
                    }
                  }
                } else if (wk_srch_category === SEARCH_CATEGORY_COIL) {
                  if ((use_mnemo_array[mnemo_search_cnt].Order == "WRT" || use_mnemo_array[mnemo_search_cnt].Order == "WRT.NOT" ||
                    use_mnemo_array[mnemo_search_cnt].Order == "RST" || use_mnemo_array[mnemo_search_cnt].Order == "SET") &&
                    use_mnemo_array[mnemo_search_cnt].Order !== "OR.STK" && use_mnemo_array[mnemo_search_cnt].Order !== "AND.STK" &&
                    use_mnemo_array[mnemo_search_cnt].Order !== "POP" && use_mnemo_array[mnemo_search_cnt].Order !== "PUSH" && use_mnemo_array[mnemo_search_cnt].SubParamRawData === undefined) {
                    if (g_perfect_match_flg == FLG_OFF) {
                      //Partial Match processing
                      if (String(g_array_grid_detail[mnemo_address].Comment1).toLowerCase().indexOf(String(search_str).toLowerCase()) !== -1) {
                        if (mnemo_search_hit_flg === FLG_OFF) {
                          g_disp_net_index = hit_net_num - 1;
                          mnemo_search_hit_flg = FLG_ON;
                          net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                        }
                        g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                        if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                          g_search_result_list_net_num.push(result_list_hit_net_num);
                          g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                        }
                      }
                    } else if (g_perfect_match_flg == FLG_ON) {
                      //Perfect Match processing
                      if (g_array_grid_detail[mnemo_address].Comment1.toLowerCase() === search_str.toLowerCase()) {
                        if (mnemo_search_hit_flg === FLG_OFF) {
                          g_disp_net_index = hit_net_num - 1;
                          mnemo_search_hit_flg = FLG_ON;
                          net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                        }
                        g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                        if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                          g_search_result_list_net_num.push(result_list_hit_net_num);
                          g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                        }
                      }
                    } else {
                      continue;
                    }
                  }
                } else if (wk_srch_category === SEARCH_CATEGORY_CONTACT_COIL) {
                  if (use_mnemo_array[mnemo_search_cnt].address == undefined) {
                    continue;
                  }
                  if (g_perfect_match_flg == FLG_OFF) {
                    //Partial Match processing
                    if (String(g_array_grid_detail[mnemo_address].Comment1).toLowerCase().indexOf(String(search_str).toLowerCase()) !== -1) {
                      if (mnemo_search_hit_flg === FLG_OFF) {
                        g_disp_net_index = hit_net_num - 1;
                        mnemo_search_hit_flg = FLG_ON;
                        net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                      }
                      g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                      if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                        g_search_result_list_net_num.push(result_list_hit_net_num);
                        g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                      }
                    }
                  } else if (g_perfect_match_flg == FLG_ON) {
                    //Perfect Match processing
                    if (g_array_grid_detail[mnemo_address].Comment1.toLowerCase() === search_str.toLowerCase()) {
                      if (mnemo_search_hit_flg === FLG_OFF) {
                        g_disp_net_index = hit_net_num - 1;
                        mnemo_search_hit_flg = FLG_ON;
                        net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                      }
                      g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                      if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                        g_search_result_list_net_num.push(result_list_hit_net_num);
                        g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                      }
                    }
                  } else {
                    continue;
                  }
                }
              }
              if ((mnemo_search_hit_flg === FLG_ON && net_index == -1) || (mnemo_search_hit_flg === FLG_ON && different_search_lv_flg === FLG_ON)) {
                if (search_level == 2 || search_level >= 4) {
                  read_address_conversion_flg = FLG_ON;
                }
                var bk_VIEW_MAX_COL;
                bk_VIEW_MAX_COL = VIEW_MAX_COL;
                g_net_num_tbl = [];
                g_result_list_net_num_tbl = [];
                VIEW_MAX_COL = g_width_num;
                net_index = update_list_jump();
                VIEW_MAX_COL = bk_VIEW_MAX_COL;
                read_address_conversion_flg = FLG_OFF;
              }
              if ((old_screen_id == SCREEN_LADDER_DISPLAY || old_screen_id == SCREEN_LADDER_EDITOR || wk_srch_category) && mnemo_search_hit_flg === FLG_ON) {
                var first_hit_flg = FLG_OFF;
                grid_List.forEach_hs(0, grid_index, iterateArray, function (data, i, fixed_grid_index, level, subnum) {
                  for (ly_i = 0; ly_i < data.length; ly_i++) {
                    if (fixed_grid_index > 0) {
                      fixed_grid_index = fixed_grid_index - 1;
                      continue;
                    }
                    for (lx_i = 0; lx_i < data[ly_i].length; lx_i++) {
                      if ((g_array_grid_detail[grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].Address])) {
                        // character string search
                        if (search_category_list.indexOf(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].FigNo) !== -1) {
                          if (g_perfect_match_flg == FLG_OFF) {
                            //Partial Match processing
                            result = String(g_array_grid_detail[grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].Address].Comment1).toLowerCase().indexOf(String(search_str).toLowerCase());
                          } else {
                            if (g_array_grid_detail[grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].Address].Comment1.toLowerCase() === search_str.toLowerCase()) {
                              result = 0;
                            } else {
                              result = -1;
                            }
                          }
                          if (result !== -1) {
                            var search_hit_info = search_hit_structure_info(result_cnt, search_hit_flg, first_hit_flg, i, lx_i, ly_i, grid_List, MARKFLG_ELCO, from_search_flg, FLG_OFF);
                            result_cnt = search_hit_info[0];
                            search_hit_flg = search_hit_info[1];
                            first_hit_flg = search_hit_info[2];
                          }
                        }
                      }
                    }
                  }
                });
                first_hit_flg = FLG_OFF;
              }
              if (result_cnt === 0) {
                g_click_pos_disp_tbl.search_result = result_cnt;
                search_err_popup2();
              } else {
                g_click_pos_disp_tbl.search_result = result_cnt;
                move_to_search_screen_check(popup_search_flg);
              }
            }
          } else {
            search_err_popup4();
          }
          break;
        // search kind : function instruction number
        case "3":
          // character count check
          if (search_str.trim().length < 256) {
            // character string check
            if (search_str.match(/[^0-9]/g)) {
              search_err_popup3();
            } else {
              // input check OK
              g_search_num_flg = FLG_ON;
              if (search_level == 0) {
                make_sub_pg_flg = FLG_OFF;
              } else {
                make_sub_pg_flg = FLG_ON;
              }
              if (search_level <= 3) {
                if (search_level == 0 || search_level == 1) {
                  if (search_level == 0) {
                    search_end_pos = use_mnemo_array.length - 1;
                  } else {
                    search_end_pos = use_lv_cnt_tbl[1].mnemo_pos - 1;
                  }
                  search_start_pos = 0;
                  g_net_cnt_before_tree = 0;
                } else {
                  search_start_pos = use_lv_cnt_tbl[Number(search_level) - 1].mnemo_pos;
                  if (use_lv_cnt_tbl[Number(search_level)] !== undefined) {
                    search_end_pos = use_lv_cnt_tbl[Number(search_level)].mnemo_pos - 1;
                  } else if (use_sub_pg_tbl.length > 0) {
                    search_end_pos = use_sub_pg_tbl[0].mnemo_pos - 1;
                  } else {
                    search_end_pos = use_mnemo_array.length - 1;
                  }
                }
                if (search_level == 1) {
                  g_net_cnt_before_tree = 0;
                } else if (search_level == 2) {
                  g_net_cnt_before_tree = use_lv_cnt_tbl[0].net_cnt;
                } else if (search_level == 3) {
                  g_net_cnt_before_tree = use_lv_cnt_tbl[0].net_cnt + use_lv_cnt_tbl[1].net_cnt;
                }
              } else if (search_level >= 4) {
                search_start_pos = use_sub_pg_tbl[Number(search_level) - 4].mnemo_pos;
                if (use_sub_pg_tbl[Number(search_level) - 3] !== undefined) {
                  search_end_pos = use_sub_pg_tbl[Number(search_level) - 3].mnemo_pos - 1;
                } else {
                  search_end_pos = use_mnemo_array.length - 1;
                }
                for (var k = 0; k < use_lv_cnt_tbl.length; k++) {
                  g_net_cnt_before_tree = g_net_cnt_before_tree + use_lv_cnt_tbl[k].net_cnt;
                }
                for (var l = 0; l < search_level - 4; l++) {
                  g_net_cnt_before_tree = g_net_cnt_before_tree + use_sub_pg_tbl[l].net_cnt;
                }
              }
              for (var mnemo_search_cnt = search_start_pos; mnemo_search_cnt <= search_end_pos; mnemo_search_cnt++) {
                if (use_mnemo_array[mnemo_search_cnt].net_num !== undefined) {
                  hit_net_num = hit_net_num + 1;
                  result_list_hit_net_num = use_mnemo_array[mnemo_search_cnt].net_num;
                }
                if (g_perfect_match_flg == FLG_OFF) {
                  //Partial Match processing
                  if (String(use_mnemo_array[mnemo_search_cnt].SubNo).toUpperCase().indexOf(String(search_str).toUpperCase()) !== -1 && use_mnemo_array[mnemo_search_cnt].SubNo !== 64) {
                    if (mnemo_search_hit_flg === FLG_OFF) {
                      g_disp_net_index = hit_net_num - 1;
                      mnemo_search_hit_flg = FLG_ON;
                      net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                    }
                    if (use_mnemo_array[mnemo_search_cnt].Order === "END1" ||
                      use_mnemo_array[mnemo_search_cnt].Order === "END2" ||
                      use_mnemo_array[mnemo_search_cnt].Order === "END3" ||
                      use_mnemo_array[mnemo_search_cnt].Order === "SP" ||
                      use_mnemo_array[mnemo_search_cnt].Order === "SPE"  ) {
                      g_end_order_hit_flg = FLG_ON;
                    }
                    g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                    if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                      g_search_result_list_net_num.push(result_list_hit_net_num);
                      g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                    }
                  }
                } else if (g_perfect_match_flg == FLG_ON) {
                  //Perfect Match processing
                  if (String(use_mnemo_array[mnemo_search_cnt].SubNo) === search_str && use_mnemo_array[mnemo_search_cnt].SubNo !== 64) {
                    if (mnemo_search_hit_flg === FLG_OFF) {
                      g_disp_net_index = hit_net_num - 1;
                      mnemo_search_hit_flg = FLG_ON;
                      net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                    }
                    if (use_mnemo_array[mnemo_search_cnt].Order === "END1" ||
                      use_mnemo_array[mnemo_search_cnt].Order === "END2" ||
                      use_mnemo_array[mnemo_search_cnt].Order === "END3" ||
                      use_mnemo_array[mnemo_search_cnt].Order === "SP" ||
                      use_mnemo_array[mnemo_search_cnt].Order === "SPE"  ) {
                      g_end_order_hit_flg = FLG_ON;
                    }
                    g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                    if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                      g_search_result_list_net_num.push(result_list_hit_net_num);
                      g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                    }
                  }
                } else {
                  continue;
                }
              }
              if ((mnemo_search_hit_flg === FLG_ON && net_index == -1) || (mnemo_search_hit_flg === FLG_ON && different_search_lv_flg === FLG_ON)) {
                if (search_level == 2 || search_level >= 4) {
                  read_address_conversion_flg = FLG_ON;
                }
                var bk_VIEW_MAX_COL;
                bk_VIEW_MAX_COL = VIEW_MAX_COL;
                g_net_num_tbl = [];
                g_result_list_net_num_tbl = [];
                VIEW_MAX_COL = g_width_num;
                net_index = update_list_jump();
                VIEW_MAX_COL = bk_VIEW_MAX_COL;
                read_address_conversion_flg = FLG_OFF;
              }

              if ((old_screen_id == SCREEN_LADDER_DISPLAY || old_screen_id == SCREEN_LADDER_EDITOR || wk_srch_category) && mnemo_search_hit_flg === FLG_ON) {
                var first_hit_flg = FLG_OFF;
                grid_List.forEach_hs(0, grid_index, iterateArray, function (data, i, fixed_grid_index, level, subnum) {
                  for (ly_i = 0; ly_i < data.length; ly_i++) {
                    if (fixed_grid_index > 0) {
                      fixed_grid_index = fixed_grid_index - 1;
                      continue;
                    }
                    for (lx_i = 0; lx_i < data[ly_i].length; lx_i++) {
                      if (grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubNo !== 0) {
                        // character string search
                        if (g_perfect_match_flg == FLG_OFF) {
                          //Partial Match processing
                          result = String(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubNo).indexOf(String(search_str));
                        } else {
                          if (String(grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubNo) === search_str) {
                            result = 0;
                          } else {
                            result = -1;
                          }
                        }
                        if (result !== -1) {
                          var search_hit_info = search_hit_structure_info(result_cnt, search_hit_flg, first_hit_flg, i, lx_i, ly_i, grid_List, MARKFLG_ELFN, from_search_flg, FLG_OFF);
                          result_cnt = search_hit_info[0];
                          search_hit_flg = search_hit_info[1];
                          first_hit_flg = search_hit_info[2];
                        }
                      }
                    }
                  }
                });
                first_hit_flg = FLG_OFF;
              }
              if (result_cnt === 0) {
                g_click_pos_disp_tbl.search_result = result_cnt;
                search_err_popup2();
              } else {
                g_click_pos_disp_tbl.search_result = result_cnt;
                move_to_search_screen_check(popup_search_flg);
              }
            }
          } else {
            search_err_popup4();
          }
          break;
        // search kind : function instruction name
        case "4":
          // character count check
          if (search_str.trim().length < 256) {
            // character string check
            if (search_str.match(/[^A-Za-z0-9]/g)) {
              search_err_popup3();
            } else {
              g_hit_func_subno_tbl = [];
              g_search_num_flg = FLG_OFF;
              if (g_perfect_match_flg == FLG_OFF) {
                //Partial Match processing
                for (var i = 0; i < subroutine_tbl.length; i++) {
                  if (subroutine_tbl[i].order.toUpperCase().indexOf(search_str.toUpperCase()) !== -1) {
                    g_hit_func_subno_tbl.push(subroutine_tbl[i].sub_num);
                  }
                }
              } else if (g_perfect_match_flg == FLG_ON) {
                //Perfect Match processing
                for (var i = 0; i < subroutine_tbl.length; i++) {
                  if (subroutine_tbl[i].order.toLowerCase() === search_str.toLowerCase()) {
                    g_hit_func_subno_tbl.push(subroutine_tbl[i].sub_num);
                    break;
                  }
                }
              }
              // input check OK
              if (search_level == 0) {
                make_sub_pg_flg = FLG_OFF;
              } else {
                make_sub_pg_flg = FLG_ON;
              }
              if (search_level <= 3) {
                if (search_level == 0 || search_level == 1) {
                  if (search_level == 0) {
                    search_end_pos = use_mnemo_array.length - 1;
                  } else {
                    search_end_pos = use_lv_cnt_tbl[1].mnemo_pos - 1;
                  }
                  search_start_pos = 0;
                  g_net_cnt_before_tree = 0;
                } else {
                  search_start_pos = use_lv_cnt_tbl[Number(search_level) - 1].mnemo_pos;
                  if (use_lv_cnt_tbl[Number(search_level)] !== undefined) {
                    search_end_pos = use_lv_cnt_tbl[Number(search_level)].mnemo_pos - 1;
                  } else if (use_sub_pg_tbl.length > 0) {
                    search_end_pos = use_sub_pg_tbl[0].mnemo_pos - 1;
                  } else {
                    search_end_pos = use_mnemo_array.length - 1;
                  }
                }
                if (search_level == 1) {
                  g_net_cnt_before_tree = 0;
                } else if (search_level == 2) {
                  g_net_cnt_before_tree = use_lv_cnt_tbl[0].net_cnt;
                } else if (search_level == 3) {
                  g_net_cnt_before_tree = use_lv_cnt_tbl[0].net_cnt + use_lv_cnt_tbl[1].net_cnt;
                }
              } else if (search_level >= 4) {
                search_start_pos = use_sub_pg_tbl[Number(search_level) - 4].mnemo_pos;
                if (use_sub_pg_tbl[Number(search_level) - 3] !== undefined) {
                  search_end_pos = use_sub_pg_tbl[Number(search_level) - 3].mnemo_pos - 1;
                } else {
                  search_end_pos = use_mnemo_array.length - 1;
                }
                for (var k = 0; k < use_lv_cnt_tbl.length; k++) {
                  g_net_cnt_before_tree = g_net_cnt_before_tree + use_lv_cnt_tbl[k].net_cnt;
                }
                for (var l = 0; l < search_level - 4; l++) {
                  g_net_cnt_before_tree = g_net_cnt_before_tree + use_sub_pg_tbl[l].net_cnt;
                }
              }
              for (var mnemo_search_cnt = search_start_pos; mnemo_search_cnt <= search_end_pos; mnemo_search_cnt++) {
                if (use_mnemo_array[mnemo_search_cnt].net_num !== undefined) {
                  hit_net_num = hit_net_num + 1;
                  result_list_hit_net_num = use_mnemo_array[mnemo_search_cnt].net_num;
                }
                if (g_perfect_match_flg == FLG_OFF) {
                  //Partial Match processing
                  if (String(use_mnemo_array[mnemo_search_cnt].Order).toLowerCase().indexOf(String(search_str).toLowerCase()) !== -1 &&
                    use_mnemo_array[mnemo_search_cnt].SubNo !== undefined &&
                    use_mnemo_array[mnemo_search_cnt].Order !== "END") {
                    if (mnemo_search_hit_flg === FLG_OFF) {
                      g_disp_net_index = hit_net_num - 1;
                      mnemo_search_hit_flg = FLG_ON;
                      net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                    }
                    if (use_mnemo_array[mnemo_search_cnt].Order === "END1" ||
                      use_mnemo_array[mnemo_search_cnt].Order === "END2" ||
                      use_mnemo_array[mnemo_search_cnt].Order === "END3" ||
                      use_mnemo_array[mnemo_search_cnt].Order === "SP" ||
                      use_mnemo_array[mnemo_search_cnt].Order === "SPE"  ) {
                      g_end_order_hit_flg = FLG_ON;
                    }
                    g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                    if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                      g_search_result_list_net_num.push(result_list_hit_net_num);
                      g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                    }
                  }
                } else if (g_perfect_match_flg == FLG_ON) {
                  //Perfect Match processing
                  if (use_mnemo_array[mnemo_search_cnt].Order.toLowerCase() === search_str.toLowerCase() &&
                    use_mnemo_array[mnemo_search_cnt].SubNo !== undefined &&
                    use_mnemo_array[mnemo_search_cnt].Order !== "END") {
                    if (mnemo_search_hit_flg === FLG_OFF) {
                      g_disp_net_index = hit_net_num - 1;
                      mnemo_search_hit_flg = FLG_ON;
                      net_index = g_net_num_tbl.indexOf(g_net_cnt_before_tree + g_disp_net_index + 1);
                    }
                    if (use_mnemo_array[mnemo_search_cnt].Order === "END1" ||
                      use_mnemo_array[mnemo_search_cnt].Order === "END2" ||
                      use_mnemo_array[mnemo_search_cnt].Order === "END3" ||
                      use_mnemo_array[mnemo_search_cnt].Order === "SP" ||
                      use_mnemo_array[mnemo_search_cnt].Order === "SPE"  ) {
                      g_end_order_hit_flg = FLG_ON;
                    }
                    g_array_search_result_netnum.push({ net_num: hit_net_num, mnemo_pos: mnemo_search_cnt });
                    if (g_search_result_list_net_num.length === 0 || g_search_result_list_net_num[g_search_result_list_net_num.length - 1] !== result_list_hit_net_num) {
                      g_search_result_list_net_num.push(result_list_hit_net_num);
                      g_search_result_list_grid_num.push(use_grid_num_tbl[result_list_hit_net_num - 1]);
                    }
                  }
                } else {
                  continue;
                }
              }
              if ((mnemo_search_hit_flg === FLG_ON && net_index == -1) || (mnemo_search_hit_flg === FLG_ON && different_search_lv_flg === FLG_ON)) {
                if (search_level == 2 || search_level >= 4) {
                  read_address_conversion_flg = FLG_ON;
                }
                var bk_VIEW_MAX_COL;
                bk_VIEW_MAX_COL = VIEW_MAX_COL;
                g_net_num_tbl = [];
                g_result_list_net_num_tbl = [];
                VIEW_MAX_COL = g_width_num;
                net_index = update_list_jump();
                VIEW_MAX_COL = bk_VIEW_MAX_COL;
                read_address_conversion_flg = FLG_OFF;
              }

              if ((old_screen_id == SCREEN_LADDER_DISPLAY || old_screen_id == SCREEN_LADDER_EDITOR || wk_srch_category) && mnemo_search_hit_flg === FLG_ON) {
                var first_hit_flg = FLG_OFF;
                grid_List.forEach_hs(0, grid_index, iterateArray, function (data, i, fixed_grid_index, level, subnum) {
                  for (ly_i = 0; ly_i < data.length; ly_i++) {
                    if (fixed_grid_index > 0) {
                      fixed_grid_index = fixed_grid_index - 1;
                      continue;
                    }
                    for (lx_i = 0; lx_i < data[ly_i].length; lx_i++) {
                      if (grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubNo !== 0) {
                        // character string search
                        for (var subno_cnt = 0; subno_cnt < g_hit_func_subno_tbl.length; subno_cnt++) {
                          if (g_perfect_match_flg == FLG_OFF) {
                            //Partial Match processing
                            if (grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubNo === g_hit_func_subno_tbl[subno_cnt]) {
                              result = 0;
                            } else {
                              result = -1;
                            }
                          } else {
                            if (grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubNo === g_hit_func_subno_tbl[subno_cnt]) {
                              result = 0;
                            } else {
                              result = -1;
                            }
                          }
                          if (grid_List.getDataNum(i, iterateArray)[ly_i][lx_i].SubNo == g_hit_func_subno_tbl[subno_cnt]) {
                            break;
                          }
                        }
                        if (g_hit_func_subno_tbl.length == 0) {
                          result = -1;
                        }
                        if (result !== -1) {
                          var search_hit_info = search_hit_structure_info(result_cnt, search_hit_flg, first_hit_flg, i, lx_i, ly_i, grid_List, MARKFLG_ELFN, from_search_flg, FLG_OFF);
                          result_cnt = search_hit_info[0];
                          search_hit_flg = search_hit_info[1];
                          first_hit_flg = search_hit_info[2];
                        }
                      }
                    }
                  }
                });
                first_hit_flg = FLG_OFF;
              }
              if (result_cnt === 0) {
                g_click_pos_disp_tbl.search_result = result_cnt;
                search_err_popup2();
              } else {
                g_click_pos_disp_tbl.search_result = result_cnt;
                move_to_search_screen_check(popup_search_flg);
              }
            }
          } else {
            search_err_popup4();
          }
          break;
        default:
          break;
      }
    } else {
      // search string at the time of non-input
      search_err_popup5();
    }
  } else {
    // search string at the time of non-input
    search_err_popup1();
  }
  // text inputting is invalid at the time of the popup indication
  if (old_screen_id !== SCREEN_LADDER_REPLACE && g_popup_flg === FLG_ON) {
    document.getElementById('intbox.inbox.search').disabled = "true";
  } else {
    document.getElementById('intbox.inbox.search').disabled = "";
  }
  
  if (old_screen_id === SCREEN_LADDER_REPLACE && g_popup_flg === FLG_ON) {
    document.getElementById('intbox.inbox.replace.before').disabled = "true";
    document.getElementById('intbox.inbox.replace.after').disabled = "true";
  } else {
    document.getElementById('intbox.inbox.replace.before').disabled = "";
    document.getElementById('intbox.inbox.replace.after').disabled = "";
  }
  return true;
}

/*
 =========================================================================
 @function name : ladder_search_click_f5_button
 @argument      : none
 @description   : F5 key click processing
 @return        : none
 =========================================================================
*/
function ladder_search_click_f5_button() {
  g_processing_flg = FLG_ON;
  // origin of transition check
  if (document.getElementById('iSelect1').className === "select message-box-contents-right opened") {
    document.getElementById('iSelect1.label').click();
  } else if (document.getElementById('iSelect2').className === "select message-box-contents-right opened") {
    document.getElementById('iSelect2.label').click();
  }

  switch(old_screen_id){
  case SCREEN_LADDER_DISPLAY:
    old_screen_id = SCREEN_LADDER_NONE;
    move_to_ladder_display('screen_ladder_search');
    break;

  case SCREEN_LADDER_EDITOR:
    old_screen_id = SCREEN_LADDER_NONE;
    move_to_ladder_editor('screen_ladder_search');
    break;

  default:
    break;
  }
  setTimeout(function () {
    g_processing_flg = FLG_OFF;
  }, 10);
}

/*
 =========================================================================
 @function name : search_result_reflection
 @argument      : none
 @description   : reflection of search results
 @return        : none
 =========================================================================
*/
function search_result_reflection(list_kind, mark_flg, i, iterateArray, lx_i, ly_i) {
  list_kind.getDataNum(i, iterateArray)[ly_i][lx_i].SearchMarker = mark_flg;
    if ((list_kind.getDataNum(i, iterateArray)[ly_i][lx_i].FigNo >= IMAGENO1_A_CONTACT) && (list_kind.getDataNum(i, iterateArray)[ly_i][lx_i].FigNo <= IMAGENO8_RDNT)) {
      list_kind.getDataNum(i, iterateArray)[ly_i][lx_i].FigNo = IMAGE_MARKER_TOP + list_kind.getDataNum(i, iterateArray)[ly_i][lx_i].FigNo;
    }
}

/*
 =========================================================================
 @function name        : search_result_first_positon_disp
 @argument[i]          : net number
 @argument[lx_i]       : list element(row)
 @argument[ly_i]       : list element(column)
 @argument[length_cnt] : net length
 @description          : decide an search result indication point(ladder display screen)
 @return               : none
 =========================================================================
*/
function search_result_first_positon_disp(i, lx_i, ly_i, length_cnt, from_search_screen_flg) {
  g_disp_grid_index = ly_i;
  if (from_search_screen_flg === FLG_ON) {
    scrollBoxPos.start_y = SBHV_POS_E + scrollBoxPos.box_height * (ly_i + length_cnt);
  } else if (from_search_screen_flg === FLG_OFF && g_pop_search_flg === FLG_ON) {
    length_cnt = length_count_func(g_disp_net_index);
    scrollBoxPos.start_y = SBHV_POS_E + scrollBoxPos.box_height * (g_disp_grid_index + length_cnt);
    scrollbar_tbl.ly = Math.round((scrollBoxPos.start_y - SBHV_POS_E) / scrollBoxPos.box_height);
  } else {
    // no action
  }
  g_search_width_index = lx_i;
  if (g_search_hit_square_disp_flag == FLG_OFF) {
    g_search_hit_square_disp_flag = FLG_ON;
    g_search_hit_net_num = g_array_search_result_index[0].net_index - 1;
    g_search_hit_element_x = lx_i;
    g_search_hit_element_y = ly_i;
  }
  next_disp_position();
}

/*
 =========================================================================
 @function name : search_result_first_positon_edit
 @argument[i]   : net number
 @argument[lx_i]: list element(row)
 @argument[ly_i]: list element(column)
 @description   : decide an search result indication point(ladder editor screen)
 @return        : none
 =========================================================================
*/
function search_result_first_positon_edit(i, lx_i, ly_i) {
  g_disp_grid_index = 0;
  g_search_width_index = lx_i;
  if (g_search_hit_square_disp_flag == FLG_OFF) {
    g_search_hit_square_disp_flag = FLG_ON;
    g_search_hit_net_num = g_array_search_result_index[0].net_index - 1;
    g_search_hit_element_x = lx_i;
    g_search_hit_element_y = ly_i;
  }
  next_disp_position();
}

/*
 =========================================================================
 @function name : move_to_search_screen_check
 @argument      : popup search flg
 @description   : screen transition check
 @return        : none
 =========================================================================
*/
function move_to_search_screen_check(popup_search_flg) {
  if (popup_search_flg === FLG_OFF) {
    var check1 = document.getElementById('checkbox1.input').checked;
  }
  if (check1 === true) {
    ladder_search_result_click_f2_button(check1);
  } else {
    var search_level = get_ladder_search_range();
    var tree_level = get_ladder_tree_level();
    if (screen_id === SCREEN_LADDER_SEARCH || (old_screen_id === SCREEN_LADDER_DISPLAY && search_level !== tree_level) || (screen_id === SCREEN_LADDER_DISPLAY && search_level !== tree_level) || (screen_id === SCREEN_LADDER_SEARCH_RESULT && search_level !== tree_level)) {
      scrollBoxPos_recomputation_disp(grid_List, g_disp_net_index, FLG_ON, g_disp_grid_index, FLG_ON);
    }
    move_to_ladder_search_result('screen_ladder_search');
  }
}

/*
 =========================================================================
 @function name : search_err_popup1
 @argument      : none
 @description   : search display non-input popup
 @return        : none
 =========================================================================
*/
function search_err_popup1() {
  document.getElementById("popup_no_comfirm_3").style.display="block";
  document.getElementById("poptitle").placeholder = "";
  document.getElementById("popcomment_3_1").style.display="block";
  document.getElementById("popcomment_3_2").style.display="none";
  document.getElementById("popcomment_3_3").style.display="none";
  document.getElementById("popcomment_3_4").style.display="none";
  document.getElementById("popcomment_3_5").style.display="none";
  document.getElementById("search_category_3_1").style.display="none";
  document.getElementById("search_category_3_2").style.display="none";
  document.getElementById("search_category_3_3").style.display="none";
  document.getElementById("search_category_3_4").style.display="none";
  document.getElementById("search_category_3_5").style.display="none";
  document.getElementById("search_category_3_6").style.display="none";
  document.getElementById("search_category_3_7").style.display="none";
  document.getElementById("search_all_category_3_1").style.display="none";
  document.getElementById("popbutton_run").style.display = "none";
  // only R-30iB Plus
  if (g_device == "pc" && top.tpkeyssheet == undefined){
    document.querySelectorAll('.select div')[0].style.backgroundColor = "#b0b0b0";
    document.querySelectorAll('.select div')[1].style.backgroundColor = "#b0b0b0";
  } else {
    document.querySelectorAll('.select div')[0].style.backgroundColor = "transparent";
    document.querySelectorAll('.select div')[1].style.backgroundColor = "transparent";
  }
  document.getElementById('checkbox1.input').disabled = true;
  document.getElementById('checkbox2.input').disabled = true;
  document.getElementById('checkbox3.input').disabled = true;
  document.getElementById('checkbox4.input').disabled = true;
  switch_disabled_radio_button();
  Popupbutton();
}

/*
 =========================================================================
 @function name : search_err_popup2
 @argument      : none
 @description   : search display no search results popup
 @return        : none
 =========================================================================
*/
function search_err_popup2() {
  document.getElementById("popup_no_comfirm_3").style.display="block";
  document.getElementById("poptitle").placeholder = "";
  document.getElementById("popcomment_3_1").style.display="none";
  document.getElementById("popcomment_3_2").style.display="block";
  document.getElementById("popcomment_3_3").style.display="none";
  document.getElementById("popcomment_3_4").style.display="none";
  document.getElementById("popcomment_3_5").style.display = "none";
  if (search_kind == "3" || search_kind == "4") {
    document.getElementById("search_category_3_1").style.display="none";
    document.getElementById("search_category_3_2").style.display="none";
    document.getElementById("search_category_3_3").style.display="none";
    document.getElementById("search_category_3_4").style.display="block";
    document.getElementById("search_category_3_5").style.display="none";
    document.getElementById("search_category_3_6").style.display="none";
    document.getElementById("search_category_3_7").style.display="none";
    document.getElementById("search_all_category_3_1").style.display="none";
    document.getElementById("popbutton_run").style.display="none";
  } else if (g_search_category == SEARCH_CATEGORY_ALL) {
    document.getElementById("search_category_3_1").style.display="none";
    document.getElementById("search_category_3_2").style.display="none";
    document.getElementById("search_category_3_3").style.display="block";
    document.getElementById("search_category_3_4").style.display="none";
    document.getElementById("search_category_3_5").style.display="none";
    document.getElementById("search_category_3_6").style.display="none";
    document.getElementById("search_category_3_7").style.display="none";
    document.getElementById("search_all_category_3_1").style.display="none";
    document.getElementById("popbutton_run").style.display="none";
  } else if (g_search_category == SEARCH_CATEGORY_CONTACT) {
    document.getElementById("search_category_3_1").style.display="block";
    document.getElementById("search_category_3_2").style.display="none";
    document.getElementById("search_category_3_3").style.display="none";
    document.getElementById("search_category_3_4").style.display="none";
    document.getElementById("search_category_3_5").style.display="none";
    document.getElementById("search_category_3_6").style.display="none";
    document.getElementById("search_category_3_7").style.display="none";
    document.getElementById("search_all_category_3_1").style.display="block";
    document.getElementById("popbutton_run").style.display="block";
  } else if(g_search_category == SEARCH_CATEGORY_COIL){
    document.getElementById("search_category_3_1").style.display="none";
    document.getElementById("search_category_3_2").style.display="block";
    document.getElementById("search_category_3_3").style.display="none";
    document.getElementById("search_category_3_4").style.display="none";
    document.getElementById("search_category_3_5").style.display="none";
    document.getElementById("search_category_3_6").style.display="none";
    document.getElementById("search_category_3_7").style.display="none";
    document.getElementById("search_all_category_3_1").style.display="block";
    document.getElementById("popbutton_run").style.display="block";
  } else if(g_search_category == SEARCH_CATEGORY_FUNC){
    document.getElementById("search_category_3_1").style.display="none";
    document.getElementById("search_category_3_2").style.display="none";
    document.getElementById("search_category_3_3").style.display="none";
    document.getElementById("search_category_3_4").style.display="block";
    document.getElementById("search_category_3_5").style.display="none";
    document.getElementById("search_category_3_6").style.display="none";
    document.getElementById("search_category_3_7").style.display="none";
    document.getElementById("search_all_category_3_1").style.display="block";
    document.getElementById("popbutton_run").style.display="block";
  } else if (g_search_category == SEARCH_CATEGORY_CONTACT_COIL) {
    if (search_kind == "1" || search_kind == "2") {
      document.getElementById("search_category_3_1").style.display="none";
      document.getElementById("search_category_3_2").style.display="none";
      document.getElementById("search_category_3_3").style.display="block";
      document.getElementById("search_category_3_4").style.display="none";
      document.getElementById("search_category_3_5").style.display="none";
      document.getElementById("search_category_3_6").style.display="none";
      document.getElementById("search_category_3_7").style.display="none";
      document.getElementById("search_all_category_3_1").style.display="none";
      document.getElementById("popbutton_run").style.display = "none";
    } else {
      document.getElementById("search_category_3_1").style.display = "none";
      document.getElementById("search_category_3_2").style.display = "none";
      document.getElementById("search_category_3_3").style.display = "none";
      document.getElementById("search_category_3_4").style.display = "none";
      document.getElementById("search_category_3_5").style.display = "block";
      document.getElementById("search_category_3_6").style.display = "none";
      document.getElementById("search_category_3_7").style.display = "none";
      document.getElementById("search_all_category_3_1").style.display = "block";
      document.getElementById("popbutton_run").style.display = "block";
    }
  } else if(g_search_category == SEARCH_CATEGORY_CONTACT_FUNC){
    document.getElementById("search_category_3_1").style.display="none";
    document.getElementById("search_category_3_2").style.display="none";
    document.getElementById("search_category_3_3").style.display="none";
    document.getElementById("search_category_3_4").style.display="none";
    document.getElementById("search_category_3_5").style.display="none";
    document.getElementById("search_category_3_6").style.display="block";
    document.getElementById("search_category_3_7").style.display="none";
    document.getElementById("search_all_category_3_1").style.display="block";
    document.getElementById("popbutton_run").style.display="block";
  } else if(g_search_category == SEARCH_CATEGORY_COIL_FUNC){
    document.getElementById("search_category_3_1").style.display="none";
    document.getElementById("search_category_3_2").style.display="none";
    document.getElementById("search_category_3_3").style.display="none";
    document.getElementById("search_category_3_4").style.display="none";
    document.getElementById("search_category_3_5").style.display="none";
    document.getElementById("search_category_3_6").style.display="none";
    document.getElementById("search_category_3_7").style.display="block";
    document.getElementById("search_all_category_3_1").style.display="block";
    document.getElementById("popbutton_run").style.display="block";
  }
  // only R-30iB Plus
  if (g_device == "pc" && top.tpkeyssheet == undefined){
    document.querySelectorAll('.select div')[0].style.backgroundColor = "#b0b0b0";
    document.querySelectorAll('.select div')[1].style.backgroundColor = "#b0b0b0";
  } else {
    document.querySelectorAll('.select div')[0].style.backgroundColor = "transparent";
    document.querySelectorAll('.select div')[1].style.backgroundColor = "transparent";
  }
  document.getElementById('checkbox1.input').disabled = true;
  document.getElementById('checkbox2.input').disabled = true;
  document.getElementById('checkbox3.input').disabled = true;
  document.getElementById('checkbox4.input').disabled = true;
  switch_disabled_radio_button();
  Popupbutton();
}

/*
 =========================================================================
 @function name : search_err_popup3
 @argument      : none
 @description   : search display unjust character input popup
 @return        : none
 =========================================================================
*/
function search_err_popup3() {
  document.getElementById("popup_no_comfirm_3").style.display="block";
  document.getElementById("poptitle").placeholder = "";
  document.getElementById("popcomment_3_1").style.display="none";
  document.getElementById("popcomment_3_2").style.display="none";
  document.getElementById("popcomment_3_3").style.display="block";
  document.getElementById("popcomment_3_4").style.display="none";
  document.getElementById("popcomment_3_5").style.display="none";
  document.getElementById("search_category_3_1").style.display="none";
  document.getElementById("search_category_3_2").style.display="none";
  document.getElementById("search_category_3_3").style.display="none";